/* Artecsan */function config($stateProvider,$urlRouterProvider,$ocLazyLoadProvider,IdleProvider,localStorageServiceProvider,$httpProvider,$locationProvider){IdleProvider.idle(5),IdleProvider.timeout(120),localStorageServiceProvider.setPrefix("artecsan"),$httpProvider.interceptors.push("interceptorService"),$locationProvider.html5Mode(!1).hashPrefix("!"),$urlRouterProvider.otherwise("/home"),$ocLazyLoadProvider.config({debug:!1}),$stateProvider.state("admin",{abstract:!0,url:"/admin",templateUrl:"views/common/content.html"}).state("admin.homeMenu",{url:"/home_menu",templateUrl:"views/homeMenu.html",controller:"homeMenuController",controllerAs:"$ctr",data:{pageTitle:"Home"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]},{serie:!0,files:["css/plugins/c3/c3.min.css","js/plugins/d3/d3.min.js","js/plugins/c3/c3.min.js"]},{serie:!0,name:"gridshore.c3js.chart",files:["js/plugins/c3/c3-angular.min.js"]}])}}}).state("admin.managementCategories",{url:"/management_categories",templateUrl:"views/managementCategories.html",data:{pageTitle:"Management Categories"}}).state("admin.inventoryAuditAsk",{url:"/inventory-audit-ask",templateUrl:"views/inventoryAuditAsk.html",data:{pageTitle:"Inventory Audit"}}).state("admin.inventoryCategories",{url:"/inventory_categories",templateUrl:"views/inventoryCategories.html",data:{pageTitle:"Inventory Categories"}}).state("admin.comingSoon",{url:"/coming_soon",templateUrl:"views/comingSoon.html",data:{pageTitle:"Coming Soon"}}).state("food",{abstract:!0,url:"/food",templateUrl:"views/common/content.html",resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]}])}}}).state("alcohol",{abstract:!0,url:"/alcohol",templateUrl:"views/common/content.html",resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]}])}}}).state("foodSubCategories",{url:"/food_sub_categories",templateUrl:"views/foodSubCategories.html",data:{pageTitle:"Food Sub Categories"}}).state("foodAuditCategories",{url:"/food_audit_categories",templateUrl:"views/foodAuditCategories.html",data:{pageTitle:"Food Audit Categories"}}).state("alcoholSubCategories",{url:"/alcohol_sub_categories",templateUrl:"views/alcoholSubCategories.html",data:{pageTitle:"Alcohol Sub Categories"}}).state("reports.food",{url:"/food",template:"<ui-view></ui-view>",abstract:!0}).state("reports.alcohol",{url:"/alcohol",template:"<ui-view></ui-view>",abstract:!0}).state("reports.alcohol.alcoholDetail",{url:"/alcohol_detail",templateUrl:"views/alcoholDetail.html",controller:"alcoholDetailController",data:{pageTitle:"Alcohol Detail"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]},{serie:!0,files:["css/plugins/c3/c3.min.css","js/plugins/d3/d3.min.js","js/plugins/c3/c3.min.js"]},{serie:!0,name:"gridshore.c3js.chart",files:["js/plugins/c3/c3-angular.min.js"]}])}}}).state("food.inventoryPurchases",{url:"/inventory_purchases",templateUrl:"views/inventoryPurchases.html",data:{pageTitle:"Inventory Purchases"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/moment/moment.min.js"]},{name:"datePicker",files:["css/plugins/datapicker/angular-datapicker.css","js/plugins/datapicker/angular-datepicker.js"]}])}}}).state("food.costOfSales",{url:"/cost_of_sales",templateUrl:"views/costOfSales.html",data:{pageTitle:"Cost Of Sales"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/moment/moment.min.js"]},{name:"datePicker",files:["css/plugins/datapicker/angular-datapicker.css","js/plugins/datapicker/angular-datepicker.js"]}])}}}).state("setupFirstAudit",{url:"/setup_first_audit",templateUrl:"views/setupFirstAudit.html",data:{pageTitle:"First Audit"}})}function pageTitle($rootScope,$timeout){return{link:function(scope,element){var listener=function(event,toState,toParams,fromState,fromParams){var title="CooksTime ";toState.data&&toState.data.pageTitle&&(title="CooksTime | "+toState.data.pageTitle),$timeout(function(){element.text(title)})};$rootScope.$on("$stateChangeStart",listener)}}}function sideNavigation($timeout){return{restrict:"A",link:function(scope,element){$timeout(function(){element.metisMenu()})}}}function responsiveVideo(){return{restrict:"A",link:function(scope,element){var figure=element,video=element.children();video.attr("data-aspectRatio",video.height()/video.width()).removeAttr("height").removeAttr("width"),$(window).resize(function(){var newWidth=figure.width();video.width(newWidth).height(newWidth*video.attr("data-aspectRatio"))}).resize()}}}function iboxTools($timeout){return{restrict:"A",scope:!0,templateUrl:"views/common/ibox_tools.html",controller:function($scope,$element){$scope.showhide=function(){var ibox=$element.closest("div.ibox"),icon=$element.find("i:first");ibox.find("div.ibox-content").slideToggle(200),icon.toggleClass("fa-chevron-up").toggleClass("fa-chevron-down"),ibox.toggleClass("").toggleClass("border-bottom"),$timeout(function(){ibox.resize(),ibox.find("[id^=map-]").resize()},50)},$scope.closebox=function(){$element.closest("div.ibox").remove()}}}}function iboxToolsFullScreen($timeout){return{restrict:"A",scope:!0,templateUrl:"views/common/ibox_tools_full_screen.html",controller:function($scope,$element){$scope.showhide=function(){var ibox=$element.closest("div.ibox"),icon=$element.find("i:first");ibox.find("div.ibox-content").slideToggle(200),icon.toggleClass("fa-chevron-up").toggleClass("fa-chevron-down"),ibox.toggleClass("").toggleClass("border-bottom"),$timeout(function(){ibox.resize(),ibox.find("[id^=map-]").resize()},50)},$scope.closebox=function(){$element.closest("div.ibox").remove()},$scope.fullscreen=function(){var ibox=$element.closest("div.ibox"),button=$element.find("i.fa-expand");$("body").toggleClass("fullscreen-ibox-mode"),button.toggleClass("fa-expand").toggleClass("fa-compress"),ibox.toggleClass("fullscreen"),setTimeout(function(){$(window).trigger("resize")},100)}}}}function minimalizaSidebar($timeout){return{restrict:"A",template:'<a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="" ng-click="minimalize()"><i class="fa fa-bars"></i></a>',controller:function($scope,$element){$scope.minimalize=function(){$("body").toggleClass("mini-navbar"),!$("body").hasClass("mini-navbar")||$("body").hasClass("body-small")?($("#side-menu").hide(),setTimeout(function(){$("#side-menu").fadeIn(400)},200)):$("body").hasClass("fixed-sidebar")?($("#side-menu").hide(),setTimeout(function(){$("#side-menu").fadeIn(400)},100)):$("#side-menu").removeAttr("style")}}}}function closeOffCanvas(){return{restrict:"A",template:'<a class="close-canvas-menu" ng-click="closeOffCanvas()"><i class="fa fa-times"></i></a>',controller:function($scope,$element){$scope.closeOffCanvas=function(){$("body").toggleClass("mini-navbar")}}}}function vectorMap(){return{restrict:"A",scope:{myMapData:"="},link:function(scope,element,attrs){var destroyMap=(element.vectorMap({map:"world_mill_en",backgroundColor:"transparent",regionStyle:{initial:{fill:"#e4e4e4","fill-opacity":.9,stroke:"none","stroke-width":0,"stroke-opacity":0}},series:{regions:[{values:scope.myMapData,scale:["#1ab394","#22d6b1"],normalizeFunction:"polynomial"}]}}),function(){element.remove()});scope.$on("$destroy",function(){destroyMap()})}}}function sparkline(){return{restrict:"A",scope:{sparkData:"=",sparkOptions:"="},link:function(scope,element,attrs){scope.$watch(scope.sparkData,function(){render()}),scope.$watch(scope.sparkOptions,function(){render()});var render=function(){$(element).sparkline(scope.sparkData,scope.sparkOptions)}}}}function icheck($timeout){return{restrict:"A",require:"ngModel",link:function($scope,element,$attrs,ngModel){return $timeout(function(){var value;return value=$attrs.value,$scope.$watch($attrs.ngModel,function(newValue){$(element).iCheck("update")}),$(element).iCheck({checkboxClass:"icheckbox_square-green",radioClass:"iradio_square-green"}).on("ifChanged",function(event){if("checkbox"===$(element).attr("type")&&$attrs.ngModel&&$scope.$apply(function(){return ngModel.$setViewValue(event.target.checked)}),"radio"===$(element).attr("type")&&$attrs.ngModel)return $scope.$apply(function(){return ngModel.$setViewValue(value)})})})}}}function ionRangeSlider(){return{restrict:"A",scope:{rangeOptions:"="},link:function(scope,elem,attrs){elem.ionRangeSlider(scope.rangeOptions)}}}function dropZone(){return{restrict:"C",link:function(scope,element,attrs){var config={url:"http://localhost:8080/upload",maxFilesize:100,paramName:"uploadfile",maxThumbnailFilesize:10,parallelUploads:1,autoProcessQueue:!1},eventHandlers={addedfile:function(file){scope.file=file,null!=this.files[1]&&this.removeFile(this.files[0]),scope.$apply(function(){scope.fileAdded=!0})},success:function(file,response){}};dropzone=new Dropzone(element[0],config),angular.forEach(eventHandlers,function(handler,event){dropzone.on(event,handler)}),scope.processDropzone=function(){dropzone.processQueue()},scope.resetDropzone=function(){dropzone.removeAllFiles()}}}}function chatSlimScroll($timeout){return{restrict:"A",link:function(scope,element){$timeout(function(){element.slimscroll({height:"234px",railOpacity:.4})})}}}function customValid(){return{require:"ngModel",link:function(scope,ele,attrs,c){scope.$watch(attrs.ngModel,function(){"Inspinia"==scope.extras?c.$setValidity("cvalid",!0):c.$setValidity("cvalid",!1)})}}}function fullScroll($timeout){return{restrict:"A",link:function(scope,element){$timeout(function(){element.slimscroll({height:"100%",railOpacity:.9})})}}}function slimScroll($timeout){return{restrict:"A",scope:{boxHeight:"@"},link:function(scope,element){$timeout(function(){element.slimscroll({height:scope.boxHeight,railOpacity:.9})})}}}function clockPicker(){return{restrict:"A",link:function(scope,element){element.clockpicker()}}}function landingScrollspy(){return{restrict:"A",link:function(scope,element,attrs){element.scrollspy({target:".navbar-fixed-top",offset:80})}}}function fitHeight(){return{restrict:"A",link:function(scope,element){element.css("height",$(window).height()+"px"),element.css("min-height",$(window).height()+"px")}}}function truncate($timeout){return{restrict:"A",scope:{truncateOptions:"="},link:function(scope,element){$timeout(function(){element.dotdotdot(scope.truncateOptions)})}}}function touchSpin(){return{restrict:"A",scope:{spinOptions:"="},link:function(scope,element,attrs){scope.$watch(scope.spinOptions,function(){render()});var render=function(){$(element).TouchSpin(scope.spinOptions)}}}}function markdownEditor(){return{restrict:"A",require:"ngModel",link:function(scope,element,attrs,ngModel){$(element).markdown({savable:!1,onChange:function(e){ngModel.$setViewValue(e.getContent())}})}}}function MainCtrl($http,$uibModal,$scope,$location,api,auth,$state,restaurant,$rootScope,$uibModalStack,$interval,localStorageService,common){var that=this;that.api=api,that.inviteForm={},that.restaurant_id=localStorageService.get("restaurant_id"),$rootScope.$on("restaurantSelected",function(){$rootScope.restaurant_id=restaurant.data.info.id,that.permissions=restaurant.data.permissions,$rootScope.subscription_type_id=restaurant.data.info.subscription_type_id,that.subscription_type_id=restaurant.data.info.subscription_type_id}),$rootScope.$on("$stateChangeStart",function(event){var top=$uibModalStack.getTop();$("html, body").animate({scrollTop:0},20),top&&$uibModalStack.dismissAll()}),$rootScope.$on("$stateChangeSuccess",function(ev,to,toParams,from,fromParams){window.onbeforeunload=null,$rootScope.previousState=from.name,$rootScope.currentState=to.name});var _report_items_match=function(){$rootScope.restaurant_id&&auth.authentication.isLogged&&that.api.report_items_match($rootScope.restaurant_id).then(function(res){$rootScope.report_items_match_to_show=res.data.data.items_to_match})};_report_items_match(),that.$onInit=function(){that.permissions=restaurant.data.permissions,$rootScope.report_items_match_interval&&$interval.cancel($rootScope.report_items_match_interval),$rootScope.report_items_match_interval=$interval(_report_items_match,6e4)};var invite_key=$location.search().invite_key,inviteKeyPopup=function(invite_key){that.api.get_invite_info({invite_key:invite_key}).then(function(res){var user=res.data.data.invite_info;user&&$uibModal.open({templateUrl:"views/modal/invite_key_popup.html",controller:function($uibModalInstance,alertService){var self=this;self.user=user,self.decline=function(){var m={invite_key:invite_key,status_id:2,is_new_user:self.user.is_new_user};that.api.redeem_invitation(m).then(function(res){1e3!==res.data.data.code&&1022!==res.data.data.code||($uibModalInstance.close(),alertService.showSuccessText("Invitation was declined"),auth.authentication.isLogged||$state.go("login",{}))})},self.submit=function(form){if(!0===form.$valid){var m={invite_key:invite_key,status_id:1,is_new_user:self.user.is_new_user};self.user.is_new_user&&(m.password=self.user.password),that.api.redeem_invitation(m).then(function(res){1e3!==res.data.data.code&&1022!==res.data.data.code||($uibModalInstance.close(),alertService.showSuccessText("Invitation was confirmed"),auth.authentication.isLogged||$state.go("login",{}))})}else if(form.$error&&form.$error.password)return void alertService.showErrorInvitation("","Password should be minimum 8 characters and contain at least 1 uppercase letter and 1 digit")}},windowClass:"animated fadeIn",controllerAs:"$ctr"})})};invite_key&&inviteKeyPopup(invite_key),that.full_Audit=function(){common.full_Audit()},that.adjustment_Audit=function(){common.adjustment_Audit()},that.showAuditOptions=function(inventory_type_id,caller){that.api.get_suggested_audit({inventory_type_id:inventory_type_id}).then(function(res){if(1e3===res.data.data.code){var sug_aud_exists=!!res.data.data.inventory.length;return $uibModal.open({templateUrl:"views/modal/show_audit_options.html",controller:function($uibModalInstance,$scope,alertService){$scope.sug_aud_exists=sug_aud_exists,$scope.startCount=function(mode){if(sug_aud_exists){var ongoing_exists=!1,ongoing_suggested_exists=!1;that.api.get_audit_dates({RestaurantId:$rootScope.restaurant_id,inventory_type_id:inventory_type_id}).then(function(res1){if(res1.data.data.Report.length&&"draft"==res1.data.data.Report[0].src&&(ongoing_exists=!0,1==res1.data.data.Report[0].is_suggested&&(ongoing_suggested_exists=!0)),ongoing_exists)if(ongoing_suggested_exists)if("reg"==mode){var conf={title:"You have an ongoing suggested audit.",text:"Please complete the suggested audit or clear it to access the Full Count.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",cancelButtonText:"Clear Suggested Audit",confirmButtonText:"OK"};swal(conf,function(res){res||that.api.delete_inventory_audit(inventory_type_id,"true").then(function(res1){alertService.showSuccessText("Deleted!, Please proceed to startover a new audit."),$uibModalInstance.dismiss("cancel")})})}else"sug"==mode&&(2==inventory_type_id?"tablet"==caller?$state.go("alcoholSetup.tabletEntry",{is_sug_aud:!0}):that.beginAlcoholInventoryCount():1==inventory_type_id&&("tablet"==caller?$state.go("foodSetup.tabletEntry",{is_sug_aud:!0}):$state.go("foodSetup.foodInventory",{is_sug_aud:!0})));else if("reg"==mode)2==inventory_type_id?"tablet"==caller?that.beginAlcoholInventoryCountTablet():that.beginAlcoholInventoryCount():1==inventory_type_id&&("tablet"==caller?that.beginFoodInventoryCountTablet():$state.go("foodSetup.foodInventory"));else{var conf={title:"You have an ongoing audit!",text:"Please complete the ongoing audit or clear it to access the Suggested Audit.",type:"warning",confirmButtonColor:"#ed5565",confirmButtonText:"OK"};swal(conf,function(res){})}else if("reg"==mode){var conf={title:"You have a suggested audit.",text:"Please complete the suggested audit or clear it to access the Full Count.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",cancelButtonText:"Clear Suggested Audit",confirmButtonText:"OK"};swal(conf,function(res){res||that.api.delete_suggested_audit({inventory_type_id:inventory_type_id}).then(function(res1){alertService.showSuccessText("Deleted!, Please proceed to startover a new audit."),$uibModalInstance.dismiss("cancel")})})}else"sug"==mode&&(2==inventory_type_id?"tablet"==caller?$state.go("alcoholSetup.tabletEntry",{is_sug_aud:!0}):that.beginAlcoholInventoryCount():1==inventory_type_id&&("tablet"==caller?$state.go("foodSetup.tabletEntry",{is_sug_aud:!0}):$state.go("foodSetup.foodInventory",{is_sug_aud:!0})))})}else"reg"==mode&&(2==inventory_type_id?"tablet"==caller?that.beginAlcoholInventoryCountTablet():that.beginAlcoholInventoryCount():1==inventory_type_id&&("tablet"==caller?that.beginFoodInventoryCountTablet():$state.go("foodSetup.foodInventory")))},$scope.cancel=function(){$uibModalInstance.dismiss("cancel")}},windowClass:"animated fadeIn",size:"lg",controllerAs:"$ctr"})}})},that.beginAlcoholInventoryCount=function(){common.beginAlcoholInventoryCount()},that.beginAlcoholInventoryCountTablet=function(){$state.go("alcoholSetup.tabletEntry")},that.beginFoodInventoryCountTablet=function(){$state.go("foodSetup.tabletEntry")},this.posIndex=2,this.isRegistration=!1,this.isFoodSetup=!1,this.isTrue=!0,this.type={value:1,name:"MEAT & POULTRY"},this.types=[{value:1,name:"MEAT & POULTRY"},{value:2,name:"SEAFOOD"},{value:3,name:"PRODUCE"},{value:4,name:"VEGETABLES"},{value:5,name:"BREAD"},{value:6,name:"FRUIT"}],this.usersList=[{firstName:"firstName",lastName:"lastName",email:"test123@ttts.rt",userType:"Admin",selected:!1},{firstName:"firstName2",lastName:"lastName",email:"test123@ttts.rt",userType:"Admin",selected:!1},{firstName:"firstName3",lastName:"lastName",email:"test123@ttts.rt",userType:"Admin",selected:!1}],this.vendorsList=[{id:121,name:"test",city:"City",date:"12/12/12",zip:"123",selected:!1},{id:122,name:"test6",city:"City6",date:"12/12/16",zip:"1236",selected:!1},{id:1241,name:"test3",city:"City3",date:"12/15/12",zip:"1523",selected:!1},{id:1621,name:"test8",city:"City8",date:"12/12/13",zip:"1239",selected:!1},{id:1821,name:"test3",city:"City3",date:"12/12/18",zip:"1235",selected:!1},{id:18621,name:"test3",city:"City3",date:"12/12/18",zip:"1235",selected:!1}],this.selectedVendors=[{id:121,name:"test",city:"City",date:"12/12/12",zip:"123",selected:!1},{id:122,name:"test",city:"City",date:"12/12/12",zip:"123",selected:!1}],this.selectedInventoryList=[],this.inventoryList=[{id:18321,name:"test",desc:"description",selected:!1},{id:14821,name:"test",desc:"description",selected:!1},{id:15821,name:"test",desc:"description",selected:!1},{id:17821,name:"test",desc:"description",selected:!1},{id:18821,name:"test",desc:"description",selected:!1}],this.selectInventory=function(ind){this.inventoryList[ind].selected=!this.inventoryList[ind].selected},this.selectVendor=function(ind){this.vendorsList[ind].selected=!this.vendorsList[ind].selected},this.recipeList=[{name:"recipe1",type:"type1",cnt:123},{name:"recipe19",type:"type19",cnt:1923},{name:"recipe1",type:"type1",cnt:123},{name:"recipe18",type:"type18",cnt:1283},{name:"recipe16",type:"type16",cnt:1623},{name:"recipe41",type:"type41",cnt:1523}],this.menuList=[{id:1,name:"menu item",price:23,cost:123},{id:41,name:"menu item",price:243,cost:123},{id:15,name:"menu item",price:23,cost:123},{id:16,name:"menu item",price:23,cost:123},{id:71,name:"menu item",price:23,cost:123},{id:18,name:"menu item",price:23,cost:123},{id:19,name:"menu item",price:23,cost:123},{id:231,name:"menu item",price:23,cost:123}],this.deliveryList=[{c:"Category",d:"\tMon,Tue,Wed"},{c:"Category",d:"\tMon,Tue,Wed"},{c:"Category",d:"\tMon,Tue,Wed"},{c:"Category",d:"\tMon,Tue,Wed"}],this.selectBlock=function(val){this.posIndex=val},this.selectRestaurant=function(){this.isRestaurantSelected=!0},this.logout=function(){this.posIndex=2,this.isRegistration=!1,this.isFoodSetup=!1,auth.logOut()},this.reset=function(){this.posIndex=2,this.isRestaurantSelected=!1,this.changeFirstDashboaed=!1},this.open2=function(self){self.usersList||(self.usersList=[]),$uibModal.open({templateUrl:"views/modal/add_new_user_item.html",controller:ModalInstanceCtrl,windowClass:"animated fadeIn",controllerAs:"vm",resolve:{user:function(){return null}}}).result.then(function(result){self.usersList.push(result)},function(reason){})},this.open3=function(self){self.usersList||(self.usersList=[]),$uibModal.open({templateUrl:"views/modal/invite_new_user_item.html",controller:ModalInstanceCtrl,windowClass:"animated fadeIn",controllerAs:"vm",resolve:{user:function(){return null}}}).result.then(function(result){self.usersList.push(result)},function(reason){})},this.open4=function(self){$uibModal.open({templateUrl:"views/modal/add_new_recipe_item.html",controller:ModalInstanceRecipeCtrl,windowClass:"animated fadeIn modal-lgg",controllerAs:"vm",size:"lg",resolve:{recipe:function(){return null}}}).result.then(function(result){},function(reason){})},this.open6=function(self){$uibModal.open({templateUrl:"views/modal/add_new_menu_item.html",controller:ModalInstanceMenuCtrl,windowClass:"animated fadeIn",size:"lg",controllerAs:"vm",resolve:{menu:function(){return null}}}).result.then(function(result){},function(reason){})},this.open7=function(self){$uibModal.open({templateUrl:"views/modal/add_new_menu_item.html",controller:ModalInstanceMenuCtrl,windowClass:"animated fadeIn",controllerAs:"vm",resolve:{menu:function(){return self.menuList[0]}}}).result.then(function(result){},function(reason){})},this.open8=function(self){$uibModal.open({templateUrl:"views/modal/add_new_delivery_item.html",controller:ModalInstanceDeliveryCtrl,windowClass:"animated fadeIn",controllerAs:"vm"}).result.then(function(result){},function(reason){})},this.editUser=function(self,user,index){self.usersList.splice(index,1),$uibModal.open({templateUrl:"views/modal/add_new_user_item.html",controller:ModalInstanceCtrl,windowClass:"animated fadeIn",controllerAs:"vm",resolve:{user:function(){return user}}}).result.then(function(result){self.usersList.push(result)},function(reason){})},this.deleteUser=function(self,index){self.usersList.splice(index,1)},this.where=function(){alert("Under construction")},this.willBe=function(){alert("It will work if number of vendors > 1")}}function notifyCtrl($scope,notify,$state){$scope.inspiniaTemplate="views/common/notify.html",$scope.inspiniaDemo1=function(){notify({message:"Thank you! We will contact you soon",classes:"alert-info",templateUrl:$scope.inspiniaTemplate}),$state.go("home.home")}}function ModalInstanceCtrl($scope,$uibModalInstance,user){this.isEdit=!1,this.user=user,user&&(this.isEdit=!0),$scope.ok=function(user){$uibModalInstance.close(user)},$scope.cancel=function(){$uibModalInstance.dismiss("cancel")}}function ModalInstanceDeliveryCtrl($scope,$uibModalInstance){$scope.ok=function(user){$uibModalInstance.close()},$scope.cancel=function(){$uibModalInstance.dismiss("cancel")}}function ModalInstanceRecipeCtrl($scope,$uibModalInstance,recipe){this.isEdit=!1,this.recipe=recipe,recipe&&(this.isEdit=!0),$scope.ok=function(recipe){$uibModalInstance.close(recipe)},this.ingredients=[{amount:122,cost:300},{amount:1242,cost:3060}],this.addIngredient=function(){this.ingredients.push({amount:1622,cost:3070})},this.removeIngredient=function(ind){this.ingredients.splice(ind,1)},$scope.cancel=function(){$uibModalInstance.dismiss("cancel")}}function ModalInstanceMenuCtrl($scope,$uibModalInstance,menu){this.isEdit=!1,this.menu=menu,menu&&(this.isEdit=!0),$scope.recipeInventories=[],$scope.ok=function(menu){$uibModalInstance.close(menu)},$scope.cancel=function(){$uibModalInstance.dismiss("cancel")},this.addRecipeInventory=function(){$scope.recipeInventories.push({name:"recipe"})},this.remove=function(ind){$scope.recipeInventories.splice(ind,1)}}function acPassword($filter,$parse){"ngInject";return{require:"^ngModel",link:function(scope,el,attrs,modelCtrl){function isValid(value){if(value.length<8)return!1;for(var hasDigit=!1,hasUpperCaseLetter=!1,i=0;i<value.length;i++){var c=value[i];c>="0"&&c<="9"&&(hasDigit=!0),c>="A"&&c<="Z"&&(hasUpperCaseLetter=!0)}return hasUpperCaseLetter&&hasDigit}function isEmpty(value){return void 0===value||null===value||""===value}function formatter(value){if(isEmpty(value))return value;var valid=isValid(value);return modelCtrl.$setValidity("password",valid),value}modelCtrl.$formatters.push(formatter),modelCtrl.$parsers.push(function(value){if(isEmpty(value))return value;var valid=isValid(value);return modelCtrl.$setValidity("password",valid),value})}}}function acPhone($filter,$parse){"ngInject";return{require:"^ngModel",scope:!0,link:function(scope,el,attrs,ngModelCtrl){function getValue(value){if(!value)return null;if("number"==typeof value&&(value=value.toString()),"string"!=typeof value)return null;for(var phone="",i=0;i<value.length;i++){var c=value[i];if("("!=c&&")"!=c&&" "!=c){if("+"==c&&""!=phone)return null;c>="0"&&c<="9"&&(phone+=c)}}return 10==phone.length&&(phone="1"+phone),phone}function isValid(value){return!!value&&"string"==typeof value&&"1"===value[0]&&11==value.length}function isEmpty(value){return void 0===value||null===value||""===value}function getViewValue(p){return p[1]+p[2]+p[3]+p[4]+p[5]+p[6]+p[7]+p[8]+p[9]+p[10]}function formatter(input){if(isEmpty(input))return ngModelCtrl.$setValidity("phone",!0),input;const phoneValue=getValue(input),isValidPhone=isValid(phoneValue),formattedValue=isValidPhone?getViewValue(phoneValue):input;return el.val(formattedValue),ngModelCtrl.$setViewValue(formattedValue),ngModelCtrl.$setValidity("phone",isValidPhone),formattedValue}ngModelCtrl.$formatters.push(formatter),ngModelCtrl.$parsers.push(function(input){if(isEmpty(input))return ngModelCtrl.$setValidity("phone",!0),input;const phoneValue=getValue(input),isValidPhone=isValid(phoneValue);return ngModelCtrl.$setValidity("phone",isValidPhone),isValidPhone?phoneValue:input}),el.bind("focus",function(){var modelGetter=$parse(attrs.ngModel),initialValue=modelGetter(scope);el.val(initialValue)}),el.bind("blur",function(){formatter(el.val()),scope.$apply()})}}}function compareTo(){return{require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(scope,element,attributes,ngModel){ngModel.$validators.compareTo=function(modelValue){return modelValue==scope.otherModelValue},scope.$watch("otherModelValue",function(){ngModel.$validate()})}}}function numbersOnly(){return{require:"?ngModel",link:function(scope,element,attrs,ngModelCtrl){function fromUser(text){if(text){var transformedInput=text.replace(/[^0-9]/g,"");return transformedInput!==text&&(ngModelCtrl.$setViewValue(transformedInput),ngModelCtrl.$render()),transformedInput}}ngModelCtrl.$parsers.push(fromUser)}}}function onlyDigits(){return{restrict:"A",require:"?ngModel",link:function(scope,element,attrs,modelCtrl){modelCtrl.$parsers.push(function(inputValue){if(void 0==inputValue)return null;if(null==inputValue)return null;if(""==inputValue)return null;if("number"==typeof inputValue)return inputValue;var intValue=parseInt(inputValue,10);return Number.isFinite(intValue)?(intValue.toString()!==inputValue&&(modelCtrl.$setViewValue(intValue.toString()),modelCtrl.$render()),intValue):(modelCtrl.$setViewValue(""),modelCtrl.$render(),null)})}}}function partialWeightValidator(SweetAlert){return{restrict:"A",require:"ngModel",link:function(scope,elem,attr,ngModel){ngModel.$validators.partialWeightValidator=function(modelValue,viewValue){var item=scope.$eval(attr.currentItem),partialEntry=modelValue||viewValue;if(item)if("Pts"==item.selected_partial_input_mode){if(partialEntry>0&&partialEntry<1)return!0}else if("Draft Beer"!=item.category&&"Draft Wine"!=item.category||("Draft Beer"==item.category||"Draft Wine"==item.category)&&"Oz"==item.selected_partial_input_mode){if(partialEntry>=item.tare_weight&&partialEntry<=item.full_weight)return!0}else if(16*partialEntry>=item.tare_weight&&16*partialEntry<=item.full_weight)return!0;return!1}}}}function scrollTop(){return{restrict:"A",link:function(scope,$elm){$elm.on("click",function(){$("body").animate({scrollTop:$elm.scrollTop()},"slow")})}}}function uniqueSku(api){return{restrict:"A",require:"ngModel",link:function(scope,elem,attr,ngModel){$(elem).blur(function(event){ngModel.$dirty&&(ngModel.$viewValue?api.vendors_sku({vendor_sku:ngModel.$viewValue,vendor_id:scope.searchParams.vendor_id}).then(function(res){res.data.data?(ngModel.$setValidity("unique",!0),ngModel.$setPristine()):ngModel.$setValidity("unique",!1)},function(e){console.log(e)}):(ngModel.$setValidity("unique",!0),ngModel.$setPristine(),ngModel.$setUntouched()))})},scope:{searchParams:"="}}}function unitWeightValid(SweetAlert){"ngInject";return{restrict:"A",require:"?ngModel",link:function(scope,elem,attr,ngModel){$(elem).blur(function(event){if(ngModel.$viewValue){var unitWeightFormula=ngModel.$viewValue.match(/\d+((,|\.)\d+)?/g),tareWeight=scope.$parent.i.tare_weight,ofBottles=scope.$parent.i.nof_bottles;0==scope.$parent.i.item_qty&&0==ofBottles&&(ngModel.$setValidity("unique",!0),ngModel.$setPristine(),ngModel.$setUntouched()),angular.forEach(unitWeightFormula,function(unitWeight){ofBottles>0&&(unitWeight<tareWeight?(ngModel.$setValidity("unique",!1),SweetAlert.swal({title:"Error",text:"Each term must be greater than the tare weight!",showConfirmButton:!1,type:"error",timer:3e3})):(ngModel.$setValidity("unique",!0),ngModel.$setPristine()))})}else ngModel.$setValidity("unique",!0),ngModel.$setPristine(),ngModel.$setUntouched()})},scope:{model:"="}}}!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){function s(a){var b=!!a&&"length"in a&&a.length,c=n.type(a);return"function"!==c&&!n.isWindow(a)&&("array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a)}function z(a,b,c){if(n.isFunction(b))return n.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return n.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(y.test(b))return n.filter(b,a,c);b=n.filter(b,a)}return n.grep(a,function(a){return h.call(b,a)>-1!==c})}function F(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}function H(a){var b={};return n.each(a.match(G)||[],function(a,c){b[c]=!0}),b}function J(){d.removeEventListener("DOMContentLoaded",J),a.removeEventListener("load",J),n.ready()}function M(){this.expando=n.expando+M.uid++}function R(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(Q,"-$&").toLowerCase(),"string"==typeof(c=a.getAttribute(d))){try{c="true"===c||"false"!==c&&("null"===c?null:+c+""===c?+c:P.test(c)?n.parseJSON(c):c)}catch(e){}O.set(a,b,c)}else c=void 0;return c}function W(a,b,c,d){var e,f=1,g=20,h=d?function(){return d.cur()}:function(){return n.css(a,b,"")},i=h(),j=c&&c[3]||(n.cssNumber[b]?"":"px"),k=(n.cssNumber[b]||"px"!==j&&+i)&&T.exec(n.css(a,b));if(k&&k[3]!==j){j=j||k[3],c=c||[],k=+i||1;do{f=f||".5",k/=f,n.style(a,b,k+j)}while(f!==(f=h()/i)&&1!==f&&--g)}return c&&(k=+k||+i||0,e=c[1]?k+(c[1]+1)*c[2]:+c[2],d&&(d.unit=j,d.start=k,d.end=e)),e}function _(a,b){var c=void 0!==a.getElementsByTagName?a.getElementsByTagName(b||"*"):void 0!==a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&n.nodeName(a,b)?n.merge([a],c):c}function aa(a,b){for(var c=0,d=a.length;d>c;c++)N.set(a[c],"globalEval",!b||N.get(b[c],"globalEval"))}function ca(a,b,c,d,e){
for(var f,g,h,i,j,k,l=b.createDocumentFragment(),m=[],o=0,p=a.length;p>o;o++)if((f=a[o])||0===f)if("object"===n.type(f))n.merge(m,f.nodeType?[f]:f);else if(ba.test(f)){for(g=g||l.appendChild(b.createElement("div")),h=(Y.exec(f)||["",""])[1].toLowerCase(),i=$[h]||$._default,g.innerHTML=i[1]+n.htmlPrefilter(f)+i[2],k=i[0];k--;)g=g.lastChild;n.merge(m,g.childNodes),g=l.firstChild,g.textContent=""}else m.push(b.createTextNode(f));for(l.textContent="",o=0;f=m[o++];)if(d&&n.inArray(f,d)>-1)e&&e.push(f);else if(j=n.contains(f.ownerDocument,f),g=_(l.appendChild(f),"script"),j&&aa(g),c)for(k=0;f=g[k++];)Z.test(f.type||"")&&c.push(f);return l}function ga(){return!0}function ha(){return!1}function ia(){try{return d.activeElement}catch(a){}}function ja(a,b,c,d,e,f){var g,h;if("object"==typeof b){"string"!=typeof c&&(d=d||c,c=void 0);for(h in b)ja(a,h,c,d,b[h],f);return a}if(null==d&&null==e?(e=c,d=c=void 0):null==e&&("string"==typeof c?(e=d,d=void 0):(e=d,d=c,c=void 0)),!1===e)e=ha;else if(!e)return a;return 1===f&&(g=e,e=function(a){return n().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=n.guid++)),a.each(function(){n.event.add(this,b,e,d,c)})}function pa(a,b){return n.nodeName(a,"table")&&n.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function qa(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function ra(a){var b=na.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function sa(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(N.hasData(a)&&(f=N.access(a),g=N.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;d>c;c++)n.event.add(b,e,j[e][c])}O.hasData(a)&&(h=O.access(a),i=n.extend({},h),O.set(b,i))}}function ta(a,b){var c=b.nodeName.toLowerCase();"input"===c&&X.test(a.type)?b.checked=a.checked:"input"!==c&&"textarea"!==c||(b.defaultValue=a.defaultValue)}function ua(a,b,c,d){b=f.apply([],b);var e,g,h,i,j,k,m=0,o=a.length,p=o-1,q=b[0],r=n.isFunction(q);if(r||o>1&&"string"==typeof q&&!l.checkClone&&ma.test(q))return a.each(function(e){var f=a.eq(e);r&&(b[0]=q.call(this,e,f.html())),ua(f,b,c,d)});if(o&&(e=ca(b,a[0].ownerDocument,!1,a,d),g=e.firstChild,1===e.childNodes.length&&(e=g),g||d)){for(h=n.map(_(e,"script"),qa),i=h.length;o>m;m++)j=e,m!==p&&(j=n.clone(j,!0,!0),i&&n.merge(h,_(j,"script"))),c.call(a[m],j,m);if(i)for(k=h[h.length-1].ownerDocument,n.map(h,ra),m=0;i>m;m++)j=h[m],Z.test(j.type||"")&&!N.access(j,"globalEval")&&n.contains(k,j)&&(j.src?n._evalUrl&&n._evalUrl(j.src):n.globalEval(j.textContent.replace(oa,"")))}return a}function va(a,b,c){for(var d,e=b?n.filter(b,a):a,f=0;null!=(d=e[f]);f++)c||1!==d.nodeType||n.cleanData(_(d)),d.parentNode&&(c&&n.contains(d.ownerDocument,d)&&aa(_(d,"script")),d.parentNode.removeChild(d));return a}function ya(a,b){var c=n(b.createElement(a)).appendTo(b.body),d=n.css(c[0],"display");return c.detach(),d}function za(a){var b=d,c=xa[a];return c||(c=ya(a,b),"none"!==c&&c||(wa=(wa||n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=wa[0].contentDocument,b.write(),b.close(),c=ya(a,b),wa.detach()),xa[a]=c),c}function Fa(a,b,c){var d,e,f,g,h=a.style;return c=c||Ca(a),g=c?c.getPropertyValue(b)||c[b]:void 0,""!==g&&void 0!==g||n.contains(a.ownerDocument,a)||(g=n.style(a,b)),c&&!l.pixelMarginRight()&&Ba.test(g)&&Aa.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f),void 0!==g?g+"":g}function Ga(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}function Ma(a){if(a in La)return a;for(var b=a[0].toUpperCase()+a.slice(1),c=Ka.length;c--;)if((a=Ka[c]+b)in La)return a}function Na(a,b,c){var d=T.exec(b);return d?Math.max(0,d[2]-(c||0))+(d[3]||"px"):b}function Oa(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=n.css(a,c+U[f],!0,e)),d?("content"===c&&(g-=n.css(a,"padding"+U[f],!0,e)),"margin"!==c&&(g-=n.css(a,"border"+U[f]+"Width",!0,e))):(g+=n.css(a,"padding"+U[f],!0,e),"padding"!==c&&(g+=n.css(a,"border"+U[f]+"Width",!0,e)));return g}function Pa(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Ca(a),g="border-box"===n.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=Fa(a,b,f),(0>e||null==e)&&(e=a.style[b]),Ba.test(e))return e;d=g&&(l.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Oa(a,b,c||(g?"border":"content"),d,f)+"px"}function Qa(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=N.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&V(d)&&(f[g]=N.access(d,"olddisplay",za(d.nodeName)))):(e=V(d),"none"===c&&e||N.set(d,"olddisplay",e?c:n.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function Ra(a,b,c,d,e){return new Ra.prototype.init(a,b,c,d,e)}function Wa(){return a.setTimeout(function(){Sa=void 0}),Sa=n.now()}function Xa(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b)c=U[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function Ya(a,b,c){for(var d,e=(_a.tweeners[b]||[]).concat(_a.tweeners["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function Za(a,b,c){var d,e,f,g,h,i,j,l=this,m={},o=a.style,p=a.nodeType&&V(a),q=N.get(a,"fxshow");c.queue||(h=n._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,l.always(function(){l.always(function(){h.unqueued--,n.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[o.overflow,o.overflowX,o.overflowY],j=n.css(a,"display"),"inline"===("none"===j?N.get(a,"olddisplay")||za(a.nodeName):j)&&"none"===n.css(a,"float")&&(o.display="inline-block")),c.overflow&&(o.overflow="hidden",l.always(function(){o.overflow=c.overflow[0],o.overflowX=c.overflow[1],o.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],Ua.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(p?"hide":"show")){if("show"!==e||!q||void 0===q[d])continue;p=!0}m[d]=q&&q[d]||n.style(a,d)}else j=void 0;if(n.isEmptyObject(m))"inline"===("none"===j?za(a.nodeName):j)&&(o.display=j);else{q?"hidden"in q&&(p=q.hidden):q=N.access(a,"fxshow",{}),f&&(q.hidden=!p),p?n(a).show():l.done(function(){n(a).hide()}),l.done(function(){var b;N.remove(a,"fxshow");for(b in m)n.style(a,b,m[b])});for(d in m)g=Ya(p?q[d]:0,d,l),d in q||(q[d]=g.start,p&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function $a(a,b){var c,d,e,f,g;for(c in a)if(d=n.camelCase(c),e=b[d],f=a[c],n.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),(g=n.cssHooks[d])&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function _a(a,b,c){var d,e,f=0,g=_a.prefilters.length,h=n.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Sa||Wa(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:n.extend({},b),opts:n.extend(!0,{specialEasing:{},easing:n.easing._default},c),originalProperties:b,originalOptions:c,startTime:Sa||Wa(),duration:c.duration,tweens:[],createTween:function(b,c){var d=n.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?(h.notifyWith(a,[j,1,0]),h.resolveWith(a,[j,b])):h.rejectWith(a,[j,b]),this}}),k=j.props;for($a(k,j.opts.specialEasing);g>f;f++)if(d=_a.prefilters[f].call(j,a,k,j.opts))return n.isFunction(d.stop)&&(n._queueHooks(j.elem,j.opts.queue).stop=n.proxy(d.stop,d)),d;return n.map(k,Ya,j),n.isFunction(j.opts.start)&&j.opts.start.call(a,j),n.fx.timer(n.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function fb(a){return a.getAttribute&&a.getAttribute("class")||""}function wb(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(G)||[];if(n.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function xb(a,b,c,d){function g(h){var i;return e[h]=!0,n.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}var e={},f=a===tb;return g(b.dataTypes[0])||!e["*"]&&g("*")}function yb(a,b){var c,d,e=n.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&n.extend(!0,a,d),a}function zb(a,b,c){for(var d,e,f,g,h=a.contents,i=a.dataTypes;"*"===i[0];)i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function Ab(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(!(g=j[i+" "+f]||j["* "+f]))for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){!0===g?g=j[e]:!0!==j[e]&&(f=h[0],k.unshift(h[1]));break}if(!0!==g)if(g&&a.throws)b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}function Gb(a,b,c,d){var e;if(n.isArray(b))n.each(b,function(b,e){c||Cb.test(a)?d(a,e):Gb(a+"["+("object"==typeof e&&null!=e?b:"")+"]",e,c,d)});else if(c||"object"!==n.type(b))d(a,b);else for(e in b)Gb(a+"["+e+"]",b[e],c,d)}function Mb(a){return n.isWindow(a)?a:9===a.nodeType&&a.defaultView}var c=[],d=a.document,e=c.slice,f=c.concat,g=c.push,h=c.indexOf,i={},j=i.toString,k=i.hasOwnProperty,l={},m="2.2.4",n=function(a,b){return new n.fn.init(a,b)},o=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,p=/^-ms-/,q=/-([\da-z])/gi,r=function(a,b){return b.toUpperCase()};n.fn=n.prototype={jquery:m,constructor:n,selector:"",length:0,toArray:function(){return e.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:e.call(this)},pushStack:function(a){var b=n.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a){return n.each(this,a)},map:function(a){return this.pushStack(n.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(e.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor()},push:g,sort:c.sort,splice:c.splice},n.extend=n.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||n.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(n.isPlainObject(d)||(e=n.isArray(d)))?(e?(e=!1,f=c&&n.isArray(c)?c:[]):f=c&&n.isPlainObject(c)?c:{},g[b]=n.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},n.extend({expando:"jQuery"+(m+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===n.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){var b=a&&a.toString();return!n.isArray(a)&&b-parseFloat(b)+1>=0},isPlainObject:function(a){var b;if("object"!==n.type(a)||a.nodeType||n.isWindow(a))return!1;if(a.constructor&&!k.call(a,"constructor")&&!k.call(a.constructor.prototype||{},"isPrototypeOf"))return!1;for(b in a);return void 0===b||k.call(a,b)},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?i[j.call(a)]||"object":typeof a},globalEval:function(a){var b,c=eval;(a=n.trim(a))&&(1===a.indexOf("use strict")?(b=d.createElement("script"),b.text=a,d.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(a){return a.replace(p,"ms-").replace(q,r)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b){var c,d=0;if(s(a))for(c=a.length;c>d&&!1!==b.call(a[d],d,a[d]);d++);else for(d in a)if(!1===b.call(a[d],d,a[d]))break;return a},trim:function(a){return null==a?"":(a+"").replace(o,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(s(Object(a))?n.merge(c,"string"==typeof a?[a]:a):g.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:h.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var e=[],f=0,g=a.length,h=!c;g>f;f++)!b(a[f],f)!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,e,g=0,h=[];if(s(a))for(d=a.length;d>g;g++)null!=(e=b(a[g],g,c))&&h.push(e);else for(g in a)null!=(e=b(a[g],g,c))&&h.push(e);return f.apply([],h)},guid:1,proxy:function(a,b){var c,d,f;return"string"==typeof b&&(c=a[b],b=a,a=c),n.isFunction(a)?(d=e.call(arguments,2),f=function(){return a.apply(b||this,d.concat(e.call(arguments)))},f.guid=a.guid=a.guid||n.guid++,f):void 0},now:Date.now,support:l}),"function"==typeof Symbol&&(n.fn[Symbol.iterator]=c[Symbol.iterator]),n.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(a,b){i["[object "+b+"]"]=b.toLowerCase()});var t=function(a){function fa(a,b,d,e){var f,h,j,k,l,o,r,s,w=b&&b.ownerDocument,x=b?b.nodeType:9;if(d=d||[],"string"!=typeof a||!a||1!==x&&9!==x&&11!==x)return d;if(!e&&((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,p)){if(11!==x&&(o=$.exec(a)))if(f=o[1]){if(9===x){if(!(j=b.getElementById(f)))return d;if(j.id===f)return d.push(j),d}else if(w&&(j=w.getElementById(f))&&t(b,j)&&j.id===f)return d.push(j),d}else{if(o[2])return H.apply(d,b.getElementsByTagName(a)),d;if((f=o[3])&&c.getElementsByClassName&&b.getElementsByClassName)return H.apply(d,b.getElementsByClassName(f)),d}if(c.qsa&&!A[a+" "]&&(!q||!q.test(a))){if(1!==x)w=b,s=a;else if("object"!==b.nodeName.toLowerCase()){for((k=b.getAttribute("id"))?k=k.replace(aa,"\\$&"):b.setAttribute("id",k=u),r=g(a),h=r.length,l=V.test(k)?"#"+k:"[id='"+k+"']";h--;)r[h]=l+" "+qa(r[h]);s=r.join(","),w=_.test(a)&&oa(b.parentNode)||b}if(s)try{return H.apply(d,w.querySelectorAll(s)),d}catch(y){}finally{k===u&&b.removeAttribute("id")}}}return i(a.replace(Q,"$1"),b,d,e)}function ga(){function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}var a=[];return b}function ha(a){return a[u]=!0,a}function ia(a){var b=n.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function ja(a,b){for(var c=a.split("|"),e=c.length;e--;)d.attrHandle[c[e]]=b}function ka(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||C)-(~a.sourceIndex||C);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function la(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}}function ma(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function na(a){return ha(function(b){return b=+b,ha(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function oa(a){return a&&void 0!==a.getElementsByTagName&&a}function pa(){}function qa(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function ra(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=x++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j,k=[w,f];if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){if(j=b[u]||(b[u]={}),i=j[b.uniqueID]||(j[b.uniqueID]={}),(h=i[d])&&h[0]===w&&h[1]===f)return k[2]=h[2];if(i[d]=k,k[2]=a(b,c,g))return!0}}}function sa(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function ta(a,b,c){for(var d=0,e=b.length;e>d;d++)fa(a,b[d],c);return c}function ua(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(c&&!c(f,d,e)||(g.push(f),j&&b.push(h)));return g}function va(a,b,c,d,e,f){return d&&!d[u]&&(d=va(d)),e&&!e[u]&&(e=va(e,f)),ha(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||ta(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:ua(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d)for(j=ua(r,n),d(j,[],h,i),k=j.length;k--;)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l));if(f){if(e||a){if(e){for(j=[],k=r.length;k--;)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}for(k=r.length;k--;)(l=r[k])&&(j=e?J(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=ua(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):H.apply(g,r)})}function wa(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=ra(function(a){return a===b},h,!0),l=ra(function(a){return J(b,a)>-1},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e}];f>i;i++)if(c=d.relative[a[i].type])m=[ra(sa(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;f>e&&!d.relative[a[e].type];e++);return va(i>1&&sa(m),i>1&&qa(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(Q,"$1"),c,e>i&&wa(a.slice(i,e)),f>e&&wa(a=a.slice(e)),f>e&&qa(a))}m.push(c)}return sa(m)}function xa(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,o,q,r=0,s="0",t=f&&[],u=[],v=j,x=f||e&&d.find.TAG("*",k),y=w+=null==v?1:Math.random()||.1,z=x.length;for(k&&(j=g===n||g||k);s!==z&&null!=(l=x[s]);s++){if(e&&l){for(o=0,g||l.ownerDocument===n||(m(l),h=!p);q=a[o++];)if(q(l,g||n,h)){i.push(l);break}k&&(w=y)}c&&((l=!q&&l)&&r--,f&&t.push(l))}if(r+=s,c&&s!==r){for(o=0;q=b[o++];)q(t,u,g,h);if(f){if(r>0)for(;s--;)t[s]||u[s]||(u[s]=F.call(i));u=ua(u)}H.apply(i,u),k&&!f&&u.length>0&&r+b.length>1&&fa.uniqueSort(i)}return k&&(w=y,j=v),t};return c?ha(f):f}var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+1*new Date,v=a.document,w=0,x=0,y=ga(),z=ga(),A=ga(),B=function(a,b){return a===b&&(l=!0),0},C=1<<31,D={}.hasOwnProperty,E=[],F=E.pop,G=E.push,H=E.push,I=E.slice,J=function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1},K="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",N="\\["+L+"*("+M+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+M+"))|)"+L+"*\\]",O=":("+M+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+N+")*)|.*)\\)|)",P=new RegExp(L+"+","g"),Q=new RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),R=new RegExp("^"+L+"*,"+L+"*"),S=new RegExp("^"+L+"*([>+~]|"+L+")"+L+"*"),T=new RegExp("="+L+"*([^\\]'\"]*?)"+L+"*\\]","g"),U=new RegExp(O),V=new RegExp("^"+M+"$"),W={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),TAG:new RegExp("^("+M+"|[*])"),ATTR:new RegExp("^"+N),PSEUDO:new RegExp("^"+O),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),bool:new RegExp("^(?:"+K+")$","i"),needsContext:new RegExp("^"+L+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+L+"*((?:-\\d)?\\d*)"+L+"*\\)|)(?=[^-]|$)","i")},X=/^(?:input|select|textarea|button)$/i,Y=/^h\d$/i,Z=/^[^{]+\{\s*\[native \w/,$=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,_=/[+~]/,aa=/'|\\/g,ba=new RegExp("\\\\([\\da-f]{1,6}"+L+"?|("+L+")|.)","ig"),ca=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},da=function(){m()};try{H.apply(E=I.call(v.childNodes),v.childNodes),E[v.childNodes.length].nodeType}catch(ea){H={apply:E.length?function(a,b){G.apply(a,I.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}c=fa.support={},f=fa.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return!!b&&"HTML"!==b.nodeName},m=fa.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement?(n=g,o=n.documentElement,p=!f(n),(e=n.defaultView)&&e.top!==e&&(e.addEventListener?e.addEventListener("unload",da,!1):e.attachEvent&&e.attachEvent("onunload",da)),c.attributes=ia(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=ia(function(a){return a.appendChild(n.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=Z.test(n.getElementsByClassName),c.getById=ia(function(a){return o.appendChild(a).id=u,!n.getElementsByName||!n.getElementsByName(u).length}),c.getById?(d.find.ID=function(a,b){if(void 0!==b.getElementById&&p){var c=b.getElementById(a);return c?[c]:[]}},d.filter.ID=function(a){var b=a.replace(ba,ca);return function(a){return a.getAttribute("id")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(ba,ca);return function(a){var c=void 0!==a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return void 0!==b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){return void 0!==b.getElementsByClassName&&p?b.getElementsByClassName(a):void 0},r=[],q=[],(c.qsa=Z.test(n.querySelectorAll))&&(ia(function(a){o.appendChild(a).innerHTML="<a id='"+u+"'></a><select id='"+u+"-\r\\' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+L+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+L+"*(?:value|"+K+")"),a.querySelectorAll("[id~="+u+"-]").length||q.push("~="),a.querySelectorAll(":checked").length||q.push(":checked"),a.querySelectorAll("a#"+u+"+*").length||q.push(".#.+[+~]")}),ia(function(a){var b=n.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+L+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=Z.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ia(function(a){c.disconnectedMatch=s.call(a,"div"),s.call(a,"[s!='']:x"),r.push("!=",O)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=Z.test(o.compareDocumentPosition),t=b||Z.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d||(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===n||a.ownerDocument===v&&t(v,a)?-1:b===n||b.ownerDocument===v&&t(v,b)?1:k?J(k,a)-J(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,g=[a],h=[b];if(!e||!f)return a===n?-1:b===n?1:e?-1:f?1:k?J(k,a)-J(k,b):0;if(e===f)return ka(a,b);for(c=a;c=c.parentNode;)g.unshift(c);for(c=b;c=c.parentNode;)h.unshift(c);for(;g[d]===h[d];)d++;return d?ka(g[d],h[d]):g[d]===v?-1:h[d]===v?1:0},n):n},fa.matches=function(a,b){return fa(a,null,null,b)},fa.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(T,"='$1']"),c.matchesSelector&&p&&!A[b+" "]&&(!r||!r.test(b))&&(!q||!q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return fa(b,n,null,[a]).length>0},fa.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},fa.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&D.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},fa.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},fa.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){for(;b=a[f++];)b===a[f]&&(e=d.push(f));for(;e--;)a.splice(d[e],1)}return k=null,a},e=fa.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else for(;b=a[d++];)c+=e(b);return c},d=fa.selectors={cacheLength:50,createPseudo:ha,match:W,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ba,ca),a[3]=(a[3]||a[4]||a[5]||"").replace(ba,ca),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||fa.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&fa.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return W.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&U.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(ba,ca).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+L+")"+a+"("+L+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||void 0!==a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=fa.attr(d,a);return null==e?"!="===b:!b||(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e.replace(P," ")+" ").indexOf(c)>-1:"|="===b&&(e===c||e.slice(0,c.length+1)===c+"-"))}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h,t=!1;if(q){if(f){for(;p;){for(m=b;m=m[p];)if(h?m.nodeName.toLowerCase()===r:1===m.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(m=q,l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===w&&j[1],t=n&&j[2],m=n&&q.childNodes[n];m=++n&&m&&m[p]||(t=n=0)||o.pop();)if(1===m.nodeType&&++t&&m===b){k[a]=[w,n,t];break}}else if(s&&(m=b,l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===w&&j[1],t=n),!1===t)for(;(m=++n&&m&&m[p]||(t=n=0)||o.pop())&&((h?m.nodeName.toLowerCase()!==r:1!==m.nodeType)||!++t||(s&&(l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),k[a]=[w,t]),m!==b)););return(t-=e)===d||t%d==0&&t/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||fa.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ha(function(a,c){for(var d,f=e(a,b),g=f.length;g--;)d=J(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:ha(function(a){var b=[],c=[],d=h(a.replace(Q,"$1"));return d[u]?ha(function(a,b,c,e){for(var f,g=d(a,null,e,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop()}}),has:ha(function(a){return function(b){return fa(a,b).length>0}}),contains:ha(function(a){return a=a.replace(ba,ca),function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:ha(function(a){return V.test(a||"")||fa.error("unsupported lang: "+a),a=a.replace(ba,ca).toLowerCase(),function(b){var c;do{if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return(c=c.toLowerCase())===a||0===c.indexOf(a+"-")}while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return Y.test(a.nodeName)},input:function(a){return X.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:na(function(){return[0]}),last:na(function(a,b){return[b-1]}),eq:na(function(a,b,c){return[0>c?c+b:c]}),even:na(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:na(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:na(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:na(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=la(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=ma(b);return pa.prototype=d.filters=d.pseudos,d.setFilters=new pa,g=fa.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);for(h=a,i=[],j=d.preFilter;h;){c&&!(e=R.exec(h))||(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=S.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(Q," ")}),h=h.slice(c.length));for(g in d.filter)!(e=W[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?fa.error(a):z(a,i).slice(0)},h=fa.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){for(b||(b=g(a)),c=b.length;c--;)f=wa(b[c]),f[u]?d.push(f):e.push(f);f=A(a,xa(e,d)),f.selector=a}return f},i=fa.select=function(a,b,e,f){var i,j,k,l,m,n="function"==typeof a&&a,o=!f&&g(a=n.selector||a);if(e=e||[],1===o.length){if(j=o[0]=o[0].slice(0),j.length>2&&"ID"===(k=j[0]).type&&c.getById&&9===b.nodeType&&p&&d.relative[j[1].type]){if(!(b=(d.find.ID(k.matches[0].replace(ba,ca),b)||[])[0]))return e;n&&(b=b.parentNode),a=a.slice(j.shift().value.length)}for(i=W.needsContext.test(a)?0:j.length;i--&&(k=j[i],!d.relative[l=k.type]);)if((m=d.find[l])&&(f=m(k.matches[0].replace(ba,ca),_.test(j[0].type)&&oa(b.parentNode)||b))){if(j.splice(i,1),!(a=f.length&&qa(j)))return H.apply(e,f),e;break}}return(n||h(a,o))(f,b,!p,e,!b||_.test(a)&&oa(b.parentNode)||b),e},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ia(function(a){return 1&a.compareDocumentPosition(n.createElement("div"))}),ia(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||ja("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&ia(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")
})||ja("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),ia(function(a){return null==a.getAttribute("disabled")})||ja(K,function(a,b,c){var d;return c?void 0:!0===a[b]?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),fa}(a);n.find=t,n.expr=t.selectors,n.expr[":"]=n.expr.pseudos,n.uniqueSort=n.unique=t.uniqueSort,n.text=t.getText,n.isXMLDoc=t.isXML,n.contains=t.contains;var u=function(a,b,c){for(var d=[],e=void 0!==c;(a=a[b])&&9!==a.nodeType;)if(1===a.nodeType){if(e&&n(a).is(c))break;d.push(a)}return d},v=function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c},w=n.expr.match.needsContext,x=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,y=/^.[^:#\[\.,]*$/;n.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?n.find.matchesSelector(d,a)?[d]:[]:n.find.matches(a,n.grep(b,function(a){return 1===a.nodeType}))},n.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(n(a).filter(function(){for(b=0;c>b;b++)if(n.contains(e[b],this))return!0}));for(b=0;c>b;b++)n.find(a,e[b],d);return d=this.pushStack(c>1?n.unique(d):d),d.selector=this.selector?this.selector+" "+a:a,d},filter:function(a){return this.pushStack(z(this,a||[],!1))},not:function(a){return this.pushStack(z(this,a||[],!0))},is:function(a){return!!z(this,"string"==typeof a&&w.test(a)?n(a):a||[],!1).length}});var A,B=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(n.fn.init=function(a,b,c){var e,f;if(!a)return this;if(c=c||A,"string"==typeof a){if(!(e="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:B.exec(a))||!e[1]&&b)return!b||b.jquery?(b||c).find(a):this.constructor(b).find(a);if(e[1]){if(b=b instanceof n?b[0]:b,n.merge(this,n.parseHTML(e[1],b&&b.nodeType?b.ownerDocument||b:d,!0)),x.test(e[1])&&n.isPlainObject(b))for(e in b)n.isFunction(this[e])?this[e](b[e]):this.attr(e,b[e]);return this}return f=d.getElementById(e[2]),f&&f.parentNode&&(this.length=1,this[0]=f),this.context=d,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):n.isFunction(a)?void 0!==c.ready?c.ready(a):a(n):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),n.makeArray(a,this))}).prototype=n.fn,A=n(d);var D=/^(?:parents|prev(?:Until|All))/,E={children:!0,contents:!0,next:!0,prev:!0};n.fn.extend({has:function(a){var b=n(a,this),c=b.length;return this.filter(function(){for(var a=0;c>a;a++)if(n.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=w.test(a)||"string"!=typeof a?n(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&n.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?n.uniqueSort(f):f)},index:function(a){return a?"string"==typeof a?h.call(n(a),this[0]):h.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(n.uniqueSort(n.merge(this.get(),n(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),n.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return u(a,"parentNode")},parentsUntil:function(a,b,c){return u(a,"parentNode",c)},next:function(a){return F(a,"nextSibling")},prev:function(a){return F(a,"previousSibling")},nextAll:function(a){return u(a,"nextSibling")},prevAll:function(a){return u(a,"previousSibling")},nextUntil:function(a,b,c){return u(a,"nextSibling",c)},prevUntil:function(a,b,c){return u(a,"previousSibling",c)},siblings:function(a){return v((a.parentNode||{}).firstChild,a)},children:function(a){return v(a.firstChild)},contents:function(a){return a.contentDocument||n.merge([],a.childNodes)}},function(a,b){n.fn[a]=function(c,d){var e=n.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=n.filter(d,e)),this.length>1&&(E[a]||n.uniqueSort(e),D.test(a)&&e.reverse()),this.pushStack(e)}});var G=/\S+/g;n.Callbacks=function(a){a="string"==typeof a?H(a):n.extend({},a);var b,c,d,e,f=[],g=[],h=-1,i=function(){for(e=a.once,d=b=!0;g.length;h=-1)for(c=g.shift();++h<f.length;)!1===f[h].apply(c[0],c[1])&&a.stopOnFalse&&(h=f.length,c=!1);a.memory||(c=!1),b=!1,e&&(f=c?[]:"")},j={add:function(){return f&&(c&&!b&&(h=f.length-1,g.push(c)),function d(b){n.each(b,function(b,c){n.isFunction(c)?a.unique&&j.has(c)||f.push(c):c&&c.length&&"string"!==n.type(c)&&d(c)})}(arguments),c&&!b&&i()),this},remove:function(){return n.each(arguments,function(a,b){for(var c;(c=n.inArray(b,f,c))>-1;)f.splice(c,1),h>=c&&h--}),this},has:function(a){return a?n.inArray(a,f)>-1:f.length>0},empty:function(){return f&&(f=[]),this},disable:function(){return e=g=[],f=c="",this},disabled:function(){return!f},lock:function(){return e=g=[],c||(f=c=""),this},locked:function(){return!!e},fireWith:function(a,c){return e||(c=c||[],c=[a,c.slice?c.slice():c],g.push(c),b||i()),this},fire:function(){return j.fireWith(this,arguments),this},fired:function(){return!!d}};return j},n.extend({Deferred:function(a){var b=[["resolve","done",n.Callbacks("once memory"),"resolved"],["reject","fail",n.Callbacks("once memory"),"rejected"],["notify","progress",n.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return n.Deferred(function(c){n.each(b,function(b,f){var g=n.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&n.isFunction(a.promise)?a.promise().progress(c.notify).done(c.resolve).fail(c.reject):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?n.extend(a,d):d}},e={};return d.pipe=d.then,n.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var i,j,k,b=0,c=e.call(arguments),d=c.length,f=1!==d||a&&n.isFunction(a.promise)?d:0,g=1===f?a:n.Deferred(),h=function(a,b,c){return function(d){b[a]=this,c[a]=arguments.length>1?e.call(arguments):d,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}};if(d>1)for(i=new Array(d),j=new Array(d),k=new Array(d);d>b;b++)c[b]&&n.isFunction(c[b].promise)?c[b].promise().progress(h(b,j,i)).done(h(b,k,c)).fail(g.reject):--f;return f||g.resolveWith(k,c),g.promise()}});var I;n.fn.ready=function(a){return n.ready.promise().done(a),this},n.extend({isReady:!1,readyWait:1,holdReady:function(a){a?n.readyWait++:n.ready(!0)},ready:function(a){(!0===a?--n.readyWait:n.isReady)||(n.isReady=!0,!0!==a&&--n.readyWait>0||(I.resolveWith(d,[n]),n.fn.triggerHandler&&(n(d).triggerHandler("ready"),n(d).off("ready"))))}}),n.ready.promise=function(b){return I||(I=n.Deferred(),"complete"===d.readyState||"loading"!==d.readyState&&!d.documentElement.doScroll?a.setTimeout(n.ready):(d.addEventListener("DOMContentLoaded",J),a.addEventListener("load",J))),I.promise(b)},n.ready.promise();var K=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===n.type(c)){e=!0;for(h in c)K(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,n.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(n(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},L=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};M.uid=1,M.prototype={register:function(a,b){var c=b||{};return a.nodeType?a[this.expando]=c:Object.defineProperty(a,this.expando,{value:c,writable:!0,configurable:!0}),a[this.expando]},cache:function(a){if(!L(a))return{};var b=a[this.expando];return b||(b={},L(a)&&(a.nodeType?a[this.expando]=b:Object.defineProperty(a,this.expando,{value:b,configurable:!0}))),b},set:function(a,b,c){var d,e=this.cache(a);if("string"==typeof b)e[b]=c;else for(d in b)e[d]=b[d];return e},get:function(a,b){return void 0===b?this.cache(a):a[this.expando]&&a[this.expando][b]},access:function(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?(d=this.get(a,b),void 0!==d?d:this.get(a,n.camelCase(b))):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d,e,f=a[this.expando];if(void 0!==f){if(void 0===b)this.register(a);else{n.isArray(b)?d=b.concat(b.map(n.camelCase)):(e=n.camelCase(b),b in f?d=[b,e]:(d=e,d=d in f?[d]:d.match(G)||[])),c=d.length;for(;c--;)delete f[d[c]]}(void 0===b||n.isEmptyObject(f))&&(a.nodeType?a[this.expando]=void 0:delete a[this.expando])}},hasData:function(a){var b=a[this.expando];return void 0!==b&&!n.isEmptyObject(b)}};var N=new M,O=new M,P=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Q=/[A-Z]/g;n.extend({hasData:function(a){return O.hasData(a)||N.hasData(a)},data:function(a,b,c){return O.access(a,b,c)},removeData:function(a,b){O.remove(a,b)},_data:function(a,b,c){return N.access(a,b,c)},_removeData:function(a,b){N.remove(a,b)}}),n.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=O.get(f),1===f.nodeType&&!N.get(f,"hasDataAttrs"))){for(c=g.length;c--;)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=n.camelCase(d.slice(5)),R(f,d,e[d])));N.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){O.set(this,a)}):K(this,function(b){var c,d;if(f&&void 0===b){if(void 0!==(c=O.get(f,a)||O.get(f,a.replace(Q,"-$&").toLowerCase())))return c;if(d=n.camelCase(a),void 0!==(c=O.get(f,d)))return c;if(void 0!==(c=R(f,d,void 0)))return c}else d=n.camelCase(a),this.each(function(){var c=O.get(this,d);O.set(this,d,b),a.indexOf("-")>-1&&void 0!==c&&O.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){O.remove(this,a)})}}),n.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=N.get(a,b),c&&(!d||n.isArray(c)?d=N.access(a,b,n.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=n.queue(a,b),d=c.length,e=c.shift(),f=n._queueHooks(a,b),g=function(){n.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return N.get(a,c)||N.access(a,c,{empty:n.Callbacks("once memory").add(function(){N.remove(a,[b+"queue",c])})})}}),n.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?n.queue(this[0],a):void 0===b?this:this.each(function(){var c=n.queue(this,a,b);n._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&n.dequeue(this,a)})},dequeue:function(a){return this.each(function(){n.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=n.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};for("string"!=typeof a&&(b=a,a=void 0),a=a||"fx";g--;)(c=N.get(f[g],a+"queueHooks"))&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var S=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,T=new RegExp("^(?:([+-])=|)("+S+")([a-z%]*)$","i"),U=["Top","Right","Bottom","Left"],V=function(a,b){return a=b||a,"none"===n.css(a,"display")||!n.contains(a.ownerDocument,a)},X=/^(?:checkbox|radio)$/i,Y=/<([\w:-]+)/,Z=/^$|\/(?:java|ecma)script/i,$={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};$.optgroup=$.option,$.tbody=$.tfoot=$.colgroup=$.caption=$.thead,$.th=$.td;var ba=/<|&#?\w+;/;!function(){var a=d.createDocumentFragment(),b=a.appendChild(d.createElement("div")),c=d.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),l.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",l.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var da=/^key/,ea=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,fa=/^([^.]*)(?:\.(.+)|)/;n.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=N.get(a);if(r)for(c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=n.guid++),(i=r.events)||(i=r.events={}),(g=r.handle)||(g=r.handle=function(b){return void 0!==n&&n.event.triggered!==b.type?n.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(G)||[""],j=b.length;j--;)h=fa.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o&&(l=n.event.special[o]||{},o=(e?l.delegateType:l.bindType)||o,l=n.event.special[o]||{},k=n.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&n.expr.match.needsContext.test(e),namespace:p.join(".")},f),(m=i[o])||(m=i[o]=[],m.delegateCount=0,l.setup&&!1!==l.setup.call(a,d,p,g)||a.addEventListener&&a.addEventListener(o,g)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),n.event.global[o]=!0)},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=N.hasData(a)&&N.get(a);if(r&&(i=r.events)){for(b=(b||"").match(G)||[""],j=b.length;j--;)if(h=fa.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o){for(l=n.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,m=i[o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;f--;)k=m[f],!e&&q!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&!1!==l.teardown.call(a,p,r.handle)||n.removeEvent(a,o,r.handle),delete i[o])}else for(o in i)n.event.remove(a,o+b[j],c,d,!0);n.isEmptyObject(i)&&N.remove(a,"handle events")}},dispatch:function(a){a=n.event.fix(a);var b,c,d,f,g,h=[],i=e.call(arguments),j=(N.get(this,"events")||{})[a.type]||[],k=n.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||!1!==k.preDispatch.call(this,a)){for(h=n.event.handlers.call(this,a,j),b=0;(f=h[b++])&&!a.isPropagationStopped();)for(a.currentTarget=f.elem,c=0;(g=f.handlers[c++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!a.rnamespace.test(g.namespace)||(a.handleObj=g,a.data=g.data,void 0!==(d=((n.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,i))&&!1===(a.result=d)&&(a.preventDefault(),a.stopPropagation()));return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&("click"!==a.type||isNaN(a.button)||a.button<1))for(;i!==this;i=i.parentNode||this)if(1===i.nodeType&&(!0!==i.disabled||"click"!==a.type)){for(d=[],c=0;h>c;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?n(e,this).index(i)>-1:n.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,e,f,g=b.button;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||d,e=c.documentElement,f=c.body,a.pageX=b.clientX+(e&&e.scrollLeft||f&&f.scrollLeft||0)-(e&&e.clientLeft||f&&f.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||f&&f.scrollTop||0)-(e&&e.clientTop||f&&f.clientTop||0)),a.which||void 0===g||(a.which=1&g?1:2&g?3:4&g?2:0),a}},fix:function(a){if(a[n.expando])return a;var b,c,e,f=a.type,g=a,h=this.fixHooks[f];for(h||(this.fixHooks[f]=h=ea.test(f)?this.mouseHooks:da.test(f)?this.keyHooks:{}),e=h.props?this.props.concat(h.props):this.props,a=new n.Event(g),b=e.length;b--;)c=e[b],a[c]=g[c];return a.target||(a.target=d),3===a.target.nodeType&&(a.target=a.target.parentNode),h.filter?h.filter(a,g):a},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==ia()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===ia()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&n.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(a){return n.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}}},n.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c)},n.Event=function(a,b){return this instanceof n.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?ga:ha):this.type=a,b&&n.extend(this,b),this.timeStamp=a&&a.timeStamp||n.now(),void(this[n.expando]=!0)):new n.Event(a,b)},n.Event.prototype={constructor:n.Event,isDefaultPrevented:ha,isPropagationStopped:ha,isImmediatePropagationStopped:ha,isSimulated:!1,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=ga,a&&!this.isSimulated&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=ga,a&&!this.isSimulated&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=ga,a&&!this.isSimulated&&a.stopImmediatePropagation(),this.stopPropagation()}},n.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){n.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return e&&(e===d||n.contains(d,e))||(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),n.fn.extend({on:function(a,b,c,d){return ja(this,a,b,c,d)},one:function(a,b,c,d){return ja(this,a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,n(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return!1!==b&&"function"!=typeof b||(c=b,b=void 0),!1===c&&(c=ha),this.each(function(){n.event.remove(this,a,c,b)})}});var ka=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,la=/<script|<style|<link/i,ma=/checked\s*(?:[^=]|=\s*.checked.)/i,na=/^true\/(.*)/,oa=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;n.extend({htmlPrefilter:function(a){return a.replace(ka,"<$1></$2>")},clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=n.contains(a.ownerDocument,a);if(!(l.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||n.isXMLDoc(a)))for(g=_(h),f=_(a),d=0,e=f.length;e>d;d++)ta(f[d],g[d]);if(b)if(c)for(f=f||_(a),g=g||_(h),d=0,e=f.length;e>d;d++)sa(f[d],g[d]);else sa(a,h);return g=_(h,"script"),g.length>0&&aa(g,!i&&_(a,"script")),h},cleanData:function(a){for(var b,c,d,e=n.event.special,f=0;void 0!==(c=a[f]);f++)if(L(c)){if(b=c[N.expando]){if(b.events)for(d in b.events)e[d]?n.event.remove(c,d):n.removeEvent(c,d,b.handle);c[N.expando]=void 0}c[O.expando]&&(c[O.expando]=void 0)}}}),n.fn.extend({domManip:ua,detach:function(a){return va(this,a,!0)},remove:function(a){return va(this,a)},text:function(a){return K(this,function(a){return void 0===a?n.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=a)})},null,a,arguments.length)},append:function(){return ua(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){pa(this,a).appendChild(a)}})},prepend:function(){return ua(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=pa(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return ua(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return ua(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(n.cleanData(_(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null!=a&&a,b=null==b?a:b,this.map(function(){return n.clone(this,a,b)})},html:function(a){return K(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!la.test(a)&&!$[(Y.exec(a)||["",""])[1].toLowerCase()]){a=n.htmlPrefilter(a);try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(n.cleanData(_(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=[];return ua(this,arguments,function(b){var c=this.parentNode;n.inArray(this,a)<0&&(n.cleanData(_(this)),c&&c.replaceChild(b,this))},a)}}),n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){n.fn[a]=function(a){for(var c,d=[],e=n(a),f=e.length-1,h=0;f>=h;h++)c=h===f?this:this.clone(!0),n(e[h])[b](c),g.apply(d,c.get());return this.pushStack(d)}});var wa,xa={HTML:"block",BODY:"block"},Aa=/^margin/,Ba=new RegExp("^("+S+")(?!px)[a-z%]+$","i"),Ca=function(b){var c=b.ownerDocument.defaultView;return c&&c.opener||(c=a),c.getComputedStyle(b)},Da=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e},Ea=d.documentElement;!function(){function i(){h.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",h.innerHTML="",Ea.appendChild(g);var d=a.getComputedStyle(h);b="1%"!==d.top,f="2px"===d.marginLeft,c="4px"===d.width,h.style.marginRight="50%",e="4px"===d.marginRight,Ea.removeChild(g)}var b,c,e,f,g=d.createElement("div"),h=d.createElement("div");h.style&&(h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",l.clearCloneStyle="content-box"===h.style.backgroundClip,g.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",g.appendChild(h),n.extend(l,{pixelPosition:function(){return i(),b},boxSizingReliable:function(){return null==c&&i(),c},pixelMarginRight:function(){return null==c&&i(),e},reliableMarginLeft:function(){return null==c&&i(),f},reliableMarginRight:function(){var b,c=h.appendChild(d.createElement("div"));return c.style.cssText=h.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",c.style.marginRight=c.style.width="0",h.style.width="1px",Ea.appendChild(g),b=!parseFloat(a.getComputedStyle(c).marginRight),Ea.removeChild(g),h.removeChild(c),b}}))}();var Ha=/^(none|table(?!-c[ea]).+)/,Ia={position:"absolute",visibility:"hidden",display:"block"},Ja={letterSpacing:"0",fontWeight:"400"},Ka=["Webkit","O","Moz","ms"],La=d.createElement("div").style;n.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Fa(a,"opacity");return""===c?"1":c}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=n.camelCase(b),i=a.style;return b=n.cssProps[h]||(n.cssProps[h]=Ma(h)||h),g=n.cssHooks[b]||n.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c,"string"===f&&(e=T.exec(c))&&e[1]&&(c=W(a,b,e),f="number"),void(null!=c&&c===c&&("number"===f&&(c+=e&&e[3]||(n.cssNumber[h]?"":"px")),l.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c))))}},css:function(a,b,c,d){var e,f,g,h=n.camelCase(b);return b=n.cssProps[h]||(n.cssProps[h]=Ma(h)||h),g=n.cssHooks[b]||n.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=Fa(a,b,d)),"normal"===e&&b in Ja&&(e=Ja[b]),""===c||c?(f=parseFloat(e),!0===c||isFinite(f)?f||0:e):e}}),n.each(["height","width"],function(a,b){n.cssHooks[b]={get:function(a,c,d){return c?Ha.test(n.css(a,"display"))&&0===a.offsetWidth?Da(a,Ia,function(){return Pa(a,b,d)}):Pa(a,b,d):void 0},set:function(a,c,d){var e,f=d&&Ca(a),g=d&&Oa(a,b,d,"border-box"===n.css(a,"boxSizing",!1,f),f);return g&&(e=T.exec(c))&&"px"!==(e[3]||"px")&&(a.style[b]=c,c=n.css(a,b)),Na(a,c,g)}}}),n.cssHooks.marginLeft=Ga(l.reliableMarginLeft,function(a,b){return b?(parseFloat(Fa(a,"marginLeft"))||a.getBoundingClientRect().left-Da(a,{marginLeft:0},function(){return a.getBoundingClientRect().left}))+"px":void 0}),n.cssHooks.marginRight=Ga(l.reliableMarginRight,function(a,b){return b?Da(a,{display:"inline-block"},Fa,[a,"marginRight"]):void 0}),n.each({margin:"",padding:"",border:"Width"},function(a,b){n.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+U[d]+b]=f[d]||f[d-2]||f[0];return e}},Aa.test(a)||(n.cssHooks[a+b].set=Na)}),n.fn.extend({css:function(a,b){return K(this,function(a,b,c){var d,e,f={},g=0;if(n.isArray(b)){for(d=Ca(a),e=b.length;e>g;g++)f[b[g]]=n.css(a,b[g],!1,d);return f}return void 0!==c?n.style(a,b,c):n.css(a,b)},a,b,arguments.length>1)},show:function(){return Qa(this,!0)},hide:function(){return Qa(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){V(this)?n(this).show():n(this).hide()})}}),n.Tween=Ra,Ra.prototype={constructor:Ra,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||n.easing._default,this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(n.cssNumber[c]?"":"px")},cur:function(){var a=Ra.propHooks[this.prop];return a&&a.get?a.get(this):Ra.propHooks._default.get(this)},run:function(a){var b,c=Ra.propHooks[this.prop];return this.options.duration?this.pos=b=n.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Ra.propHooks._default.set(this),this}},Ra.prototype.init.prototype=Ra.prototype,Ra.propHooks={_default:{get:function(a){var b;return 1!==a.elem.nodeType||null!=a.elem[a.prop]&&null==a.elem.style[a.prop]?a.elem[a.prop]:(b=n.css(a.elem,a.prop,""),b&&"auto"!==b?b:0)},set:function(a){n.fx.step[a.prop]?n.fx.step[a.prop](a):1!==a.elem.nodeType||null==a.elem.style[n.cssProps[a.prop]]&&!n.cssHooks[a.prop]?a.elem[a.prop]=a.now:n.style(a.elem,a.prop,a.now+a.unit)}}},Ra.propHooks.scrollTop=Ra.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},n.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},_default:"swing"},n.fx=Ra.prototype.init,n.fx.step={};var Sa,Ta,Ua=/^(?:toggle|show|hide)$/,Va=/queueHooks$/;n.Animation=n.extend(_a,{tweeners:{"*":[function(a,b){var c=this.createTween(a,b);return W(c.elem,a,T.exec(b),c),c}]},tweener:function(a,b){n.isFunction(a)?(b=a,a=["*"]):a=a.match(G);for(var c,d=0,e=a.length;e>d;d++)c=a[d],_a.tweeners[c]=_a.tweeners[c]||[],_a.tweeners[c].unshift(b)},prefilters:[Za],prefilter:function(a,b){b?_a.prefilters.unshift(a):_a.prefilters.push(a)}}),n.speed=function(a,b,c){var d=a&&"object"==typeof a?n.extend({},a):{complete:c||!c&&b||n.isFunction(a)&&a,duration:a,easing:c&&b||b&&!n.isFunction(b)&&b};return d.duration=n.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in n.fx.speeds?n.fx.speeds[d.duration]:n.fx.speeds._default,null!=d.queue&&!0!==d.queue||(d.queue="fx"),d.old=d.complete,d.complete=function(){n.isFunction(d.old)&&d.old.call(this),d.queue&&n.dequeue(this,d.queue)},d},n.fn.extend({fadeTo:function(a,b,c,d){return this.filter(V).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=n.isEmptyObject(a),f=n.speed(b,c,d),g=function(){var b=_a(this,n.extend({},a),f);(e||N.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||!1===f.queue?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&!1!==a&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=n.timers,g=N.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&Va.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));!b&&c||n.dequeue(this,a)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var b,c=N.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=n.timers,g=d?d.length:0;for(c.finish=!0,n.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),n.each(["toggle","show","hide"],function(a,b){var c=n.fn[b];n.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(Xa(b,!0),a,d,e)}}),n.each({slideDown:Xa("show"),slideUp:Xa("hide"),slideToggle:Xa("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){n.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),n.timers=[],n.fx.tick=function(){var a,b=0,c=n.timers;for(Sa=n.now();b<c.length;b++)(a=c[b])()||c[b]!==a||c.splice(b--,1);c.length||n.fx.stop(),Sa=void 0},n.fx.timer=function(a){n.timers.push(a),a()?n.fx.start():n.timers.pop()},n.fx.interval=13,n.fx.start=function(){Ta||(Ta=a.setInterval(n.fx.tick,n.fx.interval))},n.fx.stop=function(){a.clearInterval(Ta),Ta=null},n.fx.speeds={slow:600,fast:200,_default:400},n.fn.delay=function(b,c){return b=n.fx?n.fx.speeds[b]||b:b,c=c||"fx",this.queue(c,function(c,d){var e=a.setTimeout(c,b);d.stop=function(){a.clearTimeout(e)}})},function(){var a=d.createElement("input"),b=d.createElement("select"),c=b.appendChild(d.createElement("option"));a.type="checkbox",l.checkOn=""!==a.value,l.optSelected=c.selected,b.disabled=!0,l.optDisabled=!c.disabled,a=d.createElement("input"),a.value="t",a.type="radio",l.radioValue="t"===a.value}();var ab,bb=n.expr.attrHandle;n.fn.extend({attr:function(a,b){return K(this,n.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){n.removeAttr(this,a)})}}),n.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return void 0===a.getAttribute?n.prop(a,b,c):(1===f&&n.isXMLDoc(a)||(b=b.toLowerCase(),e=n.attrHooks[b]||(n.expr.match.bool.test(b)?ab:void 0)),void 0!==c?null===c?void n.removeAttr(a,b):e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:(a.setAttribute(b,c+""),c):e&&"get"in e&&null!==(d=e.get(a,b))?d:(d=n.find.attr(a,b),null==d?void 0:d))},attrHooks:{type:{set:function(a,b){if(!l.radioValue&&"radio"===b&&n.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(G);if(f&&1===a.nodeType)for(;c=f[e++];)d=n.propFix[c]||c,n.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)}}),ab={set:function(a,b,c){return!1===b?n.removeAttr(a,c):a.setAttribute(c,c),c}},n.each(n.expr.match.bool.source.match(/\w+/g),function(a,b){var c=bb[b]||n.find.attr;bb[b]=function(a,b,d){var e,f;return d||(f=bb[b],bb[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,bb[b]=f),e}});var cb=/^(?:input|select|textarea|button)$/i,db=/^(?:a|area)$/i;n.fn.extend({prop:function(a,b){return K(this,n.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[n.propFix[a]||a]})}}),n.extend({prop:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return 1===f&&n.isXMLDoc(a)||(b=n.propFix[b]||b,e=n.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=n.find.attr(a,"tabindex")
;return b?parseInt(b,10):cb.test(a.nodeName)||db.test(a.nodeName)&&a.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),l.optSelected||(n.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null},set:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex)}}),n.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){n.propFix[this.toLowerCase()]=this});var eb=/[\t\r\n\f]/g;n.fn.extend({addClass:function(a){var b,c,d,e,f,g,h,i=0;if(n.isFunction(a))return this.each(function(b){n(this).addClass(a.call(this,b,fb(this)))});if("string"==typeof a&&a)for(b=a.match(G)||[];c=this[i++];)if(e=fb(c),d=1===c.nodeType&&(" "+e+" ").replace(eb," ")){for(g=0;f=b[g++];)d.indexOf(" "+f+" ")<0&&(d+=f+" ");h=n.trim(d),e!==h&&c.setAttribute("class",h)}return this},removeClass:function(a){var b,c,d,e,f,g,h,i=0;if(n.isFunction(a))return this.each(function(b){n(this).removeClass(a.call(this,b,fb(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof a&&a)for(b=a.match(G)||[];c=this[i++];)if(e=fb(c),d=1===c.nodeType&&(" "+e+" ").replace(eb," ")){for(g=0;f=b[g++];)for(;d.indexOf(" "+f+" ")>-1;)d=d.replace(" "+f+" "," ");h=n.trim(d),e!==h&&c.setAttribute("class",h)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):n.isFunction(a)?this.each(function(c){n(this).toggleClass(a.call(this,c,fb(this),b),b)}):this.each(function(){var b,d,e,f;if("string"===c)for(d=0,e=n(this),f=a.match(G)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else void 0!==a&&"boolean"!==c||(b=fb(this),b&&N.set(this,"__className__",b),this.setAttribute&&this.setAttribute("class",b||!1===a?"":N.get(this,"__className__")||""))})},hasClass:function(a){var b,c,d=0;for(b=" "+a+" ";c=this[d++];)if(1===c.nodeType&&(" "+fb(c)+" ").replace(eb," ").indexOf(b)>-1)return!0;return!1}});var gb=/\r/g,hb=/[\x20\t\r\n\f]+/g;n.fn.extend({val:function(a){var b,c,d,e=this[0];return arguments.length?(d=n.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,n(this).val()):a,null==e?e="":"number"==typeof e?e+="":n.isArray(e)&&(e=n.map(e,function(a){return null==a?"":a+""})),(b=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()])&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))})):e?(b=n.valHooks[e.type]||n.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(gb,""):null==c?"":c)):void 0}}),n.extend({valHooks:{option:{get:function(a){var b=n.find.attr(a,"value");return null!=b?b:n.trim(n.text(a)).replace(hb," ")}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],(c.selected||i===e)&&(l.optDisabled?!c.disabled:null===c.getAttribute("disabled"))&&(!c.parentNode.disabled||!n.nodeName(c.parentNode,"optgroup"))){if(b=n(c).val(),f)return b;g.push(b)}return g},set:function(a,b){for(var c,d,e=a.options,f=n.makeArray(b),g=e.length;g--;)d=e[g],(d.selected=n.inArray(n.valHooks.option.get(d),f)>-1)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),n.each(["radio","checkbox"],function(){n.valHooks[this]={set:function(a,b){return n.isArray(b)?a.checked=n.inArray(n(a).val(),b)>-1:void 0}},l.checkOn||(n.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var ib=/^(?:focusinfocus|focusoutblur)$/;n.extend(n.event,{trigger:function(b,c,e,f){var g,h,i,j,l,m,o,p=[e||d],q=k.call(b,"type")?b.type:b,r=k.call(b,"namespace")?b.namespace.split("."):[];if(h=i=e=e||d,3!==e.nodeType&&8!==e.nodeType&&!ib.test(q+n.event.triggered)&&(q.indexOf(".")>-1&&(r=q.split("."),q=r.shift(),r.sort()),l=q.indexOf(":")<0&&"on"+q,b=b[n.expando]?b:new n.Event(q,"object"==typeof b&&b),b.isTrigger=f?2:3,b.namespace=r.join("."),b.rnamespace=b.namespace?new RegExp("(^|\\.)"+r.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=e),c=null==c?[b]:n.makeArray(c,[b]),o=n.event.special[q]||{},f||!o.trigger||!1!==o.trigger.apply(e,c))){if(!f&&!o.noBubble&&!n.isWindow(e)){for(j=o.delegateType||q,ib.test(j+q)||(h=h.parentNode);h;h=h.parentNode)p.push(h),i=h;i===(e.ownerDocument||d)&&p.push(i.defaultView||i.parentWindow||a)}for(g=0;(h=p[g++])&&!b.isPropagationStopped();)b.type=g>1?j:o.bindType||q,m=(N.get(h,"events")||{})[b.type]&&N.get(h,"handle"),m&&m.apply(h,c),(m=l&&h[l])&&m.apply&&L(h)&&(b.result=m.apply(h,c),!1===b.result&&b.preventDefault());return b.type=q,f||b.isDefaultPrevented()||o._default&&!1!==o._default.apply(p.pop(),c)||!L(e)||l&&n.isFunction(e[q])&&!n.isWindow(e)&&(i=e[l],i&&(e[l]=null),n.event.triggered=q,e[q](),n.event.triggered=void 0,i&&(e[l]=i)),b.result}},simulate:function(a,b,c){var d=n.extend(new n.Event,c,{type:a,isSimulated:!0});n.event.trigger(d,null,b)}}),n.fn.extend({trigger:function(a,b){return this.each(function(){n.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?n.event.trigger(a,b,c,!0):void 0}}),n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){n.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),n.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),l.focusin="onfocusin"in a,l.focusin||n.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){n.event.simulate(b,a.target,n.event.fix(a))};n.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=N.access(d,b);e||d.addEventListener(a,c,!0),N.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=N.access(d,b)-1;e?N.access(d,b,e):(d.removeEventListener(a,c,!0),N.remove(d,b))}}});var jb=a.location,kb=n.now(),lb=/\?/;n.parseJSON=function(a){return JSON.parse(a+"")},n.parseXML=function(b){var c;if(!b||"string"!=typeof b)return null;try{c=(new a.DOMParser).parseFromString(b,"text/xml")}catch(d){c=void 0}return c&&!c.getElementsByTagName("parsererror").length||n.error("Invalid XML: "+b),c};var mb=/#.*$/,nb=/([?&])_=[^&]*/,ob=/^(.*?):[ \t]*([^\r\n]*)$/gm,pb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,qb=/^(?:GET|HEAD)$/,rb=/^\/\//,sb={},tb={},ub="*/".concat("*"),vb=d.createElement("a");vb.href=jb.href,n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:jb.href,type:"GET",isLocal:pb.test(jb.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ub,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":n.parseJSON,"text xml":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?yb(yb(a,n.ajaxSettings),b):yb(n.ajaxSettings,a)},ajaxPrefilter:wb(sb),ajaxTransport:wb(tb),ajax:function(b,c){function z(b,c,d,h){var j,l,t,u,w,y=c;2!==v&&(v=2,i&&a.clearTimeout(i),e=void 0,g=h||"",x.readyState=b>0?4:0,j=b>=200&&300>b||304===b,d&&(u=zb(m,x,d)),u=Ab(m,u,x,j),j?(m.ifModified&&(w=x.getResponseHeader("Last-Modified"),w&&(n.lastModified[f]=w),(w=x.getResponseHeader("etag"))&&(n.etag[f]=w)),204===b||"HEAD"===m.type?y="nocontent":304===b?y="notmodified":(y=u.state,l=u.data,t=u.error,j=!t)):(t=y,!b&&y||(y="error",0>b&&(b=0))),x.status=b,x.statusText=(c||y)+"",j?q.resolveWith(o,[l,y,x]):q.rejectWith(o,[x,y,t]),x.statusCode(s),s=void 0,k&&p.trigger(j?"ajaxSuccess":"ajaxError",[x,m,j?l:t]),r.fireWith(o,[x,y]),k&&(p.trigger("ajaxComplete",[x,m]),--n.active||n.event.trigger("ajaxStop")))}"object"==typeof b&&(c=b,b=void 0),c=c||{};var e,f,g,h,i,j,k,l,m=n.ajaxSetup({},c),o=m.context||m,p=m.context&&(o.nodeType||o.jquery)?n(o):n.event,q=n.Deferred(),r=n.Callbacks("once memory"),s=m.statusCode||{},t={},u={},v=0,w="canceled",x={readyState:0,getResponseHeader:function(a){var b;if(2===v){if(!h)for(h={};b=ob.exec(g);)h[b[1].toLowerCase()]=b[2];b=h[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===v?g:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return v||(a=u[c]=u[c]||a,t[a]=b),this},overrideMimeType:function(a){return v||(m.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>v)for(b in a)s[b]=[s[b],a[b]];else x.always(a[x.status]);return this},abort:function(a){var b=a||w;return e&&e.abort(b),z(0,b),this}};if(q.promise(x).complete=r.add,x.success=x.done,x.error=x.fail,m.url=((b||m.url||jb.href)+"").replace(mb,"").replace(rb,jb.protocol+"//"),m.type=c.method||c.type||m.method||m.type,m.dataTypes=n.trim(m.dataType||"*").toLowerCase().match(G)||[""],null==m.crossDomain){j=d.createElement("a");try{j.href=m.url,j.href=j.href,m.crossDomain=vb.protocol+"//"+vb.host!=j.protocol+"//"+j.host}catch(y){m.crossDomain=!0}}if(m.data&&m.processData&&"string"!=typeof m.data&&(m.data=n.param(m.data,m.traditional)),xb(sb,m,c,x),2===v)return x;k=n.event&&m.global,k&&0==n.active++&&n.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!qb.test(m.type),f=m.url,m.hasContent||(m.data&&(f=m.url+=(lb.test(f)?"&":"?")+m.data,delete m.data),!1===m.cache&&(m.url=nb.test(f)?f.replace(nb,"$1_="+kb++):f+(lb.test(f)?"&":"?")+"_="+kb++)),m.ifModified&&(n.lastModified[f]&&x.setRequestHeader("If-Modified-Since",n.lastModified[f]),n.etag[f]&&x.setRequestHeader("If-None-Match",n.etag[f])),(m.data&&m.hasContent&&!1!==m.contentType||c.contentType)&&x.setRequestHeader("Content-Type",m.contentType),x.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+ub+"; q=0.01":""):m.accepts["*"]);for(l in m.headers)x.setRequestHeader(l,m.headers[l]);if(m.beforeSend&&(!1===m.beforeSend.call(o,x,m)||2===v))return x.abort();w="abort";for(l in{success:1,error:1,complete:1})x[l](m[l]);if(e=xb(tb,m,c,x)){if(x.readyState=1,k&&p.trigger("ajaxSend",[x,m]),2===v)return x;m.async&&m.timeout>0&&(i=a.setTimeout(function(){x.abort("timeout")},m.timeout));try{v=1,e.send(t,z)}catch(y){if(!(2>v))throw y;z(-1,y)}}else z(-1,"No Transport");return x},getJSON:function(a,b,c){return n.get(a,b,c,"json")},getScript:function(a,b){return n.get(a,void 0,b,"script")}}),n.each(["get","post"],function(a,b){n[b]=function(a,c,d,e){return n.isFunction(c)&&(e=e||d,d=c,c=void 0),n.ajax(n.extend({url:a,type:b,dataType:e,data:c,success:d},n.isPlainObject(a)&&a))}}),n._evalUrl=function(a){return n.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},n.fn.extend({wrapAll:function(a){var b;return n.isFunction(a)?this.each(function(b){n(this).wrapAll(a.call(this,b))}):(this[0]&&(b=n(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstElementChild;)a=a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return n.isFunction(a)?this.each(function(b){n(this).wrapInner(a.call(this,b))}):this.each(function(){var b=n(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=n.isFunction(a);return this.each(function(c){n(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){n.nodeName(this,"body")||n(this).replaceWith(this.childNodes)}).end()}}),n.expr.filters.hidden=function(a){return!n.expr.filters.visible(a)},n.expr.filters.visible=function(a){return a.offsetWidth>0||a.offsetHeight>0||a.getClientRects().length>0};var Bb=/%20/g,Cb=/\[\]$/,Db=/\r?\n/g,Eb=/^(?:submit|button|image|reset|file)$/i,Fb=/^(?:input|select|textarea|keygen)/i;n.param=function(a,b){var c,d=[],e=function(a,b){b=n.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(a)||a.jquery&&!n.isPlainObject(a))n.each(a,function(){e(this.name,this.value)});else for(c in a)Gb(c,a[c],b,e);return d.join("&").replace(Bb,"+")},n.fn.extend({serialize:function(){return n.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=n.prop(this,"elements");return a?n.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!n(this).is(":disabled")&&Fb.test(this.nodeName)&&!Eb.test(a)&&(this.checked||!X.test(a))}).map(function(a,b){var c=n(this).val();return null==c?null:n.isArray(c)?n.map(c,function(a){return{name:b.name,value:a.replace(Db,"\r\n")}}):{name:b.name,value:c.replace(Db,"\r\n")}}).get()}}),n.ajaxSettings.xhr=function(){try{return new a.XMLHttpRequest}catch(b){}};var Hb={0:200,1223:204},Ib=n.ajaxSettings.xhr();l.cors=!!Ib&&"withCredentials"in Ib,l.ajax=Ib=!!Ib,n.ajaxTransport(function(b){var c,d;return l.cors||Ib&&!b.crossDomain?{send:function(e,f){var g,h=b.xhr();if(h.open(b.type,b.url,b.async,b.username,b.password),b.xhrFields)for(g in b.xhrFields)h[g]=b.xhrFields[g];b.mimeType&&h.overrideMimeType&&h.overrideMimeType(b.mimeType),b.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");for(g in e)h.setRequestHeader(g,e[g]);c=function(a){return function(){c&&(c=d=h.onload=h.onerror=h.onabort=h.onreadystatechange=null,"abort"===a?h.abort():"error"===a?"number"!=typeof h.status?f(0,"error"):f(h.status,h.statusText):f(Hb[h.status]||h.status,h.statusText,"text"!==(h.responseType||"text")||"string"!=typeof h.responseText?{binary:h.response}:{text:h.responseText},h.getAllResponseHeaders()))}},h.onload=c(),d=h.onerror=c("error"),void 0!==h.onabort?h.onabort=d:h.onreadystatechange=function(){4===h.readyState&&a.setTimeout(function(){c&&d()})},c=c("abort");try{h.send(b.hasContent&&b.data||null)}catch(i){if(c)throw i}},abort:function(){c&&c()}}:void 0}),n.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(a){return n.globalEval(a),a}}}),n.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),n.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(e,f){b=n("<script>").prop({charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&f("error"===a.type?404:200,a.type)}),d.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Jb=[],Kb=/(=)\?(?=&|$)|\?\?/;n.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Jb.pop()||n.expando+"_"+kb++;return this[a]=!0,a}}),n.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=!1!==b.jsonp&&(Kb.test(b.url)?"url":"string"==typeof b.data&&0===(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Kb.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=n.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Kb,"$1"+e):!1!==b.jsonp&&(b.url+=(lb.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||n.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){void 0===f?n(a).removeProp(e):a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Jb.push(e)),g&&n.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),n.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||d;var e=x.exec(a),f=!c&&[];return e?[b.createElement(e[1])]:(e=ca([a],b,f),f&&f.length&&n(f).remove(),n.merge([],e.childNodes))};var Lb=n.fn.load;n.fn.load=function(a,b,c){if("string"!=typeof a&&Lb)return Lb.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>-1&&(d=n.trim(a.slice(h)),a=a.slice(0,h)),n.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&n.ajax({url:a,type:e||"GET",dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?n("<div>").append(n.parseHTML(a)).find(d):a)}).always(c&&function(a,b){g.each(function(){c.apply(this,f||[a.responseText,b,a])})}),this},n.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){n.fn[b]=function(a){return this.on(b,a)}}),n.expr.filters.animated=function(a){return n.grep(n.timers,function(b){return a===b.elem}).length},n.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=n.css(a,"position"),l=n(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=n.css(a,"top"),i=n.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),n.isFunction(b)&&(b=b.call(a,c,n.extend({},h))),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},n.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){n.offset.setOffset(this,a,b)});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;return f?(b=f.documentElement,n.contains(b,d)?(e=d.getBoundingClientRect(),c=Mb(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e):void 0},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===n.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),n.nodeName(a[0],"html")||(d=a.offset()),d.top+=n.css(a[0],"borderTopWidth",!0),d.left+=n.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-n.css(c,"marginTop",!0),left:b.left-d.left-n.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent;a&&"static"===n.css(a,"position");)a=a.offsetParent;return a||Ea})}}),n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c="pageYOffset"===b;n.fn[a]=function(d){return K(this,function(a,d,e){var f=Mb(a);return void 0===e?f?f[b]:a[d]:void(f?f.scrollTo(c?f.pageXOffset:e,c?e:f.pageYOffset):a[d]=e)},a,d,arguments.length)}}),n.each(["top","left"],function(a,b){n.cssHooks[b]=Ga(l.pixelPosition,function(a,c){return c?(c=Fa(a,b),Ba.test(c)?n(a).position()[b]+"px":c):void 0})}),n.each({Height:"height",Width:"width"},function(a,b){n.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){n.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(!0===d||!0===e?"margin":"border");return K(this,function(b,c,d){var e;return n.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?n.css(b,c,g):n.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),n.fn.extend({bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)},size:function(){return this.length}}),n.fn.andSelf=n.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return n});var Nb=a.jQuery,Ob=a.$;return n.noConflict=function(b){return a.$===n&&(a.$=Ob),b&&a.jQuery===n&&(a.jQuery=Nb),n},b||(a.jQuery=a.$=n),n}),function(O,W,v){"use strict";function H(a){return function(){var d,b=arguments[0];for(d="["+(a?a+":":"")+b+"] http://errors.angularjs.org/1.5.0/"+(a?a+"/":"")+b,b=1;b<arguments.length;b++){d=d+(1==b?"?":"&")+"p"+(b-1)+"=";var e,c=encodeURIComponent;e=arguments[b],e="function"==typeof e?e.toString().replace(/ \{[\s\S]*$/,""):void 0===e?"undefined":"string"!=typeof e?JSON.stringify(e):e,d+=c(e)}return Error(d)}}function Ca(a){if(null==a||Za(a))return!1;if(L(a)||F(a)||C&&a instanceof C)return!0;var b="length"in Object(a)&&a.length;return N(b)&&(0<=b&&(b-1 in a||a instanceof Array)||"function"==typeof a.item)}function n(a,b,d){var c,e;if(a)if(D(a))for(c in a)"prototype"==c||"length"==c||"name"==c||a.hasOwnProperty&&!a.hasOwnProperty(c)||b.call(d,a[c],c,a);else if(L(a)||Ca(a)){var f="object"!=typeof a;for(c=0,e=a.length;c<e;c++)(f||c in a)&&b.call(d,a[c],c,a)}else if(a.forEach&&a.forEach!==n)a.forEach(b,d,a);else if(qc(a))for(c in a)b.call(d,a[c],c,a);else if("function"==typeof a.hasOwnProperty)for(c in a)a.hasOwnProperty(c)&&b.call(d,a[c],c,a);else for(c in a)sa.call(a,c)&&b.call(d,a[c],c,a);return a}function rc(a,b,d){for(var c=Object.keys(a).sort(),e=0;e<c.length;e++)b.call(d,a[c[e]],c[e]);return c}function sc(a){return function(b,d){a(d,b)}}function Yd(){return++pb}function Qb(a,b,d){for(var c=a.$$hashKey,e=0,f=b.length;e<f;++e){var g=b[e];if(E(g)||D(g))for(var h=Object.keys(g),k=0,l=h.length;k<l;k++){var m=h[k],r=g[m];d&&E(r)?V(r)?a[m]=new Date(r.valueOf()):$a(r)?a[m]=new RegExp(r):r.nodeName?a[m]=r.cloneNode(!0):Rb(r)?a[m]=r.clone():(E(a[m])||(a[m]=L(r)?[]:{}),Qb(a[m],[r],!0)):a[m]=r}}return c?a.$$hashKey=c:delete a.$$hashKey,a}function T(a){return Qb(a,wa.call(arguments,1),!1)}function Zd(a){return Qb(a,wa.call(arguments,1),!0)}function ca(a){return parseInt(a,10)}function Sb(a,b){return T(Object.create(a),b)}function B(){}function ab(a){return a}function ba(a){return function(){return a}}function tc(a){return D(a.toString)&&a.toString!==ga}function x(a){return void 0===a}function y(a){return void 0!==a}function E(a){return null!==a&&"object"==typeof a}function qc(a){return null!==a&&"object"==typeof a&&!uc(a)}function F(a){return"string"==typeof a}function N(a){return"number"==typeof a}function V(a){return"[object Date]"===ga.call(a)}function D(a){return"function"==typeof a}function $a(a){return"[object RegExp]"===ga.call(a)}function Za(a){return a&&a.window===a}function bb(a){return a&&a.$evalAsync&&a.$watch}function Na(a){return"boolean"==typeof a}function $d(a){return a&&N(a.length)&&ae.test(ga.call(a))}function Rb(a){return!(!a||!(a.nodeName||a.prop&&a.attr&&a.find))}function be(a){var b={};a=a.split(",");var d;for(d=0;d<a.length;d++)b[a[d]]=!0;return b}function ra(a){return G(a.nodeName||a[0]&&a[0].nodeName)}function cb(a,b){var d=a.indexOf(b);return 0<=d&&a.splice(d,1),d}function Oa(a,b){function d(a,b){var e,d=b.$$hashKey;if(L(a)){e=0;for(var f=a.length;e<f;e++)b.push(c(a[e]))}else if(qc(a))for(e in a)b[e]=c(a[e]);else if(a&&"function"==typeof a.hasOwnProperty)for(e in a)a.hasOwnProperty(e)&&(b[e]=c(a[e]));else for(e in a)sa.call(a,e)&&(b[e]=c(a[e]));return d?b.$$hashKey=d:delete b.$$hashKey,b}function c(a){if(!E(a))return a;var b=f.indexOf(a);if(-1!==b)return g[b];if(Za(a)||bb(a))throw Da("cpws");var b=!1,c=e(a);return c===v&&(c=L(a)?[]:Object.create(uc(a)),b=!0),f.push(a),g.push(c),b?d(a,c):c}function e(a){switch(ga.call(a)){case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Float32Array]":case"[object Float64Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return new a.constructor(c(a.buffer));case"[object ArrayBuffer]":if(!a.slice){var b=new ArrayBuffer(a.byteLength);return new Uint8Array(b).set(new Uint8Array(a)),b}return a.slice(0);case"[object Boolean]":case"[object Number]":case"[object String]":case"[object Date]":return new a.constructor(a.valueOf());case"[object RegExp]":return b=new RegExp(a.source,a.toString().match(/[^\/]*$/)[0]),b.lastIndex=a.lastIndex,b}if(D(a.cloneNode))return a.cloneNode(!0)}var f=[],g=[];if(b){if($d(b)||"[object ArrayBuffer]"===ga.call(b))throw Da("cpta");if(a===b)throw Da("cpi");return L(b)?b.length=0:n(b,function(a,c){"$$hashKey"!==c&&delete b[c]}),f.push(a),g.push(b),d(a,b)}return c(a)}function na(a,b){if(L(a)){b=b||[];for(var d=0,c=a.length;d<c;d++)b[d]=a[d]}else if(E(a))for(d in b=b||{},a)"$"===d.charAt(0)&&"$"===d.charAt(1)||(b[d]=a[d]);return b||a}function oa(a,b){if(a===b)return!0;if(null===a||null===b)return!1;if(a!==a&&b!==b)return!0;var c,d=typeof a;if(d==typeof b&&"object"==d){if(!L(a)){if(V(a))return!!V(b)&&oa(a.getTime(),b.getTime());if($a(a))return!!$a(b)&&a.toString()==b.toString();if(bb(a)||bb(b)||Za(a)||Za(b)||L(b)||V(b)||$a(b))return!1;d=Z();for(c in a)if("$"!==c.charAt(0)&&!D(a[c])){if(!oa(a[c],b[c]))return!1;d[c]=!0}for(c in b)if(!(c in d)&&"$"!==c.charAt(0)&&y(b[c])&&!D(b[c]))return!1;return!0}if(!L(b))return!1;if((d=a.length)==b.length){for(c=0;c<d;c++)if(!oa(a[c],b[c]))return!1;return!0}}return!1}function db(a,b,d){return a.concat(wa.call(b,d))}function vc(a,b){var d=2<arguments.length?wa.call(arguments,2):[];return!D(b)||b instanceof RegExp?b:d.length?function(){return arguments.length?b.apply(a,db(d,arguments,0)):b.apply(a,d)}:function(){return arguments.length?b.apply(a,arguments):b.call(a)}}function ce(a,b){var d=b;return"string"==typeof a&&"$"===a.charAt(0)&&"$"===a.charAt(1)?d=v:Za(b)?d="$WINDOW":b&&W===b?d="$DOCUMENT":bb(b)&&(d="$SCOPE"),d}function eb(a,b){return x(a)?v:(N(b)||(b=b?2:null),JSON.stringify(a,ce,b))}function wc(a){return F(a)?JSON.parse(a):a}function xc(a,b){a=a.replace(de,"");var d=Date.parse("Jan 01, 1970 00:00:00 "+a)/6e4;return isNaN(d)?b:d}function Tb(a,b,d){d=d?-1:1;var c=a.getTimezoneOffset();return b=xc(b,c),d*=b-c,a=new Date(a.getTime()),a.setMinutes(a.getMinutes()+d),a}function ta(a){a=C(a).clone();try{a.empty()}catch(b){}var d=C("<div>").append(a).html();try{return a[0].nodeType===Pa?G(d):d.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(a,b){return"<"+G(b)})}catch(c){return G(d)}}function yc(a){try{return decodeURIComponent(a)}catch(b){}}function zc(a){var b={};return n((a||"").split("&"),function(a){var c,e,f;a&&(e=a=a.replace(/\+/g,"%20"),c=a.indexOf("="),-1!==c&&(e=a.substring(0,c),f=a.substring(c+1)),e=yc(e),y(e)&&(f=!y(f)||yc(f),sa.call(b,e)?L(b[e])?b[e].push(f):b[e]=[b[e],f]:b[e]=f))}),b}function Ub(a){var b=[];return n(a,function(a,c){L(a)?n(a,function(a){b.push(ha(c,!0)+(!0===a?"":"="+ha(a,!0)))}):b.push(ha(c,!0)+(!0===a?"":"="+ha(a,!0)))}),b.length?b.join("&"):""}function qb(a){return ha(a,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function ha(a,b){return encodeURIComponent(a).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,b?"%20":"+")}function ee(a,b){var d,c,e=Qa.length;for(c=0;c<e;++c)if(d=Qa[c]+b,F(d=a.getAttribute(d)))return d;return null}function fe(a,b){var d,c,e={};n(Qa,function(b){b+="app",!d&&a.hasAttribute&&a.hasAttribute(b)&&(d=a,c=a.getAttribute(b))}),n(Qa,function(b){b+="app";var e;!d&&(e=a.querySelector("["+b.replace(":","\\:")+"]"))&&(d=e,c=e.getAttribute(b))}),d&&(e.strictDi=null!==ee(d,"strict-di"),b(d,c?[c]:[],e))}function Ac(a,b,d){E(d)||(d={}),d=T({strictDi:!1},d);var c=function(){if(a=C(a),a.injector()){var c=a[0]===W?"document":ta(a);throw Da("btstrpd",c.replace(/</,"&lt;").replace(/>/,"&gt;"))}return b=b||[],b.unshift(["$provide",function(b){b.value("$rootElement",a)}]),d.debugInfoEnabled&&b.push(["$compileProvider",function(a){a.debugInfoEnabled(!0)}]),b.unshift("ng"),c=fb(b,d.strictDi),c.invoke(["$rootScope","$rootElement","$compile","$injector",function(a,b,c,d){a.$apply(function(){b.data("$injector",d),c(b)(a)})}]),c},e=/^NG_ENABLE_DEBUG_INFO!/,f=/^NG_DEFER_BOOTSTRAP!/;if(O&&e.test(O.name)&&(d.debugInfoEnabled=!0,O.name=O.name.replace(e,"")),O&&!f.test(O.name))return c();O.name=O.name.replace(f,""),ia.resumeBootstrap=function(a){return n(a,function(a){b.push(a)}),c()},D(ia.resumeDeferredBootstrap)&&ia.resumeDeferredBootstrap()}function ge(){O.name="NG_ENABLE_DEBUG_INFO!"+O.name,O.location.reload()}function he(a){if(!(a=ia.element(a).injector()))throw Da("test");return a.get("$$testability")}function Bc(a,b){return b=b||"_",a.replace(ie,function(a,c){return(c?b:"")+a.toLowerCase()})}function je(){var a;if(!Cc){var b=rb();(ua=x(b)?O.jQuery:b?O[b]:v)&&ua.fn.on?(C=ua,T(ua.fn,{scope:Ra.scope,isolateScope:Ra.isolateScope,controller:Ra.controller,injector:Ra.injector,inheritedData:Ra.inheritedData}),a=ua.cleanData,ua.cleanData=function(b){for(var c,f,e=0;null!=(f=b[e]);e++)(c=ua._data(f,"events"))&&c.$destroy&&ua(f).triggerHandler("$destroy");a(b)}):C=U,ia.element=C,Cc=!0}}function sb(a,b,d){if(!a)throw Da("areq",b||"?",d||"required");return a}function Sa(a,b,d){return d&&L(a)&&(a=a[a.length-1]),sb(D(a),b,"not a function, got "+(a&&"object"==typeof a?a.constructor.name||"Object":typeof a)),a}function Ta(a,b){if("hasOwnProperty"===a)throw Da("badname",b)}function Dc(a,b,d){if(!b)return a;b=b.split(".");for(var c,e=a,f=b.length,g=0;g<f;g++)c=b[g],a&&(a=(e=a)[c]);return!d&&D(a)?vc(e,a):a}function tb(a){for(var c,b=a[0],d=a[a.length-1],e=1;b!==d&&(b=b.nextSibling);e++)(c||a[e]!==b)&&(c||(c=C(wa.call(a,0,e))),c.push(b));return c||a}function Z(){return Object.create(null)}function ke(a){function b(a,b,c){return a[b]||(a[b]=c())}var d=H("$injector"),c=H("ng");return a=b(a,"angular",Object),a.$$minErr=a.$$minErr||H,b(a,"module",function(){var a={};return function(f,g,h){if("hasOwnProperty"===f)throw c("badname","module");return g&&a.hasOwnProperty(f)&&(a[f]=null),b(a,f,function(){function a(b,d,e,f){return f||(f=c),function(){return f[e||"push"]([b,d,arguments]),K}}function b(a,d){return function(b,e){return e&&D(e)&&(e.$$moduleName=f),c.push([a,d,arguments]),K}}if(!g)throw d("nomod",f);var c=[],e=[],s=[],I=a("$injector","invoke","push",e),K={_invokeQueue:c,_configBlocks:e,_runBlocks:s,requires:g,name:f,provider:b("$provide","provider"),factory:b("$provide","factory"),service:b("$provide","service"),value:a("$provide","value"),constant:a("$provide","constant","unshift"),decorator:b("$provide","decorator"),animation:b("$animateProvider","register"),filter:b("$filterProvider","register"),controller:b("$controllerProvider","register"),directive:b("$compileProvider","directive"),component:b("$compileProvider","component"),config:I,run:function(a){return s.push(a),this}};return h&&I(h),K})}})}function le(a){T(a,{bootstrap:Ac,copy:Oa,extend:T,merge:Zd,equals:oa,element:C,forEach:n,injector:fb,noop:B,bind:vc,toJson:eb,fromJson:wc,identity:ab,isUndefined:x,isDefined:y,isString:F,isFunction:D,isObject:E,isNumber:N,isElement:Rb,isArray:L,version:me,isDate:V,lowercase:G,uppercase:ub,callbacks:{counter:0},getTestability:he,$$minErr:H,$$csp:Ea,reloadWithDebugInfo:ge}),(Vb=ke(O))("ng",["ngLocale"],["$provide",function(a){a.provider({$$sanitizeUri:ne}),a.provider("$compile",Ec).directive({a:oe,input:Fc,textarea:Fc,form:pe,script:qe,select:re,style:se,option:te,ngBind:ue,ngBindHtml:ve,ngBindTemplate:we,ngClass:xe,ngClassEven:ye,ngClassOdd:ze,ngCloak:Ae,ngController:Be,ngForm:Ce,ngHide:De,ngIf:Ee,ngInclude:Fe,ngInit:Ge,ngNonBindable:He,ngPluralize:Ie,ngRepeat:Je,ngShow:Ke,ngStyle:Le,ngSwitch:Me,ngSwitchWhen:Ne,ngSwitchDefault:Oe,ngOptions:Pe,ngTransclude:Qe,ngModel:Re,ngList:Se,ngChange:Te,pattern:Gc,ngPattern:Gc,required:Hc,ngRequired:Hc,minlength:Ic,ngMinlength:Ic,maxlength:Jc,ngMaxlength:Jc,ngValue:Ue,ngModelOptions:Ve}).directive({ngInclude:We}).directive(vb).directive(Kc),a.provider({$anchorScroll:Xe,$animate:Ye,$animateCss:Ze,$$animateJs:$e,$$animateQueue:af,$$AnimateRunner:bf,$$animateAsyncRun:cf,$browser:df,$cacheFactory:ef,$controller:ff,$document:gf,$exceptionHandler:hf,$filter:Lc,$$forceReflow:jf,$interpolate:kf,$interval:lf,$http:mf,$httpParamSerializer:nf,$httpParamSerializerJQLike:of,$httpBackend:pf,$xhrFactory:qf,$location:rf,$log:sf,$parse:tf,$rootScope:uf,$q:vf,$$q:wf,$sce:xf,$sceDelegate:yf,$sniffer:zf,$templateCache:Af,$templateRequest:Bf,$$testability:Cf,$timeout:Df,$window:Ef,$$rAF:Ff,$$jqLite:Gf,$$HashMap:Hf,$$cookieReader:If})}])}function gb(a){return a.replace(Jf,function(a,d,c,e){return e?c.toUpperCase():c}).replace(Kf,"Moz$1")}function Mc(a){return 1===(a=a.nodeType)||!a||9===a}function Nc(a,b){var d,c,e=b.createDocumentFragment(),f=[];if(Wb.test(a)){for(d=d||e.appendChild(b.createElement("div")),c=(Lf.exec(a)||["",""])[1].toLowerCase(),c=da[c]||da._default,d.innerHTML=c[1]+a.replace(Mf,"<$1></$2>")+c[2],c=c[0];c--;)d=d.lastChild;f=db(f,d.childNodes),d=e.firstChild,d.textContent=""}else f.push(b.createTextNode(a))
;return e.textContent="",e.innerHTML="",n(f,function(a){e.appendChild(a)}),e}function Oc(a,b){var d=a.parentNode;d&&d.replaceChild(b,a),b.appendChild(a)}function U(a){if(a instanceof U)return a;var b;if(F(a)&&(a=X(a),b=!0),!(this instanceof U)){if(b&&"<"!=a.charAt(0))throw Xb("nosel");return new U(a)}if(b){b=W;var d;a=(d=Nf.exec(a))?[b.createElement(d[1])]:(d=Nc(a,b))?d.childNodes:[]}Pc(this,a)}function Yb(a){return a.cloneNode(!0)}function wb(a,b){if(b||hb(a),a.querySelectorAll)for(var d=a.querySelectorAll("*"),c=0,e=d.length;c<e;c++)hb(d[c])}function Qc(a,b,d,c){if(y(c))throw Xb("offargs");var e=(c=xb(a))&&c.events,f=c&&c.handle;if(f)if(b){var g=function(b){var c=e[b];y(d)&&cb(c||[],d),y(d)&&c&&0<c.length||(a.removeEventListener(b,f,!1),delete e[b])};n(b.split(" "),function(a){g(a),yb[a]&&g(yb[a])})}else for(b in e)"$destroy"!==b&&a.removeEventListener(b,f,!1),delete e[b]}function hb(a,b){var d=a.ng339,c=d&&ib[d];c&&(b?delete c.data[b]:(c.handle&&(c.events.$destroy&&c.handle({},"$destroy"),Qc(a)),delete ib[d],a.ng339=v))}function xb(a,b){var d=a.ng339,d=d&&ib[d];return b&&!d&&(a.ng339=d=++Of,d=ib[d]={events:{},data:{},handle:v}),d}function Zb(a,b,d){if(Mc(a)){var c=y(d),e=!c&&b&&!E(b),f=!b;if(a=(a=xb(a,!e))&&a.data,c)a[b]=d;else{if(f)return a;if(e)return a&&a[b];T(a,b)}}}function zb(a,b){return!!a.getAttribute&&-1<(" "+(a.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+b+" ")}function Ab(a,b){b&&a.setAttribute&&n(b.split(" "),function(b){a.setAttribute("class",X((" "+(a.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+X(b)+" "," ")))})}function Bb(a,b){if(b&&a.setAttribute){var d=(" "+(a.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");n(b.split(" "),function(a){a=X(a),-1===d.indexOf(" "+a+" ")&&(d+=a+" ")}),a.setAttribute("class",X(d))}}function Pc(a,b){if(b)if(b.nodeType)a[a.length++]=b;else{var d=b.length;if("number"==typeof d&&b.window!==b){if(d)for(var c=0;c<d;c++)a[a.length++]=b[c]}else a[a.length++]=b}}function Rc(a,b){return Cb(a,"$"+(b||"ngController")+"Controller")}function Cb(a,b,d){for(9==a.nodeType&&(a=a.documentElement),b=L(b)?b:[b];a;){for(var c=0,e=b.length;c<e;c++)if(y(d=C.data(a,b[c])))return d;a=a.parentNode||11===a.nodeType&&a.host}}function Sc(a){for(wb(a,!0);a.firstChild;)a.removeChild(a.firstChild)}function $b(a,b){b||wb(a);var d=a.parentNode;d&&d.removeChild(a)}function Pf(a,b){b=b||O,"complete"===b.document.readyState?b.setTimeout(a):C(b).on("load",a)}function Tc(a,b){var d=Db[b.toLowerCase()];return d&&Uc[ra(a)]&&d}function Qf(a,b){var d=function(c,d){c.isDefaultPrevented=function(){return c.defaultPrevented};var f=b[d||c.type],g=f?f.length:0;if(g){if(x(c.immediatePropagationStopped)){var h=c.stopImmediatePropagation;c.stopImmediatePropagation=function(){c.immediatePropagationStopped=!0,c.stopPropagation&&c.stopPropagation(),h&&h.call(c)}}c.isImmediatePropagationStopped=function(){return!0===c.immediatePropagationStopped};var k=f.specialHandlerWrapper||Rf;1<g&&(f=na(f));for(var l=0;l<g;l++)c.isImmediatePropagationStopped()||k(a,c,f[l])}};return d.elem=a,d}function Rf(a,b,d){d.call(a,b)}function Sf(a,b,d){var c=b.relatedTarget;c&&(c===a||Tf.call(a,c))||d.call(a,b)}function Gf(){this.$get=function(){return T(U,{hasClass:function(a,b){return a.attr&&(a=a[0]),zb(a,b)},addClass:function(a,b){return a.attr&&(a=a[0]),Bb(a,b)},removeClass:function(a,b){return a.attr&&(a=a[0]),Ab(a,b)}})}}function Fa(a,b){var d=a&&a.$$hashKey;return d?("function"==typeof d&&(d=a.$$hashKey()),d):(d=typeof a,d="function"==d||"object"==d&&null!==a?a.$$hashKey=d+":"+(b||Yd)():d+":"+a)}function Ua(a,b){if(b){var d=0;this.nextUid=function(){return++d}}n(a,this.put,this)}function Vc(a){return a=a.toString().replace(Uf,""),a.match(Vf)||a.match(Wf)}function Xf(a){return(a=Vc(a))?"function("+(a[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}function fb(a,b){function d(a){return function(b,c){if(!E(b))return a(b,c);n(b,sc(a))}}function c(a,b){if(Ta(a,"service"),(D(b)||L(b))&&(b=s.instantiate(b)),!b.$get)throw Ga("pget",a);return r[a+"Provider"]=b}function e(a,b){return function(){var c=t.invoke(b,this);if(x(c))throw Ga("undef",a);return c}}function f(a,b,d){return c(a,{$get:!1!==d?e(a,b):b})}function g(a){sb(x(a)||L(a),"modulesToLoad","not an array");var c,b=[];return n(a,function(a){function d(a){var b,c;for(b=0,c=a.length;b<c;b++){var e=a[b],f=s.get(e[0]);f[e[1]].apply(f,e[2])}}if(!m.get(a)){m.put(a,!0);try{F(a)?(c=Vb(a),b=b.concat(g(c.requires)).concat(c._runBlocks),d(c._invokeQueue),d(c._configBlocks)):D(a)?b.push(s.invoke(a)):L(a)?b.push(s.invoke(a)):Sa(a,"module")}catch(e){throw L(a)&&(a=a[a.length-1]),e.message&&e.stack&&-1==e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),Ga("modulerr",a,e.stack||e.message||e)}}}),b}function h(a,c){function d(b,e){if(a.hasOwnProperty(b)){if(a[b]===k)throw Ga("cdep",b+" <- "+l.join(" <- "));return a[b]}try{return l.unshift(b),a[b]=k,a[b]=c(b,e)}catch(f){throw a[b]===k&&delete a[b],f}finally{l.shift()}}function e(a,c,f){var g=[];a=fb.$$annotate(a,b,f);for(var h=0,k=a.length;h<k;h++){var l=a[h];if("string"!=typeof l)throw Ga("itkn",l);g.push(c&&c.hasOwnProperty(l)?c[l]:d(l,f))}return g}return{invoke:function(a,b,c,d){return"string"==typeof c&&(d=c,c=null),c=e(a,c,d),L(a)&&(a=a[a.length-1]),d=!(11>=xa)&&("function"==typeof a&&/^(?:class\s|constructor\()/.test(Function.prototype.toString.call(a))),d?(c.unshift(null),new(Function.prototype.bind.apply(a,c))):a.apply(b,c)},instantiate:function(a,b,c){var d=L(a)?a[a.length-1]:a;return a=e(a,b,c),a.unshift(null),new(Function.prototype.bind.apply(d,a))},get:d,annotate:fb.$$annotate,has:function(b){return r.hasOwnProperty(b+"Provider")||a.hasOwnProperty(b)}}}b=!0===b;var k={},l=[],m=new Ua([],!0),r={$provide:{provider:d(c),factory:d(f),service:d(function(a,b){return f(a,["$injector",function(a){return a.instantiate(b)}])}),value:d(function(a,b){return f(a,ba(b),!1)}),constant:d(function(a,b){Ta(a,"constant"),r[a]=b,I[a]=b}),decorator:function(a,b){var c=s.get(a+"Provider"),d=c.$get;c.$get=function(){var a=t.invoke(d,c);return t.invoke(b,null,{$delegate:a})}}}},s=r.$injector=h(r,function(a,b){throw ia.isString(b)&&l.push(b),Ga("unpr",l.join(" <- "))}),I={},K=h(I,function(a,b){var c=s.get(a+"Provider",b);return t.invoke(c.$get,c,v,a)}),t=K;r.$injectorProvider={$get:ba(K)};var p=g(a),t=K.get("$injector");return t.strictDi=b,n(p,function(a){a&&t.invoke(a)}),t}function Xe(){var a=!0;this.disableAutoScrolling=function(){a=!1},this.$get=["$window","$location","$rootScope",function(b,d,c){function e(a){var b=null;return Array.prototype.some.call(a,function(a){if("a"===ra(a))return b=a,!0}),b}function f(a){if(a){a.scrollIntoView();var c;c=g.yOffset,D(c)?c=c():Rb(c)?(c=c[0],c="fixed"!==b.getComputedStyle(c).position?0:c.getBoundingClientRect().bottom):N(c)||(c=0),c&&(a=a.getBoundingClientRect().top,b.scrollBy(0,a-c))}else b.scrollTo(0,0)}function g(a){a=F(a)?a:d.hash();var b;a?(b=h.getElementById(a))?f(b):(b=e(h.getElementsByName(a)))?f(b):"top"===a&&f(null):f(null)}var h=b.document;return a&&c.$watch(function(){return d.hash()},function(a,b){a===b&&""===a||Pf(function(){c.$evalAsync(g)})}),g}]}function jb(a,b){return a||b?a?b?(L(a)&&(a=a.join(" ")),L(b)&&(b=b.join(" ")),a+" "+b):a:b:""}function Yf(a){F(a)&&(a=a.split(" "));var b=Z();return n(a,function(a){a.length&&(b[a]=!0)}),b}function Ha(a){return E(a)?a:{}}function Zf(a,b,d,c){function e(a){try{a.apply(null,wa.call(arguments,1))}finally{if(0===--K)for(;t.length;)try{t.pop()()}catch(b){d.error(b)}}}function f(){z=null,g(),h()}function g(){a:{try{p=m.state;break a}catch(a){}p=void 0}p=x(p)?null:p,oa(p,$)&&(p=$),$=p}function h(){u===k.url()&&w===p||(u=k.url(),w=p,n(A,function(a){a(k.url(),p)}))}var k=this,l=a.location,m=a.history,r=a.setTimeout,s=a.clearTimeout,I={};k.isMock=!1;var K=0,t=[];k.$$completeOutstandingRequest=e,k.$$incOutstandingRequestCount=function(){K++},k.notifyWhenNoOutstandingRequests=function(a){0===K?a():t.push(a)};var p,w,u=l.href,la=b.find("base"),z=null;g(),w=p,k.url=function(b,d,e){if(x(e)&&(e=null),l!==a.location&&(l=a.location),m!==a.history&&(m=a.history),b){var f=w===e;if(u===b&&(!c.history||f))return k;var h=u&&Ia(u)===Ia(b);return u=b,w=e,!c.history||h&&f?(h&&!z||(z=b),d?l.replace(b):h?(d=l,e=b.indexOf("#"),e=-1===e?"":b.substr(e),d.hash=e):l.href=b,l.href!==b&&(z=b)):(m[d?"replaceState":"pushState"](e,"",b),g(),w=p),k}return z||l.href.replace(/%27/g,"'")},k.state=function(){return p};var A=[],Q=!1,$=null;k.onUrlChange=function(b){return Q||(c.history&&C(a).on("popstate",f),C(a).on("hashchange",f),Q=!0),A.push(b),b},k.$$applicationDestroyed=function(){C(a).off("hashchange popstate",f)},k.$$checkUrlChange=h,k.baseHref=function(){var a=la.attr("href");return a?a.replace(/^(https?\:)?\/\/[^\/]*/,""):""},k.defer=function(a,b){var c;return K++,c=r(function(){delete I[c],e(a)},b||0),I[c]=!0,c},k.defer.cancel=function(a){return!!I[a]&&(delete I[a],s(a),e(B),!0)}}function df(){this.$get=["$window","$log","$sniffer","$document",function(a,b,d,c){return new Zf(a,c,b,d)}]}function ef(){this.$get=function(){function a(a,c){function e(a){a!=r&&(s?s==a&&(s=a.n):s=a,f(a.n,a.p),f(a,r),r=a,r.n=null)}function f(a,b){a!=b&&(a&&(a.p=b),b&&(b.n=a))}if(a in b)throw H("$cacheFactory")("iid",a);var g=0,h=T({},c,{id:a}),k=Z(),l=c&&c.capacity||Number.MAX_VALUE,m=Z(),r=null,s=null;return b[a]={put:function(a,b){if(!x(b)){if(l<Number.MAX_VALUE){e(m[a]||(m[a]={key:a}))}return a in k||g++,k[a]=b,g>l&&this.remove(s.key),b}},get:function(a){if(l<Number.MAX_VALUE){var b=m[a];if(!b)return;e(b)}return k[a]},remove:function(a){if(l<Number.MAX_VALUE){var b=m[a];if(!b)return;b==r&&(r=b.p),b==s&&(s=b.n),f(b.n,b.p),delete m[a]}a in k&&(delete k[a],g--)},removeAll:function(){k=Z(),g=0,m=Z(),r=s=null},destroy:function(){m=h=k=null,delete b[a]},info:function(){return T({},h,{size:g})}}}var b={};return a.info=function(){var a={};return n(b,function(b,e){a[e]=b.info()}),a},a.get=function(a){return b[a]},a}}function Af(){this.$get=["$cacheFactory",function(a){return a("templates")}]}function Ec(a,b){function d(a,b,c){var d=/^\s*([@&<]|=(\*?))(\??)\s*(\w*)\s*$/,e={};return n(a,function(a,f){var g=a.match(d);if(!g)throw ja("iscp",b,f,a,c?"controller bindings definition":"isolate scope definition");e[f]={mode:g[1][0],collection:"*"===g[2],optional:"?"===g[3],attrName:g[4]||f}}),e}function c(a){var b=a.charAt(0);if(!b||b!==G(b))throw ja("baddir",a);if(a!==a.trim())throw ja("baddir",a)}var e={},f=/^\s*directive\:\s*([\w\-]+)\s+(.*)$/,g=/(([\w\-]+)(?:\:([^;]+))?;?)/,h=be("ngSrc,ngSrcset,src,srcset"),k=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,l=/^(on[a-z]+|formaction)$/;this.directive=function s(b,f){return Ta(b,"directive"),F(b)?(c(b),sb(f,"directiveFactory"),e.hasOwnProperty(b)||(e[b]=[],a.factory(b+"Directive",["$injector","$exceptionHandler",function(a,c){var f=[];return n(e[b],function(e,g){try{var h=a.invoke(e);D(h)?h={compile:ba(h)}:!h.compile&&h.link&&(h.compile=ba(h.link)),h.priority=h.priority||0,h.index=g,h.name=h.name||b,h.require=h.require||h.controller&&h.name,h.restrict=h.restrict||"EA";var k=h,l=h,m=h.name,s={isolateScope:null,bindToController:null};if(E(l.scope)&&(!0===l.bindToController?(s.bindToController=d(l.scope,m,!0),s.isolateScope={}):s.isolateScope=d(l.scope,m,!1)),E(l.bindToController)&&(s.bindToController=d(l.bindToController,m,!0)),E(s.bindToController)){var P=l.controller,S=l.controllerAs;if(!P)throw ja("noctrl",m);if(!Wc(P,S))throw ja("noident",m)}var ma=k.$$bindings=s;E(ma.isolateScope)&&(h.$$isolateBindings=ma.isolateScope),h.$$moduleName=e.$$moduleName,f.push(h)}catch(K){c(K)}}),f}])),e[b].push(f)):n(b,sc(s)),this},this.component=function(a,b){function c(a){function e(b){return D(b)||L(b)?function(c,d){return a.invoke(b,this,{$element:c,$attrs:d})}:b}var f=b.template||b.templateUrl?b.template:"";return{controller:d,controllerAs:Wc(b.controller)||b.controllerAs||"$ctrl",template:e(f),templateUrl:e(b.templateUrl),transclude:b.transclude,scope:{},bindToController:b.bindings||{},restrict:"E",require:b.require}}var d=b.controller||function(){};return n(b,function(a,b){"$"===b.charAt(0)&&(c[b]=a)}),c.$inject=["$injector"],this.directive(a,c)},this.aHrefSanitizationWhitelist=function(a){return y(a)?(b.aHrefSanitizationWhitelist(a),this):b.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(a){return y(a)?(b.imgSrcSanitizationWhitelist(a),this):b.imgSrcSanitizationWhitelist()};var m=!0;this.debugInfoEnabled=function(a){return y(a)?(m=a,this):m},this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$sce","$animate","$$sanitizeUri",function(a,b,c,d,p,w,u,la,z,A){function Q(a,b,c){ba.innerHTML="<span "+b+">",b=ba.firstChild.attributes;var d=b[0];b.removeNamedItem(d.name),d.value=c,a.attributes.setNamedItem(d)}function $(a,b){try{a.addClass(b)}catch(c){}}function M(a,b,c,d,e){a instanceof C||(a=C(a));for(var f=/\S+/,g=0,h=a.length;g<h;g++){var k=a[g];k.nodeType===Pa&&k.nodeValue.match(f)&&Oc(k,a[g]=W.createElement("span"))}var l=P(a,b,a,c,d,e);M.$$addScopeClass(a);var m=null;return function(b,c,d){sb(b,"scope"),e&&e.needsNewScope&&(b=b.$parent.$new()),d=d||{};var f=d.parentBoundTranscludeFn,g=d.transcludeControllers;if(d=d.futureParentElement,f&&f.$$boundTransclude&&(f=f.$$boundTransclude),m||(m=(d=d&&d[0])&&"foreignobject"!==ra(d)&&ga.call(d).match(/SVG/)?"svg":"html"),d="html"!==m?C(U(m,C("<div>").append(a).html())):c?Ra.clone.call(a):a,g)for(var h in g)d.data("$"+h+"Controller",g[h].instance);return M.$$addScopeInfo(d,b),c&&c(d,b),l&&l(b,d,d,f),d}}function P(a,b,c,d,e,f){function g(a,c,d,e){var f,k,l,m,p,s,u;if(A)for(u=Array(c.length),m=0;m<h.length;m+=3)f=h[m],u[f]=c[f];else u=c;for(m=0,p=h.length;m<p;)k=u[h[m++]],c=h[m++],f=h[m++],c?(c.scope?(l=a.$new(),M.$$addScopeInfo(C(k),l)):l=a,s=c.transcludeOnThisElement?S(a,c.transclude,e):!c.templateOnThisElement&&e?e:!e&&b?S(a,b):null,c(f,l,k,d,s)):f&&f(a,k.childNodes,v,e)}for(var k,l,m,p,A,h=[],s=0;s<a.length;s++)k=new na,l=ma(a[s],[],k,0===s?d:v,e),(f=l.length?y(l,a[s],k,b,c,null,[],[],f):null)&&f.scope&&M.$$addScopeClass(k.$$element),k=f&&f.terminal||!(m=a[s].childNodes)||!m.length?null:P(m,f?(f.transcludeOnThisElement||!f.templateOnThisElement)&&f.transclude:b),(f||k)&&(h.push(s,f,k),p=!0,A=A||f),f=null;return p?g:null}function S(a,b,c){var f,d=function(d,e,f,g,h){return d||(d=a.$new(!1,h),d.$$transcluded=!0),b(d,e,{parentBoundTranscludeFn:c,transcludeControllers:f,futureParentElement:g})},e=d.$$slots=Z();for(f in b.$$slots)e[f]=b.$$slots[f]?S(a,b.$$slots[f],c):null;return d}function ma(a,b,c,d,e){var k,h=c.$attr;switch(a.nodeType){case 1:H(b,va(ra(a)),"E",d,e);for(var l,m,p,s=a.attributes,A=0,u=s&&s.length;A<u;A++){var t=!1,w=!1;l=s[A],k=l.name,m=X(l.value),l=va(k),(p=pa.test(l))&&(k=k.replace(Xc,"").substr(8).replace(/_(.)/g,function(a,b){return b.toUpperCase()})),(l=l.match(ua))&&O(l[1])&&(t=k,w=k.substr(0,k.length-5)+"end",k=k.substr(0,k.length-6)),l=va(k.toLowerCase()),h[l]=k,!p&&c.hasOwnProperty(l)||(c[l]=m,Tc(a,l)&&(c[l]=!0)),Y(a,b,m,l,p),H(b,l,"A",d,e,t,w)}if(a=a.className,E(a)&&(a=a.animVal),F(a)&&""!==a)for(;k=g.exec(a);)l=va(k[2]),H(b,l,"C",d,e)&&(c[l]=X(k[3])),a=a.substr(k.index+k[0].length);break;case Pa:if(11===xa)for(;a.parentNode&&a.nextSibling&&a.nextSibling.nodeType===Pa;)a.nodeValue+=a.nextSibling.nodeValue,a.parentNode.removeChild(a.nextSibling);N(b,a.nodeValue);break;case 8:try{(k=f.exec(a.nodeValue))&&(l=va(k[1]),H(b,l,"M",d,e)&&(c[l]=X(k[2])))}catch(M){}}return b.sort(ya),b}function q(a,b,c){var d=[],e=0;if(b&&a.hasAttribute&&a.hasAttribute(b))do{if(!a)throw ja("uterdir",b,c);1==a.nodeType&&(a.hasAttribute(b)&&e++,a.hasAttribute(c)&&e--),d.push(a),a=a.nextSibling}while(0<e);else d.push(a);return C(d)}function Yc(a,b,c){return function(d,e,f,g,h){return e=q(e[0],b,c),a(d,e,f,g,h)}}function ac(a,b,c,d,e,f){if(a)return M(b,c,d,e,f);var g;return function(){return g||(g=M(b,c,d,e,f),b=c=f=null),g.apply(this,arguments)}}function y(a,b,d,e,f,g,h,l,m){function p(a,b,c,d){a&&(c&&(a=Yc(a,c,d)),a.require=J.require,a.directiveName=H,(P===J||J.$$isolateScope)&&(a=ca(a,{isolateScope:!0})),h.push(a)),b&&(c&&(b=Yc(b,c,d)),b.require=J.require,b.directiveName=H,(P===J||J.$$isolateScope)&&(b=ca(b,{isolateScope:!0})),l.push(b))}function s(a,b,c,d){var e;if(F(b)){var f=b.match(k);b=b.substring(f[0].length);var g=f[1]||f[3],f="?"===f[2];if("^^"===g?c=c.parent():e=(e=d&&d[b])&&e.instance,!e){var h="$"+b+"Controller";e=g?c.inheritedData(h):c.data(h)}if(!e&&!f)throw ja("ctreq",b,a)}else if(L(b))for(e=[],g=0,f=b.length;g<f;g++)e[g]=s(a,b[g],c,d);else E(b)&&(e={},n(b,function(b,f){e[f]=s(a,b,c,d)}));return e||null}function A(a,b,c,d,e,f){var h,g=Z();for(h in d){var k=d[h],l={$scope:k===P||k.$$isolateScope?e:f,$element:a,$attrs:b,$transclude:c},m=k.controller;"@"==m&&(m=b[k.name]),l=w(m,l,!0,k.controllerAs),g[k.name]=l,B||a.data("$"+k.name+"Controller",l.instance)}return g}function u(a,c,e,f,g){function k(a,b,c,d){var e;if(bb(a)||(d=c,c=b,b=a,a=v),B&&(e=ma),c||(c=B?z.parent():z),!d)return g(a,b,e,c,Eb);var f=g.$$slots[d];if(f)return f(a,b,e,c,Eb);if(x(f))throw ja("noslot",d,ta(z))}var m,p,t,w,ma,S,z,Ja;b===e?(f=d,z=d.$$element):(z=C(e),f=new na(z,d)),t=c,P?w=c.$new(!0):Q&&(t=c.$parent),g&&(S=k,S.$$boundTransclude=g,S.isSlotFilled=function(a){return!!g.$$slots[a]}),I&&(ma=A(z,f,S,I,w,c)),P&&(M.$$addScopeInfo(z,w,!0,!($&&($===P||$===P.$$originalDirective))),M.$$addScopeClass(z,!0),w.$$isolateBindings=P.$$isolateBindings,(Ja=ia(c,f,w,w.$$isolateBindings,P))&&w.$on("$destroy",Ja));for(p in ma){Ja=I[p];var K=ma[p],la=Ja.$$bindings.bindToController;K.identifier&&la&&(m=ia(t,f,K.instance,la,Ja));var q=K();q!==K.instance&&(K.instance=q,z.data("$"+Ja.name+"Controller",q),m&&m(),m=ia(t,f,K.instance,la,Ja))}for(n(I,function(a,b){var c=a.require;a.bindToController&&!L(c)&&E(c)&&T(ma[b].instance,s(b,c,z,ma))}),n(ma,function(a){D(a.instance.$onInit)&&a.instance.$onInit()}),m=0,p=h.length;m<p;m++)t=h[m],ka(t,t.isolateScope?w:c,z,f,t.require&&s(t.directiveName,t.require,z,ma),S);var Eb=c;for(P&&(P.template||null===P.templateUrl)&&(Eb=w),a&&a(Eb,e.childNodes,v,g),m=l.length-1;0<=m;m--)t=l[m],ka(t,t.isolateScope?w:c,z,f,t.require&&s(t.directiveName,t.require,z,ma),S)}m=m||{};for(var J,H,G,O,fa,t=-Number.MAX_VALUE,Q=m.newScopeDirective,I=m.controllerDirectives,P=m.newIsolateScopeDirective,$=m.templateDirective,S=m.nonTlbTranscludeDirective,z=!1,la=!1,B=m.hasElementTranscludeDirective,ea=d.$$element=C(b),ya=e,N=!1,Fb=!1,R=0,Va=a.length;R<Va;R++){J=a[R];var Y=J.$$start,ba=J.$$end;if(Y&&(ea=q(b,Y,ba)),G=v,t>J.priority)break;if((fa=J.scope)&&(J.templateUrl||(E(fa)?(Wa("new/isolated scope",P||Q,J,ea),P=J):Wa("new/isolated scope",P,J,ea)),Q=Q||J),H=J.name,!N&&(J.replace&&(J.templateUrl||J.template)||J.transclude&&!J.$$tlb)){for(fa=R+1;N=a[fa++];)if(N.transclude&&!N.$$tlb||N.replace&&(N.templateUrl||N.template)){Fb=!0;break}N=!0}if(!J.templateUrl&&J.controller&&(fa=J.controller,I=I||Z(),Wa("'"+H+"' controller",I[H],J,ea),I[H]=J),fa=J.transclude)if(z=!0,J.$$tlb||(Wa("transclusion",S,J,ea),S=J),"element"==fa)B=!0,t=J.priority,G=ea,ea=d.$$element=C(W.createComment(" "+H+": "+d[H]+" ")),b=ea[0],aa(f,wa.call(G,0),b),ya=ac(Fb,G,e,t,g&&g.name,{nonTlbTranscludeDirective:S});else{var V=Z();if(G=C(Yb(b)).contents(),E(fa)){G=[];var ha=Z(),da=Z();n(fa,function(a,b){var c="?"===a.charAt(0);a=c?a.substring(1):a,ha[a]=b,V[b]=null,da[b]=c}),n(ea.contents(),function(a){var b=ha[va(ra(a))];b?(da[b]=!0,V[b]=V[b]||[],V[b].push(a)):G.push(a)}),n(da,function(a,b){if(!a)throw ja("reqslot",b)});for(var ga in V)V[ga]&&(V[ga]=ac(Fb,V[ga],e))}ea.empty(),ya=ac(Fb,G,e,v,v,{needsNewScope:J.$$isolateScope||J.$$newScope}),ya.$$slots=V}if(J.template)if(la=!0,Wa("template",$,J,ea),$=J,fa=D(J.template)?J.template(ea,d):J.template,fa=qa(fa),J.replace){if(g=J,G=Wb.test(fa)?Zc(U(J.templateNamespace,X(fa))):[],b=G[0],1!=G.length||1!==b.nodeType)throw ja("tplrt",H,"");aa(f,ea,b),Va={$attr:{}},fa=ma(b,[],Va);var oa=a.splice(R+1,a.length-(R+1));(P||Q)&&$c(fa,P,Q),a=a.concat(fa).concat(oa),ad(d,Va),Va=a.length}else ea.html(fa);if(J.templateUrl)la=!0,Wa("template",$,J,ea),$=J,J.replace&&(g=J),u=$f(a.splice(R,a.length-R),ea,d,f,z&&ya,h,l,{controllerDirectives:I,newScopeDirective:Q!==J&&Q,newIsolateScopeDirective:P,templateDirective:$,nonTlbTranscludeDirective:S}),Va=a.length;else if(J.compile)try{O=J.compile(ea,d,ya),D(O)?p(null,O,Y,ba):O&&p(O.pre,O.post,Y,ba)}catch(pa){c(pa,ta(ea))}J.terminal&&(u.terminal=!0,t=Math.max(t,J.priority))}return u.scope=Q&&!0===Q.scope,u.transcludeOnThisElement=z,u.templateOnThisElement=la,u.transclude=ya,m.hasElementTranscludeDirective=B,u}function $c(a,b,c){for(var d=0,e=a.length;d<e;d++)a[d]=Sb(a[d],{$$isolateScope:b,$$newScope:c})}function H(b,d,f,g,h,k,l){if(d===h)return null;if(h=null,e.hasOwnProperty(d)){var m;d=a.get(d+"Directive");for(var p=0,A=d.length;p<A;p++)try{m=d[p],(x(g)||g>m.priority)&&-1!=m.restrict.indexOf(f)&&(k&&(m=Sb(m,{$$start:k,$$end:l})),b.push(m),h=m)}catch(t){c(t)}}return h}function O(b){if(e.hasOwnProperty(b))for(var c=a.get(b+"Directive"),d=0,f=c.length;d<f;d++)if(b=c[d],b.multiElement)return!0;return!1}function ad(a,b){var c=b.$attr,d=a.$attr,e=a.$$element;n(a,function(d,e){"$"!=e.charAt(0)&&(b[e]&&b[e]!==d&&(d+=("style"===e?";":" ")+b[e]),a.$set(e,d,!0,c[e]))}),n(b,function(b,f){"class"==f?($(e,b),a.class=(a.class?a.class+" ":"")+b):"style"==f?(e.attr("style",e.attr("style")+";"+b),a.style=(a.style?a.style+";":"")+b):"$"==f.charAt(0)||a.hasOwnProperty(f)||(a[f]=b,d[f]=c[f])})}function $f(a,b,c,e,f,g,h,k){var m,p,l=[],s=b[0],A=a.shift(),u=Sb(A,{templateUrl:null,transclude:null,replace:null,$$originalDirective:A}),w=D(A.templateUrl)?A.templateUrl(b,c):A.templateUrl,Q=A.templateNamespace;return b.empty(),d(w).then(function(d){var t,I;if(d=qa(d),A.replace){if(d=Wb.test(d)?Zc(U(Q,X(d))):[],t=d[0],1!=d.length||1!==t.nodeType)throw ja("tplrt",A.name,w);d={$attr:{}},aa(e,b,t);var M=ma(t,[],d);E(A.scope)&&$c(M,!0),a=M.concat(a),ad(c,d)}else t=s,b.html(d);for(a.unshift(u),m=y(a,t,c,f,b,A,g,h,k),n(e,function(a,c){a==t&&(e[c]=b[0])}),p=P(b[0].childNodes,f);l.length;){d=l.shift(),I=l.shift();var z=l.shift(),K=l.shift(),M=b[0];if(!d.$$destroyed){if(I!==s){var la=I.className;k.hasElementTranscludeDirective&&A.replace||(M=Yb(t)),aa(z,C(I),M),$(C(M),la)}I=m.transcludeOnThisElement?S(d,m.transclude,K):K,m(p,d,M,e,I)}}l=null}),function(a,b,c,d,e){a=e,b.$$destroyed||(l?l.push(b,c,d,a):(m.transcludeOnThisElement&&(a=S(b,m.transclude,e)),m(p,b,c,d,a)))}}function ya(a,b){var c=b.priority-a.priority;return 0!==c?c:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function Wa(a,b,c,d){function e(a){return a?" (module: "+a+")":""}if(b)throw ja("multidir",b.name,e(b.$$moduleName),c.name,e(c.$$moduleName),a,ta(d))}function N(a,c){var d=b(c,!0);d&&a.push({priority:0,compile:function(a){a=a.parent();var b=!!a.length;return b&&M.$$addBindingClass(a),function(a,c){var e=c.parent();b||M.$$addBindingClass(e),M.$$addBindingInfo(e,d.expressions),a.$watch(d,function(a){c[0].nodeValue=a})}}})}function U(a,b){switch(a=G(a||"html")){case"svg":case"math":var c=W.createElement("div");return c.innerHTML="<"+a+">"+b+"</"+a+">",c.childNodes[0].childNodes;default:return b}}function R(a,b){if("srcdoc"==b)return la.HTML;var c=ra(a);return"xlinkHref"==b||"form"==c&&"action"==b||"img"!=c&&("src"==b||"ngSrc"==b)?la.RESOURCE_URL:void 0}function Y(a,c,d,e,f){var g=R(a,e);f=h[e]||f;var k=b(d,!0,g,f);if(k){if("multiple"===e&&"select"===ra(a))throw ja("selmulti",ta(a));c.push({priority:100,compile:function(){return{pre:function(a,c,h){if(c=h.$$observers||(h.$$observers=Z()),l.test(e))throw ja("nodomevents");var m=h[e];m!==d&&(k=m&&b(m,!0,g,f),d=m),k&&(h[e]=k(a),(c[e]||(c[e]=[])).$$inter=!0,(h.$$observers&&h.$$observers[e].$$scope||a).$watch(k,function(a,b){"class"===e&&a!=b?h.$updateClass(a,b):h.$set(e,a)}))}}}})}}function aa(a,b,c){var g,h,d=b[0],e=b.length,f=d.parentNode;if(a)for(g=0,h=a.length;g<h;g++)if(a[g]==d){a[g++]=c,h=g+e-1;for(var k=a.length;g<k;g++,h++)h<k?a[g]=a[h]:delete a[g];a.length-=e-1,a.context===d&&(a.context=c);break}for(f&&f.replaceChild(c,d),a=W.createDocumentFragment(),g=0;g<e;g++)a.appendChild(b[g]);for(C.hasData(d)&&(C.data(c,C.data(d)),C(d).off("$destroy")),C.cleanData(a.querySelectorAll("*")),g=1;g<e;g++)delete b[g];b[0]=c,b.length=1}function ca(a,b){return T(function(){return a.apply(null,arguments)},a,b)}function ka(a,b,d,e,f,g){try{a(b,d,e,f,g)}catch(h){c(h,ta(d))}}function ia(a,c,d,e,f){var g=[];return n(e,function(e,h){var m,A,s,t,k=e.attrName,l=e.optional;switch(e.mode){case"@":l||sa.call(c,k)||(d[h]=c[k]=void 0),c.$observe(k,function(a){F(a)&&(d[h]=a)}),c.$$observers[k].$$scope=a,m=c[k],F(m)?d[h]=b(m)(a):Na(m)&&(d[h]=m);break;case"=":if(!sa.call(c,k)){if(l)break;c[k]=void 0}if(l&&!c[k])break;A=p(c[k]),t=A.literal?oa:function(a,b){return a===b||a!==a&&b!==b},s=A.assign||function(){throw m=d[h]=A(a),ja("nonassign",c[k],k,f.name)},m=d[h]=A(a),l=function(b){return t(b,d[h])||(t(b,m)?s(a,b=d[h]):d[h]=b),m=b},l.$stateful=!0,l=e.collection?a.$watchCollection(c[k],l):a.$watch(p(c[k],l),null,A.literal),g.push(l);break;case"<":if(!sa.call(c,k)){if(l)break;c[k]=void 0}if(l&&!c[k])break;A=p(c[k]),d[h]=A(a),l=a.$watch(A,function(a){d[h]=a},A.literal),g.push(l);break;case"&":if((A=c.hasOwnProperty(k)?p(c[k]):B)===B&&l)break;d[h]=function(b){return A(a,b)}}}),g.length&&function(){for(var a=0,b=g.length;a<b;++a)g[a]()}}var V=/^\w/,ba=W.createElement("div"),na=function(a,b){if(b){var d,e,f,c=Object.keys(b);for(d=0,e=c.length;d<e;d++)f=c[d],this[f]=b[f]}else this.$attr={};this.$$element=a};na.prototype={$normalize:va,$addClass:function(a){a&&0<a.length&&z.addClass(this.$$element,a)},$removeClass:function(a){a&&0<a.length&&z.removeClass(this.$$element,a)},$updateClass:function(a,b){var c=bd(a,b);c&&c.length&&z.addClass(this.$$element,c),(c=bd(b,a))&&c.length&&z.removeClass(this.$$element,c)},$set:function(a,b,d,e){var f=Tc(this.$$element[0],a),g=cd[a],h=a;if(f?(this.$$element.prop(a,b),e=f):g&&(this[g]=b,h=g),this[a]=b,e?this.$attr[a]=e:(e=this.$attr[a])||(this.$attr[a]=e=Bc(a,"-")),"a"===(f=ra(this.$$element))&&("href"===a||"xlinkHref"===a)||"img"===f&&"src"===a)this[a]=b=A(b,"src"===a);else if("img"===f&&"srcset"===a){for(var f="",g=X(b),k=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,k=/\s/.test(g)?k:/(,)/,g=g.split(k),k=Math.floor(g.length/2),l=0;l<k;l++)var m=2*l,f=f+A(X(g[m]),!0),f=f+" "+X(g[m+1]);g=X(g[2*l]).split(/\s/),f+=A(X(g[0]),!0),2===g.length&&(f+=" "+X(g[1])),this[a]=b=f}!1!==d&&(null===b||x(b)?this.$$element.removeAttr(e):V.test(e)?this.$$element.attr(e,b):Q(this.$$element[0],e,b)),(a=this.$$observers)&&n(a[h],function(a){try{a(b)}catch(d){c(d)}})},$observe:function(a,b){var c=this,d=c.$$observers||(c.$$observers=Z()),e=d[a]||(d[a]=[]);return e.push(b),u.$evalAsync(function(){e.$$inter||!c.hasOwnProperty(a)||x(c[a])||b(c[a])}),function(){cb(e,b)}}};var ha=b.startSymbol(),da=b.endSymbol(),qa="{{"==ha&&"}}"==da?ab:function(a){return a.replace(/\{\{/g,ha).replace(/}}/g,da)},pa=/^ngAttr[A-Z]/,ua=/^(.+)Start$/;return M.$$addBindingInfo=m?function(a,b){var c=a.data("$binding")||[];L(b)?c=c.concat(b):c.push(b),a.data("$binding",c)}:B,M.$$addBindingClass=m?function(a){$(a,"ng-binding")}:B,M.$$addScopeInfo=m?function(a,b,c,d){a.data(c?d?"$isolateScopeNoTemplate":"$isolateScope":"$scope",b)}:B,M.$$addScopeClass=m?function(a,b){$(a,b?"ng-isolate-scope":"ng-scope")}:B,M}]}function va(a){return gb(a.replace(Xc,""))}function bd(a,b){var d="",c=a.split(/\s+/),e=b.split(/\s+/),f=0;a:for(;f<c.length;f++){for(var g=c[f],h=0;h<e.length;h++)if(g==e[h])continue a;d+=(0<d.length?" ":"")+g}return d}function Zc(a){a=C(a);var b=a.length;if(1>=b)return a;for(;b--;)8===a[b].nodeType&&ag.call(a,b,1);return a}function Wc(a,b){if(b&&F(b))return b;if(F(a)){var d=dd.exec(a);if(d)return d[3]}}function ff(){var a={},b=!1;this.register=function(b,c){Ta(b,"controller"),E(b)?T(a,b):a[b]=c},this.allowGlobals=function(){b=!0},this.$get=["$injector","$window",function(d,c){function e(a,b,c,d){if(!a||!E(a.$scope))throw H("$controller")("noscp",d,b);a.$scope[b]=c}return function(f,g,h,k){var l,m,r;if(h=!0===h,k&&F(k)&&(r=k),F(f)){if(!(k=f.match(dd)))throw bg("ctrlfmt",f);m=k[1],r=r||k[3],f=a.hasOwnProperty(m)?a[m]:Dc(g.$scope,m,!0)||(b?Dc(c,m,!0):v),Sa(f,m,!0)}return h?(h=(L(f)?f[f.length-1]:f).prototype,l=Object.create(h||null),r&&e(g,r,l,m||f.name),T(function(){var a=d.invoke(f,l,g,m);return a!==l&&(E(a)||D(a))&&(l=a,r&&e(g,r,l,m||f.name)),l},{instance:l,identifier:r})):(l=d.instantiate(f,g,m),r&&e(g,r,l,m||f.name),l)}}]}function gf(){this.$get=["$window",function(a){return C(a.document)}]}function hf(){this.$get=["$log",function(a){return function(b,d){a.error.apply(a,arguments)}}]}function bc(a){return E(a)?V(a)?a.toISOString():eb(a):a}function nf(){this.$get=function(){return function(a){if(!a)return"";var b=[];return rc(a,function(a,c){null===a||x(a)||(L(a)?n(a,function(a,d){b.push(ha(c)+"="+ha(bc(a)))}):b.push(ha(c)+"="+ha(bc(a))))}),b.join("&")}}}function of(){this.$get=function(){return function(a){function b(a,e,f){null===a||x(a)||(L(a)?n(a,function(a,c){b(a,e+"["+(E(a)?c:"")+"]")}):E(a)&&!V(a)?rc(a,function(a,c){b(a,e+(f?"":"[")+c+(f?"":"]"))}):d.push(ha(e)+"="+ha(bc(a))))}if(!a)return"";var d=[];return b(a,"",!0),d.join("&")}}}function cc(a,b){if(F(a)){var d=a.replace(cg,"").trim();if(d){var c=b("Content-Type");(c=c&&0===c.indexOf(ed))||(c=(c=d.match(dg))&&eg[c[0]].test(d)),c&&(a=wc(d))}}return a}function fd(a){var d,b=Z();return F(a)?n(a.split("\n"),function(a){d=a.indexOf(":");var e=G(X(a.substr(0,d)));a=X(a.substr(d+1)),e&&(b[e]=b[e]?b[e]+", "+a:a)}):E(a)&&n(a,function(a,d){var f=G(d),g=X(a);f&&(b[f]=b[f]?b[f]+", "+g:g)}),b}function gd(a){var b;return function(d){return b||(b=fd(a)),d?(d=b[G(d)],void 0===d&&(d=null),d):b}}function hd(a,b,d,c){return D(c)?c(a,b,d):(n(c,function(c){a=c(a,b,d)}),a)}function mf(){var a=this.defaults={transformResponse:[cc],transformRequest:[function(a){return E(a)&&"[object File]"!==ga.call(a)&&"[object Blob]"!==ga.call(a)&&"[object FormData]"!==ga.call(a)?eb(a):a}],headers:{common:{Accept:"application/json, text/plain, */*"},post:na(dc),put:na(dc),patch:na(dc)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",paramSerializer:"$httpParamSerializer"},b=!1;this.useApplyAsync=function(a){return y(a)?(b=!!a,this):b};var d=!0;this.useLegacyPromiseExtensions=function(a){return y(a)?(d=!!a,this):d};var c=this.interceptors=[];this.$get=["$httpBackend","$$cookieReader","$cacheFactory","$rootScope","$q","$injector",function(e,f,g,h,k,l){function m(b){function c(a){var b=T({},a);return b.data=hd(a.data,a.headers,a.status,f.transformResponse),a=a.status,200<=a&&300>a?b:k.reject(b)}function e(a,b){var c,d={};return n(a,function(a,e){D(a)?null!=(c=a(b))&&(d[e]=c):d[e]=a}),d}if(!E(b))throw H("$http")("badreq",b);if(!F(b.url))throw H("$http")("badreq",b.url);var f=T({method:"get",transformRequest:a.transformRequest,transformResponse:a.transformResponse,paramSerializer:a.paramSerializer},b);f.headers=function(b){var f,g,h,c=a.headers,d=T({},b.headers),c=T({},c.common,c[G(b.method)]);a:for(f in c){g=G(f);for(h in d)if(G(h)===g)continue a;d[f]=c[f]}return e(d,na(b))}(b),f.method=ub(f.method),f.paramSerializer=F(f.paramSerializer)?l.get(f.paramSerializer):f.paramSerializer;var g=[function(b){var d=b.headers,e=hd(b.data,gd(d),v,b.transformRequest);return x(e)&&n(d,function(a,b){"content-type"===G(b)&&delete d[b]}),x(b.withCredentials)&&!x(a.withCredentials)&&(b.withCredentials=a.withCredentials),r(b,e).then(c,c)},v],h=k.when(f);for(n(K,function(a){(a.request||a.requestError)&&g.unshift(a.request,a.requestError),(a.response||a.responseError)&&g.push(a.response,a.responseError)});g.length;){b=g.shift();var m=g.shift(),h=h.then(b,m)}return d?(h.success=function(a){return Sa(a,"fn"),h.then(function(b){a(b.data,b.status,b.headers,f)}),h},h.error=function(a){return Sa(a,"fn"),h.then(null,function(b){a(b.data,b.status,b.headers,f)}),h}):(h.success=id("success"),h.error=id("error")),h}function r(c,d){function g(a,c,d,e){function f(){l(c,a,d,e)}
K&&(200<=a&&300>a?K.put(S,[a,c,fd(d),e]):K.remove(S)),b?h.$applyAsync(f):(f(),h.$$phase||h.$apply())}function l(a,b,d,e){b=-1<=b?b:0,(200<=b&&300>b?A.resolve:A.reject)({data:a,status:b,headers:gd(d),config:c,statusText:e})}function r(a){l(a.data,a.status,na(a.headers()),a.statusText)}function z(){var a=m.pendingRequests.indexOf(c);-1!==a&&m.pendingRequests.splice(a,1)}var K,M,A=k.defer(),Q=A.promise,P=c.headers,S=s(c.url,c.paramSerializer(c.params));return m.pendingRequests.push(c),Q.then(z,z),!c.cache&&!a.cache||!1===c.cache||"GET"!==c.method&&"JSONP"!==c.method||(K=E(c.cache)?c.cache:E(a.cache)?a.cache:I),K&&(M=K.get(S),y(M)?M&&D(M.then)?M.then(r,r):L(M)?l(M[1],M[0],na(M[2]),M[3]):l(M,200,{},"OK"):K.put(S,Q)),x(M)&&((M=jd(c.url)?f()[c.xsrfCookieName||a.xsrfCookieName]:v)&&(P[c.xsrfHeaderName||a.xsrfHeaderName]=M),e(c.method,S,d,g,P,c.timeout,c.withCredentials,c.responseType)),Q}function s(a,b){return 0<b.length&&(a+=(-1==a.indexOf("?")?"?":"&")+b),a}var I=g("$http");a.paramSerializer=F(a.paramSerializer)?l.get(a.paramSerializer):a.paramSerializer;var K=[];return n(c,function(a){K.unshift(F(a)?l.get(a):l.invoke(a))}),m.pendingRequests=[],function(a){n(arguments,function(a){m[a]=function(b,c){return m(T({},c||{},{method:a,url:b}))}})}("get","delete","head","jsonp"),function(a){n(arguments,function(a){m[a]=function(b,c,d){return m(T({},d||{},{method:a,url:b,data:c}))}})}("post","put","patch"),m.defaults=a,m}]}function qf(){this.$get=function(){return function(){return new O.XMLHttpRequest}}}function pf(){this.$get=["$browser","$window","$document","$xhrFactory",function(a,b,d,c){return fg(a,c,a.defer,b.angular.callbacks,d[0])}]}function fg(a,b,d,c,e){function f(a,b,d){var f=e.createElement("script"),m=null;return f.type="text/javascript",f.src=a,f.async=!0,m=function(a){f.removeEventListener("load",m,!1),f.removeEventListener("error",m,!1),e.body.removeChild(f),f=null;var g=-1,I="unknown";a&&("load"!==a.type||c[b].called||(a={type:"error"}),I=a.type,g="error"===a.type?404:200),d&&d(g,I)},f.addEventListener("load",m,!1),f.addEventListener("error",m,!1),e.body.appendChild(f),m}return function(e,h,k,l,m,r,s,I){function K(){w&&w(),u&&u.abort()}function t(b,c,e,f,g){y(z)&&d.cancel(z),w=u=null,b(c,e,f,g),a.$$completeOutstandingRequest(B)}if(a.$$incOutstandingRequestCount(),h=h||a.url(),"jsonp"==G(e)){var p="_"+(c.counter++).toString(36);c[p]=function(a){c[p].data=a,c[p].called=!0};var w=f(h.replace("JSON_CALLBACK","angular.callbacks."+p),p,function(a,b){t(l,a,c[p].data,"",b),c[p]=B})}else{var u=b(e,h);if(u.open(e,h,!0),n(m,function(a,b){y(a)&&u.setRequestHeader(b,a)}),u.onload=function(){var a=u.statusText||"",b="response"in u?u.response:u.responseText,c=1223===u.status?204:u.status;0===c&&(c=b?200:"file"==za(h).protocol?404:0),t(l,c,b,u.getAllResponseHeaders(),a)},e=function(){t(l,-1,null,null,"")},u.onerror=e,u.onabort=e,s&&(u.withCredentials=!0),I)try{u.responseType=I}catch(la){if("json"!==I)throw la}u.send(x(k)?null:k)}if(0<r)var z=d(K,r);else r&&D(r.then)&&r.then(K)}}function kf(){var a="{{",b="}}";this.startSymbol=function(b){return b?(a=b,this):a},this.endSymbol=function(a){return a?(b=a,this):b},this.$get=["$parse","$exceptionHandler","$sce",function(d,c,e){function f(a){return"\\\\\\"+a}function g(c){return c.replace(r,a).replace(s,b)}function h(a,b,c,d){var e;return e=a.$watch(function(a){return e(),d(a)},b,c)}function k(f,k,r,p){function s(a){try{var b=a;a=r?e.getTrusted(r,b):e.valueOf(b);var d;if(p&&!y(a))d=a;else if(null==a)d="";else{switch(typeof a){case"string":break;case"number":a=""+a;break;default:a=eb(a)}d=a}return d}catch(g){c(Ka.interr(f,g))}}if(!f.length||-1===f.indexOf(a)){var u;return k||(k=g(f),u=ba(k),u.exp=f,u.expressions=[],u.$$watchDelegate=h),u}p=!!p;var n,z,A=0,Q=[],$=[];u=f.length;for(var M=[],P=[];A<u;){if(-1==(n=f.indexOf(a,A))||-1==(z=f.indexOf(b,n+l))){A!==u&&M.push(g(f.substring(A)));break}A!==n&&M.push(g(f.substring(A,n))),A=f.substring(n+l,z),Q.push(A),$.push(d(A,s)),A=z+m,P.push(M.length),M.push("")}if(r&&1<M.length&&Ka.throwNoconcat(f),!k||Q.length){var S=function(a){for(var b=0,c=Q.length;b<c;b++){if(p&&x(a[b]))return;M[P[b]]=a[b]}return M.join("")};return T(function(a){var b=0,d=Q.length,e=Array(d);try{for(;b<d;b++)e[b]=$[b](a);return S(e)}catch(g){c(Ka.interr(f,g))}},{exp:f,expressions:Q,$$watchDelegate:function(a,b){var c;return a.$watchGroup($,function(d,e){var f=S(d);D(b)&&b.call(this,f,d!==e?c:f,a),c=f})}})}}var l=a.length,m=b.length,r=new RegExp(a.replace(/./g,f),"g"),s=new RegExp(b.replace(/./g,f),"g");return k.startSymbol=function(){return a},k.endSymbol=function(){return b},k}]}function lf(){this.$get=["$rootScope","$window","$q","$$q","$browser",function(a,b,d,c,e){function f(f,k,l,m){function r(){s?f.apply(null,I):f(p)}var s=4<arguments.length,I=s?wa.call(arguments,4):[],K=b.setInterval,t=b.clearInterval,p=0,w=y(m)&&!m,u=(w?c:d).defer(),n=u.promise;return l=y(l)?l:0,n.$$intervalId=K(function(){w?e.defer(r):a.$evalAsync(r),u.notify(p++),0<l&&p>=l&&(u.resolve(p),t(n.$$intervalId),delete g[n.$$intervalId]),w||a.$apply()},k),g[n.$$intervalId]=u,n}var g={};return f.cancel=function(a){return!!(a&&a.$$intervalId in g)&&(g[a.$$intervalId].reject("canceled"),b.clearInterval(a.$$intervalId),delete g[a.$$intervalId],!0)},f}]}function ec(a){a=a.split("/");for(var b=a.length;b--;)a[b]=qb(a[b]);return a.join("/")}function kd(a,b){var d=za(a);b.$$protocol=d.protocol,b.$$host=d.hostname,b.$$port=ca(d.port)||gg[d.protocol]||null}function ld(a,b){var d="/"!==a.charAt(0);d&&(a="/"+a);var c=za(a);b.$$path=decodeURIComponent(d&&"/"===c.pathname.charAt(0)?c.pathname.substring(1):c.pathname),b.$$search=zc(c.search),b.$$hash=decodeURIComponent(c.hash),b.$$path&&"/"!=b.$$path.charAt(0)&&(b.$$path="/"+b.$$path)}function pa(a,b){if(0===b.indexOf(a))return b.substr(a.length)}function Ia(a){var b=a.indexOf("#");return-1==b?a:a.substr(0,b)}function kb(a){return a.replace(/(#.+)|#$/,"$1")}function fc(a,b,d){this.$$html5=!0,d=d||"",kd(a,this),this.$$parse=function(a){var d=pa(b,a);if(!F(d))throw Gb("ipthprfx",a,b);ld(d,this),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var a=Ub(this.$$search),d=this.$$hash?"#"+qb(this.$$hash):"";this.$$url=ec(this.$$path)+(a?"?"+a:"")+d,this.$$absUrl=b+this.$$url.substr(1)},this.$$parseLinkUrl=function(c,e){if(e&&"#"===e[0])return this.hash(e.slice(1)),!0;var f,g;return y(f=pa(a,c))?(g=f,g=y(f=pa(d,f))?b+(pa("/",f)||f):a+g):y(f=pa(b,c))?g=b+f:b==c+"/"&&(g=b),g&&this.$$parse(g),!!g}}function gc(a,b,d){kd(a,this),this.$$parse=function(c){var f,e=pa(a,c)||pa(b,c);x(e)||"#"!==e.charAt(0)?this.$$html5?f=e:(f="",x(e)&&(a=c,this.replace())):(f=pa(d,e),x(f)&&(f=e)),ld(f,this),c=this.$$path;var e=a,g=/^\/[A-Z]:(\/.*)/;0===f.indexOf(e)&&(f=f.replace(e,"")),g.exec(f)||(c=(f=g.exec(c))?f[1]:c),this.$$path=c,this.$$compose()},this.$$compose=function(){var b=Ub(this.$$search),e=this.$$hash?"#"+qb(this.$$hash):"";this.$$url=ec(this.$$path)+(b?"?"+b:"")+e,this.$$absUrl=a+(this.$$url?d+this.$$url:"")},this.$$parseLinkUrl=function(b,d){return Ia(a)==Ia(b)&&(this.$$parse(b),!0)}}function md(a,b,d){this.$$html5=!0,gc.apply(this,arguments),this.$$parseLinkUrl=function(c,e){if(e&&"#"===e[0])return this.hash(e.slice(1)),!0;var f,g;return a==Ia(c)?f=c:(g=pa(b,c))?f=a+d+g:b===c+"/"&&(f=b),f&&this.$$parse(f),!!f},this.$$compose=function(){var b=Ub(this.$$search),e=this.$$hash?"#"+qb(this.$$hash):"";this.$$url=ec(this.$$path)+(b?"?"+b:"")+e,this.$$absUrl=a+d+this.$$url}}function Hb(a){return function(){return this[a]}}function nd(a,b){return function(d){return x(d)?this[a]:(this[a]=b(d),this.$$compose(),this)}}function rf(){var a="",b={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(b){return y(b)?(a=b,this):a},this.html5Mode=function(a){return Na(a)?(b.enabled=a,this):E(a)?(Na(a.enabled)&&(b.enabled=a.enabled),Na(a.requireBase)&&(b.requireBase=a.requireBase),Na(a.rewriteLinks)&&(b.rewriteLinks=a.rewriteLinks),this):b},this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function(d,c,e,f,g){function h(a,b,d){var e=l.url(),f=l.$$state;try{c.url(a,b,d),l.$$state=c.state()}catch(g){throw l.url(e),l.$$state=f,g}}function k(a,b){d.$broadcast("$locationChangeSuccess",l.absUrl(),a,l.$$state,b)}var l,m;m=c.baseHref();var s,r=c.url();if(b.enabled){if(!m&&b.requireBase)throw Gb("nobase");s=r.substring(0,r.indexOf("/",r.indexOf("//")+2))+(m||"/"),m=e.history?fc:md}else s=Ia(r),m=gc;var I=s.substr(0,Ia(s).lastIndexOf("/")+1);l=new m(s,I,"#"+a),l.$$parseLinkUrl(r,r),l.$$state=c.state();var n=/^\s*(javascript|mailto):/i;f.on("click",function(a){if(b.rewriteLinks&&!a.ctrlKey&&!a.metaKey&&!a.shiftKey&&2!=a.which&&2!=a.button){for(var e=C(a.target);"a"!==ra(e[0]);)if(e[0]===f[0]||!(e=e.parent())[0])return;var h=e.prop("href"),k=e.attr("href")||e.attr("xlink:href");E(h)&&"[object SVGAnimatedString]"===h.toString()&&(h=za(h.animVal).href),n.test(h)||!h||e.attr("target")||a.isDefaultPrevented()||!l.$$parseLinkUrl(h,k)||(a.preventDefault(),l.absUrl()!=c.url()&&(d.$apply(),g.angular["ff-684208-preventDefault"]=!0))}}),kb(l.absUrl())!=kb(r)&&c.url(l.absUrl(),!0);var t=!0;return c.onUrlChange(function(a,b){x(pa(I,a))?g.location.href=a:(d.$evalAsync(function(){var f,c=l.absUrl(),e=l.$$state;a=kb(a),l.$$parse(a),l.$$state=b,f=d.$broadcast("$locationChangeStart",a,c,b,e).defaultPrevented,l.absUrl()===a&&(f?(l.$$parse(c),l.$$state=e,h(c,!1,e)):(t=!1,k(c,e)))}),d.$$phase||d.$digest())}),d.$watch(function(){var a=kb(c.url()),b=kb(l.absUrl()),f=c.state(),g=l.$$replace,m=a!==b||l.$$html5&&e.history&&f!==l.$$state;(t||m)&&(t=!1,d.$evalAsync(function(){var b=l.absUrl(),c=d.$broadcast("$locationChangeStart",b,a,l.$$state,f).defaultPrevented;l.absUrl()===b&&(c?(l.$$parse(a),l.$$state=f):(m&&h(b,g,f===l.$$state?null:l.$$state),k(a,f)))})),l.$$replace=!1}),l}]}function sf(){var a=!0,b=this;this.debugEnabled=function(b){return y(b)?(a=b,this):a},this.$get=["$window",function(d){function c(a){return a instanceof Error&&(a.stack?a=a.message&&-1===a.stack.indexOf(a.message)?"Error: "+a.message+"\n"+a.stack:a.stack:a.sourceURL&&(a=a.message+"\n"+a.sourceURL+":"+a.line)),a}function e(a){var b=d.console||{},e=b[a]||b.log||B;a=!1;try{a=!!e.apply}catch(k){}return a?function(){var a=[];return n(arguments,function(b){a.push(c(b))}),e.apply(b,a)}:function(a,b){e(a,null==b?"":b)}}return{log:e("log"),info:e("info"),warn:e("warn"),error:e("error"),debug:function(){var c=e("debug");return function(){a&&c.apply(b,arguments)}}()}}]}function Xa(a,b){if("__defineGetter__"===a||"__defineSetter__"===a||"__lookupGetter__"===a||"__lookupSetter__"===a||"__proto__"===a)throw ka("isecfld",b);return a}function hg(a){return a+""}function Aa(a,b){if(a){if(a.constructor===a)throw ka("isecfn",b);if(a.window===a)throw ka("isecwindow",b);if(a.children&&(a.nodeName||a.prop&&a.attr&&a.find))throw ka("isecdom",b);if(a===Object)throw ka("isecobj",b)}return a}function od(a,b){if(a){if(a.constructor===a)throw ka("isecfn",b);if(a===ig||a===jg||a===kg)throw ka("isecff",b)}}function Ib(a,b){if(a&&(a===(0).constructor||a===(!1).constructor||a==="".constructor||a==={}.constructor||a===[].constructor||a===Function.constructor))throw ka("isecaf",b)}function lg(a,b){return void 0!==a?a:b}function pd(a,b){return void 0===a?b:void 0===b?a:a+b}function R(a,b){var d,c;switch(a.type){case q.Program:d=!0,n(a.body,function(a){R(a.expression,b),d=d&&a.expression.constant}),a.constant=d;break;case q.Literal:a.constant=!0,a.toWatch=[];break;case q.UnaryExpression:R(a.argument,b),a.constant=a.argument.constant,a.toWatch=a.argument.toWatch;break;case q.BinaryExpression:R(a.left,b),R(a.right,b),a.constant=a.left.constant&&a.right.constant,a.toWatch=a.left.toWatch.concat(a.right.toWatch);break;case q.LogicalExpression:R(a.left,b),R(a.right,b),a.constant=a.left.constant&&a.right.constant,a.toWatch=a.constant?[]:[a];break;case q.ConditionalExpression:R(a.test,b),R(a.alternate,b),R(a.consequent,b),a.constant=a.test.constant&&a.alternate.constant&&a.consequent.constant,a.toWatch=a.constant?[]:[a];break;case q.Identifier:a.constant=!1,a.toWatch=[a];break;case q.MemberExpression:R(a.object,b),a.computed&&R(a.property,b),a.constant=a.object.constant&&(!a.computed||a.property.constant),a.toWatch=[a];break;case q.CallExpression:d=!!a.filter&&!b(a.callee.name).$stateful,c=[],n(a.arguments,function(a){R(a,b),d=d&&a.constant,a.constant||c.push.apply(c,a.toWatch)}),a.constant=d,a.toWatch=a.filter&&!b(a.callee.name).$stateful?c:[a];break;case q.AssignmentExpression:R(a.left,b),R(a.right,b),a.constant=a.left.constant&&a.right.constant,a.toWatch=[a];break;case q.ArrayExpression:d=!0,c=[],n(a.elements,function(a){R(a,b),d=d&&a.constant,a.constant||c.push.apply(c,a.toWatch)}),a.constant=d,a.toWatch=c;break;case q.ObjectExpression:d=!0,c=[],n(a.properties,function(a){R(a.value,b),d=d&&a.value.constant,a.value.constant||c.push.apply(c,a.value.toWatch)}),a.constant=d,a.toWatch=c;break;case q.ThisExpression:a.constant=!1,a.toWatch=[];break;case q.LocalsExpression:a.constant=!1,a.toWatch=[]}}function qd(a){if(1==a.length){a=a[0].expression;var b=a.toWatch;return 1!==b.length?b:b[0]!==a?b:v}}function rd(a){return a.type===q.Identifier||a.type===q.MemberExpression}function sd(a){if(1===a.body.length&&rd(a.body[0].expression))return{type:q.AssignmentExpression,left:a.body[0].expression,right:{type:q.NGValueParameter},operator:"="}}function td(a){return 0===a.body.length||1===a.body.length&&(a.body[0].expression.type===q.Literal||a.body[0].expression.type===q.ArrayExpression||a.body[0].expression.type===q.ObjectExpression)}function ud(a,b){this.astBuilder=a,this.$filter=b}function vd(a,b){this.astBuilder=a,this.$filter=b}function Jb(a){return"constructor"==a}function hc(a){return D(a.valueOf)?a.valueOf():mg.call(a)}function tf(){var a=Z(),b=Z();this.$get=["$filter",function(d){function c(c,f,r){var u,n,z;switch(r=r||K,typeof c){case"string":z=c=c.trim();var A=r?b:a;if(!(u=A[z])){":"===c.charAt(0)&&":"===c.charAt(1)&&(n=!0,c=c.substring(2)),u=r?I:s;var Q=new ic(u);u=new jc(Q,d,u).parse(c),u.constant?u.$$watchDelegate=l:n?u.$$watchDelegate=u.literal?k:h:u.inputs&&(u.$$watchDelegate=g),r&&(u=e(u)),A[z]=u}return m(u,f);case"function":return m(c,f);default:return m(B,f)}}function e(a){function b(c,d,e,f){var g=K;K=!0;try{return a(c,d,e,f)}finally{K=g}}if(!a)return a;b.$$watchDelegate=a.$$watchDelegate,b.assign=e(a.assign),b.constant=a.constant,b.literal=a.literal;for(var c=0;a.inputs&&c<a.inputs.length;++c)a.inputs[c]=e(a.inputs[c]);return b.inputs=a.inputs,b}function f(a,b){return null==a||null==b?a===b:("object"!=typeof a||"object"!=typeof(a=hc(a)))&&(a===b||a!==a&&b!==b)}function g(a,b,c,d,e){var h,g=d.inputs;if(1===g.length){var k=f,g=g[0];return a.$watch(function(a){var b=g(a);return f(b,k)||(h=d(a,v,v,[b]),k=b&&hc(b)),h},b,c,e)}for(var l=[],m=[],r=0,s=g.length;r<s;r++)l[r]=f,m[r]=null;return a.$watch(function(a){for(var b=!1,c=0,e=g.length;c<e;c++){var k=g[c](a);(b||(b=!f(k,l[c])))&&(m[c]=k,l[c]=k&&hc(k))}return b&&(h=d(a,v,v,m)),h},b,c,e)}function h(a,b,c,d){var e,f;return e=a.$watch(function(a){return d(a)},function(a,c,d){f=a,D(b)&&b.apply(this,arguments),y(a)&&d.$$postDigest(function(){y(f)&&e()})},c)}function k(a,b,c,d){function e(a){var b=!0;return n(a,function(a){y(a)||(b=!1)}),b}var f,g;return f=a.$watch(function(a){return d(a)},function(a,c,d){g=a,D(b)&&b.call(this,a,c,d),e(a)&&d.$$postDigest(function(){e(g)&&f()})},c)}function l(a,b,c,d){var e;return e=a.$watch(function(a){return e(),d(a)},b,c)}function m(a,b){if(!b)return a;var c=a.$$watchDelegate,d=!1,c=c!==k&&c!==h?function(c,e,f,g){return f=d&&g?g[0]:a(c,e,f,g),b(f,c,e)}:function(c,d,e,f){return e=a(c,d,e,f),c=b(e,c,d),y(e)?c:e};return a.$$watchDelegate&&a.$$watchDelegate!==g?c.$$watchDelegate=a.$$watchDelegate:b.$stateful||(c.$$watchDelegate=g,d=!a.inputs,c.inputs=a.inputs?a.inputs:[a]),c}var r=Ea().noUnsafeEval,s={csp:r,expensiveChecks:!1},I={csp:r,expensiveChecks:!0},K=!1;return c.$$runningExpensiveChecks=function(){return K},c}]}function vf(){this.$get=["$rootScope","$exceptionHandler",function(a,b){return wd(function(b){a.$evalAsync(b)},b)}]}function wf(){this.$get=["$browser","$exceptionHandler",function(a,b){return wd(function(b){a.defer(b)},b)}]}function wd(a,b){function d(){this.$$state={status:0}}function c(a,b){return function(c){b.call(a,c)}}function e(c){!c.processScheduled&&c.pending&&(c.processScheduled=!0,a(function(){var a,d,e;e=c.pending,c.processScheduled=!1,c.pending=v;for(var f=0,g=e.length;f<g;++f){d=e[f][0],a=e[f][c.status];try{D(a)?d.resolve(a(c.value)):1===c.status?d.resolve(c.value):d.reject(c.value)}catch(h){d.reject(h),b(h)}}}))}function f(){this.promise=new d}var g=H("$q",TypeError);T(d.prototype,{then:function(a,b,c){if(x(a)&&x(b)&&x(c))return this;var d=new f;return this.$$state.pending=this.$$state.pending||[],this.$$state.pending.push([d,a,b,c]),0<this.$$state.status&&e(this.$$state),d.promise},catch:function(a){return this.then(null,a)},finally:function(a,b){return this.then(function(b){return k(b,!0,a)},function(b){return k(b,!1,a)},b)}}),T(f.prototype,{resolve:function(a){this.promise.$$state.status||(a===this.promise?this.$$reject(g("qcycle",a)):this.$$resolve(a))},$$resolve:function(a){function d(a){k||(k=!0,h.$$resolve(a))}function f(a){k||(k=!0,h.$$reject(a))}var g,h=this,k=!1;try{(E(a)||D(a))&&(g=a&&a.then),D(g)?(this.promise.$$state.status=-1,g.call(a,d,f,c(this,this.notify))):(this.promise.$$state.value=a,this.promise.$$state.status=1,e(this.promise.$$state))}catch(l){f(l),b(l)}},reject:function(a){this.promise.$$state.status||this.$$reject(a)},$$reject:function(a){this.promise.$$state.value=a,this.promise.$$state.status=2,e(this.promise.$$state)},notify:function(c){var d=this.promise.$$state.pending;0>=this.promise.$$state.status&&d&&d.length&&a(function(){for(var a,e,f=0,g=d.length;f<g;f++){e=d[f][0],a=d[f][3];try{e.notify(D(a)?a(c):c)}catch(h){b(h)}}})}});var h=function(a,b){var c=new f;return b?c.resolve(a):c.reject(a),c.promise},k=function(a,b,c){var d=null;try{D(c)&&(d=c())}catch(e){return h(e,!1)}return d&&D(d.then)?d.then(function(){return h(a,b)},function(a){return h(a,!1)}):h(a,b)},l=function(a,b,c,d){var e=new f;return e.resolve(a),e.promise.then(b,c,d)},m=function(a){if(!D(a))throw g("norslvr",a);var b=new f;return a(function(a){b.resolve(a)},function(a){b.reject(a)}),b.promise};return m.prototype=d.prototype,m.defer=function(){var a=new f;return a.resolve=c(a,a.resolve),a.reject=c(a,a.reject),a.notify=c(a,a.notify),a},m.reject=function(a){var b=new f;return b.reject(a),b.promise},m.when=l,m.resolve=l,m.all=function(a){var b=new f,c=0,d=L(a)?[]:{};return n(a,function(a,e){c++,l(a).then(function(a){d.hasOwnProperty(e)||(d[e]=a,--c||b.resolve(d))},function(a){d.hasOwnProperty(e)||b.reject(a)})}),0===c&&b.resolve(d),b.promise},m}function Ff(){this.$get=["$window","$timeout",function(a,b){var d=a.requestAnimationFrame||a.webkitRequestAnimationFrame,c=a.cancelAnimationFrame||a.webkitCancelAnimationFrame||a.webkitCancelRequestAnimationFrame,e=!!d,f=e?function(a){var b=d(a);return function(){c(b)}}:function(a){var c=b(a,16.66,!1);return function(){b.cancel(c)}};return f.supported=e,f}]}function uf(){function a(a){function b(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$id=++pb,this.$$ChildScope=null}return b.prototype=a,b}var b=10,d=H("$rootScope"),c=null,e=null;this.digestTtl=function(a){return arguments.length&&(b=a),b},this.$get=["$exceptionHandler","$parse","$browser",function(f,g,h){function k(a){a.currentScope.$$destroyed=!0}function l(a){9===xa&&(a.$$childHead&&l(a.$$childHead),a.$$nextSibling&&l(a.$$nextSibling)),a.$parent=a.$$nextSibling=a.$$prevSibling=a.$$childHead=a.$$childTail=a.$root=a.$$watchers=null}function m(){this.$id=++pb,this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.$root=this,this.$$destroyed=!1,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$$isolateBindings=null}function r(a){if(w.$$phase)throw d("inprog",w.$$phase);w.$$phase=a}function s(a,b){do{a.$$watchersCount+=b}while(a=a.$parent)}function I(a,b,c){do{a.$$listenerCount[c]-=b,0===a.$$listenerCount[c]&&delete a.$$listenerCount[c]}while(a=a.$parent)}function q(){}function t(){for(;z.length;)try{z.shift()()}catch(a){f(a)}e=null}function p(){null===e&&(e=h.defer(function(){w.$apply(t)}))}m.prototype={constructor:m,$new:function(b,c){var d;return c=c||this,b?(d=new m,d.$root=this.$root):(this.$$ChildScope||(this.$$ChildScope=a(this)),d=new this.$$ChildScope),d.$parent=c,d.$$prevSibling=c.$$childTail,c.$$childHead?(c.$$childTail.$$nextSibling=d,c.$$childTail=d):c.$$childHead=c.$$childTail=d,(b||c!=this)&&d.$on("$destroy",k),d},$watch:function(a,b,d,e){var f=g(a);if(f.$$watchDelegate)return f.$$watchDelegate(this,b,d,f,a);var h=this,k=h.$$watchers,l={fn:b,last:q,get:f,exp:e||a,eq:!!d};return c=null,D(b)||(l.fn=B),k||(k=h.$$watchers=[]),k.unshift(l),s(this,1),function(){0<=cb(k,l)&&s(h,-1),c=null}},$watchGroup:function(a,b){function c(){h=!1,k?(k=!1,b(e,e,g)):b(e,d,g)}var d=Array(a.length),e=Array(a.length),f=[],g=this,h=!1,k=!0;if(!a.length){var l=!0;return g.$evalAsync(function(){l&&b(e,e,g)}),function(){l=!1}}return 1===a.length?this.$watch(a[0],function(a,c,f){e[0]=a,d[0]=c,b(e,a===c?e:d,f)}):(n(a,function(a,b){var k=g.$watch(a,function(a,f){e[b]=a,d[b]=f,h||(h=!0,g.$evalAsync(c))});f.push(k)}),function(){for(;f.length;)f.shift()()})},$watchCollection:function(a,b){function c(a){e=a;var b,g,h;if(!x(e)){if(E(e))if(Ca(e))for(f!==r&&(f=r,u=f.length=0,l++),a=e.length,u!==a&&(l++,f.length=u=a),b=0;b<a;b++)h=f[b],g=e[b],h!==h&&g!==g||h===g||(l++,f[b]=g);else{f!==s&&(f=s={},u=0,l++),a=0;for(b in e)sa.call(e,b)&&(a++,g=e[b],h=f[b],b in f?h!==h&&g!==g||h===g||(l++,f[b]=g):(u++,f[b]=g,l++));if(u>a)for(b in l++,f)sa.call(e,b)||(u--,delete f[b])}else f!==e&&(f=e,l++);return l}}c.$stateful=!0;var e,f,h,d=this,k=1<b.length,l=0,m=g(a,c),r=[],s={},p=!0,u=0;return this.$watch(m,function(){if(p?(p=!1,b(e,e,d)):b(e,h,d),k)if(E(e))if(Ca(e)){h=Array(e.length);for(var a=0;a<e.length;a++)h[a]=e[a]}else for(a in h={},e)sa.call(e,a)&&(h[a]=e[a]);else h=e})},$digest:function(){var a,g,k,l,m,s,p,n,z,x,C,I=b,y=[];r("$digest"),h.$$checkUrlChange(),this===w&&null!==e&&(h.defer.cancel(e),t()),c=null;do{for(n=!1,z=this;u.length;){try{C=u.shift(),C.scope.$eval(C.expression,C.locals)}catch(B){f(B)}c=null}a:do{if(s=z.$$watchers)for(p=s.length;p--;)try{if(a=s[p])if(m=a.get,(g=m(z))===(k=a.last)||(a.eq?oa(g,k):"number"==typeof g&&"number"==typeof k&&isNaN(g)&&isNaN(k))){if(a===c){n=!1;break a}}else n=!0,c=a,a.last=a.eq?Oa(g,null):g,l=a.fn,l(g,k===q?g:k,z),5>I&&(x=4-I,y[x]||(y[x]=[]),y[x].push({msg:D(a.exp)?"fn: "+(a.exp.name||a.exp.toString()):a.exp,newVal:g,oldVal:k}))}catch(E){f(E)}if(!(s=z.$$watchersCount&&z.$$childHead||z!==this&&z.$$nextSibling))for(;z!==this&&!(s=z.$$nextSibling);)z=z.$parent}while(z=s);if((n||u.length)&&!I--)throw w.$$phase=null,d("infdig",b,y)}while(n||u.length);for(w.$$phase=null;v.length;)try{v.shift()()}catch(H){f(H)}},$destroy:function(){if(!this.$$destroyed){var a=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this===w&&h.$$applicationDestroyed(),s(this,-this.$$watchersCount);for(var b in this.$$listenerCount)I(this,this.$$listenerCount[b],b);a&&a.$$childHead==this&&(a.$$childHead=this.$$nextSibling),a&&a.$$childTail==this&&(a.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=B,this.$on=this.$watch=this.$watchGroup=function(){return B},this.$$listeners={},this.$$nextSibling=null,l(this)}},$eval:function(a,b){return g(a)(this,b)},$evalAsync:function(a,b){w.$$phase||u.length||h.defer(function(){u.length&&w.$digest()}),u.push({scope:this,expression:g(a),locals:b})},$$postDigest:function(a){v.push(a)},$apply:function(a){try{r("$apply");try{return this.$eval(a)}finally{w.$$phase=null}}catch(b){f(b)}finally{try{w.$digest()}catch(c){throw f(c),c}}},$applyAsync:function(a){function b(){c.$eval(a)}var c=this;a&&z.push(b),a=g(a),p()},$on:function(a,b){var c=this.$$listeners[a];c||(this.$$listeners[a]=c=[]),c.push(b);var d=this;do{d.$$listenerCount[a]||(d.$$listenerCount[a]=0),d.$$listenerCount[a]++}while(d=d.$parent);var e=this;return function(){var d=c.indexOf(b);-1!==d&&(c[d]=null,I(e,1,a))}},$emit:function(a,b){var d,l,m,c=[],e=this,g=!1,h={name:a,targetScope:e,stopPropagation:function(){g=!0},preventDefault:function(){h.defaultPrevented=!0},defaultPrevented:!1},k=db([h],arguments,1);do{for(d=e.$$listeners[a]||c,h.currentScope=e,l=0,m=d.length;l<m;l++)if(d[l])try{d[l].apply(null,k)}catch(r){f(r)}else d.splice(l,1),l--,m--;if(g)return h.currentScope=null,h;e=e.$parent}while(e);return h.currentScope=null,h},$broadcast:function(a,b){var c=this,d=this,e={name:a,targetScope:this,preventDefault:function(){e.defaultPrevented=!0},defaultPrevented:!1};if(!this.$$listenerCount[a])return e;for(var h,k,g=db([e],arguments,1);c=d;){for(e.currentScope=c,d=c.$$listeners[a]||[],h=0,k=d.length;h<k;h++)if(d[h])try{d[h].apply(null,g)}catch(l){f(l)}else d.splice(h,1),h--,k--;if(!(d=c.$$listenerCount[a]&&c.$$childHead||c!==this&&c.$$nextSibling))for(;c!==this&&!(d=c.$$nextSibling);)c=c.$parent}return e.currentScope=null,e}};var w=new m,u=w.$$asyncQueue=[],v=w.$$postDigestQueue=[],z=w.$$applyAsyncQueue=[];return w}]}function ne(){var a=/^\s*(https?|ftp|mailto|tel|file):/,b=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(b){return y(b)?(a=b,this):a},this.imgSrcSanitizationWhitelist=function(a){return y(a)?(b=a,this):b},this.$get=function(){return function(d,c){var f,e=c?b:a;return f=za(d).href,""===f||f.match(e)?d:"unsafe:"+f}}}function ng(a){if("self"===a)return a;if(F(a)){if(-1<a.indexOf("***"))throw Ba("iwcard",a);return a=xd(a).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+a+"$")}if($a(a))return new RegExp("^"+a.source+"$");throw Ba("imatcher")}function yd(a){var b=[];return y(a)&&n(a,function(a){b.push(ng(a))}),b}function yf(){this.SCE_CONTEXTS=qa;var a=["self"],b=[];this.resourceUrlWhitelist=function(b){return arguments.length&&(a=yd(b)),a},this.resourceUrlBlacklist=function(a){return arguments.length&&(b=yd(a)),b},this.$get=["$injector",function(d){function c(a,b){return"self"===a?jd(b):!!a.exec(b.href)}function e(a){var b=function(a){this.$$unwrapTrustedValue=function(){return a}};return a&&(b.prototype=new a),b.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},b.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},b}var f=function(a){throw Ba("unsafe")};d.has("$sanitize")&&(f=d.get("$sanitize"));var g=e(),h={};return h[qa.HTML]=e(g),h[qa.CSS]=e(g),h[qa.URL]=e(g),h[qa.JS]=e(g),h[qa.RESOURCE_URL]=e(h[qa.URL]),{trustAs:function(a,b){var c=h.hasOwnProperty(a)?h[a]:null;if(!c)throw Ba("icontext",a,b);if(null===b||x(b)||""===b)return b;if("string"!=typeof b)throw Ba("itype",a);return new c(b)},getTrusted:function(d,e){if(null===e||x(e)||""===e)return e;var g=h.hasOwnProperty(d)?h[d]:null;if(g&&e instanceof g)return e.$$unwrapTrustedValue();if(d===qa.RESOURCE_URL){var r,s,g=za(e.toString()),n=!1;for(r=0,s=a.length;r<s;r++)if(c(a[r],g)){n=!0;break}if(n)for(r=0,s=b.length;r<s;r++)if(c(b[r],g)){n=!1;break}if(n)return e;throw Ba("insecurl",e.toString())}if(d===qa.HTML)return f(e);throw Ba("unsafe")},valueOf:function(a){return a instanceof g?a.$$unwrapTrustedValue():a}}}]}function xf(){var a=!0;this.enabled=function(b){return arguments.length&&(a=!!b),a},this.$get=["$parse","$sceDelegate",function(b,d){if(a&&8>xa)throw Ba("iequirks");var c=na(qa);c.isEnabled=function(){return a},c.trustAs=d.trustAs,c.getTrusted=d.getTrusted,c.valueOf=d.valueOf,a||(c.trustAs=c.getTrusted=function(a,b){return b},c.valueOf=ab),c.parseAs=function(a,d){var e=b(d);return e.literal&&e.constant?e:b(d,function(b){return c.getTrusted(a,b)})};var e=c.parseAs,f=c.getTrusted,g=c.trustAs;return n(qa,function(a,b){var d=G(b);c[gb("parse_as_"+d)]=function(b){return e(a,b)},c[gb("get_trusted_"+d)]=function(b){return f(a,b)},c[gb("trust_as_"+d)]=function(b){return g(a,b)}}),c}]}function zf(){this.$get=["$window","$document",function(a,b){var g,d={},c=ca((/android (\d+)/.exec(G((a.navigator||{}).userAgent))||[])[1]),e=/Boxee/i.test((a.navigator||{}).userAgent),f=b[0]||{},h=/^(Moz|webkit|ms)(?=[A-Z])/,k=f.body&&f.body.style,l=!1,m=!1;if(k){for(var r in k)if(l=h.exec(r)){g=l[0],g=g.substr(0,1).toUpperCase()+g.substr(1);break}g||(g="WebkitOpacity"in k&&"webkit"),l=!!("transition"in k||g+"Transition"in k),m=!!("animation"in k||g+"Animation"in k),!c||l&&m||(l=F(k.webkitTransition),m=F(k.webkitAnimation))}return{history:!(!a.history||!a.history.pushState||4>c||e),hasEvent:function(a){if("input"===a&&11>=xa)return!1;if(x(d[a])){var b=f.createElement("div");d[a]="on"+a in b}return d[a]},csp:Ea(),vendorPrefix:g,transitions:l,animations:m,android:c}}]}function Bf(){var a;this.httpOptions=function(b){return b?(a=b,this):a},this.$get=["$templateCache","$http","$q","$sce",function(b,d,c,e){function f(g,h){f.totalPendingRequests++,F(g)&&b.get(g)||(g=e.getTrustedResourceUrl(g));var k=d.defaults&&d.defaults.transformResponse;return L(k)?k=k.filter(function(a){return a!==cc}):k===cc&&(k=null),d.get(g,T({cache:b,transformResponse:k},a)).finally(function(){f.totalPendingRequests--}).then(function(a){return b.put(g,a.data),a.data},function(a){if(!h)throw ja("tpload",g,a.status,a.statusText);return c.reject(a)})}return f.totalPendingRequests=0,f}]}function Cf(){this.$get=["$rootScope","$browser","$location",function(a,b,d){return{findBindings:function(a,b,d){a=a.getElementsByClassName("ng-binding");var g=[];return n(a,function(a){var c=ia.element(a).data("$binding");c&&n(c,function(c){d?new RegExp("(^|\\s)"+xd(b)+"(\\s|\\||$)").test(c)&&g.push(a):-1!=c.indexOf(b)&&g.push(a)})}),g},findModels:function(a,b,d){for(var g=["ng-","data-ng-","ng\\:"],h=0;h<g.length;++h){var k=a.querySelectorAll("["+g[h]+"model"+(d?"=":"*=")+'"'+b+'"]');if(k.length)return k}},getLocation:function(){return d.url()},setLocation:function(b){b!==d.url()&&(d.url(b),a.$digest())},whenStable:function(a){b.notifyWhenNoOutstandingRequests(a)}}}]}function Df(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function(a,b,d,c,e){function f(f,k,l){D(f)||(l=k,k=f,f=B);var q,m=wa.call(arguments,3),r=y(l)&&!l,s=(r?c:d).defer(),n=s.promise;return q=b.defer(function(){try{s.resolve(f.apply(null,m))}catch(b){s.reject(b),e(b)}finally{delete g[n.$$timeoutId]}r||a.$apply()},k),n.$$timeoutId=q,g[q]=s,n}var g={};return f.cancel=function(a){return!!(a&&a.$$timeoutId in g)&&(g[a.$$timeoutId].reject("canceled"),delete g[a.$$timeoutId],b.defer.cancel(a.$$timeoutId))},f}]}function za(a){return xa&&(Y.setAttribute("href",a),a=Y.href),Y.setAttribute("href",a),{href:Y.href,protocol:Y.protocol?Y.protocol.replace(/:$/,""):"",host:Y.host,search:Y.search?Y.search.replace(/^\?/,""):"",hash:Y.hash?Y.hash.replace(/^#/,""):"",hostname:Y.hostname,port:Y.port,pathname:"/"===Y.pathname.charAt(0)?Y.pathname:"/"+Y.pathname}}function jd(a){return a=F(a)?za(a):a,a.protocol===zd.protocol&&a.host===zd.host}function Ef(){this.$get=ba(O)}function Ad(a){function b(a){try{return decodeURIComponent(a)}catch(b){return a}}var d=a[0]||{},c={},e="";return function(){var a,g,h,k,l;if((a=d.cookie||"")!==e)for(e=a,a=e.split("; "),c={},h=0;h<a.length;h++)g=a[h],0<(k=g.indexOf("="))&&(l=b(g.substring(0,k)),x(c[l])&&(c[l]=b(g.substring(k+1))));return c}}function If(){this.$get=Ad}function Lc(a){function b(d,c){if(E(d)){var e={};return n(d,function(a,c){e[c]=b(c,a)}),e}return a.factory(d+"Filter",c)}this.register=b,this.$get=["$injector",function(a){return function(b){return a.get(b+"Filter")}}],b("currency",Bd),b("date",Cd),b("filter",og),b("json",pg),b("limitTo",qg),b("lowercase",rg),
b("number",Dd),b("orderBy",Ed),b("uppercase",sg)}function og(){return function(a,b,d){if(!Ca(a)){if(null==a)return a;throw H("filter")("notarray",a)}var c;switch(kc(b)){case"function":break;case"boolean":case"null":case"number":case"string":c=!0;case"object":b=tg(b,d,c);break;default:return a}return Array.prototype.filter.call(a,b)}}function tg(a,b,d){var c=E(a)&&"$"in a;return!0===b?b=oa:D(b)||(b=function(a,b){return!x(a)&&(null===a||null===b?a===b:!(E(b)||E(a)&&!tc(a))&&(a=G(""+a),b=G(""+b),-1!==a.indexOf(b)))}),function(e){return c&&!E(e)?La(e,a.$,b,!1):La(e,a,b,d)}}function La(a,b,d,c,e){var f=kc(a),g=kc(b);if("string"===g&&"!"===b.charAt(0))return!La(a,b.substring(1),d,c);if(L(a))return a.some(function(a){return La(a,b,d,c)});switch(f){case"object":var h;if(c){for(h in a)if("$"!==h.charAt(0)&&La(a[h],b,d,!0))return!0;return!e&&La(a,b,d,!1)}if("object"===g){for(h in b)if(e=b[h],!D(e)&&!x(e)&&(f="$"===h,!La(f?a:a[h],e,d,f,f)))return!1;return!0}return d(a,b);case"function":return!1;default:return d(a,b)}}function kc(a){return null===a?"null":typeof a}function Bd(a){var b=a.NUMBER_FORMATS;return function(a,c,e){return x(c)&&(c=b.CURRENCY_SYM),x(e)&&(e=b.PATTERNS[1].maxFrac),null==a?a:Fd(a,b.PATTERNS[1],b.GROUP_SEP,b.DECIMAL_SEP,e).replace(/\u00A4/g,c)}}function Dd(a){var b=a.NUMBER_FORMATS;return function(a,c){return null==a?a:Fd(a,b.PATTERNS[0],b.GROUP_SEP,b.DECIMAL_SEP,c)}}function ug(a){var d,c,e,f,g,b=0;for(-1<(c=a.indexOf(Gd))&&(a=a.replace(Gd,"")),0<(e=a.search(/e/i))?(0>c&&(c=e),c+=+a.slice(e+1),a=a.substring(0,e)):0>c&&(c=a.length),e=0;a.charAt(e)==lc;e++);if(e==(g=a.length))d=[0],c=1;else{for(g--;a.charAt(g)==lc;)g--;for(c-=e,d=[],f=0;e<=g;e++,f++)d[f]=+a.charAt(e)}return c>Hd&&(d=d.splice(0,Hd-1),b=c-1,c=1),{d:d,e:b,i:c}}function vg(a,b,d,c){var e=a.d,f=e.length-a.i;if(b=x(b)?Math.min(Math.max(d,f),c):+b,d=b+a.i,c=e[d],0<d)e.splice(d);else{a.i=1,e.length=d=b+1;for(var g=0;g<d;g++)e[g]=0}for(5<=c&&e[d-1]++;f<b;f++)e.push(0);(b=e.reduceRight(function(a,b,c,d){return b+=a,d[c]=b%10,Math.floor(b/10)},0))&&(e.unshift(b),a.i++)}function Fd(a,b,d,c,e){if(!F(a)&&!N(a)||isNaN(a))return"";var f=!isFinite(a),g=!1,h=Math.abs(a)+"",k="";if(f)k="";else{for(g=ug(h),vg(g,e,b.minFrac,b.maxFrac),k=g.d,h=g.i,e=g.e,f=[],g=k.reduce(function(a,b){return a&&!b},!0);0>h;)k.unshift(0),h++;for(0<h?f=k.splice(h):(f=k,k=[0]),h=[],k.length>b.lgSize&&h.unshift(k.splice(-b.lgSize).join(""));k.length>b.gSize;)h.unshift(k.splice(-b.gSize).join(""));k.length&&h.unshift(k.join("")),k=h.join(d),f.length&&(k+=c+f.join("")),e&&(k+="e+"+e)}return 0>a&&!g?b.negPre+k+b.negSuf:b.posPre+k+b.posSuf}function Kb(a,b,d){var c="";for(0>a&&(c="-",a=-a),a=""+a;a.length<b;)a=lc+a;return d&&(a=a.substr(a.length-b)),c+a}function aa(a,b,d,c){return d=d||0,function(e){return e=e["get"+a](),(0<d||e>-d)&&(e+=d),0===e&&-12==d&&(e=12),Kb(e,b,c)}}function Lb(a,b){return function(d,c){var e=d["get"+a]();return c[ub(b?"SHORT"+a:a)][e]}}function Id(a){var b=new Date(a,0,1).getDay();return new Date(a,0,(4>=b?5:12)-b)}function Jd(a){return function(b){var d=Id(b.getFullYear());return b=+new Date(b.getFullYear(),b.getMonth(),b.getDate()+(4-b.getDay()))-+d,b=1+Math.round(b/6048e5),Kb(b,a)}}function mc(a,b){return 0>=a.getFullYear()?b.ERAS[0]:b.ERAS[1]}function Cd(a){function b(a){var b;if(b=a.match(d)){a=new Date(0);var f=0,g=0,h=b[8]?a.setUTCFullYear:a.setFullYear,k=b[8]?a.setUTCHours:a.setHours;b[9]&&(f=ca(b[9]+b[10]),g=ca(b[9]+b[11])),h.call(a,ca(b[1]),ca(b[2])-1,ca(b[3])),f=ca(b[4]||0)-f,g=ca(b[5]||0)-g,h=ca(b[6]||0),b=Math.round(1e3*parseFloat("0."+(b[7]||0))),k.call(a,f,g,h,b)}return a}var d=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(c,d,f){var k,l,g="",h=[];if(d=d||"mediumDate",d=a.DATETIME_FORMATS[d]||d,F(c)&&(c=wg.test(c)?ca(c):b(c)),N(c)&&(c=new Date(c)),!V(c)||!isFinite(c.getTime()))return c;for(;d;)(l=xg.exec(d))?(h=db(h,l,1),d=h.pop()):(h.push(d),d=null);var m=c.getTimezoneOffset();return f&&(m=xc(f,m),c=Tb(c,f,!0)),n(h,function(b){k=yg[b],g+=k?k(c,a.DATETIME_FORMATS,m):"''"===b?"'":b.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),g}}function pg(){return function(a,b){return x(b)&&(b=2),eb(a,b)}}function qg(){return function(a,b,d){return b=1/0===Math.abs(Number(b))?Number(b):ca(b),isNaN(b)?a:(N(a)&&(a=a.toString()),L(a)||F(a)?(d=!d||isNaN(d)?0:ca(d),d=0>d?Math.max(0,a.length+d):d,0<=b?a.slice(d,d+b):0===d?a.slice(b,a.length):a.slice(Math.max(0,d+b),d)):a)}}function Ed(a){function b(b,d){return d=d?-1:1,b.map(function(b){var c=1,h=ab;if(D(b))h=b;else if(F(b)&&("+"!=b.charAt(0)&&"-"!=b.charAt(0)||(c="-"==b.charAt(0)?-1:1,b=b.substring(1)),""!==b&&(h=a(b),h.constant)))var k=h(),h=function(a){return a[k]};return{get:h,descending:c*d}})}function d(a){switch(typeof a){case"number":case"boolean":case"string":return!0;default:return!1}}return function(a,e,f){if(null==a)return a;if(!Ca(a))throw H("orderBy")("notarray",a);L(e)||(e=[e]),0===e.length&&(e=["+"]);var g=b(e,f);return g.push({get:function(){return{}},descending:f?-1:1}),a=Array.prototype.map.call(a,function(a,b){return{value:a,predicateValues:g.map(function(c){var e=c.get(a);return c=typeof e,null===e?(c="string",e="null"):"string"===c?e=e.toLowerCase():"object"===c&&("function"==typeof e.valueOf&&(e=e.valueOf(),d(e))||tc(e)&&(e=e.toString(),d(e))||(e=b)),{value:e,type:c}})}}),a.sort(function(a,b){for(var c=0,d=0,e=g.length;d<e;++d){var c=a.predicateValues[d],f=b.predicateValues[d],n=0;if(c.type===f.type?c.value!==f.value&&(n=c.value<f.value?-1:1):n=c.type<f.type?-1:1,c=n*g[d].descending)break}return c}),a=a.map(function(a){return a.value})}}function Ma(a){return D(a)&&(a={link:a}),a.restrict=a.restrict||"AC",ba(a)}function Kd(a,b,d,c,e){var f=this,g=[];f.$error={},f.$$success={},f.$pending=v,f.$name=e(b.name||b.ngForm||"")(d),f.$dirty=!1,f.$pristine=!0,f.$valid=!0,f.$invalid=!1,f.$submitted=!1,f.$$parentForm=Mb,f.$rollbackViewValue=function(){n(g,function(a){a.$rollbackViewValue()})},f.$commitViewValue=function(){n(g,function(a){a.$commitViewValue()})},f.$addControl=function(a){Ta(a.$name,"input"),g.push(a),a.$name&&(f[a.$name]=a),a.$$parentForm=f},f.$$renameControl=function(a,b){var c=a.$name;f[c]===a&&delete f[c],f[b]=a,a.$name=b},f.$removeControl=function(a){a.$name&&f[a.$name]===a&&delete f[a.$name],n(f.$pending,function(b,c){f.$setValidity(c,null,a)}),n(f.$error,function(b,c){f.$setValidity(c,null,a)}),n(f.$$success,function(b,c){f.$setValidity(c,null,a)}),cb(g,a),a.$$parentForm=Mb},Ld({ctrl:this,$element:a,set:function(a,b,c){var d=a[b];d?-1===d.indexOf(c)&&d.push(c):a[b]=[c]},unset:function(a,b,c){var d=a[b];d&&(cb(d,c),0===d.length&&delete a[b])},$animate:c}),f.$setDirty=function(){c.removeClass(a,Ya),c.addClass(a,Nb),f.$dirty=!0,f.$pristine=!1,f.$$parentForm.$setDirty()},f.$setPristine=function(){c.setClass(a,Ya,Nb+" ng-submitted"),f.$dirty=!1,f.$pristine=!0,f.$submitted=!1,n(g,function(a){a.$setPristine()})},f.$setUntouched=function(){n(g,function(a){a.$setUntouched()})},f.$setSubmitted=function(){c.addClass(a,"ng-submitted"),f.$submitted=!0,f.$$parentForm.$setSubmitted()}}function nc(a){a.$formatters.push(function(b){return a.$isEmpty(b)?b:b.toString()})}function lb(a,b,d,c,e,f){var g=G(b[0].type);if(!e.android){var h=!1;b.on("compositionstart",function(a){h=!0}),b.on("compositionend",function(){h=!1,k()})}var k=function(a){if(l&&(f.defer.cancel(l),l=null),!h){var e=b.val();a=a&&a.type,"password"===g||d.ngTrim&&"false"===d.ngTrim||(e=X(e)),(c.$viewValue!==e||""===e&&c.$$hasNativeValidators)&&c.$setViewValue(e,a)}};if(e.hasEvent("input"))b.on("input",k);else{var l,m=function(a,b,c){l||(l=f.defer(function(){l=null,b&&b.value===c||k(a)}))};b.on("keydown",function(a){var b=a.keyCode;91===b||15<b&&19>b||37<=b&&40>=b||m(a,this,this.value)}),e.hasEvent("paste")&&b.on("paste cut",m)}b.on("change",k),c.$render=function(){var a=c.$isEmpty(c.$viewValue)?"":c.$viewValue;b.val()!==a&&b.val(a)}}function Ob(a,b){return function(d,c){var e,f;if(V(d))return d;if(F(d)){if('"'==d.charAt(0)&&'"'==d.charAt(d.length-1)&&(d=d.substring(1,d.length-1)),zg.test(d))return new Date(d);if(a.lastIndex=0,e=a.exec(d))return e.shift(),f=c?{yyyy:c.getFullYear(),MM:c.getMonth()+1,dd:c.getDate(),HH:c.getHours(),mm:c.getMinutes(),ss:c.getSeconds(),sss:c.getMilliseconds()/1e3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},n(e,function(a,c){c<b.length&&(f[b[c]]=+a)}),new Date(f.yyyy,f.MM-1,f.dd,f.HH,f.mm,f.ss||0,1e3*f.sss||0)}return NaN}}function mb(a,b,d,c){return function(e,f,g,h,k,l,m){function r(a){return a&&!(a.getTime&&a.getTime()!==a.getTime())}function s(a){return y(a)&&!V(a)?d(a)||v:a}Md(e,f,g,h),lb(e,f,g,h,k,l);var q,n=h&&h.$options&&h.$options.timezone;if(h.$$parserName=a,h.$parsers.push(function(a){return h.$isEmpty(a)?null:b.test(a)?(a=d(a,q),n&&(a=Tb(a,n)),a):v}),h.$formatters.push(function(a){if(a&&!V(a))throw nb("datefmt",a);return r(a)?((q=a)&&n&&(q=Tb(q,n,!0)),m("date")(a,c,n)):(q=null,"")}),y(g.min)||g.ngMin){var t;h.$validators.min=function(a){return!r(a)||x(t)||d(a)>=t},g.$observe("min",function(a){t=s(a),h.$validate()})}if(y(g.max)||g.ngMax){var p;h.$validators.max=function(a){return!r(a)||x(p)||d(a)<=p},g.$observe("max",function(a){p=s(a),h.$validate()})}}}function Md(a,b,d,c){(c.$$hasNativeValidators=E(b[0].validity))&&c.$parsers.push(function(a){var c=b.prop("validity")||{};return c.badInput||c.typeMismatch?v:a})}function Nd(a,b,d,c,e){if(y(c)){if(a=a(c),!a.constant)throw nb("constexpr",d,c);return a(b)}return e}function oc(a,b){return a="ngClass"+a,["$animate",function(d){function c(a,b){var c=[],d=0;a:for(;d<a.length;d++){for(var e=a[d],m=0;m<b.length;m++)if(e==b[m])continue a;c.push(e)}return c}function e(a){var b=[];return L(a)?(n(a,function(a){b=b.concat(e(a))}),b):F(a)?a.split(" "):E(a)?(n(a,function(a,c){a&&(b=b.concat(c.split(" ")))}),b):a}return{restrict:"AC",link:function(f,g,h){function k(a,b){var c=g.data("$classCounts")||Z(),d=[];return n(a,function(a){(0<b||c[a])&&(c[a]=(c[a]||0)+b,c[a]===+(0<b)&&d.push(a))}),g.data("$classCounts",c),d.join(" ")}function l(a){if(!0===b||f.$index%2===b){var l=e(a||[]);if(m){if(!oa(a,m)){var q=e(m),n=c(l,q),l=c(q,l),n=k(n,1),l=k(l,-1);n&&n.length&&d.addClass(g,n),l&&l.length&&d.removeClass(g,l)}}else{var n=k(l,1);h.$addClass(n)}}m=na(a)}var m;f.$watch(h[a],l,!0),h.$observe("class",function(b){l(f.$eval(h[a]))}),"ngClass"!==a&&f.$watch("$index",function(c,d){var g=1&c;if(g!==(1&d)){var l=e(f.$eval(h[a]));g===b?(g=k(l,1),h.$addClass(g)):(g=k(l,-1),h.$removeClass(g))}})}}}]}function Ld(a){function b(a,b){b&&!f[a]?(k.addClass(e,a),f[a]=!0):!b&&f[a]&&(k.removeClass(e,a),f[a]=!1)}function d(a,c){a=a?"-"+Bc(a,"-"):"",b(ob+a,!0===c),b(Od+a,!1===c)}var c=a.ctrl,e=a.$element,f={},g=a.set,h=a.unset,k=a.$animate;f[Od]=!(f[ob]=e.hasClass(ob)),c.$setValidity=function(a,e,f){x(e)?(c.$pending||(c.$pending={}),g(c.$pending,a,f)):(c.$pending&&h(c.$pending,a,f),Pd(c.$pending)&&(c.$pending=v)),Na(e)?e?(h(c.$error,a,f),g(c.$$success,a,f)):(g(c.$error,a,f),h(c.$$success,a,f)):(h(c.$error,a,f),h(c.$$success,a,f)),c.$pending?(b(Qd,!0),c.$valid=c.$invalid=v,d("",null)):(b(Qd,!1),c.$valid=Pd(c.$error),c.$invalid=!c.$valid,d("",c.$valid)),e=c.$pending&&c.$pending[a]?v:!c.$error[a]&&(!!c.$$success[a]||null),d(a,e),c.$$parentForm.$setValidity(a,e,c)}}function Pd(a){if(a)for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}var xa,C,ua,Vb,Ag=/^\/(.+)\/([a-z]*)$/,sa=Object.prototype.hasOwnProperty,G=function(a){return F(a)?a.toLowerCase():a},ub=function(a){return F(a)?a.toUpperCase():a},wa=[].slice,ag=[].splice,Bg=[].push,ga=Object.prototype.toString,uc=Object.getPrototypeOf,Da=H("ng"),ia=O.angular||(O.angular={}),pb=0;xa=W.documentMode,B.$inject=[],ab.$inject=[];var L=Array.isArray,ae=/^\[object (?:Uint8|Uint8Clamped|Uint16|Uint32|Int8|Int16|Int32|Float32|Float64)Array\]$/,X=function(a){return F(a)?a.trim():a},xd=function(a){return a.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},Ea=function(){if(!y(Ea.rules)){var a=W.querySelector("[ng-csp]")||W.querySelector("[data-ng-csp]");if(a){var b=a.getAttribute("ng-csp")||a.getAttribute("data-ng-csp");Ea.rules={noUnsafeEval:!b||-1!==b.indexOf("no-unsafe-eval"),noInlineStyle:!b||-1!==b.indexOf("no-inline-style")}}else{a=Ea;try{new Function(""),b=!1}catch(d){b=!0}a.rules={noUnsafeEval:b,noInlineStyle:!1}}}return Ea.rules},rb=function(){if(y(rb.name_))return rb.name_;var a,b,c,e,d=Qa.length;for(b=0;b<d;++b)if(c=Qa[b],a=W.querySelector("["+c.replace(":","\\:")+"jq]")){e=a.getAttribute(c+"jq");break}return rb.name_=e},de=/:/g,Qa=["ng-","data-ng-","ng:","x-ng-"],ie=/[A-Z]/g,Cc=!1,Pa=3,me={full:"1.5.0",major:1,minor:5,dot:0,codeName:"ennoblement-facilitation"};U.expando="ng339";var ib=U.cache={},Of=1;U._data=function(a){return this.cache[a[this.expando]]||{}};var Jf=/([\:\-\_]+(.))/g,Kf=/^moz([A-Z])/,yb={mouseleave:"mouseout",mouseenter:"mouseover"},Xb=H("jqLite"),Nf=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,Wb=/<|&#?\w+;/,Lf=/<([\w:-]+)/,Mf=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,da={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};da.optgroup=da.option,da.tbody=da.tfoot=da.colgroup=da.caption=da.thead,da.th=da.td;var Tf=Node.prototype.contains||function(a){return!!(16&this.compareDocumentPosition(a))},Ra=U.prototype={ready:function(a){function b(){d||(d=!0,a())}var d=!1;"complete"===W.readyState?setTimeout(b):(this.on("DOMContentLoaded",b),U(O).on("load",b))},toString:function(){var a=[];return n(this,function(b){a.push(""+b)}),"["+a.join(", ")+"]"},eq:function(a){return C(0<=a?this[a]:this[this.length+a])},length:0,push:Bg,sort:[].sort,splice:[].splice},Db={};n("multiple selected checked disabled readOnly required open".split(" "),function(a){Db[G(a)]=a});var Uc={};n("input select option textarea button form details".split(" "),function(a){Uc[a]=!0});var cd={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern"};n({data:Zb,removeData:hb,hasData:function(a){for(var b in ib[a.ng339])return!0;return!1},cleanData:function(a){for(var b=0,d=a.length;b<d;b++)hb(a[b])}},function(a,b){U[b]=a}),n({data:Zb,inheritedData:Cb,scope:function(a){return C.data(a,"$scope")||Cb(a.parentNode||a,["$isolateScope","$scope"])},isolateScope:function(a){return C.data(a,"$isolateScope")||C.data(a,"$isolateScopeNoTemplate")},controller:Rc,injector:function(a){return Cb(a,"$injector")},removeAttr:function(a,b){a.removeAttribute(b)},hasClass:zb,css:function(a,b,d){if(b=gb(b),!y(d))return a.style[b];a.style[b]=d},attr:function(a,b,d){var c=a.nodeType;if(c!==Pa&&2!==c&&8!==c)if(c=G(b),Db[c]){if(!y(d))return a[b]||(a.attributes.getNamedItem(b)||B).specified?c:v;d?(a[b]=!0,a.setAttribute(b,c)):(a[b]=!1,a.removeAttribute(c))}else if(y(d))a.setAttribute(b,d);else if(a.getAttribute)return a=a.getAttribute(b,2),null===a?v:a},prop:function(a,b,d){if(!y(d))return a[b];a[b]=d},text:function(){function a(a,d){if(x(d)){var c=a.nodeType;return 1===c||c===Pa?a.textContent:""}a.textContent=d}return a.$dv="",a}(),val:function(a,b){if(x(b)){if(a.multiple&&"select"===ra(a)){var d=[];return n(a.options,function(a){a.selected&&d.push(a.value||a.text)}),0===d.length?null:d}return a.value}a.value=b},html:function(a,b){if(x(b))return a.innerHTML;wb(a,!0),a.innerHTML=b},empty:Sc},function(a,b){U.prototype[b]=function(b,c){var e,f,g=this.length;if(a!==Sc&&x(2==a.length&&a!==zb&&a!==Rc?b:c)){if(E(b)){for(e=0;e<g;e++)if(a===Zb)a(this[e],b);else for(f in b)a(this[e],f,b[f]);return this}for(e=a.$dv,g=x(e)?Math.min(g,1):g,f=0;f<g;f++){var h=a(this[f],b,c);e=e?e+h:h}return e}for(e=0;e<g;e++)a(this[e],b,c);return this}}),n({removeData:hb,on:function(a,b,d,c){if(y(c))throw Xb("onargs");if(Mc(a)){c=xb(a,!0);var e=c.events,f=c.handle;f||(f=c.handle=Qf(a,e)),c=0<=b.indexOf(" ")?b.split(" "):[b];for(var g=c.length,h=function(b,c,g){var h=e[b];h||(h=e[b]=[],h.specialHandlerWrapper=c,"$destroy"===b||g||a.addEventListener(b,f,!1)),h.push(d)};g--;)b=c[g],yb[b]?(h(yb[b],Sf),h(b,v,!0)):h(b)}},off:Qc,one:function(a,b,d){a=C(a),a.on(b,function e(){a.off(b,d),a.off(b,e)}),a.on(b,d)},replaceWith:function(a,b){var d,c=a.parentNode;wb(a),n(new U(b),function(b){d?c.insertBefore(b,d.nextSibling):c.replaceChild(b,a),d=b})},children:function(a){var b=[];return n(a.childNodes,function(a){1===a.nodeType&&b.push(a)}),b},contents:function(a){return a.contentDocument||a.childNodes||[]},append:function(a,b){var d=a.nodeType;if(1===d||11===d){b=new U(b);for(var d=0,c=b.length;d<c;d++)a.appendChild(b[d])}},prepend:function(a,b){if(1===a.nodeType){var d=a.firstChild;n(new U(b),function(b){a.insertBefore(b,d)})}},wrap:function(a,b){Oc(a,C(b).eq(0).clone()[0])},remove:$b,detach:function(a){$b(a,!0)},after:function(a,b){var d=a,c=a.parentNode;b=new U(b);for(var e=0,f=b.length;e<f;e++){var g=b[e];c.insertBefore(g,d.nextSibling),d=g}},addClass:Bb,removeClass:Ab,toggleClass:function(a,b,d){b&&n(b.split(" "),function(b){var e=d;x(e)&&(e=!zb(a,b)),(e?Bb:Ab)(a,b)})},parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},next:function(a){return a.nextElementSibling},find:function(a,b){return a.getElementsByTagName?a.getElementsByTagName(b):[]},clone:Yb,triggerHandler:function(a,b,d){var c,e,f=b.type||b,g=xb(a);(g=(g=g&&g.events)&&g[f])&&(c={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return!0===this.defaultPrevented},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return!0===this.immediatePropagationStopped},stopPropagation:B,type:f,target:a},b.type&&(c=T(c,b)),b=na(g),e=d?[c].concat(d):[c],n(b,function(b){c.isImmediatePropagationStopped()||b.apply(a,e)}))}},function(a,b){U.prototype[b]=function(b,c,e){for(var f,g=0,h=this.length;g<h;g++)x(f)?(f=a(this[g],b,c,e),y(f)&&(f=C(f))):Pc(f,a(this[g],b,c,e));return y(f)?f:this},U.prototype.bind=U.prototype.on,U.prototype.unbind=U.prototype.off}),Ua.prototype={put:function(a,b){this[Fa(a,this.nextUid)]=b},get:function(a){return this[Fa(a,this.nextUid)]},remove:function(a){var b=this[a=Fa(a,this.nextUid)];return delete this[a],b}};var Hf=[function(){this.$get=[function(){return Ua}]}],Vf=/^([^\(]+?)=>/,Wf=/^[^\(]*\(\s*([^\)]*)\)/m,Cg=/,/,Dg=/^\s*(_?)(\S+?)\1\s*$/,Uf=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,Ga=H("$injector");fb.$$annotate=function(a,b,d){var c;if("function"==typeof a){if(!(c=a.$inject)){if(c=[],a.length){if(b)throw F(d)&&d||(d=a.name||Xf(a)),Ga("strictdi",d);b=Vc(a),n(b[1].split(Cg),function(a){a.replace(Dg,function(a,b,d){c.push(d)})})}a.$inject=c}}else L(a)?(b=a.length-1,Sa(a[b],"fn"),c=a.slice(0,b)):Sa(a,"fn",!0);return c};var Rd=H("$animate"),$e=function(){this.$get=function(){}},af=function(){var a=new Ua,b=[];this.$get=["$$AnimateRunner","$rootScope",function(d,c){function e(a,b,c){var d=!1;return b&&(b=F(b)?b.split(" "):L(b)?b:[],n(b,function(b){b&&(d=!0,a[b]=c)})),d}function f(){n(b,function(b){var c=a.get(b);if(c){var d=Yf(b.attr("class")),e="",f="";n(c,function(a,b){a!==!!d[b]&&(a?e+=(e.length?" ":"")+b:f+=(f.length?" ":"")+b)}),n(b,function(a){e&&Bb(a,e),f&&Ab(a,f)}),a.remove(b)}}),b.length=0}return{enabled:B,on:B,off:B,pin:B,push:function(g,h,k,l){return l&&l(),k=k||{},k.from&&g.css(k.from),k.to&&g.css(k.to),(k.addClass||k.removeClass)&&(h=k.addClass,l=k.removeClass,k=a.get(g)||{},h=e(k,h,!0),l=e(k,l,!1),(h||l)&&(a.put(g,k),b.push(g),1===b.length&&c.$$postDigest(f))),g=new d,g.complete(),g}}}]},Ye=["$provide",function(a){var b=this;this.$$registeredAnimations=Object.create(null),this.register=function(d,c){if(d&&"."!==d.charAt(0))throw Rd("notcsel",d);var e=d+"-animation";b.$$registeredAnimations[d.substr(1)]=e,a.factory(e,c)},this.classNameFilter=function(a){if(1===arguments.length&&(this.$$classNameFilter=a instanceof RegExp?a:null)&&/(\s+|\/)ng-animate(\s+|\/)/.test(this.$$classNameFilter.toString()))throw Rd("nongcls","ng-animate");return this.$$classNameFilter},this.$get=["$$animateQueue",function(a){function b(a,c,d){if(d){var h;a:{for(h=0;h<d.length;h++){var k=d[h];if(1===k.nodeType){h=k;break a}}h=void 0}!h||h.parentNode||h.previousElementSibling||(d=null)}d?d.after(a):c.prepend(a)}return{on:a.on,off:a.off,pin:a.pin,enabled:a.enabled,cancel:function(a){a.end&&a.end()},enter:function(e,f,g,h){return f=f&&C(f),g=g&&C(g),f=f||g.parent(),b(e,f,g),a.push(e,"enter",Ha(h))},move:function(e,f,g,h){return f=f&&C(f),g=g&&C(g),f=f||g.parent(),b(e,f,g),a.push(e,"move",Ha(h))},leave:function(b,c){return a.push(b,"leave",Ha(c),function(){b.remove()})},addClass:function(b,c,g){return g=Ha(g),g.addClass=jb(g.addclass,c),a.push(b,"addClass",g)},removeClass:function(b,c,g){return g=Ha(g),g.removeClass=jb(g.removeClass,c),a.push(b,"removeClass",g)},setClass:function(b,c,g,h){return h=Ha(h),h.addClass=jb(h.addClass,c),h.removeClass=jb(h.removeClass,g),a.push(b,"setClass",h)},animate:function(b,c,g,h,k){return k=Ha(k),k.from=k.from?T(k.from,c):c,k.to=k.to?T(k.to,g):g,k.tempClasses=jb(k.tempClasses,h||"ng-inline-animate"),a.push(b,"animate",k)}}}]}],cf=function(){this.$get=["$$rAF",function(a){function b(b){d.push(b),1<d.length||a(function(){for(var a=0;a<d.length;a++)d[a]();d=[]})}var d=[];return function(){var a=!1;return b(function(){a=!0}),function(d){a?d():b(d)}}}]},bf=function(){this.$get=["$q","$sniffer","$$animateAsyncRun","$document","$timeout",function(a,b,d,c,e){function f(a){this.setHost(a);var b=d();this._doneCallbacks=[],this._tick=function(a){var d=c[0];d&&d.hidden?e(a,0,!1):b(a)},this._state=0}return f.chain=function(a,b){function c(){d===a.length?b(!0):a[d](function(a){!1===a?b(!1):(d++,c())})}var d=0;c()},f.all=function(a,b){function c(f){e=e&&f,++d===a.length&&b(e)}var d=0,e=!0;n(a,function(a){a.done(c)})},f.prototype={setHost:function(a){this.host=a||{}},done:function(a){2===this._state?a():this._doneCallbacks.push(a)},progress:B,getPromise:function(){if(!this.promise){var b=this;this.promise=a(function(a,c){b.done(function(b){!1===b?c():a()})})}return this.promise},then:function(a,b){return this.getPromise().then(a,b)},catch:function(a){return this.getPromise().catch(a)},finally:function(a){return this.getPromise().finally(a)},pause:function(){this.host.pause&&this.host.pause()},resume:function(){this.host.resume&&this.host.resume()},end:function(){this.host.end&&this.host.end(),this._resolve(!0)},cancel:function(){this.host.cancel&&this.host.cancel(),this._resolve(!1)},complete:function(a){var b=this;0===b._state&&(b._state=1,b._tick(function(){b._resolve(a)}))},_resolve:function(a){2!==this._state&&(n(this._doneCallbacks,function(b){b(a)}),this._doneCallbacks.length=0,this._state=2)}},f}]},Ze=function(){this.$get=["$$rAF","$q","$$AnimateRunner",function(a,b,d){return function(b,e){function f(){return a(function(){g.addClass&&(b.addClass(g.addClass),g.addClass=null),g.removeClass&&(b.removeClass(g.removeClass),g.removeClass=null),g.to&&(b.css(g.to),g.to=null),h||k.complete(),h=!0}),k}var g=e||{};g.$$prepared||(g=Oa(g)),g.cleanupStyles&&(g.from=g.to=null),g.from&&(b.css(g.from),g.from=null);var h,k=new d;return{start:f,end:f}}}]},ja=H("$compile");Ec.$inject=["$provide","$$sanitizeUriProvider"];var Xc=/^((?:x|data)[\:\-_])/i,bg=H("$controller"),dd=/^(\S+)(\s+as\s+([\w$]+))?$/,jf=function(){this.$get=["$document",function(a){return function(b){return b?!b.nodeType&&b instanceof C&&(b=b[0]):b=a[0].body,b.offsetWidth+1}}]},ed="application/json",dc={"Content-Type":ed+";charset=utf-8"},dg=/^\[|^\{(?!\{)/,eg={"[":/]$/,"{":/}$/},cg=/^\)\]\}',?\n/,Eg=H("$http"),id=function(a){return function(){throw Eg("legacy",a)}},Ka=ia.$interpolateMinErr=H("$interpolate");Ka.throwNoconcat=function(a){throw Ka("noconcat",a)},Ka.interr=function(a,b){return Ka("interr",a,b.toString())};var Fg=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,gg={http:80,https:443,ftp:21},Gb=H("$location"),Gg={$$html5:!1,$$replace:!1,absUrl:Hb("$$absUrl"),url:function(a){if(x(a))return this.$$url;var b=Fg.exec(a);return(b[1]||""===a)&&this.path(decodeURIComponent(b[1])),(b[2]||b[1]||""===a)&&this.search(b[3]||""),this.hash(b[5]||""),this},protocol:Hb("$$protocol"),host:Hb("$$host"),port:Hb("$$port"),path:nd("$$path",function(a){return a=null!==a?a.toString():"","/"==a.charAt(0)?a:"/"+a}),search:function(a,b){switch(arguments.length){case 0:return this.$$search;case 1:if(F(a)||N(a))a=a.toString(),this.$$search=zc(a);else{if(!E(a))throw Gb("isrcharg");a=Oa(a,{}),n(a,function(b,c){null==b&&delete a[c]}),this.$$search=a}break;default:x(b)||null===b?delete this.$$search[a]:this.$$search[a]=b}return this.$$compose(),this},hash:nd("$$hash",function(a){return null!==a?a.toString():""}),replace:function(){return this.$$replace=!0,this}};n([md,gc,fc],function(a){a.prototype=Object.create(Gg),a.prototype.state=function(b){if(!arguments.length)return this.$$state;if(a!==fc||!this.$$html5)throw Gb("nostate");return this.$$state=x(b)?null:b,this}});var ka=H("$parse"),ig=Function.prototype.call,jg=Function.prototype.apply,kg=Function.prototype.bind,Pb=Z();n("+ - * / % === !== == != < > <= >= && || ! = |".split(" "),function(a){Pb[a]=!0});var Hg={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},ic=function(a){this.options=a};ic.prototype={constructor:ic,lex:function(a){for(this.text=a,this.index=0,this.tokens=[];this.index<this.text.length;)if('"'===(a=this.text.charAt(this.index))||"'"===a)this.readString(a);else if(this.isNumber(a)||"."===a&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(a))this.readIdent();else if(this.is(a,"(){}[].,;:?"))this.tokens.push({index:this.index,text:a}),this.index++;else if(this.isWhitespace(a))this.index++;else{var b=a+this.peek(),d=b+this.peek(2),c=Pb[b],e=Pb[d];Pb[a]||c||e?(a=e?d:c?b:a,this.tokens.push({index:this.index,text:a,operator:!0}),this.index+=a.length):this.throwError("Unexpected next character ",this.index,this.index+1)}return this.tokens},is:function(a,b){return-1!==b.indexOf(a)},peek:function(a){return a=a||1,this.index+a<this.text.length&&this.text.charAt(this.index+a)},isNumber:function(a){return"0"<=a&&"9">=a&&"string"==typeof a},isWhitespace:function(a){return" "===a||"\r"===a||"\t"===a||"\n"===a||"\v"===a||""===a},isIdent:function(a){return"a"<=a&&"z">=a||"A"<=a&&"Z">=a||"_"===a||"$"===a},isExpOperator:function(a){return"-"===a||"+"===a||this.isNumber(a)},throwError:function(a,b,d){throw d=d||this.index,b=y(b)?"s "+b+"-"+this.index+" ["+this.text.substring(b,d)+"]":" "+d,ka("lexerr",a,b,this.text)},readNumber:function(){for(var a="",b=this.index;this.index<this.text.length;){var d=G(this.text.charAt(this.index));if("."==d||this.isNumber(d))a+=d;else{var c=this.peek();if("e"==d&&this.isExpOperator(c))a+=d;else if(this.isExpOperator(d)&&c&&this.isNumber(c)&&"e"==a.charAt(a.length-1))a+=d;else{if(!this.isExpOperator(d)||c&&this.isNumber(c)||"e"!=a.charAt(a.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:b,text:a,constant:!0,value:Number(a)})},readIdent:function(){for(var a=this.index;this.index<this.text.length;){var b=this.text.charAt(this.index);if(!this.isIdent(b)&&!this.isNumber(b))break;this.index++}this.tokens.push({index:a,text:this.text.slice(a,this.index),identifier:!0})},readString:function(a){var b=this.index;this.index++;for(var d="",c=a,e=!1;this.index<this.text.length;){var f=this.text.charAt(this.index),c=c+f;if(e)"u"===f?(e=this.text.substring(this.index+1,this.index+5),e.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+e+"]"),this.index+=4,d+=String.fromCharCode(parseInt(e,16))):d+=Hg[f]||f,e=!1;else if("\\"===f)e=!0;else{if(f===a)return this.index++,void this.tokens.push({index:b,text:c,constant:!0,value:d});d+=f}this.index++}this.throwError("Unterminated quote",b)}};var q=function(a,b){this.lexer=a,this.options=b};q.Program="Program",q.ExpressionStatement="ExpressionStatement",q.AssignmentExpression="AssignmentExpression",q.ConditionalExpression="ConditionalExpression",q.LogicalExpression="LogicalExpression",q.BinaryExpression="BinaryExpression",q.UnaryExpression="UnaryExpression",q.CallExpression="CallExpression",q.MemberExpression="MemberExpression",q.Identifier="Identifier",q.Literal="Literal",q.ArrayExpression="ArrayExpression",q.Property="Property",q.ObjectExpression="ObjectExpression",q.ThisExpression="ThisExpression",q.LocalsExpression="LocalsExpression",q.NGValueParameter="NGValueParameter",q.prototype={ast:function(a){return this.text=a,this.tokens=this.lexer.lex(a),a=this.program(),0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),a},program:function(){for(var a=[];;)if(0<this.tokens.length&&!this.peek("}",")",";","]")&&a.push(this.expressionStatement()),!this.expect(";"))return{type:q.Program,body:a}},expressionStatement:function(){return{type:q.ExpressionStatement,expression:this.filterChain()}},filterChain:function(){for(var a=this.expression();this.expect("|");)a=this.filter(a);return a},expression:function(){return this.assignment()},assignment:function(){var a=this.ternary();return this.expect("=")&&(a={type:q.AssignmentExpression,left:a,right:this.assignment(),operator:"="}),a},ternary:function(){var b,d,a=this.logicalOR();return this.expect("?")&&(b=this.expression(),this.consume(":"))?(d=this.expression(),{type:q.ConditionalExpression,test:a,alternate:b,consequent:d}):a},logicalOR:function(){for(var a=this.logicalAND();this.expect("||");)a={type:q.LogicalExpression,operator:"||",left:a,right:this.logicalAND()};return a},logicalAND:function(){for(var a=this.equality();this.expect("&&");)a={type:q.LogicalExpression,operator:"&&",left:a,right:this.equality()};return a},equality:function(){for(var b,a=this.relational();b=this.expect("==","!=","===","!==");)a={type:q.BinaryExpression,operator:b.text,left:a,right:this.relational()};return a},relational:function(){for(var b,a=this.additive();b=this.expect("<",">","<=",">=");)a={type:q.BinaryExpression,operator:b.text,left:a,right:this.additive()};return a},additive:function(){for(var b,a=this.multiplicative();b=this.expect("+","-");)a={type:q.BinaryExpression,operator:b.text,left:a,right:this.multiplicative()};return a},multiplicative:function(){for(var b,a=this.unary();b=this.expect("*","/","%");)a={type:q.BinaryExpression,operator:b.text,left:a,right:this.unary()};return a},unary:function(){var a;return(a=this.expect("+","-","!"))?{type:q.UnaryExpression,operator:a.text,prefix:!0,argument:this.unary()}:this.primary()},primary:function(){var a;this.expect("(")?(a=this.filterChain(),this.consume(")")):this.expect("[")?a=this.arrayDeclaration():this.expect("{")?a=this.object():this.constants.hasOwnProperty(this.peek().text)?a=Oa(this.constants[this.consume().text]):this.peek().identifier?a=this.identifier():this.peek().constant?a=this.constant():this.throwError("not a primary expression",this.peek());for(var b;b=this.expect("(","[",".");)"("===b.text?(a={type:q.CallExpression,callee:a,arguments:this.parseArguments()},this.consume(")")):"["===b.text?(a={type:q.MemberExpression,object:a,property:this.expression(),computed:!0},this.consume("]")):"."===b.text?a={type:q.MemberExpression,object:a,property:this.identifier(),computed:!1}:this.throwError("IMPOSSIBLE");return a},filter:function(a){a=[a];for(var b={type:q.CallExpression,callee:this.identifier(),arguments:a,filter:!0};this.expect(":");)a.push(this.expression());return b},parseArguments:function(){var a=[];if(")"!==this.peekToken().text)do{a.push(this.expression())}while(this.expect(","));return a},identifier:function(){var a=this.consume();return a.identifier||this.throwError("is not a valid identifier",a),{type:q.Identifier,name:a.text}},constant:function(){return{type:q.Literal,value:this.consume().value}},arrayDeclaration:function(){var a=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;a.push(this.expression())}while(this.expect(","));return this.consume("]"),{type:q.ArrayExpression,elements:a}},object:function(){var b,a=[]
;if("}"!==this.peekToken().text)do{if(this.peek("}"))break;b={type:q.Property,kind:"init"},this.peek().constant?b.key=this.constant():this.peek().identifier?b.key=this.identifier():this.throwError("invalid key",this.peek()),this.consume(":"),b.value=this.expression(),a.push(b)}while(this.expect(","));return this.consume("}"),{type:q.ObjectExpression,properties:a}},throwError:function(a,b){throw ka("syntax",b.text,a,b.index+1,this.text,this.text.substring(b.index))},consume:function(a){if(0===this.tokens.length)throw ka("ueoe",this.text);var b=this.expect(a);return b||this.throwError("is unexpected, expecting ["+a+"]",this.peek()),b},peekToken:function(){if(0===this.tokens.length)throw ka("ueoe",this.text);return this.tokens[0]},peek:function(a,b,d,c){return this.peekAhead(0,a,b,d,c)},peekAhead:function(a,b,d,c,e){if(this.tokens.length>a){a=this.tokens[a];var f=a.text;if(f===b||f===d||f===c||f===e||!(b||d||c||e))return a}return!1},expect:function(a,b,d,c){return!!(a=this.peek(a,b,d,c))&&(this.tokens.shift(),a)},constants:{true:{type:q.Literal,value:!0},false:{type:q.Literal,value:!1},null:{type:q.Literal,value:null},undefined:{type:q.Literal,value:v},this:{type:q.ThisExpression},$locals:{type:q.LocalsExpression}}},ud.prototype={compile:function(a,b){var d=this,c=this.astBuilder.ast(a);this.state={nextId:0,filters:{},expensiveChecks:b,fn:{vars:[],body:[],own:{}},assign:{vars:[],body:[],own:{}},inputs:[]},R(c,d.$filter);var f,e="";return this.stage="assign",(f=sd(c))&&(this.state.computing="assign",e=this.nextId(),this.recurse(f,e),this.return_(e),e="fn.assign="+this.generateFunction("assign","s,v,l")),f=qd(c.body),d.stage="inputs",n(f,function(a,b){var c="fn"+b;d.state[c]={vars:[],body:[],own:{}},d.state.computing=c;var e=d.nextId();d.recurse(a,e),d.return_(e),d.state.inputs.push(c),a.watchId=b}),this.state.computing="fn",this.stage="main",this.recurse(c),e='"'+this.USE+" "+this.STRICT+'";\n'+this.filterPrefix()+"var fn="+this.generateFunction("fn","s,l,a,i")+e+this.watchFns()+"return fn;",e=new Function("$filter","ensureSafeMemberName","ensureSafeObject","ensureSafeFunction","getStringValue","ensureSafeAssignContext","ifDefined","plus","text",e)(this.$filter,Xa,Aa,od,hg,Ib,lg,pd,a),this.state=this.stage=v,e.literal=td(c),e.constant=c.constant,e},USE:"use",STRICT:"strict",watchFns:function(){var a=[],b=this.state.inputs,d=this;return n(b,function(b){a.push("var "+b+"="+d.generateFunction(b,"s"))}),b.length&&a.push("fn.inputs=["+b.join(",")+"];"),a.join("")},generateFunction:function(a,b){return"function("+b+"){"+this.varsPrefix(a)+this.body(a)+"};"},filterPrefix:function(){var a=[],b=this;return n(this.state.filters,function(d,c){a.push(d+"=$filter("+b.escape(c)+")")}),a.length?"var "+a.join(",")+";":""},varsPrefix:function(a){return this.state[a].vars.length?"var "+this.state[a].vars.join(",")+";":""},body:function(a){return this.state[a].body.join("")},recurse:function(a,b,d,c,e,f){var g,h,l,m,k=this;if(c=c||B,!f&&y(a.watchId))b=b||this.nextId(),this.if_("i",this.lazyAssign(b,this.computedMember("i",a.watchId)),this.lazyRecurse(a,b,d,c,e,!0));else switch(a.type){case q.Program:n(a.body,function(b,c){k.recurse(b.expression,v,v,function(a){h=a}),c!==a.body.length-1?k.current().body.push(h,";"):k.return_(h)});break;case q.Literal:m=this.escape(a.value),this.assign(b,m),c(m);break;case q.UnaryExpression:this.recurse(a.argument,v,v,function(a){h=a}),m=a.operator+"("+this.ifDefined(h,0)+")",this.assign(b,m),c(m);break;case q.BinaryExpression:this.recurse(a.left,v,v,function(a){g=a}),this.recurse(a.right,v,v,function(a){h=a}),m="+"===a.operator?this.plus(g,h):"-"===a.operator?this.ifDefined(g,0)+a.operator+this.ifDefined(h,0):"("+g+")"+a.operator+"("+h+")",this.assign(b,m),c(m);break;case q.LogicalExpression:b=b||this.nextId(),k.recurse(a.left,b),k.if_("&&"===a.operator?b:k.not(b),k.lazyRecurse(a.right,b)),c(b);break;case q.ConditionalExpression:b=b||this.nextId(),k.recurse(a.test,b),k.if_(b,k.lazyRecurse(a.alternate,b),k.lazyRecurse(a.consequent,b)),c(b);break;case q.Identifier:b=b||this.nextId(),d&&(d.context="inputs"===k.stage?"s":this.assign(this.nextId(),this.getHasOwnProperty("l",a.name)+"?l:s"),d.computed=!1,d.name=a.name),Xa(a.name),k.if_("inputs"===k.stage||k.not(k.getHasOwnProperty("l",a.name)),function(){k.if_("inputs"===k.stage||"s",function(){e&&1!==e&&k.if_(k.not(k.nonComputedMember("s",a.name)),k.lazyAssign(k.nonComputedMember("s",a.name),"{}")),k.assign(b,k.nonComputedMember("s",a.name))})},b&&k.lazyAssign(b,k.nonComputedMember("l",a.name))),(k.state.expensiveChecks||Jb(a.name))&&k.addEnsureSafeObject(b),c(b);break;case q.MemberExpression:g=d&&(d.context=this.nextId())||this.nextId(),b=b||this.nextId(),k.recurse(a.object,g,v,function(){k.if_(k.notNull(g),function(){e&&1!==e&&k.addEnsureSafeAssignContext(g),a.computed?(h=k.nextId(),k.recurse(a.property,h),k.getStringValue(h),k.addEnsureSafeMemberName(h),e&&1!==e&&k.if_(k.not(k.computedMember(g,h)),k.lazyAssign(k.computedMember(g,h),"{}")),m=k.ensureSafeObject(k.computedMember(g,h)),k.assign(b,m),d&&(d.computed=!0,d.name=h)):(Xa(a.property.name),e&&1!==e&&k.if_(k.not(k.nonComputedMember(g,a.property.name)),k.lazyAssign(k.nonComputedMember(g,a.property.name),"{}")),m=k.nonComputedMember(g,a.property.name),(k.state.expensiveChecks||Jb(a.property.name))&&(m=k.ensureSafeObject(m)),k.assign(b,m),d&&(d.computed=!1,d.name=a.property.name))},function(){k.assign(b,"undefined")}),c(b)},!!e);break;case q.CallExpression:b=b||this.nextId(),a.filter?(h=k.filter(a.callee.name),l=[],n(a.arguments,function(a){var b=k.nextId();k.recurse(a,b),l.push(b)}),m=h+"("+l.join(",")+")",k.assign(b,m),c(b)):(h=k.nextId(),g={},l=[],k.recurse(a.callee,h,g,function(){k.if_(k.notNull(h),function(){k.addEnsureSafeFunction(h),n(a.arguments,function(a){k.recurse(a,k.nextId(),v,function(a){l.push(k.ensureSafeObject(a))})}),g.name?(k.state.expensiveChecks||k.addEnsureSafeObject(g.context),m=k.member(g.context,g.name,g.computed)+"("+l.join(",")+")"):m=h+"("+l.join(",")+")",m=k.ensureSafeObject(m),k.assign(b,m)},function(){k.assign(b,"undefined")}),c(b)}));break;case q.AssignmentExpression:if(h=this.nextId(),g={},!rd(a.left))throw ka("lval");this.recurse(a.left,v,g,function(){k.if_(k.notNull(g.context),function(){k.recurse(a.right,h),k.addEnsureSafeObject(k.member(g.context,g.name,g.computed)),k.addEnsureSafeAssignContext(g.context),m=k.member(g.context,g.name,g.computed)+a.operator+h,k.assign(b,m),c(b||m)})},1);break;case q.ArrayExpression:l=[],n(a.elements,function(a){k.recurse(a,k.nextId(),v,function(a){l.push(a)})}),m="["+l.join(",")+"]",this.assign(b,m),c(m);break;case q.ObjectExpression:l=[],n(a.properties,function(a){k.recurse(a.value,k.nextId(),v,function(b){l.push(k.escape(a.key.type===q.Identifier?a.key.name:""+a.key.value)+":"+b)})}),m="{"+l.join(",")+"}",this.assign(b,m),c(m);break;case q.ThisExpression:this.assign(b,"s"),c("s");break;case q.LocalsExpression:this.assign(b,"l"),c("l");break;case q.NGValueParameter:this.assign(b,"v"),c("v")}},getHasOwnProperty:function(a,b){var d=a+"."+b,c=this.current().own;return c.hasOwnProperty(d)||(c[d]=this.nextId(!1,a+"&&("+this.escape(b)+" in "+a+")")),c[d]},assign:function(a,b){if(a)return this.current().body.push(a,"=",b,";"),a},filter:function(a){return this.state.filters.hasOwnProperty(a)||(this.state.filters[a]=this.nextId(!0)),this.state.filters[a]},ifDefined:function(a,b){return"ifDefined("+a+","+this.escape(b)+")"},plus:function(a,b){return"plus("+a+","+b+")"},return_:function(a){this.current().body.push("return ",a,";")},if_:function(a,b,d){if(!0===a)b();else{var c=this.current().body;c.push("if(",a,"){"),b(),c.push("}"),d&&(c.push("else{"),d(),c.push("}"))}},not:function(a){return"!("+a+")"},notNull:function(a){return a+"!=null"},nonComputedMember:function(a,b){return a+"."+b},computedMember:function(a,b){return a+"["+b+"]"},member:function(a,b,d){return d?this.computedMember(a,b):this.nonComputedMember(a,b)},addEnsureSafeObject:function(a){this.current().body.push(this.ensureSafeObject(a),";")},addEnsureSafeMemberName:function(a){this.current().body.push(this.ensureSafeMemberName(a),";")},addEnsureSafeFunction:function(a){this.current().body.push(this.ensureSafeFunction(a),";")},addEnsureSafeAssignContext:function(a){this.current().body.push(this.ensureSafeAssignContext(a),";")},ensureSafeObject:function(a){return"ensureSafeObject("+a+",text)"},ensureSafeMemberName:function(a){return"ensureSafeMemberName("+a+",text)"},ensureSafeFunction:function(a){return"ensureSafeFunction("+a+",text)"},getStringValue:function(a){this.assign(a,"getStringValue("+a+")")},ensureSafeAssignContext:function(a){return"ensureSafeAssignContext("+a+",text)"},lazyRecurse:function(a,b,d,c,e,f){var g=this;return function(){g.recurse(a,b,d,c,e,f)}},lazyAssign:function(a,b){var d=this;return function(){d.assign(a,b)}},stringEscapeRegex:/[^ a-zA-Z0-9]/g,stringEscapeFn:function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)},escape:function(a){if(F(a))return"'"+a.replace(this.stringEscapeRegex,this.stringEscapeFn)+"'";if(N(a))return a.toString();if(!0===a)return"true";if(!1===a)return"false";if(null===a)return"null";if(void 0===a)return"undefined";throw ka("esc")},nextId:function(a,b){var d="v"+this.state.nextId++;return a||this.current().vars.push(d+(b?"="+b:"")),d},current:function(){return this.state[this.state.computing]}},vd.prototype={compile:function(a,b){var d=this,c=this.astBuilder.ast(a);this.expression=a,this.expensiveChecks=b,R(c,d.$filter);var e,f;(e=sd(c))&&(f=this.recurse(e)),e=qd(c.body);var g;e&&(g=[],n(e,function(a,b){var c=d.recurse(a);a.input=c,g.push(c),a.watchId=b}));var h=[];return n(c.body,function(a){h.push(d.recurse(a.expression))}),e=0===c.body.length?function(){}:1===c.body.length?h[0]:function(a,b){var c;return n(h,function(d){c=d(a,b)}),c},f&&(e.assign=function(a,b,c){return f(a,c,b)}),g&&(e.inputs=g),e.literal=td(c),e.constant=c.constant,e},recurse:function(a,b,d){var c,e,g,f=this;if(a.input)return this.inputs(a.input,a.watchId);switch(a.type){case q.Literal:return this.value(a.value,b);case q.UnaryExpression:return e=this.recurse(a.argument),this["unary"+a.operator](e,b);case q.BinaryExpression:case q.LogicalExpression:return c=this.recurse(a.left),e=this.recurse(a.right),this["binary"+a.operator](c,e,b);case q.ConditionalExpression:return this["ternary?:"](this.recurse(a.test),this.recurse(a.alternate),this.recurse(a.consequent),b);case q.Identifier:return Xa(a.name,f.expression),f.identifier(a.name,f.expensiveChecks||Jb(a.name),b,d,f.expression);case q.MemberExpression:return c=this.recurse(a.object,!1,!!d),a.computed||(Xa(a.property.name,f.expression),e=a.property.name),a.computed&&(e=this.recurse(a.property)),a.computed?this.computedMember(c,e,b,d,f.expression):this.nonComputedMember(c,e,f.expensiveChecks,b,d,f.expression);case q.CallExpression:return g=[],n(a.arguments,function(a){g.push(f.recurse(a))}),a.filter&&(e=this.$filter(a.callee.name)),a.filter||(e=this.recurse(a.callee,!0)),a.filter?function(a,c,d,f){for(var r=[],n=0;n<g.length;++n)r.push(g[n](a,c,d,f));return a=e.apply(v,r,f),b?{context:v,name:v,value:a}:a}:function(a,c,d,m){var n,r=e(a,c,d,m);if(null!=r.value){Aa(r.context,f.expression),od(r.value,f.expression),n=[];for(var q=0;q<g.length;++q)n.push(Aa(g[q](a,c,d,m),f.expression));n=Aa(r.value.apply(r.context,n),f.expression)}return b?{value:n}:n};case q.AssignmentExpression:return c=this.recurse(a.left,!0,1),e=this.recurse(a.right),function(a,d,g,m){var r=c(a,d,g,m);return a=e(a,d,g,m),Aa(r.value,f.expression),Ib(r.context),r.context[r.name]=a,b?{value:a}:a};case q.ArrayExpression:return g=[],n(a.elements,function(a){g.push(f.recurse(a))}),function(a,c,d,e){for(var f=[],n=0;n<g.length;++n)f.push(g[n](a,c,d,e));return b?{value:f}:f};case q.ObjectExpression:return g=[],n(a.properties,function(a){g.push({key:a.key.type===q.Identifier?a.key.name:""+a.key.value,value:f.recurse(a.value)})}),function(a,c,d,e){for(var f={},n=0;n<g.length;++n)f[g[n].key]=g[n].value(a,c,d,e);return b?{value:f}:f};case q.ThisExpression:return function(a){return b?{value:a}:a};case q.LocalsExpression:return function(a,c){return b?{value:c}:c};case q.NGValueParameter:return function(a,c,d,e){return b?{value:d}:d}}},"unary+":function(a,b){return function(d,c,e,f){return d=a(d,c,e,f),d=y(d)?+d:0,b?{value:d}:d}},"unary-":function(a,b){return function(d,c,e,f){return d=a(d,c,e,f),d=y(d)?-d:0,b?{value:d}:d}},"unary!":function(a,b){return function(d,c,e,f){return d=!a(d,c,e,f),b?{value:d}:d}},"binary+":function(a,b,d){return function(c,e,f,g){var h=a(c,e,f,g);return c=b(c,e,f,g),h=pd(h,c),d?{value:h}:h}},"binary-":function(a,b,d){return function(c,e,f,g){var h=a(c,e,f,g);return c=b(c,e,f,g),h=(y(h)?h:0)-(y(c)?c:0),d?{value:h}:h}},"binary*":function(a,b,d){return function(c,e,f,g){return c=a(c,e,f,g)*b(c,e,f,g),d?{value:c}:c}},"binary/":function(a,b,d){return function(c,e,f,g){return c=a(c,e,f,g)/b(c,e,f,g),d?{value:c}:c}},"binary%":function(a,b,d){return function(c,e,f,g){return c=a(c,e,f,g)%b(c,e,f,g),d?{value:c}:c}},"binary===":function(a,b,d){return function(c,e,f,g){return c=a(c,e,f,g)===b(c,e,f,g),d?{value:c}:c}},"binary!==":function(a,b,d){return function(c,e,f,g){return c=a(c,e,f,g)!==b(c,e,f,g),d?{value:c}:c}},"binary==":function(a,b,d){return function(c,e,f,g){return c=a(c,e,f,g)==b(c,e,f,g),d?{value:c}:c}},"binary!=":function(a,b,d){return function(c,e,f,g){return c=a(c,e,f,g)!=b(c,e,f,g),d?{value:c}:c}},"binary<":function(a,b,d){return function(c,e,f,g){return c=a(c,e,f,g)<b(c,e,f,g),d?{value:c}:c}},"binary>":function(a,b,d){return function(c,e,f,g){return c=a(c,e,f,g)>b(c,e,f,g),d?{value:c}:c}},"binary<=":function(a,b,d){return function(c,e,f,g){return c=a(c,e,f,g)<=b(c,e,f,g),d?{value:c}:c}},"binary>=":function(a,b,d){return function(c,e,f,g){return c=a(c,e,f,g)>=b(c,e,f,g),d?{value:c}:c}},"binary&&":function(a,b,d){return function(c,e,f,g){return c=a(c,e,f,g)&&b(c,e,f,g),d?{value:c}:c}},"binary||":function(a,b,d){return function(c,e,f,g){return c=a(c,e,f,g)||b(c,e,f,g),d?{value:c}:c}},"ternary?:":function(a,b,d,c){return function(e,f,g,h){return e=a(e,f,g,h)?b(e,f,g,h):d(e,f,g,h),c?{value:e}:e}},value:function(a,b){return function(){return b?{context:v,name:v,value:a}:a}},identifier:function(a,b,d,c,e){return function(f,g,h,k){return f=g&&a in g?g:f,c&&1!==c&&f&&!f[a]&&(f[a]={}),g=f?f[a]:v,b&&Aa(g,e),d?{context:f,name:a,value:g}:g}},computedMember:function(a,b,d,c,e){return function(f,g,h,k){var m,n,l=a(f,g,h,k);return null!=l&&(m=b(f,g,h,k),m+="",Xa(m,e),c&&1!==c&&(Ib(l),l&&!l[m]&&(l[m]={})),n=l[m],Aa(n,e)),d?{context:l,name:m,value:n}:n}},nonComputedMember:function(a,b,d,c,e,f){return function(g,h,k,l){return g=a(g,h,k,l),e&&1!==e&&(Ib(g),g&&!g[b]&&(g[b]={})),h=null!=g?g[b]:v,(d||Jb(b))&&Aa(h,f),c?{context:g,name:b,value:h}:h}},inputs:function(a,b){return function(d,c,e,f){return f?f[b]:a(d,c,e)}}};var jc=function(a,b,d){this.lexer=a,this.$filter=b,this.options=d,this.ast=new q(this.lexer),this.astCompiler=d.csp?new vd(this.ast,b):new ud(this.ast,b)};jc.prototype={constructor:jc,parse:function(a){return this.astCompiler.compile(a,this.options.expensiveChecks)}};var mg=Object.prototype.valueOf,Ba=H("$sce"),qa={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},ja=H("$compile"),Y=W.createElement("a"),zd=za(O.location.href);Ad.$inject=["$document"],Lc.$inject=["$provide"];var Hd=22,Gd=".",lc="0";Bd.$inject=["$locale"],Dd.$inject=["$locale"];var yg={yyyy:aa("FullYear",4),yy:aa("FullYear",2,0,!0),y:aa("FullYear",1),MMMM:Lb("Month"),MMM:Lb("Month",!0),MM:aa("Month",2,1),M:aa("Month",1,1),dd:aa("Date",2),d:aa("Date",1),HH:aa("Hours",2),H:aa("Hours",1),hh:aa("Hours",2,-12),h:aa("Hours",1,-12),mm:aa("Minutes",2),m:aa("Minutes",1),ss:aa("Seconds",2),s:aa("Seconds",1),sss:aa("Milliseconds",3),EEEE:Lb("Day"),EEE:Lb("Day",!0),a:function(a,b){return 12>a.getHours()?b.AMPMS[0]:b.AMPMS[1]},Z:function(a,b,d){return a=-1*d,a=(0<=a?"+":"")+(Kb(Math[0<a?"floor":"ceil"](a/60),2)+Kb(Math.abs(a%60),2))},ww:Jd(2),w:Jd(1),G:mc,GG:mc,GGG:mc,GGGG:function(a,b){return 0>=a.getFullYear()?b.ERANAMES[0]:b.ERANAMES[1]}},xg=/((?:[^yMdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z|G+|w+))(.*)/,wg=/^\-?\d+$/;Cd.$inject=["$locale"];var rg=ba(G),sg=ba(ub);Ed.$inject=["$parse"];var oe=ba({restrict:"E",compile:function(a,b){if(!b.href&&!b.xlinkHref)return function(a,b){if("a"===b[0].nodeName.toLowerCase()){var e="[object SVGAnimatedString]"===ga.call(b.prop("href"))?"xlink:href":"href";b.on("click",function(a){b.attr(e)||a.preventDefault()})}}}}),vb={};n(Db,function(a,b){function d(a,d,e){a.$watch(e[c],function(a){e.$set(b,!!a)})}if("multiple"!=a){var c=va("ng-"+b),e=d;"checked"===a&&(e=function(a,b,e){e.ngModel!==e[c]&&d(a,b,e)}),vb[c]=function(){return{restrict:"A",priority:100,link:e}}}}),n(cd,function(a,b){vb[b]=function(){return{priority:100,link:function(a,c,e){if("ngPattern"===b&&"/"==e.ngPattern.charAt(0)&&(c=e.ngPattern.match(Ag)))return void e.$set("ngPattern",new RegExp(c[1],c[2]));a.$watch(e[b],function(a){e.$set(b,a)})}}}}),n(["src","srcset","href"],function(a){var b=va("ng-"+a);vb[b]=function(){return{priority:99,link:function(d,c,e){var f=a,g=a;"href"===a&&"[object SVGAnimatedString]"===ga.call(c.prop("href"))&&(g="xlinkHref",e.$attr[g]="xlink:href",f=null),e.$observe(b,function(b){b?(e.$set(g,b),xa&&f&&c.prop(f,e[g])):"href"===a&&e.$set(g,null)})}}}});var Mb={$addControl:B,$$renameControl:function(a,b){a.$name=b},$removeControl:B,$setValidity:B,$setDirty:B,$setPristine:B,$setSubmitted:B};Kd.$inject=["$element","$attrs","$scope","$animate","$interpolate"];var Sd=function(a){return["$timeout","$parse",function(b,d){function c(a){return""===a?d('this[""]').assign:d(a).assign||B}return{name:"form",restrict:a?"EAC":"E",require:["form","^^?form"],controller:Kd,compile:function(d,f){d.addClass(Ya).addClass(ob);var g=f.name?"name":!(!a||!f.ngForm)&&"ngForm";return{pre:function(a,d,e,f){var n=f[0];if(!("action"in e)){var s=function(b){a.$apply(function(){n.$commitViewValue(),n.$setSubmitted()}),b.preventDefault()};d[0].addEventListener("submit",s,!1),d.on("$destroy",function(){b(function(){d[0].removeEventListener("submit",s,!1)},0,!1)})}(f[1]||n.$$parentForm).$addControl(n);var q=g?c(n.$name):B;g&&(q(a,n),e.$observe(g,function(b){n.$name!==b&&(q(a,v),n.$$parentForm.$$renameControl(n,b),(q=c(n.$name))(a,n))})),d.on("$destroy",function(){n.$$parentForm.$removeControl(n),q(a,v),T(n,Mb)})}}}}}]},pe=Sd(),Ce=Sd(!0),zg=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z)/,Ig=/^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:/?#]+|\[[a-f\d:]+\])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i,Jg=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,Kg=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,Td=/^(\d{4})-(\d{2})-(\d{2})$/,Ud=/^(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,pc=/^(\d{4})-W(\d\d)$/,Vd=/^(\d{4})-(\d\d)$/,Wd=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,Xd={text:function(a,b,d,c,e,f){lb(a,b,d,c,e,f),nc(c)},date:mb("date",Td,Ob(Td,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":mb("datetimelocal",Ud,Ob(Ud,"yyyy MM dd HH mm ss sss".split(" ")),"yyyy-MM-ddTHH:mm:ss.sss"),time:mb("time",Wd,Ob(Wd,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:mb("week",pc,function(a,b){if(V(a))return a;if(F(a)){pc.lastIndex=0;var d=pc.exec(a);if(d){var c=+d[1],e=+d[2],f=d=0,g=0,h=0,k=Id(c),e=7*(e-1);return b&&(d=b.getHours(),f=b.getMinutes(),g=b.getSeconds(),h=b.getMilliseconds()),new Date(c,0,k.getDate()+e,d,f,g,h)}}return NaN},"yyyy-Www"),month:mb("month",Vd,Ob(Vd,["yyyy","MM"]),"yyyy-MM"),number:function(a,b,d,c,e,f){if(Md(a,b,d,c),lb(a,b,d,c,e,f),c.$$parserName="number",c.$parsers.push(function(a){return c.$isEmpty(a)?null:Kg.test(a)?parseFloat(a):v}),c.$formatters.push(function(a){if(!c.$isEmpty(a)){if(!N(a))throw nb("numfmt",a);a=a.toString()}return a}),y(d.min)||d.ngMin){var g;c.$validators.min=function(a){return c.$isEmpty(a)||x(g)||a>=g},d.$observe("min",function(a){y(a)&&!N(a)&&(a=parseFloat(a,10)),g=N(a)&&!isNaN(a)?a:v,c.$validate()})}if(y(d.max)||d.ngMax){var h;c.$validators.max=function(a){return c.$isEmpty(a)||x(h)||a<=h},d.$observe("max",function(a){y(a)&&!N(a)&&(a=parseFloat(a,10)),h=N(a)&&!isNaN(a)?a:v,c.$validate()})}},url:function(a,b,d,c,e,f){lb(a,b,d,c,e,f),nc(c),c.$$parserName="url",c.$validators.url=function(a,b){var d=a||b;return c.$isEmpty(d)||Ig.test(d)}},email:function(a,b,d,c,e,f){lb(a,b,d,c,e,f),nc(c),c.$$parserName="email",c.$validators.email=function(a,b){var d=a||b;return c.$isEmpty(d)||Jg.test(d)}},radio:function(a,b,d,c){x(d.name)&&b.attr("name",++pb),b.on("click",function(a){b[0].checked&&c.$setViewValue(d.value,a&&a.type)}),c.$render=function(){b[0].checked=d.value==c.$viewValue},d.$observe("value",c.$render)},checkbox:function(a,b,d,c,e,f,g,h){var k=Nd(h,a,"ngTrueValue",d.ngTrueValue,!0),l=Nd(h,a,"ngFalseValue",d.ngFalseValue,!1);b.on("click",function(a){c.$setViewValue(b[0].checked,a&&a.type)}),c.$render=function(){b[0].checked=c.$viewValue},c.$isEmpty=function(a){return!1===a},c.$formatters.push(function(a){return oa(a,k)}),c.$parsers.push(function(a){return a?k:l})},hidden:B,button:B,submit:B,reset:B,file:B},Fc=["$browser","$sniffer","$filter","$parse",function(a,b,d,c){return{restrict:"E",require:["?ngModel"],link:{pre:function(e,f,g,h){h[0]&&(Xd[G(g.type)]||Xd.text)(e,f,g,h[0],b,a,d,c)}}}}],Lg=/^(true|false|\d+)$/,Ue=function(){return{restrict:"A",priority:100,compile:function(a,b){return Lg.test(b.ngValue)?function(a,b,e){e.$set("value",a.$eval(e.ngValue))}:function(a,b,e){a.$watch(e.ngValue,function(a){e.$set("value",a)})}}}},ue=["$compile",function(a){return{restrict:"AC",compile:function(b){return a.$$addBindingClass(b),function(b,c,e){a.$$addBindingInfo(c,e.ngBind),c=c[0],b.$watch(e.ngBind,function(a){c.textContent=x(a)?"":a})}}}}],we=["$interpolate","$compile",function(a,b){return{compile:function(d){return b.$$addBindingClass(d),function(c,d,f){c=a(d.attr(f.$attr.ngBindTemplate)),b.$$addBindingInfo(d,c.expressions),d=d[0],f.$observe("ngBindTemplate",function(a){d.textContent=x(a)?"":a})}}}}],ve=["$sce","$parse","$compile",function(a,b,d){return{restrict:"A",compile:function(c,e){var f=b(e.ngBindHtml),g=b(e.ngBindHtml,function(a){return(a||"").toString()});return d.$$addBindingClass(c),function(b,c,e){d.$$addBindingInfo(c,e.ngBindHtml),b.$watch(g,function(){c.html(a.getTrustedHtml(f(b))||"")})}}}}],Te=ba({restrict:"A",require:"ngModel",link:function(a,b,d,c){c.$viewChangeListeners.push(function(){a.$eval(d.ngChange)})}}),xe=oc("",!0),ze=oc("Odd",0),ye=oc("Even",1),Ae=Ma({compile:function(a,b){b.$set("ngCloak",v),a.removeClass("ng-cloak")}}),Be=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],Kc={},Mg={blur:!0,focus:!0};n("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(a){var b=va("ng-"+a);Kc[b]=["$parse","$rootScope",function(d,c){return{restrict:"A",compile:function(e,f){var g=d(f[b],null,!0);return function(b,d){d.on(a,function(d){var e=function(){g(b,{$event:d})};Mg[a]&&c.$$phase?b.$evalAsync(e):b.$apply(e)})}}}}]});var Ee=["$animate",function(a){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(b,d,c,e,f){var g,h,k;b.$watch(c.ngIf,function(b){b?h||f(function(b,e){h=e,b[b.length++]=W.createComment(" end ngIf: "+c.ngIf+" "),g={clone:b},a.enter(b,d.parent(),d)}):(k&&(k.remove(),k=null),h&&(h.$destroy(),h=null),g&&(k=tb(g.clone),a.leave(k).then(function(){k=null}),g=null))})}}}],Fe=["$templateRequest","$anchorScroll","$animate",function(a,b,d){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:ia.noop,compile:function(c,e){var f=e.ngInclude||e.src,g=e.onload||"",h=e.autoscroll;return function(c,e,m,n,s){var v,t,p,q=0,w=function(){t&&(t.remove(),t=null),v&&(v.$destroy(),v=null),p&&(d.leave(p).then(function(){t=null}),t=p,p=null)};c.$watch(f,function(f){var m=function(){!y(h)||h&&!c.$eval(h)||b()},z=++q;f?(a(f,!0).then(function(a){if(!c.$$destroyed&&z===q){var b=c.$new();n.template=a,a=s(b,function(a){w(),d.enter(a,null,e).then(m)}),v=b,p=a,v.$emit("$includeContentLoaded",f),c.$eval(g)}},function(){c.$$destroyed||z!==q||(w(),c.$emit("$includeContentError",f))}),c.$emit("$includeContentRequested",f)):(w(),n.template=null)})}}}}],We=["$compile",function(a){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(b,d,c,e){ga.call(d[0]).match(/SVG/)?(d.empty(),a(Nc(e.template,W).childNodes)(b,function(a){d.append(a)},{futureParentElement:d})):(d.html(e.template),a(d.contents())(b))}}}],Ge=Ma({priority:450,compile:function(){return{pre:function(a,b,d){a.$eval(d.ngInit)}}}}),Se=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(a,b,d,c){var e=b.attr(d.$attr.ngList)||", ",f="false"!==d.ngTrim,g=f?X(e):e;c.$parsers.push(function(a){if(!x(a)){var b=[];return a&&n(a.split(g),function(a){a&&b.push(f?X(a):a)}),b}}),c.$formatters.push(function(a){return L(a)?a.join(e):v}),c.$isEmpty=function(a){return!a||!a.length}}}},ob="ng-valid",Od="ng-invalid",Ya="ng-pristine",Nb="ng-dirty",Qd="ng-pending",nb=H("ngModel"),Ng=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$rootScope","$q","$interpolate",function(a,b,d,c,e,f,g,h,k,l){this.$modelValue=this.$viewValue=Number.NaN,this.$$rawModelValue=v,this.$validators={},this.$asyncValidators={},this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$untouched=!0,this.$touched=!1,this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$error={},this.$$success={},this.$pending=v,this.$name=l(d.name||"",!1)(a),this.$$parentForm=Mb;var t,m=e(d.ngModel),r=m.assign,q=m,I=r,K=null,p=this;this.$$setOptions=function(a){if((p.$options=a)&&a.getterSetter){var b=e(d.ngModel+"()"),f=e(d.ngModel+"($$$p)");q=function(a){var c=m(a);return D(c)&&(c=b(a)),c},I=function(a,b){D(m(a))?f(a,{$$$p:p.$modelValue}):r(a,p.$modelValue)}}else if(!m.assign)throw nb("nonassign",d.ngModel,ta(c))},this.$render=B,this.$isEmpty=function(a){return x(a)||""===a||null===a||a!==a},this.$$updateEmptyClasses=function(a){p.$isEmpty(a)?(f.removeClass(c,"ng-not-empty"),f.addClass(c,"ng-empty")):(f.removeClass(c,"ng-empty"),f.addClass(c,"ng-not-empty"))};var w=0;Ld({ctrl:this,$element:c,set:function(a,b){a[b]=!0},unset:function(a,b){delete a[b]},$animate:f}),this.$setPristine=function(){p.$dirty=!1,p.$pristine=!0,f.removeClass(c,Nb),f.addClass(c,Ya)},this.$setDirty=function(){p.$dirty=!0,p.$pristine=!1,f.removeClass(c,Ya),f.addClass(c,Nb),p.$$parentForm.$setDirty()},this.$setUntouched=function(){p.$touched=!1,p.$untouched=!0,f.setClass(c,"ng-untouched","ng-touched")},this.$setTouched=function(){p.$touched=!0,p.$untouched=!1,f.setClass(c,"ng-touched","ng-untouched")},this.$rollbackViewValue=function(){g.cancel(K),p.$viewValue=p.$$lastCommittedViewValue,p.$render()},this.$validate=function(){if(!N(p.$modelValue)||!isNaN(p.$modelValue)){var a=p.$$rawModelValue,b=p.$valid,c=p.$modelValue,d=p.$options&&p.$options.allowInvalid;p.$$runValidators(a,p.$$lastCommittedViewValue,function(e){d||b===e||(p.$modelValue=e?a:v,p.$modelValue!==c&&p.$$writeModelToScope())})}},this.$$runValidators=function(a,b,c){function d(){var c=!0;return n(p.$validators,function(d,e){var g=d(a,b);c=c&&g,f(e,g)}),!!c||(n(p.$asyncValidators,function(a,b){f(b,null)}),!1)}function e(){var c=[],d=!0;n(p.$asyncValidators,function(e,g){var h=e(a,b);if(!h||!D(h.then))throw nb("nopromise",h);f(g,v),c.push(h.then(function(){f(g,!0)},function(a){d=!1,f(g,!1)}))}),c.length?k.all(c).then(function(){g(d)},B):g(!0)}function f(a,b){h===w&&p.$setValidity(a,b)}function g(a){h===w&&c(a)}w++;var h=w;!function(){var a=p.$$parserName||"parse";return x(t)?(f(a,null),!0):(t||(n(p.$validators,function(a,b){f(b,null)}),n(p.$asyncValidators,function(a,b){f(b,null)})),f(a,t),t)}()?g(!1):d()?e():g(!1)},this.$commitViewValue=function(){var a=p.$viewValue;g.cancel(K),(p.$$lastCommittedViewValue!==a||""===a&&p.$$hasNativeValidators)&&(p.$$updateEmptyClasses(a),p.$$lastCommittedViewValue=a,p.$pristine&&this.$setDirty(),this.$$parseAndValidate())},this.$$parseAndValidate=function(){var b=p.$$lastCommittedViewValue;if(t=!x(b)||v)for(var c=0;c<p.$parsers.length;c++)if(b=p.$parsers[c](b),x(b)){t=!1;break}N(p.$modelValue)&&isNaN(p.$modelValue)&&(p.$modelValue=q(a));var d=p.$modelValue,e=p.$options&&p.$options.allowInvalid;p.$$rawModelValue=b,e&&(p.$modelValue=b,p.$modelValue!==d&&p.$$writeModelToScope()),p.$$runValidators(b,p.$$lastCommittedViewValue,function(a){e||(p.$modelValue=a?b:v,p.$modelValue!==d&&p.$$writeModelToScope())})},this.$$writeModelToScope=function(){I(a,p.$modelValue),n(p.$viewChangeListeners,function(a){try{a()}catch(c){b(c)}})},this.$setViewValue=function(a,b){p.$viewValue=a,p.$options&&!p.$options.updateOnDefault||p.$$debounceViewValueCommit(b)},this.$$debounceViewValueCommit=function(b){var c=0,d=p.$options;d&&y(d.debounce)&&(d=d.debounce,N(d)?c=d:N(d[b])?c=d[b]:N(d.default)&&(c=d.default)),g.cancel(K),c?K=g(function(){p.$commitViewValue()},c):h.$$phase?p.$commitViewValue():a.$apply(function(){p.$commitViewValue()})},a.$watch(function(){var b=q(a);if(b!==p.$modelValue&&(p.$modelValue===p.$modelValue||b===b)){p.$modelValue=p.$$rawModelValue=b,t=v;for(var c=p.$formatters,d=c.length,e=b;d--;)e=c[d](e);p.$viewValue!==e&&(p.$$updateEmptyClasses(e),p.$viewValue=p.$$lastCommittedViewValue=e,p.$render(),p.$$runValidators(b,e,B))}return b})}],Re=["$rootScope",function(a){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:Ng,priority:1,compile:function(b){return b.addClass(Ya).addClass("ng-untouched").addClass(ob),{pre:function(a,b,e,f){var g=f[0];b=f[1]||g.$$parentForm,g.$$setOptions(f[2]&&f[2].$options),b.$addControl(g),e.$observe("name",function(a){g.$name!==a&&g.$$parentForm.$$renameControl(g,a)}),a.$on("$destroy",function(){g.$$parentForm.$removeControl(g)})},post:function(b,c,e,f){var g=f[0];g.$options&&g.$options.updateOn&&c.on(g.$options.updateOn,function(a){g.$$debounceViewValueCommit(a&&a.type)}),c.on("blur",function(c){g.$touched||(a.$$phase?b.$evalAsync(g.$setTouched):b.$apply(g.$setTouched))})}}}}}],Og=/(\s+|^)default(\s+|$)/,Ve=function(){return{restrict:"A",controller:["$scope","$attrs",function(a,b){var d=this;this.$options=Oa(a.$eval(b.ngModelOptions)),y(this.$options.updateOn)?(this.$options.updateOnDefault=!1,this.$options.updateOn=X(this.$options.updateOn.replace(Og,function(){return d.$options.updateOnDefault=!0," "}))):this.$options.updateOnDefault=!0}]}},He=Ma({terminal:!0,priority:1e3}),Pg=H("ngOptions"),Qg=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,Pe=["$compile","$parse",function(a,b){function d(a,c,d){function e(a,b,c,d,f){this.selectValue=a,this.viewValue=b,this.label=c,this.group=d,this.disabled=f}function l(a){var b;if(!q&&Ca(a))b=a;else{b=[];for(var c in a)a.hasOwnProperty(c)&&"$"!==c.charAt(0)&&b.push(c)}return b}var m=a.match(Qg);if(!m)throw Pg("iexp",a,ta(c));var n=m[5]||m[7],q=m[6];a=/ as /.test(m[0])&&m[1];var v=m[9];c=b(m[2]?m[1]:n);var y=a&&b(a)||c,t=v&&b(v),p=v?function(a,b){return t(d,b)}:function(a){return Fa(a)},w=function(a,b){return p(a,B(a,b))},u=b(m[2]||m[1]),x=b(m[3]||""),z=b(m[4]||""),A=b(m[8]),C={},B=q?function(a,b){return C[q]=b,C[n]=a,C}:function(a){return C[n]=a,C};return{trackBy:v,getTrackByValue:w,getWatchables:b(A,function(a){var b=[];a=a||[];for(var c=l(a),e=c.length,f=0;f<e;f++){var g=a===c?f:c[f],k=B(a[g],g),g=p(a[g],k);b.push(g),(m[2]||m[1])&&(g=u(d,k),b.push(g)),m[4]&&(k=z(d,k),b.push(k))}return b}),getOptions:function(){for(var a=[],b={},c=A(d)||[],f=l(c),g=f.length,m=0;m<g;m++){
var n=c===f?m:f[m],r=B(c[n],n),q=y(d,r),n=p(q,r),s=u(d,r),t=x(d,r),r=z(d,r),q=new e(n,q,s,t,r);a.push(q),b[n]=q}return{items:a,selectValueMap:b,getOptionFromViewValue:function(a){return b[w(a)]},getViewValueFromOption:function(a){return v?ia.copy(a.viewValue):a.viewValue}}}}}var c=W.createElement("option"),e=W.createElement("optgroup");return{restrict:"A",terminal:!0,require:["select","ngModel"],link:{pre:function(a,b,c,d){d[0].registerOption=B},post:function(b,g,h,k){function l(a,b){a.element=b,b.disabled=a.disabled,a.label!==b.label&&(b.label=a.label,b.textContent=a.label),a.value!==b.value&&(b.value=a.selectValue)}function m(a,b,c,d){return b&&G(b.nodeName)===c?c=b:(c=d.cloneNode(!1),b?a.insertBefore(c,b):a.appendChild(c)),c}function r(a){for(var b;a;)b=a.nextSibling,$b(a),a=b}function q(a){var b=w&&w[0],c=A&&A[0];if(b||c)for(;a&&(a===b||a===c||8===a.nodeType||"option"===ra(a)&&""===a.value);)a=a.nextSibling;return a}function v(){var a=D&&x.readValue();D=E.getOptions();var b={},d=g[0].firstChild;if(z&&g.prepend(w),d=q(d),D.items.forEach(function(a){var f,h;y(a.group)?(f=b[a.group],f||(f=m(g[0],d,"optgroup",e),d=f.nextSibling,f.label=a.group,f=b[a.group]={groupElement:f,currentOptionElement:f.firstChild}),h=m(f.groupElement,f.currentOptionElement,"option",c),l(a,h),f.currentOptionElement=h.nextSibling):(h=m(g[0],d,"option",c),l(a,h),d=h.nextSibling)}),Object.keys(b).forEach(function(a){r(b[a].currentOptionElement)}),r(d),t.$render(),!t.$isEmpty(a)){var f=x.readValue();(E.trackBy||p?oa(a,f):a===f)||(t.$setViewValue(f),t.$render())}}var w,x=k[0],t=k[1],p=h.multiple;k=0;for(var u=g.children(),B=u.length;k<B;k++)if(""===u[k].value){w=u.eq(k);break}var z=!!w,A=C(c.cloneNode(!1));A.val("?");var D,E=d(h.ngOptions,g,b);p?(t.$isEmpty=function(a){return!a||0===a.length},x.writeValue=function(a){D.items.forEach(function(a){a.element.selected=!1}),a&&a.forEach(function(a){(a=D.getOptionFromViewValue(a))&&!a.disabled&&(a.element.selected=!0)})},x.readValue=function(){var a=g.val()||[],b=[];return n(a,function(a){(a=D.selectValueMap[a])&&!a.disabled&&b.push(D.getViewValueFromOption(a))}),b},E.trackBy&&b.$watchCollection(function(){if(L(t.$viewValue))return t.$viewValue.map(function(a){return E.getTrackByValue(a)})},function(){t.$render()})):(x.writeValue=function(a){var b=D.getOptionFromViewValue(a);b&&!b.disabled?g[0].value!==b.selectValue&&(A.remove(),z||w.remove(),g[0].value=b.selectValue,b.element.selected=!0,b.element.setAttribute("selected","selected")):null===a||z?(A.remove(),z||g.prepend(w),g.val(""),w.prop("selected",!0),w.attr("selected",!0)):(z||w.remove(),g.prepend(A),g.val("?"),A.prop("selected",!0),A.attr("selected",!0))},x.readValue=function(){var a=D.selectValueMap[g.val()];return a&&!a.disabled?(z||w.remove(),A.remove(),D.getViewValueFromOption(a)):null},E.trackBy&&b.$watch(function(){return E.getTrackByValue(t.$viewValue)},function(){t.$render()})),z?(w.remove(),a(w)(b),w.removeClass("ng-scope")):w=C(c.cloneNode(!1)),v(),b.$watchCollection(E.getWatchables,v)}}}}],Ie=["$locale","$interpolate","$log",function(a,b,d){var c=/{}/g,e=/^when(Minus)?(.+)$/;return{link:function(f,g,h){function k(a){g.text(a||"")}var u,l=h.count,m=h.$attr.when&&g.attr(h.$attr.when),r=h.offset||0,q=f.$eval(m)||{},v={},y=b.startSymbol(),t=b.endSymbol(),p=y+l+"-"+r+t,w=ia.noop;n(h,function(a,b){var c=e.exec(b);c&&(c=(c[1]?"-":"")+G(c[2]),q[c]=g.attr(h.$attr[b]))}),n(q,function(a,d){v[d]=b(a.replace(c,p))}),f.$watch(l,function(b){var c=parseFloat(b),e=isNaN(c);e||c in q||(c=a.pluralCat(c-r)),c===u||e&&N(u)&&isNaN(u)||(w(),e=v[c],x(e)?(null!=b&&d.debug("ngPluralize: no rule defined for '"+c+"' in "+m),w=B,k()):w=f.$watch(e,k),u=c)})}}}],Je=["$parse","$animate",function(a,b){var d=H("ngRepeat"),c=function(a,b,c,d,k,l,m){a[c]=d,k&&(a[k]=l),a.$index=b,a.$first=0===b,a.$last=b===m-1,a.$middle=!(a.$first||a.$last),a.$odd=!(a.$even=0==(1&b))};return{restrict:"A",multiElement:!0,transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,compile:function(e,f){var g=f.ngRepeat,h=W.createComment(" end ngRepeat: "+g+" "),k=g.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!k)throw d("iexp",g);var l=k[1],m=k[2],r=k[3],q=k[4],k=l.match(/^(?:(\s*[\$\w]+)|\(\s*([\$\w]+)\s*,\s*([\$\w]+)\s*\))$/);if(!k)throw d("iidexp",l);var x=k[3]||k[1],y=k[2];if(r&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(r)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(r)))throw d("badident",r);var t,p,w,u,B={$id:Fa};return q?t=a(q):(w=function(a,b){return Fa(b)},u=function(a){return a}),function(a,e,f,k,l){t&&(p=function(b,c,d){return y&&(B[y]=b),B[x]=c,B.$index=d,t(a,B)});var q=Z();a.$watchCollection(m,function(f){var k,m,t,D,E,H,F,L,G,N,s=e[0],B=Z();if(r&&(a[r]=f),Ca(f))L=f,m=p||w;else for(N in m=p||u,L=[],f)sa.call(f,N)&&"$"!==N.charAt(0)&&L.push(N);for(D=L.length,N=Array(D),k=0;k<D;k++)if(E=f===L?k:L[k],H=f[E],F=m(E,H,k),q[F])G=q[F],delete q[F],B[F]=G,N[k]=G;else{if(B[F])throw n(N,function(a){a&&a.scope&&(q[a.id]=a)}),d("dupes",g,F,H);N[k]={id:F,scope:v,clone:v},B[F]=!0}for(t in q){if(G=q[t],F=tb(G.clone),b.leave(F),F[0].parentNode)for(k=0,m=F.length;k<m;k++)F[k].$$NG_REMOVED=!0;G.scope.$destroy()}for(k=0;k<D;k++)if(E=f===L?k:L[k],H=f[E],G=N[k],G.scope){t=s;do{t=t.nextSibling}while(t&&t.$$NG_REMOVED);G.clone[0]!=t&&b.move(tb(G.clone),null,C(s)),s=G.clone[G.clone.length-1],c(G.scope,k,x,H,y,E,D)}else l(function(a,d){G.scope=d;var e=h.cloneNode(!1);a[a.length++]=e,b.enter(a,null,C(s)),s=e,G.clone=a,B[G.id]=G,c(G.scope,k,x,H,y,E,D)});q=B})}}}}],Ke=["$animate",function(a){return{restrict:"A",multiElement:!0,link:function(b,d,c){b.$watch(c.ngShow,function(b){a[b?"removeClass":"addClass"](d,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],De=["$animate",function(a){return{restrict:"A",multiElement:!0,link:function(b,d,c){b.$watch(c.ngHide,function(b){a[b?"addClass":"removeClass"](d,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],Le=Ma(function(a,b,d){a.$watch(d.ngStyle,function(a,d){d&&a!==d&&n(d,function(a,c){b.css(c,"")}),a&&b.css(a)},!0)}),Me=["$animate",function(a){return{require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(b,d,c,e){var f=[],g=[],h=[],k=[],l=function(a,b){return function(){a.splice(b,1)}};b.$watch(c.ngSwitch||c.on,function(b){var c,d;for(c=0,d=h.length;c<d;++c)a.cancel(h[c]);for(c=h.length=0,d=k.length;c<d;++c){var q=tb(g[c].clone);k[c].$destroy(),(h[c]=a.leave(q)).then(l(h,c))}g.length=0,k.length=0,(f=e.cases["!"+b]||e.cases["?"])&&n(f,function(b){b.transclude(function(c,d){k.push(d);var e=b.element;c[c.length++]=W.createComment(" end ngSwitchWhen: "),g.push({clone:c}),a.enter(c,e.parent(),e)})})})}}}],Ne=Ma({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(a,b,d,c,e){c.cases["!"+d.ngSwitchWhen]=c.cases["!"+d.ngSwitchWhen]||[],c.cases["!"+d.ngSwitchWhen].push({transclude:e,element:b})}}),Oe=Ma({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(a,b,d,c,e){c.cases["?"]=c.cases["?"]||[],c.cases["?"].push({transclude:e,element:b})}}),Rg=H("ngTransclude"),Qe=Ma({restrict:"EAC",link:function(a,b,d,c,e){if(d.ngTransclude===d.$attr.ngTransclude&&(d.ngTransclude=""),!e)throw Rg("orphan",ta(b));e(function(a){a.length&&(b.empty(),b.append(a))},null,d.ngTransclude||d.ngTranscludeSlot)}}),qe=["$templateCache",function(a){return{restrict:"E",terminal:!0,compile:function(b,d){"text/ng-template"==d.type&&a.put(d.id,b[0].text)}}}],Sg={$setViewValue:B,$render:B},Tg=["$element","$scope","$attrs",function(a,b,d){var c=this,e=new Ua;c.ngModelCtrl=Sg,c.unknownOption=C(W.createElement("option")),c.renderUnknownOption=function(b){b="? "+Fa(b)+" ?",c.unknownOption.val(b),a.prepend(c.unknownOption),a.val(b)},b.$on("$destroy",function(){c.renderUnknownOption=B}),c.removeUnknownOption=function(){c.unknownOption.parent()&&c.unknownOption.remove()},c.readValue=function(){return c.removeUnknownOption(),a.val()},c.writeValue=function(b){c.hasOption(b)?(c.removeUnknownOption(),a.val(b),""===b&&c.emptyOption.prop("selected",!0)):null==b&&c.emptyOption?(c.removeUnknownOption(),a.val("")):c.renderUnknownOption(b)},c.addOption=function(a,b){if(8!==b[0].nodeType){Ta(a,'"option value"'),""===a&&(c.emptyOption=b);var d=e.get(a)||0;e.put(a,d+1),c.ngModelCtrl.$render(),b[0].hasAttribute("selected")&&(b[0].selected=!0)}},c.removeOption=function(a){var b=e.get(a);b&&(1===b?(e.remove(a),""===a&&(c.emptyOption=v)):e.put(a,b-1))},c.hasOption=function(a){return!!e.get(a)},c.registerOption=function(a,b,d,e,l){if(e){var m;d.$observe("value",function(a){y(m)&&c.removeOption(m),m=a,c.addOption(a,b)})}else l?a.$watch(l,function(a,e){d.$set("value",a),e!==a&&c.removeOption(e),c.addOption(a,b)}):c.addOption(d.value,b);b.on("$destroy",function(){c.removeOption(d.value),c.ngModelCtrl.$render()})}}],re=function(){return{restrict:"E",require:["select","?ngModel"],controller:Tg,priority:1,link:{pre:function(a,b,d,c){var e=c[1];if(e){var f=c[0];if(f.ngModelCtrl=e,b.on("change",function(){a.$apply(function(){e.$setViewValue(f.readValue())})}),d.multiple){f.readValue=function(){var a=[];return n(b.find("option"),function(b){b.selected&&a.push(b.value)}),a},f.writeValue=function(a){var c=new Ua(a);n(b.find("option"),function(a){a.selected=y(c.get(a.value))})};var g,h=NaN;a.$watch(function(){h!==e.$viewValue||oa(g,e.$viewValue)||(g=na(e.$viewValue),e.$render()),h=e.$viewValue}),e.$isEmpty=function(a){return!a||0===a.length}}}},post:function(a,b,d,c){var e=c[1];if(e){var f=c[0];e.$render=function(){f.writeValue(e.$viewValue)}}}}}},te=["$interpolate",function(a){return{restrict:"E",priority:100,compile:function(b,d){if(y(d.value))var c=a(d.value,!0);else{var e=a(b.text(),!0);e||d.$set("value",b.text())}return function(a,b,d){var k=b.parent();(k=k.data("$selectController")||k.parent().data("$selectController"))&&k.registerOption(a,b,d,c,e)}}}}],se=ba({restrict:"E",terminal:!1}),Hc=function(){return{restrict:"A",require:"?ngModel",link:function(a,b,d,c){c&&(d.required=!0,c.$validators.required=function(a,b){return!d.required||!c.$isEmpty(b)},d.$observe("required",function(){c.$validate()}))}}},Gc=function(){return{restrict:"A",require:"?ngModel",link:function(a,b,d,c){if(c){var e,f=d.ngPattern||d.pattern;d.$observe("pattern",function(a){if(F(a)&&0<a.length&&(a=new RegExp("^"+a+"$")),a&&!a.test)throw H("ngPattern")("noregexp",f,a,ta(b));e=a||v,c.$validate()}),c.$validators.pattern=function(a,b){return c.$isEmpty(b)||x(e)||e.test(b)}}}}},Jc=function(){return{restrict:"A",require:"?ngModel",link:function(a,b,d,c){if(c){var e=-1;d.$observe("maxlength",function(a){a=ca(a),e=isNaN(a)?-1:a,c.$validate()}),c.$validators.maxlength=function(a,b){return 0>e||c.$isEmpty(b)||b.length<=e}}}}},Ic=function(){return{restrict:"A",require:"?ngModel",link:function(a,b,d,c){if(c){var e=0;d.$observe("minlength",function(a){e=ca(a)||0,c.$validate()}),c.$validators.minlength=function(a,b){return c.$isEmpty(b)||b.length>=e}}}}};O.angular.bootstrap?console.log("WARNING: Tried to load angular more than once."):(je(),le(ia),ia.module("ngLocale",[],["$provide",function(a){function b(a){a+="";var b=a.indexOf(".");return-1==b?0:a.length-b-1}a.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:"January February March April May June July August September October November December".split(" "),SHORTDAY:"Sun Mon Tue Wed Thu Fri Sat".split(" "),SHORTMONTH:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),STANDALONEMONTH:"January February March April May June July August September October November December".split(" "),WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a",short:"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""}]},id:"en-us",localeID:"en_US",pluralCat:function(a,c){var e=0|a,f=c;return v===f&&(f=Math.min(b(a),3)),Math.pow(10,f),1==e&&0==f?"one":"other"}})}]),C(W).ready(function(){fe(W,Ac)}))}(window,document),!window.angular.$$csp().noInlineStyle&&window.angular.element(document.head).prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style>'),function(){"use strict";angular.module("inspinia",["ui.router","oc.lazyLoad","ui.bootstrap","ngIdle","ngSanitize","oitozero.ngSweetAlert","LocalStorageModule","ui.bootstrap.datetimepicker","anguFixedHeaderTable","chart.js","angularPayments","angularjs-dropdown-multiselect"])}();var appConfig={apiDomain:"http://dev-api.artecsan.com/",token:null,apiAuthorization:"Basic T2ZmZXJCb3hXRUJDbDFlbnQ6T2ZmZXJCb3hXRUJTM2NyM3Q=",googleCaptcha:"6Lc17RIUAAAAACKwIeV24O6S51nMWvzNqRxX8tm_",sessionExpires:9,apiBincodesDomain:"https://api.bincodes.com/"},ENV="development";if("production"===ENV&&(appConfig.apiDomain="http://dev-api.artecsan.com/"),angular.module("inspinia").config(config).constant("appConfig",appConfig).run(function($rootScope,$state,core,auth){$rootScope.$state=$state,$rootScope.$on("$stateChangeSuccess",function(event,currentRoute,previousRoute){$("html, body").animate({scrollTop:1})}),core.init(),auth.fillAuthData()}),angular.module("inspinia").directive("pageTitle",pageTitle).directive("sideNavigation",sideNavigation).directive("iboxTools",iboxTools).directive("minimalizaSidebar",minimalizaSidebar).directive("vectorMap",vectorMap).directive("sparkline",sparkline).directive("icheck",icheck).directive("ionRangeSlider",ionRangeSlider).directive("dropZone",dropZone).directive("responsiveVideo",responsiveVideo).directive("chatSlimScroll",chatSlimScroll).directive("customValid",customValid).directive("fullScroll",fullScroll).directive("closeOffCanvas",closeOffCanvas).directive("clockPicker",clockPicker).directive("landingScrollspy",landingScrollspy).directive("fitHeight",fitHeight).directive("iboxToolsFullScreen",iboxToolsFullScreen).directive("slimScroll",slimScroll).directive("truncate",truncate).directive("touchSpin",touchSpin).directive("markdownEditor",markdownEditor),angular.module("inspinia").controller("MainCtrl",MainCtrl).controller("notifyCtrl",notifyCtrl).controller("ModalInstanceRecipeCtrl",ModalInstanceRecipeCtrl).controller("ModalInstanceMenuCtrl",ModalInstanceMenuCtrl).controller("ModalInstanceDeliveryCtrl",ModalInstanceDeliveryCtrl),function($,undefined){function focusable(element,isTabIndexNotNaN){var map,mapName,img,nodeName=element.nodeName.toLowerCase();return"area"===nodeName?(map=element.parentNode,mapName=map.name,!(!element.href||!mapName||"map"!==map.nodeName.toLowerCase())&&(!!(img=$("img[usemap=#"+mapName+"]")[0])&&visible(img))):(/input|select|textarea|button|object/.test(nodeName)?!element.disabled:"a"===nodeName?element.href||isTabIndexNotNaN:isTabIndexNotNaN)&&visible(element)}function visible(element){return $.expr.filters.visible(element)&&!$(element).parents().addBack().filter(function(){return"hidden"===$.css(this,"visibility")}).length}var uuid=0,runiqueId=/^ui-id-\d+$/;$.ui=$.ui||{},$.extend($.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),$.fn.extend({focus:function(orig){return function(delay,fn){return"number"==typeof delay?this.each(function(){var elem=this;setTimeout(function(){$(elem).focus(),fn&&fn.call(elem)},delay)}):orig.apply(this,arguments)}}($.fn.focus),scrollParent:function(){var scrollParent;return scrollParent=$.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test($.css(this,"position"))&&/(auto|scroll)/.test($.css(this,"overflow")+$.css(this,"overflow-y")+$.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test($.css(this,"overflow")+$.css(this,"overflow-y")+$.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!scrollParent.length?$(document):scrollParent},zIndex:function(zIndex){if(zIndex!==undefined)return this.css("zIndex",zIndex);if(this.length)for(var position,value,elem=$(this[0]);elem.length&&elem[0]!==document;){if(("absolute"===(position=elem.css("position"))||"relative"===position||"fixed"===position)&&(value=parseInt(elem.css("zIndex"),10),!isNaN(value)&&0!==value))return value;elem=elem.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++uuid)})},removeUniqueId:function(){return this.each(function(){runiqueId.test(this.id)&&$(this).removeAttr("id")})}}),$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return!!$.data(elem,dataName)}}):function(elem,i,match){return!!$.data(elem,match[3])},focusable:function(element){return focusable(element,!isNaN($.attr(element,"tabindex")))},tabbable:function(element){var tabIndex=$.attr(element,"tabindex"),isTabIndexNaN=isNaN(tabIndex);return(isTabIndexNaN||tabIndex>=0)&&focusable(element,!isTabIndexNaN)}}),$("<a>").outerWidth(1).jquery||$.each(["Width","Height"],function(i,name){function reduce(elem,size,border,margin){return $.each(side,function(){size-=parseFloat($.css(elem,"padding"+this))||0,border&&(size-=parseFloat($.css(elem,"border"+this+"Width"))||0),margin&&(size-=parseFloat($.css(elem,"margin"+this))||0)}),size}var side="Width"===name?["Left","Right"]:["Top","Bottom"],type=name.toLowerCase(),orig={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};$.fn["inner"+name]=function(size){return size===undefined?orig["inner"+name].call(this):this.each(function(){$(this).css(type,reduce(this,size)+"px")})},$.fn["outer"+name]=function(size,margin){return"number"!=typeof size?orig["outer"+name].call(this,size):this.each(function(){$(this).css(type,reduce(this,size,!0,margin)+"px")})}}),$.fn.addBack||($.fn.addBack=function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}),$("<a>").data("a-b","a").removeData("a-b").data("a-b")&&($.fn.removeData=function(removeData){return function(key){return arguments.length?removeData.call(this,$.camelCase(key)):removeData.call(this)}}($.fn.removeData)),$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),$.support.selectstart="onselectstart"in document.createElement("div"),$.fn.extend({disableSelection:function(){return this.bind(($.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(event){event.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),$.extend($.ui,{plugin:{add:function(module,option,set){var i,proto=$.ui[module].prototype;for(i in set)proto.plugins[i]=proto.plugins[i]||[],proto.plugins[i].push([option,set[i]])},call:function(instance,name,args){var i,set=instance.plugins[name];if(set&&instance.element[0].parentNode&&11!==instance.element[0].parentNode.nodeType)for(i=0;i<set.length;i++)instance.options[set[i][0]]&&set[i][1].apply(instance.element,args)}},hasScroll:function(el,a){if("hidden"===$(el).css("overflow"))return!1;var scroll=a&&"left"===a?"scrollLeft":"scrollTop",has=!1;return el[scroll]>0||(el[scroll]=1,has=el[scroll]>0,el[scroll]=0,has)}})}(jQuery),function($,undefined){var uuid=0,slice=Array.prototype.slice,_cleanData=$.cleanData;$.cleanData=function(elems){for(var elem,i=0;null!=(elem=elems[i]);i++)try{$(elem).triggerHandler("remove")}catch(e){}_cleanData(elems)},$.widget=function(name,base,prototype){var fullName,existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0];name=name.split(".")[1],fullName=namespace+"-"+name,prototype||(prototype=base,base=$.Widget),$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName)},$[namespace]=$[namespace]||{},existingConstructor=$[namespace][name],constructor=$[namespace][name]=function(options,element){if(!this._createWidget)return new constructor(options,element);arguments.length&&this._createWidget(options,element)},$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]}),basePrototype=new base,basePrototype.options=$.widget.extend({},basePrototype.options),$.each(prototype,function(prop,value){if(!$.isFunction(value))return void(proxiedPrototype[prop]=value);proxiedPrototype[prop]=function(){var _super=function(){return base.prototype[prop].apply(this,arguments)},_superApply=function(args){return base.prototype[prop].apply(this,args)};return function(){var returnValue,__super=this._super,__superApply=this._superApply;return this._super=_super,this._superApply=_superApply,returnValue=value.apply(this,arguments),this._super=__super,this._superApply=__superApply,returnValue}}()}),constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?basePrototype.widgetEventPrefix||name:name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName}),existingConstructor?($.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto)}),delete existingConstructor._childConstructors):base._childConstructors.push(constructor),$.widget.bridge(name,constructor)},$.widget.extend=function(target){for(var key,value,input=slice.call(arguments,1),inputIndex=0,inputLength=input.length;inputIndex<inputLength;inputIndex++)for(key in input[inputIndex])value=input[inputIndex][key],input[inputIndex].hasOwnProperty(key)&&value!==undefined&&($.isPlainObject(value)?target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value):target[key]=value);return target},$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall="string"==typeof options,args=slice.call(arguments,1),returnValue=this;return options=!isMethodCall&&args.length?$.widget.extend.apply(null,[options].concat(args)):options,isMethodCall?this.each(function(){var methodValue,instance=$.data(this,fullName);return instance?$.isFunction(instance[options])&&"_"!==options.charAt(0)?(methodValue=instance[options].apply(instance,args),methodValue!==instance&&methodValue!==undefined?(returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue,!1):void 0):$.error("no such method '"+options+"' for "+name+" widget instance"):$.error("cannot call methods on "+name+" prior to initialization; attempted to call method '"+options+"'")}):this.each(function(){var instance=$.data(this,fullName);instance?instance.option(options||{})._init():$.data(this,fullName,new object(options,this))}),returnValue}},$.Widget=function(){},$.Widget._childConstructors=[],$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0],this.element=$(element),this.uuid=uuid++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=$.widget.extend({},this.options,this._getCreateOptions(),options),this.bindings=$(),this.hoverable=$(),this.focusable=$(),element!==this&&($.data(element,this.widgetFullName,this),this._on(!0,this.element,{remove:function(event){event.target===element&&this.destroy()}}),this.document=$(element.style?element.ownerDocument:element.document||element),this.window=$(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:$.noop,widget:function(){return this.element},option:function(key,value){var parts,curOption,i,options=key;if(0===arguments.length)return $.widget.extend({},this.options);if("string"==typeof key)if(options={},parts=key.split("."),key=parts.shift(),parts.length){for(curOption=options[key]=$.widget.extend({},this.options[key]),i=0;i<parts.length-1;i++)curOption[parts[i]]=curOption[parts[i]]||{},curOption=curOption[parts[i]];if(key=parts.pop(),1===arguments.length)return curOption[key]===undefined?null:curOption[key];curOption[key]=value}else{if(1===arguments.length)return this.options[key]===undefined?null:this.options[key];options[key]=value}return this._setOptions(options),this},_setOptions:function(options){var key;for(key in options)this._setOption(key,options[key]);return this},_setOption:function(key,value){return this.options[key]=value,"disabled"===key&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!value).attr("aria-disabled",value),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;"boolean"!=typeof suppressDisabledCheck&&(handlers=element,element=suppressDisabledCheck,suppressDisabledCheck=!1),handlers?(element=delegateElement=$(element),this.bindings=this.bindings.add(element)):(handlers=element,element=this.element,delegateElement=this.widget()),$.each(handlers,function(event,handler){function handlerProxy(){if(suppressDisabledCheck||!0!==instance.options.disabled&&!$(this).hasClass("ui-state-disabled"))return("string"==typeof handler?instance[handler]:handler).apply(instance,arguments)}"string"!=typeof handler&&(handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++);var match=event.match(/^(\w+)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];selector?delegateElement.delegate(selector,eventName,handlerProxy):element.bind(eventName,handlerProxy)})},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,element.unbind(eventName).undelegate(eventName)},_delay:function(handler,delay){function handlerProxy(){return("string"==typeof handler?instance[handler]:handler).apply(instance,arguments)}var instance=this;return setTimeout(handlerProxy,delay||0)},_hoverable:function(element){this.hoverable=this.hoverable.add(element),this._on(element,{mouseenter:function(event){$(event.currentTarget).addClass("ui-state-hover")},mouseleave:function(event){$(event.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(element){this.focusable=this.focusable.add(element),this._on(element,{focusin:function(event){$(event.currentTarget).addClass("ui-state-focus")},focusout:function(event){$(event.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];if(data=data||{},event=$.Event(event),event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase(),event.target=this.element[0],orig=event.originalEvent)for(prop in orig)prop in event||(event[prop]=orig[prop]);return this.element.trigger(event,data),!($.isFunction(callback)&&!1===callback.apply(this.element[0],[event].concat(data))||event.isDefaultPrevented())}},$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){"string"==typeof options&&(options={effect:options});var hasOptions,effectName=options?!0===options||"number"==typeof options?defaultEffect:options.effect||defaultEffect:method;options=options||{},"number"==typeof options&&(options={duration:options}),hasOptions=!$.isEmptyObject(options),options.complete=callback,options.delay&&element.delay(options.delay),hasOptions&&$.effects&&$.effects.effect[effectName]?element[method](options):effectName!==method&&element[effectName]?element[effectName](options.duration,options.easing,callback):element.queue(function(next){$(this)[method](),callback&&callback.call(element[0]),next()})}})}(jQuery),function($,undefined){var mouseHandled=!1;$(document).mouseup(function(){mouseHandled=!1}),$.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var that=this;this.element.bind("mousedown."+this.widgetName,function(event){return that._mouseDown(event)}).bind("click."+this.widgetName,function(event){if(!0===$.data(event.target,that.widgetName+".preventClickEvent"))return $.removeData(event.target,that.widgetName+".preventClickEvent"),event.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&$(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(event){if(!mouseHandled){this._mouseStarted&&this._mouseUp(event),this._mouseDownEvent=event;var that=this,btnIsLeft=1===event.which,elIsCancel=!("string"!=typeof this.options.cancel||!event.target.nodeName)&&$(event.target).closest(this.options.cancel).length;return!(btnIsLeft&&!elIsCancel&&this._mouseCapture(event))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){that.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(event)&&this._mouseDelayMet(event)&&(this._mouseStarted=!1!==this._mouseStart(event),!this._mouseStarted)?(event.preventDefault(),!0):(!0===$.data(event.target,this.widgetName+".preventClickEvent")&&$.removeData(event.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(event){return that._mouseMove(event)},this._mouseUpDelegate=function(event){return that._mouseUp(event)},$(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),event.preventDefault(),mouseHandled=!0,!0))}},_mouseMove:function(event){return $.ui.ie&&(!document.documentMode||document.documentMode<9)&&!event.button?this._mouseUp(event):this._mouseStarted?(this._mouseDrag(event),event.preventDefault()):(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,event),this._mouseStarted?this._mouseDrag(event):this._mouseUp(event)),!this._mouseStarted)},_mouseUp:function(event){return $(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,event.target===this._mouseDownEvent.target&&$.data(event.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(event)),!1},_mouseDistanceMet:function(event){return Math.max(Math.abs(this._mouseDownEvent.pageX-event.pageX),Math.abs(this._mouseDownEvent.pageY-event.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},
_mouseCapture:function(){return!0}})}(jQuery),function($,undefined){$.widget("ui.draggable",$.ui.mouse,{version:"1.10.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(event){var o=this.options;return!(this.helper||o.disabled||$(event.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(event),!!this.handle&&($(!0===o.iframeFix?"iframe":o.iframeFix).each(function(){$("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css($(this).offset()).appendTo("body")}),!0))},_mouseStart:function(event){var o=this.options;return this.helper=this._createHelper(event),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),$.ui.ddmanager&&($.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,$.extend(this.offset,{click:{left:event.pageX-this.offset.left,top:event.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(event),this.originalPageX=event.pageX,this.originalPageY=event.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this._setContainment(),!1===this._trigger("start",event)?(this._clear(),!1):(this._cacheHelperProportions(),$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,event),this._mouseDrag(event,!0),$.ui.ddmanager&&$.ui.ddmanager.dragStart(this,event),!0)},_mouseDrag:function(event,noPropagation){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(event),this.positionAbs=this._convertPositionTo("absolute"),!noPropagation){var ui=this._uiHash();if(!1===this._trigger("drag",event,ui))return this._mouseUp({}),!1;this.position=ui.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),$.ui.ddmanager&&$.ui.ddmanager.drag(this,event),!1},_mouseStop:function(event){var that=this,dropped=!1;return $.ui.ddmanager&&!this.options.dropBehaviour&&(dropped=$.ui.ddmanager.drop(this,event)),this.dropped&&(dropped=this.dropped,this.dropped=!1),!("original"===this.options.helper&&!$.contains(this.element[0].ownerDocument,this.element[0]))&&("invalid"===this.options.revert&&!dropped||"valid"===this.options.revert&&dropped||!0===this.options.revert||$.isFunction(this.options.revert)&&this.options.revert.call(this.element,dropped)?$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==that._trigger("stop",event)&&that._clear()}):!1!==this._trigger("stop",event)&&this._clear(),!1)},_mouseUp:function(event){return $("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),$.ui.ddmanager&&$.ui.ddmanager.dragStop(this,event),$.ui.mouse.prototype._mouseUp.call(this,event)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(event){return!this.options.handle||!!$(event.target).closest(this.element.find(this.options.handle)).length},_createHelper:function(event){var o=this.options,helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event])):"clone"===o.helper?this.element.clone().removeAttr("id"):this.element;return helper.parents("body").length||helper.appendTo("parent"===o.appendTo?this.element[0].parentNode:o.appendTo),helper[0]===this.element[0]||/(fixed|absolute)/.test(helper.css("position"))||helper.css("position","absolute"),helper},_adjustOffsetFromHelper:function(obj){"string"==typeof obj&&(obj=obj.split(" ")),$.isArray(obj)&&(obj={left:+obj[0],top:+obj[1]||0}),"left"in obj&&(this.offset.click.left=obj.left+this.margins.left),"right"in obj&&(this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left),"top"in obj&&(this.offset.click.top=obj.top+this.margins.top),"bottom"in obj&&(this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top)},_getParentOffset:function(){var po=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(po.left+=this.scrollParent.scrollLeft(),po.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&$.ui.ie)&&(po={top:0,left:0}),{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var p=this.element.position();return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var over,c,ce,o=this.options;return o.containment?"window"===o.containment?void(this.containment=[$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,$(window).scrollLeft()+$(window).width()-this.helperProportions.width-this.margins.left,$(window).scrollTop()+($(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===o.containment?void(this.containment=[0,0,$(document).width()-this.helperProportions.width-this.margins.left,($(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):o.containment.constructor===Array?void(this.containment=o.containment):("parent"===o.containment&&(o.containment=this.helper[0].parentNode),c=$(o.containment),void((ce=c[0])&&(over="hidden"!==c.css("overflow"),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=c))):void(this.containment=null)},_convertPositionTo:function(d,pos){pos||(pos=this.position);var mod="absolute"===d?1:-1,scroll="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:scroll.scrollTop(),left:scroll.scrollLeft()}),{top:pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*mod,left:pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*mod}},_generatePosition:function(event){var containment,co,top,left,o=this.options,scroll="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,pageX=event.pageX,pageY=event.pageY;return this.offset.scroll||(this.offset.scroll={top:scroll.scrollTop(),left:scroll.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(co=this.relative_container.offset(),containment=[this.containment[0]+co.left,this.containment[1]+co.top,this.containment[2]+co.left,this.containment[3]+co.top]):containment=this.containment,event.pageX-this.offset.click.left<containment[0]&&(pageX=containment[0]+this.offset.click.left),event.pageY-this.offset.click.top<containment[1]&&(pageY=containment[1]+this.offset.click.top),event.pageX-this.offset.click.left>containment[2]&&(pageX=containment[2]+this.offset.click.left),event.pageY-this.offset.click.top>containment[3]&&(pageY=containment[3]+this.offset.click.top)),o.grid&&(top=o.grid[1]?this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,pageY=containment?top-this.offset.click.top>=containment[1]||top-this.offset.click.top>containment[3]?top:top-this.offset.click.top>=containment[1]?top-o.grid[1]:top+o.grid[1]:top,left=o.grid[0]?this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,pageX=containment?left-this.offset.click.left>=containment[0]||left-this.offset.click.left>containment[2]?left:left-this.offset.click.left>=containment[0]?left-o.grid[0]:left+o.grid[0]:left)),{top:pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(type,event,ui){return ui=ui||this._uiHash(),$.ui.plugin.call(this,type,[event,ui]),"drag"===type&&(this.positionAbs=this._convertPositionTo("absolute")),$.Widget.prototype._trigger.call(this,type,event,ui)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),$.ui.plugin.add("draggable","connectToSortable",{start:function(event,ui){var inst=$(this).data("ui-draggable"),o=inst.options,uiSortable=$.extend({},ui,{item:inst.element});inst.sortables=[],$(o.connectToSortable).each(function(){var sortable=$.data(this,"ui-sortable");sortable&&!sortable.options.disabled&&(inst.sortables.push({instance:sortable,shouldRevert:sortable.options.revert}),sortable.refreshPositions(),sortable._trigger("activate",event,uiSortable))})},stop:function(event,ui){var inst=$(this).data("ui-draggable"),uiSortable=$.extend({},ui,{item:inst.element});$.each(inst.sortables,function(){this.instance.isOver?(this.instance.isOver=0,inst.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(event),this.instance.options.helper=this.instance.options._helper,"original"===inst.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",event,uiSortable))})},drag:function(event,ui){var inst=$(this).data("ui-draggable"),that=this;$.each(inst.sortables,function(){var innermostIntersecting=!1,thisSortable=this;this.instance.positionAbs=inst.positionAbs,this.instance.helperProportions=inst.helperProportions,this.instance.offset.click=inst.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(innermostIntersecting=!0,$.each(inst.sortables,function(){return this.instance.positionAbs=inst.positionAbs,this.instance.helperProportions=inst.helperProportions,this.instance.offset.click=inst.offset.click,this!==thisSortable&&this.instance._intersectsWith(this.instance.containerCache)&&$.contains(thisSortable.instance.element[0],this.instance.element[0])&&(innermostIntersecting=!1),innermostIntersecting})),innermostIntersecting?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=$(that).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return ui.helper[0]},event.target=this.instance.currentItem[0],this.instance._mouseCapture(event,!0),this.instance._mouseStart(event,!0,!0),this.instance.offset.click.top=inst.offset.click.top,this.instance.offset.click.left=inst.offset.click.left,this.instance.offset.parent.left-=inst.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=inst.offset.parent.top-this.instance.offset.parent.top,inst._trigger("toSortable",event),inst.dropped=this.instance.element,inst.currentItem=inst.element,this.instance.fromOutside=inst),this.instance.currentItem&&this.instance._mouseDrag(event)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",event,this.instance._uiHash(this.instance)),this.instance._mouseStop(event,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),inst._trigger("fromSortable",event),inst.dropped=!1)})}}),$.ui.plugin.add("draggable","cursor",{start:function(){var t=$("body"),o=$(this).data("ui-draggable").options;t.css("cursor")&&(o._cursor=t.css("cursor")),t.css("cursor",o.cursor)},stop:function(){var o=$(this).data("ui-draggable").options;o._cursor&&$("body").css("cursor",o._cursor)}}),$.ui.plugin.add("draggable","opacity",{start:function(event,ui){var t=$(ui.helper),o=$(this).data("ui-draggable").options;t.css("opacity")&&(o._opacity=t.css("opacity")),t.css("opacity",o.opacity)},stop:function(event,ui){var o=$(this).data("ui-draggable").options;o._opacity&&$(ui.helper).css("opacity",o._opacity)}}),$.ui.plugin.add("draggable","scroll",{start:function(){var i=$(this).data("ui-draggable");i.scrollParent[0]!==document&&"HTML"!==i.scrollParent[0].tagName&&(i.overflowOffset=i.scrollParent.offset())},drag:function(event){var i=$(this).data("ui-draggable"),o=i.options,scrolled=!1;i.scrollParent[0]!==document&&"HTML"!==i.scrollParent[0].tagName?(o.axis&&"x"===o.axis||(i.overflowOffset.top+i.scrollParent[0].offsetHeight-event.pageY<o.scrollSensitivity?i.scrollParent[0].scrollTop=scrolled=i.scrollParent[0].scrollTop+o.scrollSpeed:event.pageY-i.overflowOffset.top<o.scrollSensitivity&&(i.scrollParent[0].scrollTop=scrolled=i.scrollParent[0].scrollTop-o.scrollSpeed)),o.axis&&"y"===o.axis||(i.overflowOffset.left+i.scrollParent[0].offsetWidth-event.pageX<o.scrollSensitivity?i.scrollParent[0].scrollLeft=scrolled=i.scrollParent[0].scrollLeft+o.scrollSpeed:event.pageX-i.overflowOffset.left<o.scrollSensitivity&&(i.scrollParent[0].scrollLeft=scrolled=i.scrollParent[0].scrollLeft-o.scrollSpeed))):(o.axis&&"x"===o.axis||(event.pageY-$(document).scrollTop()<o.scrollSensitivity?scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed):$(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity&&(scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed))),o.axis&&"y"===o.axis||(event.pageX-$(document).scrollLeft()<o.scrollSensitivity?scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed):$(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity&&(scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed)))),!1!==scrolled&&$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(i,event)}}),$.ui.plugin.add("draggable","snap",{start:function(){var i=$(this).data("ui-draggable"),o=i.options;i.snapElements=[],$(o.snap.constructor!==String?o.snap.items||":data(ui-draggable)":o.snap).each(function(){var $t=$(this),$o=$t.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:$t.outerWidth(),height:$t.outerHeight(),top:$o.top,left:$o.left})})},drag:function(event,ui){var ts,bs,ls,rs,l,r,t,b,i,first,inst=$(this).data("ui-draggable"),o=inst.options,d=o.snapTolerance,x1=ui.offset.left,x2=x1+inst.helperProportions.width,y1=ui.offset.top,y2=y1+inst.helperProportions.height;for(i=inst.snapElements.length-1;i>=0;i--)l=inst.snapElements[i].left,r=l+inst.snapElements[i].width,t=inst.snapElements[i].top,b=t+inst.snapElements[i].height,x2<l-d||x1>r+d||y2<t-d||y1>b+d||!$.contains(inst.snapElements[i].item.ownerDocument,inst.snapElements[i].item)?(inst.snapElements[i].snapping&&inst.options.snap.release&&inst.options.snap.release.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})),inst.snapElements[i].snapping=!1):("inner"!==o.snapMode&&(ts=Math.abs(t-y2)<=d,bs=Math.abs(b-y1)<=d,ls=Math.abs(l-x2)<=d,rs=Math.abs(r-x1)<=d,ts&&(ui.position.top=inst._convertPositionTo("relative",{top:t-inst.helperProportions.height,left:0}).top-inst.margins.top),bs&&(ui.position.top=inst._convertPositionTo("relative",{top:b,left:0}).top-inst.margins.top),ls&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:l-inst.helperProportions.width}).left-inst.margins.left),rs&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:r}).left-inst.margins.left)),first=ts||bs||ls||rs,"outer"!==o.snapMode&&(ts=Math.abs(t-y1)<=d,bs=Math.abs(b-y2)<=d,ls=Math.abs(l-x1)<=d,rs=Math.abs(r-x2)<=d,ts&&(ui.position.top=inst._convertPositionTo("relative",{top:t,left:0}).top-inst.margins.top),bs&&(ui.position.top=inst._convertPositionTo("relative",{top:b-inst.helperProportions.height,left:0}).top-inst.margins.top),ls&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:l}).left-inst.margins.left),rs&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:r-inst.helperProportions.width}).left-inst.margins.left)),!inst.snapElements[i].snapping&&(ts||bs||ls||rs||first)&&inst.options.snap.snap&&inst.options.snap.snap.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})),inst.snapElements[i].snapping=ts||bs||ls||rs||first)}}),$.ui.plugin.add("draggable","stack",{start:function(){var min,o=this.data("ui-draggable").options,group=$.makeArray($(o.stack)).sort(function(a,b){return(parseInt($(a).css("zIndex"),10)||0)-(parseInt($(b).css("zIndex"),10)||0)});group.length&&(min=parseInt($(group[0]).css("zIndex"),10)||0,$(group).each(function(i){$(this).css("zIndex",min+i)}),this.css("zIndex",min+group.length))}}),$.ui.plugin.add("draggable","zIndex",{start:function(event,ui){var t=$(ui.helper),o=$(this).data("ui-draggable").options;t.css("zIndex")&&(o._zIndex=t.css("zIndex")),t.css("zIndex",o.zIndex)},stop:function(event,ui){var o=$(this).data("ui-draggable").options;o._zIndex&&$(ui.helper).css("zIndex",o._zIndex)}})}(jQuery),function($,undefined){function isOverAxis(x,reference,size){return x>reference&&x<reference+size}$.widget("ui.droppable",{version:"1.10.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var proportions,o=this.options,accept=o.accept;this.isover=!1,this.isout=!0,this.accept=$.isFunction(accept)?accept:function(d){return d.is(accept)},this.proportions=function(){if(!arguments.length)return proportions||(proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});proportions=arguments[0]},$.ui.ddmanager.droppables[o.scope]=$.ui.ddmanager.droppables[o.scope]||[],$.ui.ddmanager.droppables[o.scope].push(this),o.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var i=0,drop=$.ui.ddmanager.droppables[this.options.scope];i<drop.length;i++)drop[i]===this&&drop.splice(i,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(key,value){"accept"===key&&(this.accept=$.isFunction(value)?value:function(d){return d.is(value)}),$.Widget.prototype._setOption.apply(this,arguments)},_activate:function(event){var draggable=$.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),draggable&&this._trigger("activate",event,this.ui(draggable))},_deactivate:function(event){var draggable=$.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),draggable&&this._trigger("deactivate",event,this.ui(draggable))},_over:function(event){var draggable=$.ui.ddmanager.current;draggable&&(draggable.currentItem||draggable.element)[0]!==this.element[0]&&this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",event,this.ui(draggable)))},_out:function(event){var draggable=$.ui.ddmanager.current;draggable&&(draggable.currentItem||draggable.element)[0]!==this.element[0]&&this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",event,this.ui(draggable)))},_drop:function(event,custom){var draggable=custom||$.ui.ddmanager.current,childrenIntersection=!1;return!(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var inst=$.data(this,"ui-droppable");if(inst.options.greedy&&!inst.options.disabled&&inst.options.scope===draggable.options.scope&&inst.accept.call(inst.element[0],draggable.currentItem||draggable.element)&&$.ui.intersect(draggable,$.extend(inst,{offset:inst.element.offset()}),inst.options.tolerance))return childrenIntersection=!0,!1}),!childrenIntersection&&(!!this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",event,this.ui(draggable)),this.element)))},ui:function(c){return{draggable:c.currentItem||c.element,helper:c.helper,position:c.position,offset:c.positionAbs}}}),$.ui.intersect=function(draggable,droppable,toleranceMode){if(!droppable.offset)return!1;var draggableLeft,draggableTop,x1=(draggable.positionAbs||draggable.position.absolute).left,y1=(draggable.positionAbs||draggable.position.absolute).top,x2=x1+draggable.helperProportions.width,y2=y1+draggable.helperProportions.height,l=droppable.offset.left,t=droppable.offset.top,r=l+droppable.proportions().width,b=t+droppable.proportions().height;switch(toleranceMode){case"fit":return l<=x1&&x2<=r&&t<=y1&&y2<=b;case"intersect":return l<x1+draggable.helperProportions.width/2&&x2-draggable.helperProportions.width/2<r&&t<y1+draggable.helperProportions.height/2&&y2-draggable.helperProportions.height/2<b;case"pointer":return draggableLeft=(draggable.positionAbs||draggable.position.absolute).left+(draggable.clickOffset||draggable.offset.click).left,draggableTop=(draggable.positionAbs||draggable.position.absolute).top+(draggable.clickOffset||draggable.offset.click).top,isOverAxis(draggableTop,t,droppable.proportions().height)&&isOverAxis(draggableLeft,l,droppable.proportions().width);case"touch":return(y1>=t&&y1<=b||y2>=t&&y2<=b||y1<t&&y2>b)&&(x1>=l&&x1<=r||x2>=l&&x2<=r||x1<l&&x2>r);default:return!1}},$.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(t,event){var i,j,m=$.ui.ddmanager.droppables[t.options.scope]||[],type=event?event.type:null,list=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();droppablesLoop:for(i=0;i<m.length;i++)if(!(m[i].options.disabled||t&&!m[i].accept.call(m[i].element[0],t.currentItem||t.element))){for(j=0;j<list.length;j++)if(list[j]===m[i].element[0]){m[i].proportions().height=0;continue droppablesLoop}m[i].visible="none"!==m[i].element.css("display"),m[i].visible&&("mousedown"===type&&m[i]._activate.call(m[i],event),m[i].offset=m[i].element.offset(),m[i].proportions({width:m[i].element[0].offsetWidth,height:m[i].element[0].offsetHeight}))}},drop:function(draggable,event){var dropped=!1;return $.each(($.ui.ddmanager.droppables[draggable.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&$.ui.intersect(draggable,this,this.options.tolerance)&&(dropped=this._drop.call(this,event)||dropped),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,event)))}),dropped},dragStart:function(draggable,event){draggable.element.parentsUntil("body").bind("scroll.droppable",function(){draggable.options.refreshPositions||$.ui.ddmanager.prepareOffsets(draggable,event)})},drag:function(draggable,event){draggable.options.refreshPositions&&$.ui.ddmanager.prepareOffsets(draggable,event),$.each($.ui.ddmanager.droppables[draggable.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var parentInstance,scope,parent,intersects=$.ui.intersect(draggable,this,this.options.tolerance),c=!intersects&&this.isover?"isout":intersects&&!this.isover?"isover":null;c&&(this.options.greedy&&(scope=this.options.scope,parent=this.element.parents(":data(ui-droppable)").filter(function(){return $.data(this,"ui-droppable").options.scope===scope}),parent.length&&(parentInstance=$.data(parent[0],"ui-droppable"),parentInstance.greedyChild="isover"===c)),parentInstance&&"isover"===c&&(parentInstance.isover=!1,parentInstance.isout=!0,parentInstance._out.call(parentInstance,event)),this[c]=!0,this["isout"===c?"isover":"isout"]=!1,this["isover"===c?"_over":"_out"].call(this,event),parentInstance&&"isout"===c&&(parentInstance.isout=!1,parentInstance.isover=!0,parentInstance._over.call(parentInstance,event)))}})},dragStop:function(draggable,event){draggable.element.parentsUntil("body").unbind("scroll.droppable"),draggable.options.refreshPositions||$.ui.ddmanager.prepareOffsets(draggable,event)}}}(jQuery),function($,undefined){function num(v){return parseInt(v,10)||0}function isNumber(value){return!isNaN(parseInt(value,10))}$.widget("ui.resizable",$.ui.mouse,{version:"1.10.4",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var n,i,handle,axis,hname,that=this,o=this.options;if(this.element.addClass("ui-resizable"),$.extend(this,{_aspectRatio:!!o.aspectRatio,aspectRatio:o.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:o.helper||o.ghost||o.animate?o.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap($("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=o.handles||($(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),n=this.handles.split(","),this.handles={},i=0;i<n.length;i++)handle=$.trim(n[i]),hname="ui-resizable-"+handle,axis=$("<div class='ui-resizable-handle "+hname+"'></div>"),axis.css({zIndex:o.zIndex}),"se"===handle&&axis.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[handle]=".ui-resizable-"+handle,this.element.append(axis);this._renderAxis=function(target){var i,axis,padPos,padWrapper;target=target||this.element;for(i in this.handles)this.handles[i].constructor===String&&(this.handles[i]=$(this.handles[i],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(axis=$(this.handles[i],this.element),padWrapper=/sw|ne|nw|se|n|s/.test(i)?axis.outerHeight():axis.outerWidth(),padPos=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),target.css(padPos,padWrapper),this._proportionallyResize()),$(this.handles[i]).length},this._renderAxis(this.element),this._handles=$(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){that.resizing||(this.className&&(axis=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),that.axis=axis&&axis[1]?axis[1]:"se")}),o.autoHide&&(this._handles.hide(),$(this.element).addClass("ui-resizable-autohide").mouseenter(function(){o.disabled||($(this).removeClass("ui-resizable-autohide"),that._handles.show())}).mouseleave(function(){o.disabled||that.resizing||($(this).addClass("ui-resizable-autohide"),that._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var wrapper,_destroy=function(exp){$(exp).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(_destroy(this.element),wrapper=this.element,this.originalElement.css({position:wrapper.css("position"),width:wrapper.outerWidth(),height:wrapper.outerHeight(),top:wrapper.css("top"),left:wrapper.css("left")}).insertAfter(wrapper),wrapper.remove()),this.originalElement.css("resize",this.originalResizeStyle),_destroy(this.originalElement),this},_mouseCapture:function(event){var i,handle,capture=!1;for(i in this.handles)((handle=$(this.handles[i])[0])===event.target||$.contains(handle,event.target))&&(capture=!0);return!this.options.disabled&&capture},_mouseStart:function(event){var curleft,curtop,cursor,o=this.options,iniPos=this.element.position(),el=this.element;return this.resizing=!0,/absolute/.test(el.css("position"))?el.css({position:"absolute",top:el.css("top"),left:el.css("left")}):el.is(".ui-draggable")&&el.css({position:"absolute",
top:iniPos.top,left:iniPos.left}),this._renderProxy(),curleft=num(this.helper.css("left")),curtop=num(this.helper.css("top")),o.containment&&(curleft+=$(o.containment).scrollLeft()||0,curtop+=$(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:curleft,top:curtop},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:el.width(),height:el.height()},this.originalSize=this._helper?{width:el.outerWidth(),height:el.outerHeight()}:{width:el.width(),height:el.height()},this.originalPosition={left:curleft,top:curtop},this.sizeDiff={width:el.outerWidth()-el.width(),height:el.outerHeight()-el.height()},this.originalMousePosition={left:event.pageX,top:event.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,cursor=$(".ui-resizable-"+this.axis).css("cursor"),$("body").css("cursor","auto"===cursor?this.axis+"-resize":cursor),el.addClass("ui-resizable-resizing"),this._propagate("start",event),!0},_mouseDrag:function(event){var data,el=this.helper,props={},smp=this.originalMousePosition,a=this.axis,prevTop=this.position.top,prevLeft=this.position.left,prevWidth=this.size.width,prevHeight=this.size.height,dx=event.pageX-smp.left||0,dy=event.pageY-smp.top||0,trigger=this._change[a];return!!trigger&&(data=trigger.apply(this,[event,dx,dy]),this._updateVirtualBoundaries(event.shiftKey),(this._aspectRatio||event.shiftKey)&&(data=this._updateRatio(data,event)),data=this._respectSize(data,event),this._updateCache(data),this._propagate("resize",event),this.position.top!==prevTop&&(props.top=this.position.top+"px"),this.position.left!==prevLeft&&(props.left=this.position.left+"px"),this.size.width!==prevWidth&&(props.width=this.size.width+"px"),this.size.height!==prevHeight&&(props.height=this.size.height+"px"),el.css(props),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),$.isEmptyObject(props)||this._trigger("resize",event,this.ui()),!1)},_mouseStop:function(event){this.resizing=!1;var pr,ista,soffseth,soffsetw,s,left,top,o=this.options,that=this;return this._helper&&(pr=this._proportionallyResizeElements,ista=pr.length&&/textarea/i.test(pr[0].nodeName),soffseth=ista&&$.ui.hasScroll(pr[0],"left")?0:that.sizeDiff.height,soffsetw=ista?0:that.sizeDiff.width,s={width:that.helper.width()-soffsetw,height:that.helper.height()-soffseth},left=parseInt(that.element.css("left"),10)+(that.position.left-that.originalPosition.left)||null,top=parseInt(that.element.css("top"),10)+(that.position.top-that.originalPosition.top)||null,o.animate||this.element.css($.extend(s,{top:top,left:left})),that.helper.height(that.size.height),that.helper.width(that.size.width),this._helper&&!o.animate&&this._proportionallyResize()),$("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",event),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(forceAspectRatio){var pMinWidth,pMaxWidth,pMinHeight,pMaxHeight,b,o=this.options;b={minWidth:isNumber(o.minWidth)?o.minWidth:0,maxWidth:isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:isNumber(o.minHeight)?o.minHeight:0,maxHeight:isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||forceAspectRatio)&&(pMinWidth=b.minHeight*this.aspectRatio,pMinHeight=b.minWidth/this.aspectRatio,pMaxWidth=b.maxHeight*this.aspectRatio,pMaxHeight=b.maxWidth/this.aspectRatio,pMinWidth>b.minWidth&&(b.minWidth=pMinWidth),pMinHeight>b.minHeight&&(b.minHeight=pMinHeight),pMaxWidth<b.maxWidth&&(b.maxWidth=pMaxWidth),pMaxHeight<b.maxHeight&&(b.maxHeight=pMaxHeight)),this._vBoundaries=b},_updateCache:function(data){this.offset=this.helper.offset(),isNumber(data.left)&&(this.position.left=data.left),isNumber(data.top)&&(this.position.top=data.top),isNumber(data.height)&&(this.size.height=data.height),isNumber(data.width)&&(this.size.width=data.width)},_updateRatio:function(data){var cpos=this.position,csize=this.size,a=this.axis;return isNumber(data.height)?data.width=data.height*this.aspectRatio:isNumber(data.width)&&(data.height=data.width/this.aspectRatio),"sw"===a&&(data.left=cpos.left+(csize.width-data.width),data.top=null),"nw"===a&&(data.top=cpos.top+(csize.height-data.height),data.left=cpos.left+(csize.width-data.width)),data},_respectSize:function(data){var o=this._vBoundaries,a=this.axis,ismaxw=isNumber(data.width)&&o.maxWidth&&o.maxWidth<data.width,ismaxh=isNumber(data.height)&&o.maxHeight&&o.maxHeight<data.height,isminw=isNumber(data.width)&&o.minWidth&&o.minWidth>data.width,isminh=isNumber(data.height)&&o.minHeight&&o.minHeight>data.height,dw=this.originalPosition.left+this.originalSize.width,dh=this.position.top+this.size.height,cw=/sw|nw|w/.test(a),ch=/nw|ne|n/.test(a);return isminw&&(data.width=o.minWidth),isminh&&(data.height=o.minHeight),ismaxw&&(data.width=o.maxWidth),ismaxh&&(data.height=o.maxHeight),isminw&&cw&&(data.left=dw-o.minWidth),ismaxw&&cw&&(data.left=dw-o.maxWidth),isminh&&ch&&(data.top=dh-o.minHeight),ismaxh&&ch&&(data.top=dh-o.maxHeight),data.width||data.height||data.left||!data.top?data.width||data.height||data.top||!data.left||(data.left=null):data.top=null,data},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var i,j,borders,paddings,prel,element=this.helper||this.element;for(i=0;i<this._proportionallyResizeElements.length;i++){if(prel=this._proportionallyResizeElements[i],!this.borderDif)for(this.borderDif=[],borders=[prel.css("borderTopWidth"),prel.css("borderRightWidth"),prel.css("borderBottomWidth"),prel.css("borderLeftWidth")],paddings=[prel.css("paddingTop"),prel.css("paddingRight"),prel.css("paddingBottom"),prel.css("paddingLeft")],j=0;j<borders.length;j++)this.borderDif[j]=(parseInt(borders[j],10)||0)+(parseInt(paddings[j],10)||0);prel.css({height:element.height()-this.borderDif[0]-this.borderDif[2]||0,width:element.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var el=this.element,o=this.options;this.elementOffset=el.offset(),this._helper?(this.helper=this.helper||$("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++o.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(event,dx){return{width:this.originalSize.width+dx}},w:function(event,dx){var cs=this.originalSize;return{left:this.originalPosition.left+dx,width:cs.width-dx}},n:function(event,dx,dy){var cs=this.originalSize;return{top:this.originalPosition.top+dy,height:cs.height-dy}},s:function(event,dx,dy){return{height:this.originalSize.height+dy}},se:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]))},sw:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]))},ne:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]))},nw:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]))}},_propagate:function(n,event){$.ui.plugin.call(this,n,[event,this.ui()]),"resize"!==n&&this._trigger(n,event,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),$.ui.plugin.add("resizable","animate",{stop:function(event){var that=$(this).data("ui-resizable"),o=that.options,pr=that._proportionallyResizeElements,ista=pr.length&&/textarea/i.test(pr[0].nodeName),soffseth=ista&&$.ui.hasScroll(pr[0],"left")?0:that.sizeDiff.height,soffsetw=ista?0:that.sizeDiff.width,style={width:that.size.width-soffsetw,height:that.size.height-soffseth},left=parseInt(that.element.css("left"),10)+(that.position.left-that.originalPosition.left)||null,top=parseInt(that.element.css("top"),10)+(that.position.top-that.originalPosition.top)||null;that.element.animate($.extend(style,top&&left?{top:top,left:left}:{}),{duration:o.animateDuration,easing:o.animateEasing,step:function(){var data={width:parseInt(that.element.css("width"),10),height:parseInt(that.element.css("height"),10),top:parseInt(that.element.css("top"),10),left:parseInt(that.element.css("left"),10)};pr&&pr.length&&$(pr[0]).css({width:data.width,height:data.height}),that._updateCache(data),that._propagate("resize",event)}})}}),$.ui.plugin.add("resizable","containment",{start:function(){var element,p,co,ch,cw,width,height,that=$(this).data("ui-resizable"),o=that.options,el=that.element,oc=o.containment,ce=oc instanceof $?oc.get(0):/parent/.test(oc)?el.parent().get(0):oc;ce&&(that.containerElement=$(ce),/document/.test(oc)||oc===document?(that.containerOffset={left:0,top:0},that.containerPosition={left:0,top:0},that.parentData={element:$(document),left:0,top:0,width:$(document).width(),height:$(document).height()||document.body.parentNode.scrollHeight}):(element=$(ce),p=[],$(["Top","Right","Left","Bottom"]).each(function(i,name){p[i]=num(element.css("padding"+name))}),that.containerOffset=element.offset(),that.containerPosition=element.position(),that.containerSize={height:element.innerHeight()-p[3],width:element.innerWidth()-p[1]},co=that.containerOffset,ch=that.containerSize.height,cw=that.containerSize.width,width=$.ui.hasScroll(ce,"left")?ce.scrollWidth:cw,height=$.ui.hasScroll(ce)?ce.scrollHeight:ch,that.parentData={element:ce,left:co.left,top:co.top,width:width,height:height}))},resize:function(event){var woset,hoset,isParent,isOffsetRelative,that=$(this).data("ui-resizable"),o=that.options,co=that.containerOffset,cp=that.position,pRatio=that._aspectRatio||event.shiftKey,cop={top:0,left:0},ce=that.containerElement;ce[0]!==document&&/static/.test(ce.css("position"))&&(cop=co),cp.left<(that._helper?co.left:0)&&(that.size.width=that.size.width+(that._helper?that.position.left-co.left:that.position.left-cop.left),pRatio&&(that.size.height=that.size.width/that.aspectRatio),that.position.left=o.helper?co.left:0),cp.top<(that._helper?co.top:0)&&(that.size.height=that.size.height+(that._helper?that.position.top-co.top:that.position.top),pRatio&&(that.size.width=that.size.height*that.aspectRatio),that.position.top=that._helper?co.top:0),that.offset.left=that.parentData.left+that.position.left,that.offset.top=that.parentData.top+that.position.top,woset=Math.abs((that._helper,that.offset.left-cop.left+that.sizeDiff.width)),hoset=Math.abs((that._helper?that.offset.top-cop.top:that.offset.top-co.top)+that.sizeDiff.height),isParent=that.containerElement.get(0)===that.element.parent().get(0),isOffsetRelative=/relative|absolute/.test(that.containerElement.css("position")),isParent&&isOffsetRelative&&(woset-=Math.abs(that.parentData.left)),woset+that.size.width>=that.parentData.width&&(that.size.width=that.parentData.width-woset,pRatio&&(that.size.height=that.size.width/that.aspectRatio)),hoset+that.size.height>=that.parentData.height&&(that.size.height=that.parentData.height-hoset,pRatio&&(that.size.width=that.size.height*that.aspectRatio))},stop:function(){var that=$(this).data("ui-resizable"),o=that.options,co=that.containerOffset,cop=that.containerPosition,ce=that.containerElement,helper=$(that.helper),ho=helper.offset(),w=helper.outerWidth()-that.sizeDiff.width,h=helper.outerHeight()-that.sizeDiff.height;that._helper&&!o.animate&&/relative/.test(ce.css("position"))&&$(this).css({left:ho.left-cop.left-co.left,width:w,height:h}),that._helper&&!o.animate&&/static/.test(ce.css("position"))&&$(this).css({left:ho.left-cop.left-co.left,width:w,height:h})}}),$.ui.plugin.add("resizable","alsoResize",{start:function(){var that=$(this).data("ui-resizable"),o=that.options,_store=function(exp){$(exp).each(function(){var el=$(this);el.data("ui-resizable-alsoresize",{width:parseInt(el.width(),10),height:parseInt(el.height(),10),left:parseInt(el.css("left"),10),top:parseInt(el.css("top"),10)})})};"object"!=typeof o.alsoResize||o.alsoResize.parentNode?_store(o.alsoResize):o.alsoResize.length?(o.alsoResize=o.alsoResize[0],_store(o.alsoResize)):$.each(o.alsoResize,function(exp){_store(exp)})},resize:function(event,ui){var that=$(this).data("ui-resizable"),o=that.options,os=that.originalSize,op=that.originalPosition,delta={height:that.size.height-os.height||0,width:that.size.width-os.width||0,top:that.position.top-op.top||0,left:that.position.left-op.left||0},_alsoResize=function(exp,c){$(exp).each(function(){var el=$(this),start=$(this).data("ui-resizable-alsoresize"),style={},css=c&&c.length?c:el.parents(ui.originalElement[0]).length?["width","height"]:["width","height","top","left"];$.each(css,function(i,prop){var sum=(start[prop]||0)+(delta[prop]||0);sum&&sum>=0&&(style[prop]=sum||null)}),el.css(style)})};"object"!=typeof o.alsoResize||o.alsoResize.nodeType?_alsoResize(o.alsoResize):$.each(o.alsoResize,function(exp,c){_alsoResize(exp,c)})},stop:function(){$(this).removeData("resizable-alsoresize")}}),$.ui.plugin.add("resizable","ghost",{start:function(){var that=$(this).data("ui-resizable"),o=that.options,cs=that.size;that.ghost=that.originalElement.clone(),that.ghost.css({opacity:.25,display:"block",position:"relative",height:cs.height,width:cs.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof o.ghost?o.ghost:""),that.ghost.appendTo(that.helper)},resize:function(){var that=$(this).data("ui-resizable");that.ghost&&that.ghost.css({position:"relative",height:that.size.height,width:that.size.width})},stop:function(){var that=$(this).data("ui-resizable");that.ghost&&that.helper&&that.helper.get(0).removeChild(that.ghost.get(0))}}),$.ui.plugin.add("resizable","grid",{resize:function(){var that=$(this).data("ui-resizable"),o=that.options,cs=that.size,os=that.originalSize,op=that.originalPosition,a=that.axis,grid="number"==typeof o.grid?[o.grid,o.grid]:o.grid,gridX=grid[0]||1,gridY=grid[1]||1,ox=Math.round((cs.width-os.width)/gridX)*gridX,oy=Math.round((cs.height-os.height)/gridY)*gridY,newWidth=os.width+ox,newHeight=os.height+oy,isMaxWidth=o.maxWidth&&o.maxWidth<newWidth,isMaxHeight=o.maxHeight&&o.maxHeight<newHeight,isMinWidth=o.minWidth&&o.minWidth>newWidth,isMinHeight=o.minHeight&&o.minHeight>newHeight;o.grid=grid,isMinWidth&&(newWidth+=gridX),isMinHeight&&(newHeight+=gridY),isMaxWidth&&(newWidth-=gridX),isMaxHeight&&(newHeight-=gridY),/^(se|s|e)$/.test(a)?(that.size.width=newWidth,that.size.height=newHeight):/^(ne)$/.test(a)?(that.size.width=newWidth,that.size.height=newHeight,that.position.top=op.top-oy):/^(sw)$/.test(a)?(that.size.width=newWidth,that.size.height=newHeight,that.position.left=op.left-ox):(newHeight-gridY>0?(that.size.height=newHeight,that.position.top=op.top-oy):(that.size.height=gridY,that.position.top=op.top+os.height-gridY),newWidth-gridX>0?(that.size.width=newWidth,that.position.left=op.left-ox):(that.size.width=gridX,that.position.left=op.left+os.width-gridX))}})}(jQuery),function($,undefined){$.widget("ui.selectable",$.ui.mouse,{version:"1.10.4",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var selectees,that=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){selectees=$(that.options.filter,that.element[0]),selectees.addClass("ui-selectee"),selectees.each(function(){var $this=$(this),pos=$this.offset();$.data(this,"selectable-item",{element:this,$element:$this,left:pos.left,top:pos.top,right:pos.left+$this.outerWidth(),bottom:pos.top+$this.outerHeight(),startselected:!1,selected:$this.hasClass("ui-selected"),selecting:$this.hasClass("ui-selecting"),unselecting:$this.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=selectees.addClass("ui-selectee"),this._mouseInit(),this.helper=$("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(event){var that=this,options=this.options;this.opos=[event.pageX,event.pageY],this.options.disabled||(this.selectees=$(options.filter,this.element[0]),this._trigger("start",event),$(options.appendTo).append(this.helper),this.helper.css({left:event.pageX,top:event.pageY,width:0,height:0}),options.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var selectee=$.data(this,"selectable-item");selectee.startselected=!0,event.metaKey||event.ctrlKey||(selectee.$element.removeClass("ui-selected"),selectee.selected=!1,selectee.$element.addClass("ui-unselecting"),selectee.unselecting=!0,that._trigger("unselecting",event,{unselecting:selectee.element}))}),$(event.target).parents().addBack().each(function(){var doSelect,selectee=$.data(this,"selectable-item");if(selectee)return doSelect=!event.metaKey&&!event.ctrlKey||!selectee.$element.hasClass("ui-selected"),selectee.$element.removeClass(doSelect?"ui-unselecting":"ui-selected").addClass(doSelect?"ui-selecting":"ui-unselecting"),selectee.unselecting=!doSelect,selectee.selecting=doSelect,selectee.selected=doSelect,doSelect?that._trigger("selecting",event,{selecting:selectee.element}):that._trigger("unselecting",event,{unselecting:selectee.element}),!1}))},_mouseDrag:function(event){if(this.dragged=!0,!this.options.disabled){var tmp,that=this,options=this.options,x1=this.opos[0],y1=this.opos[1],x2=event.pageX,y2=event.pageY;return x1>x2&&(tmp=x2,x2=x1,x1=tmp),y1>y2&&(tmp=y2,y2=y1,y1=tmp),this.helper.css({left:x1,top:y1,width:x2-x1,height:y2-y1}),this.selectees.each(function(){var selectee=$.data(this,"selectable-item"),hit=!1;selectee&&selectee.element!==that.element[0]&&("touch"===options.tolerance?hit=!(selectee.left>x2||selectee.right<x1||selectee.top>y2||selectee.bottom<y1):"fit"===options.tolerance&&(hit=selectee.left>x1&&selectee.right<x2&&selectee.top>y1&&selectee.bottom<y2),hit?(selectee.selected&&(selectee.$element.removeClass("ui-selected"),selectee.selected=!1),selectee.unselecting&&(selectee.$element.removeClass("ui-unselecting"),selectee.unselecting=!1),selectee.selecting||(selectee.$element.addClass("ui-selecting"),selectee.selecting=!0,that._trigger("selecting",event,{selecting:selectee.element}))):(selectee.selecting&&((event.metaKey||event.ctrlKey)&&selectee.startselected?(selectee.$element.removeClass("ui-selecting"),selectee.selecting=!1,selectee.$element.addClass("ui-selected"),selectee.selected=!0):(selectee.$element.removeClass("ui-selecting"),selectee.selecting=!1,selectee.startselected&&(selectee.$element.addClass("ui-unselecting"),selectee.unselecting=!0),that._trigger("unselecting",event,{unselecting:selectee.element}))),selectee.selected&&(event.metaKey||event.ctrlKey||selectee.startselected||(selectee.$element.removeClass("ui-selected"),selectee.selected=!1,selectee.$element.addClass("ui-unselecting"),selectee.unselecting=!0,that._trigger("unselecting",event,{unselecting:selectee.element})))))}),!1}},_mouseStop:function(event){var that=this;return this.dragged=!1,$(".ui-unselecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");selectee.$element.removeClass("ui-unselecting"),selectee.unselecting=!1,selectee.startselected=!1,that._trigger("unselected",event,{unselected:selectee.element})}),$(".ui-selecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");selectee.$element.removeClass("ui-selecting").addClass("ui-selected"),selectee.selecting=!1,selectee.selected=!0,selectee.startselected=!0,that._trigger("selected",event,{selected:selectee.element})}),this._trigger("stop",event),this.helper.remove(),!1}})}(jQuery),function($,undefined){function isOverAxis(x,reference,size){return x>reference&&x<reference+size}function isFloating(item){return/left|right/.test(item.css("float"))||/inline|table-cell/.test(item.css("display"))}$.widget("ui.sortable",$.ui.mouse,{version:"1.10.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var o=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=!!this.items.length&&("x"===o.axis||isFloating(this.items[0].item)),this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var i=this.items.length-1;i>=0;i--)this.items[i].item.removeData(this.widgetName+"-item");return this},_setOption:function(key,value){"disabled"===key?(this.options[key]=value,this.widget().toggleClass("ui-sortable-disabled",!!value)):$.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(event,overrideHandle){var currentItem=null,validHandle=!1,that=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(event),$(event.target).parents().each(function(){if($.data(this,that.widgetName+"-item")===that)return currentItem=$(this),!1}),$.data(event.target,that.widgetName+"-item")===that&&(currentItem=$(event.target)),!!currentItem&&(!(this.options.handle&&!overrideHandle&&($(this.options.handle,currentItem).find("*").addBack().each(function(){this===event.target&&(validHandle=!0)}),!validHandle))&&(this.currentItem=currentItem,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(event,overrideHandle,noActivation){var i,body,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(event),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},$.extend(this.offset,{click:{left:event.pageX-this.offset.left,top:event.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(event),this.originalPageX=event.pageX,this.originalPageY=event.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(body=this.document.find("body"),this.storedCursor=body.css("cursor"),body.css("cursor",o.cursor),this.storedStylesheet=$("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(body)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",event,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!noActivation)for(i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("activate",event,this._uiHash(this));return $.ui.ddmanager&&($.ui.ddmanager.current=this),$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,event),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(event),!0},_mouseDrag:function(event){var i,item,itemElement,intersection,o=this.options,scrolled=!1;for(this.position=this._generatePosition(event),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-event.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop+o.scrollSpeed:event.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-event.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft+o.scrollSpeed:event.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(event.pageY-$(document).scrollTop()<o.scrollSensitivity?scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed):$(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity&&(scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed)),event.pageX-$(document).scrollLeft()<o.scrollSensitivity?scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed):$(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity&&(scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed))),!1!==scrolled&&$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,event)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(item=this.items[i],itemElement=item.item[0],(intersection=this._intersectsWithPointer(item))&&item.instance===this.currentContainer&&!(itemElement===this.currentItem[0]||this.placeholder[1===intersection?"next":"prev"]()[0]===itemElement||$.contains(this.placeholder[0],itemElement)||"semi-dynamic"===this.options.type&&$.contains(this.element[0],itemElement))){if(this.direction=1===intersection?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(item))break;this._rearrange(event,item),this._trigger("change",event,this._uiHash());break}return this._contactContainers(event),$.ui.ddmanager&&$.ui.ddmanager.drag(this,event),this._trigger("sort",event,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(event,noPropagation){if(event){if($.ui.ddmanager&&!this.options.dropBehaviour&&$.ui.ddmanager.drop(this,event),this.options.revert){var that=this,cur=this.placeholder.offset(),axis=this.options.axis,animation={};axis&&"x"!==axis||(animation.left=cur.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),axis&&"y"!==axis||(animation.top=cur.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,$(this.helper).animate(animation,parseInt(this.options.revert,10)||500,function(){that._clear(event)})}else this._clear(event,noPropagation);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("deactivate",null,this._uiHash(this)),this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",null,this._uiHash(this)),this.containers[i].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),$.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?$(this.domPosition.prev).after(this.currentItem):$(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(o){var items=this._getItemsAsjQuery(o&&o.connected),str=[];return o=o||{},$(items).each(function(){var res=($(o.item||this).attr(o.attribute||"id")||"").match(o.expression||/(.+)[\-=_](.+)/);res&&str.push((o.key||res[1]+"[]")+"="+(o.key&&o.expression?res[1]:res[2]))}),!str.length&&o.key&&str.push(o.key+"="),str.join("&")},toArray:function(o){var items=this._getItemsAsjQuery(o&&o.connected),ret=[];return o=o||{},items.each(function(){ret.push($(o.item||this).attr(o.attribute||"id")||"")}),ret},_intersectsWith:function(item){var x1=this.positionAbs.left,x2=x1+this.helperProportions.width,y1=this.positionAbs.top,y2=y1+this.helperProportions.height,l=item.left,r=l+item.width,t=item.top,b=t+item.height,dyClick=this.offset.click.top,dxClick=this.offset.click.left,isOverElementHeight="x"===this.options.axis||y1+dyClick>t&&y1+dyClick<b,isOverElementWidth="y"===this.options.axis||x1+dxClick>l&&x1+dxClick<r,isOverElement=isOverElementHeight&&isOverElementWidth;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>item[this.floating?"width":"height"]?isOverElement:l<x1+this.helperProportions.width/2&&x2-this.helperProportions.width/2<r&&t<y1+this.helperProportions.height/2&&y2-this.helperProportions.height/2<b},_intersectsWithPointer:function(item){var isOverElementHeight="x"===this.options.axis||isOverAxis(this.positionAbs.top+this.offset.click.top,item.top,item.height),isOverElementWidth="y"===this.options.axis||isOverAxis(this.positionAbs.left+this.offset.click.left,item.left,item.width),isOverElement=isOverElementHeight&&isOverElementWidth,verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();return!!isOverElement&&(this.floating?horizontalDirection&&"right"===horizontalDirection||"down"===verticalDirection?2:1:verticalDirection&&("down"===verticalDirection?2:1))},_intersectsWithSides:function(item){var isOverBottomHalf=isOverAxis(this.positionAbs.top+this.offset.click.top,item.top+item.height/2,item.height),isOverRightHalf=isOverAxis(this.positionAbs.left+this.offset.click.left,item.left+item.width/2,item.width),verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();return this.floating&&horizontalDirection?"right"===horizontalDirection&&isOverRightHalf||"left"===horizontalDirection&&!isOverRightHalf:verticalDirection&&("down"===verticalDirection&&isOverBottomHalf||"up"===verticalDirection&&!isOverBottomHalf)},_getDragVerticalDirection:function(){var delta=this.positionAbs.top-this.lastPositionAbs.top;return 0!==delta&&(delta>0?"down":"up")},_getDragHorizontalDirection:function(){var delta=this.positionAbs.left-this.lastPositionAbs.left;return 0!==delta&&(delta>0?"right":"left")},refresh:function(event){return this._refreshItems(event),this.refreshPositions(),this},_connectWith:function(){var options=this.options;return options.connectWith.constructor===String?[options.connectWith]:options.connectWith},_getItemsAsjQuery:function(connected){function addItems(){items.push(this)}var i,j,cur,inst,items=[],queries=[],connectWith=this._connectWith();if(connectWith&&connected)for(i=connectWith.length-1;i>=0;i--)for(cur=$(connectWith[i]),j=cur.length-1;j>=0;j--)(inst=$.data(cur[j],this.widgetFullName))&&inst!==this&&!inst.options.disabled&&queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element):$(inst.options.items,inst.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),inst]);for(queries.push([$.isFunction(this.options.items)?this.options.items.call(this.element,null,{
options:this.options,item:this.currentItem}):$(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),i=queries.length-1;i>=0;i--)queries[i][0].each(addItems);return $(items)},_removeCurrentsFromItems:function(){var list=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=$.grep(this.items,function(item){for(var j=0;j<list.length;j++)if(list[j]===item.item[0])return!1;return!0})},_refreshItems:function(event){this.items=[],this.containers=[this];var i,j,cur,inst,targetData,_queries,item,queriesLength,items=this.items,queries=[[$.isFunction(this.options.items)?this.options.items.call(this.element[0],event,{item:this.currentItem}):$(this.options.items,this.element),this]],connectWith=this._connectWith();if(connectWith&&this.ready)for(i=connectWith.length-1;i>=0;i--)for(cur=$(connectWith[i]),j=cur.length-1;j>=0;j--)(inst=$.data(cur[j],this.widgetFullName))&&inst!==this&&!inst.options.disabled&&(queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element[0],event,{item:this.currentItem}):$(inst.options.items,inst.element),inst]),this.containers.push(inst));for(i=queries.length-1;i>=0;i--)for(targetData=queries[i][1],_queries=queries[i][0],j=0,queriesLength=_queries.length;j<queriesLength;j++)item=$(_queries[j]),item.data(this.widgetName+"-item",targetData),items.push({item:item,instance:targetData,width:0,height:0,left:0,top:0})},refreshPositions:function(fast){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,item,t,p;for(i=this.items.length-1;i>=0;i--)item=this.items[i],item.instance!==this.currentContainer&&this.currentContainer&&item.item[0]!==this.currentItem[0]||(t=this.options.toleranceElement?$(this.options.toleranceElement,item.item):item.item,fast||(item.width=t.outerWidth(),item.height=t.outerHeight()),p=t.offset(),item.left=p.left,item.top=p.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)p=this.containers[i].element.offset(),this.containers[i].containerCache.left=p.left,this.containers[i].containerCache.top=p.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(that){that=that||this;var className,o=that.options;o.placeholder&&o.placeholder.constructor!==String||(className=o.placeholder,o.placeholder={element:function(){var nodeName=that.currentItem[0].nodeName.toLowerCase(),element=$("<"+nodeName+">",that.document[0]).addClass(className||that.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===nodeName?that.currentItem.children().each(function(){$("<td>&#160;</td>",that.document[0]).attr("colspan",$(this).attr("colspan")||1).appendTo(element)}):"img"===nodeName&&element.attr("src",that.currentItem.attr("src")),className||element.css("visibility","hidden"),element},update:function(container,p){className&&!o.forcePlaceholderSize||(p.height()||p.height(that.currentItem.innerHeight()-parseInt(that.currentItem.css("paddingTop")||0,10)-parseInt(that.currentItem.css("paddingBottom")||0,10)),p.width()||p.width(that.currentItem.innerWidth()-parseInt(that.currentItem.css("paddingLeft")||0,10)-parseInt(that.currentItem.css("paddingRight")||0,10)))}}),that.placeholder=$(o.placeholder.element.call(that.element,that.currentItem)),that.currentItem.after(that.placeholder),o.placeholder.update(that,that.placeholder)},_contactContainers:function(event){var i,j,dist,itemWithLeastDistance,posProperty,sizeProperty,base,cur,nearBottom,floating,innermostContainer=null,innermostIndex=null;for(i=this.containers.length-1;i>=0;i--)if(!$.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(innermostContainer&&$.contains(this.containers[i].element[0],innermostContainer.element[0]))continue;innermostContainer=this.containers[i],innermostIndex=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",event,this._uiHash(this)),this.containers[i].containerCache.over=0);if(innermostContainer)if(1===this.containers.length)this.containers[innermostIndex].containerCache.over||(this.containers[innermostIndex]._trigger("over",event,this._uiHash(this)),this.containers[innermostIndex].containerCache.over=1);else{for(dist=1e4,itemWithLeastDistance=null,floating=innermostContainer.floating||isFloating(this.currentItem),posProperty=floating?"left":"top",sizeProperty=floating?"width":"height",base=this.positionAbs[posProperty]+this.offset.click[posProperty],j=this.items.length-1;j>=0;j--)$.contains(this.containers[innermostIndex].element[0],this.items[j].item[0])&&this.items[j].item[0]!==this.currentItem[0]&&(floating&&!isOverAxis(this.positionAbs.top+this.offset.click.top,this.items[j].top,this.items[j].height)||(cur=this.items[j].item.offset()[posProperty],nearBottom=!1,Math.abs(cur-base)>Math.abs(cur+this.items[j][sizeProperty]-base)&&(nearBottom=!0,cur+=this.items[j][sizeProperty]),Math.abs(cur-base)<dist&&(dist=Math.abs(cur-base),itemWithLeastDistance=this.items[j],this.direction=nearBottom?"up":"down")));if(!itemWithLeastDistance&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[innermostIndex])return;itemWithLeastDistance?this._rearrange(event,itemWithLeastDistance,null,!0):this._rearrange(event,null,this.containers[innermostIndex].element,!0),this._trigger("change",event,this._uiHash()),this.containers[innermostIndex]._trigger("change",event,this._uiHash(this)),this.currentContainer=this.containers[innermostIndex],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[innermostIndex]._trigger("over",event,this._uiHash(this)),this.containers[innermostIndex].containerCache.over=1}},_createHelper:function(event){var o=this.options,helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event,this.currentItem])):"clone"===o.helper?this.currentItem.clone():this.currentItem;return helper.parents("body").length||$("parent"!==o.appendTo?o.appendTo:this.currentItem[0].parentNode)[0].appendChild(helper[0]),helper[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),helper[0].style.width&&!o.forceHelperSize||helper.width(this.currentItem.width()),helper[0].style.height&&!o.forceHelperSize||helper.height(this.currentItem.height()),helper},_adjustOffsetFromHelper:function(obj){"string"==typeof obj&&(obj=obj.split(" ")),$.isArray(obj)&&(obj={left:+obj[0],top:+obj[1]||0}),"left"in obj&&(this.offset.click.left=obj.left+this.margins.left),"right"in obj&&(this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left),"top"in obj&&(this.offset.click.top=obj.top+this.margins.top),"bottom"in obj&&(this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var po=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(po.left+=this.scrollParent.scrollLeft(),po.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&$.ui.ie)&&(po={top:0,left:0}),{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var p=this.currentItem.position();return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var ce,co,over,o=this.options;"parent"===o.containment&&(o.containment=this.helper[0].parentNode),"document"!==o.containment&&"window"!==o.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,$("document"===o.containment?document:window).width()-this.helperProportions.width-this.margins.left,($("document"===o.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(o.containment)||(ce=$(o.containment)[0],co=$(o.containment).offset(),over="hidden"!==$(ce).css("overflow"),this.containment=[co.left+(parseInt($(ce).css("borderLeftWidth"),10)||0)+(parseInt($(ce).css("paddingLeft"),10)||0)-this.margins.left,co.top+(parseInt($(ce).css("borderTopWidth"),10)||0)+(parseInt($(ce).css("paddingTop"),10)||0)-this.margins.top,co.left+(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt($(ce).css("borderLeftWidth"),10)||0)-(parseInt($(ce).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,co.top+(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt($(ce).css("borderTopWidth"),10)||0)-(parseInt($(ce).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(d,pos){pos||(pos=this.position);var mod="absolute"===d?1:-1,scroll="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,scrollIsRootNode=/(html|body)/i.test(scroll[0].tagName);return{top:pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():scrollIsRootNode?0:scroll.scrollTop())*mod,left:pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())*mod}},_generatePosition:function(event){var top,left,o=this.options,pageX=event.pageX,pageY=event.pageY,scroll="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,scrollIsRootNode=/(html|body)/i.test(scroll[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(event.pageX-this.offset.click.left<this.containment[0]&&(pageX=this.containment[0]+this.offset.click.left),event.pageY-this.offset.click.top<this.containment[1]&&(pageY=this.containment[1]+this.offset.click.top),event.pageX-this.offset.click.left>this.containment[2]&&(pageX=this.containment[2]+this.offset.click.left),event.pageY-this.offset.click.top>this.containment[3]&&(pageY=this.containment[3]+this.offset.click.top)),o.grid&&(top=this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1],pageY=this.containment?top-this.offset.click.top>=this.containment[1]&&top-this.offset.click.top<=this.containment[3]?top:top-this.offset.click.top>=this.containment[1]?top-o.grid[1]:top+o.grid[1]:top,left=this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0],pageX=this.containment?left-this.offset.click.left>=this.containment[0]&&left-this.offset.click.left<=this.containment[2]?left:left-this.offset.click.left>=this.containment[0]?left-o.grid[0]:left+o.grid[0]:left)),{top:pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():scrollIsRootNode?0:scroll.scrollTop()),left:pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())}},_rearrange:function(event,i,a,hardRefresh){a?a[0].appendChild(this.placeholder[0]):i.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?i.item[0]:i.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var counter=this.counter;this._delay(function(){counter===this.counter&&this.refreshPositions(!hardRefresh)})},_clear:function(event,noPropagation){function delayEvent(type,instance,container){return function(event){container._trigger(type,event,instance._uiHash(instance))}}this.reverting=!1;var i,delayedTriggers=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)"auto"!==this._storedCSS[i]&&"static"!==this._storedCSS[i]||(this._storedCSS[i]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!noPropagation&&delayedTriggers.push(function(event){this._trigger("receive",event,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||noPropagation||delayedTriggers.push(function(event){this._trigger("update",event,this._uiHash())}),this!==this.currentContainer&&(noPropagation||(delayedTriggers.push(function(event){this._trigger("remove",event,this._uiHash())}),delayedTriggers.push(function(c){return function(event){c._trigger("receive",event,this._uiHash(this))}}.call(this,this.currentContainer)),delayedTriggers.push(function(c){return function(event){c._trigger("update",event,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;i>=0;i--)noPropagation||delayedTriggers.push(delayEvent("deactivate",this,this.containers[i])),this.containers[i].containerCache.over&&(delayedTriggers.push(delayEvent("out",this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!noPropagation){for(this._trigger("beforeStop",event,this._uiHash()),i=0;i<delayedTriggers.length;i++)delayedTriggers[i].call(this,event);this._trigger("stop",event,this._uiHash())}return this.fromOutside=!1,!1}if(noPropagation||this._trigger("beforeStop",event,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!noPropagation){for(i=0;i<delayedTriggers.length;i++)delayedTriggers[i].call(this,event);this._trigger("stop",event,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){!1===$.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(_inst){var inst=_inst||this;return{helper:inst.helper,placeholder:inst.placeholder||$([]),position:inst.position,originalPosition:inst.originalPosition,offset:inst.positionAbs,item:inst.currentItem,sender:_inst?_inst.element:null}}})}(jQuery),function($,undefined){var dataSpace="ui-effects-";$.effects={effect:{}},function(jQuery,undefined){function clamp(value,prop,allowEmpty){var type=propTypes[prop.type]||{};return null==value?allowEmpty||!prop.def?null:prop.def:(value=type.floor?~~value:parseFloat(value),isNaN(value)?prop.def:type.mod?(value+type.mod)%type.mod:0>value?0:type.max<value?type.max:value)}function stringParse(string){var inst=color(),rgba=inst._rgba=[];return string=string.toLowerCase(),each(stringParsers,function(i,parser){var parsed,match=parser.re.exec(string),values=match&&parser.parse(match),spaceName=parser.space||"rgba";if(values)return parsed=inst[spaceName](values),inst[spaces[spaceName].cache]=parsed[spaces[spaceName].cache],rgba=inst._rgba=parsed._rgba,!1}),rgba.length?("0,0,0,0"===rgba.join()&&jQuery.extend(rgba,colors.transparent),inst):colors[string]}function hue2rgb(p,q,h){return h=(h+1)%1,6*h<1?p+(q-p)*h*6:2*h<1?q:3*h<2?p+(q-p)*(2/3-h)*6:p}var colors,stepHooks="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",rplusequals=/^([\-+])=\s*(\d+\.?\d*)/,stringParsers=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[execResult[1],execResult[2],execResult[3],execResult[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[2.55*execResult[1],2.55*execResult[2],2.55*execResult[3],execResult[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(execResult){return[parseInt(execResult[1],16),parseInt(execResult[2],16),parseInt(execResult[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(execResult){return[parseInt(execResult[1]+execResult[1],16),parseInt(execResult[2]+execResult[2],16),parseInt(execResult[3]+execResult[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(execResult){return[execResult[1],execResult[2]/100,execResult[3]/100,execResult[4]]}}],color=jQuery.Color=function(color,green,blue,alpha){return new jQuery.Color.fn.parse(color,green,blue,alpha)},spaces={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},propTypes={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},support=color.support={},supportElem=jQuery("<p>")[0],each=jQuery.each;supportElem.style.cssText="background-color:rgba(1,1,1,.5)",support.rgba=supportElem.style.backgroundColor.indexOf("rgba")>-1,each(spaces,function(spaceName,space){space.cache="_"+spaceName,space.props.alpha={idx:3,type:"percent",def:1}}),color.fn=jQuery.extend(color.prototype,{parse:function(red,green,blue,alpha){if(red===undefined)return this._rgba=[null,null,null,null],this;(red.jquery||red.nodeType)&&(red=jQuery(red).css(green),green=undefined);var inst=this,type=jQuery.type(red),rgba=this._rgba=[];return green!==undefined&&(red=[red,green,blue,alpha],type="array"),"string"===type?this.parse(stringParse(red)||colors._default):"array"===type?(each(spaces.rgba.props,function(key,prop){rgba[prop.idx]=clamp(red[prop.idx],prop)}),this):"object"===type?(red instanceof color?each(spaces,function(spaceName,space){red[space.cache]&&(inst[space.cache]=red[space.cache].slice())}):each(spaces,function(spaceName,space){var cache=space.cache;each(space.props,function(key,prop){if(!inst[cache]&&space.to){if("alpha"===key||null==red[key])return;inst[cache]=space.to(inst._rgba)}inst[cache][prop.idx]=clamp(red[key],prop,!0)}),inst[cache]&&jQuery.inArray(null,inst[cache].slice(0,3))<0&&(inst[cache][3]=1,space.from&&(inst._rgba=space.from(inst[cache])))}),this):void 0},is:function(compare){var is=color(compare),same=!0,inst=this;return each(spaces,function(_,space){var localCache,isCache=is[space.cache];return isCache&&(localCache=inst[space.cache]||space.to&&space.to(inst._rgba)||[],each(space.props,function(_,prop){if(null!=isCache[prop.idx])return same=isCache[prop.idx]===localCache[prop.idx]})),same}),same},_space:function(){var used=[],inst=this;return each(spaces,function(spaceName,space){inst[space.cache]&&used.push(spaceName)}),used.pop()},transition:function(other,distance){var end=color(other),spaceName=end._space(),space=spaces[spaceName],startColor=0===this.alpha()?color("transparent"):this,start=startColor[space.cache]||space.to(startColor._rgba),result=start.slice();return end=end[space.cache],each(space.props,function(key,prop){var index=prop.idx,startValue=start[index],endValue=end[index],type=propTypes[prop.type]||{};null!==endValue&&(null===startValue?result[index]=endValue:(type.mod&&(endValue-startValue>type.mod/2?startValue+=type.mod:startValue-endValue>type.mod/2&&(startValue-=type.mod)),result[index]=clamp((endValue-startValue)*distance+startValue,prop)))}),this[spaceName](result)},blend:function(opaque){if(1===this._rgba[3])return this;var rgb=this._rgba.slice(),a=rgb.pop(),blend=color(opaque)._rgba;return color(jQuery.map(rgb,function(v,i){return(1-a)*blend[i]+a*v}))},toRgbaString:function(){var prefix="rgba(",rgba=jQuery.map(this._rgba,function(v,i){return null==v?i>2?1:0:v});return 1===rgba[3]&&(rgba.pop(),prefix="rgb("),prefix+rgba.join()+")"},toHslaString:function(){var prefix="hsla(",hsla=jQuery.map(this.hsla(),function(v,i){return null==v&&(v=i>2?1:0),i&&i<3&&(v=Math.round(100*v)+"%"),v});return 1===hsla[3]&&(hsla.pop(),prefix="hsl("),prefix+hsla.join()+")"},toHexString:function(includeAlpha){var rgba=this._rgba.slice(),alpha=rgba.pop();return includeAlpha&&rgba.push(~~(255*alpha)),"#"+jQuery.map(rgba,function(v){return v=(v||0).toString(16),1===v.length?"0"+v:v}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),color.fn.parse.prototype=color.fn,spaces.hsla.to=function(rgba){if(null==rgba[0]||null==rgba[1]||null==rgba[2])return[null,null,null,rgba[3]];var h,s,r=rgba[0]/255,g=rgba[1]/255,b=rgba[2]/255,a=rgba[3],max=Math.max(r,g,b),min=Math.min(r,g,b),diff=max-min,add=max+min,l=.5*add;return h=min===max?0:r===max?60*(g-b)/diff+360:g===max?60*(b-r)/diff+120:60*(r-g)/diff+240,s=0===diff?0:l<=.5?diff/add:diff/(2-add),[Math.round(h)%360,s,l,null==a?1:a]},spaces.hsla.from=function(hsla){if(null==hsla[0]||null==hsla[1]||null==hsla[2])return[null,null,null,hsla[3]];var h=hsla[0]/360,s=hsla[1],l=hsla[2],a=hsla[3],q=l<=.5?l*(1+s):l+s-l*s,p=2*l-q;return[Math.round(255*hue2rgb(p,q,h+1/3)),Math.round(255*hue2rgb(p,q,h)),Math.round(255*hue2rgb(p,q,h-1/3)),a]},each(spaces,function(spaceName,space){var props=space.props,cache=space.cache,to=space.to,from=space.from;color.fn[spaceName]=function(value){if(to&&!this[cache]&&(this[cache]=to(this._rgba)),value===undefined)return this[cache].slice();var ret,type=jQuery.type(value),arr="array"===type||"object"===type?value:arguments,local=this[cache].slice();return each(props,function(key,prop){var val=arr["object"===type?key:prop.idx];null==val&&(val=local[prop.idx]),local[prop.idx]=clamp(val,prop)}),from?(ret=color(from(local)),ret[cache]=local,ret):color(local)},each(props,function(key,prop){color.fn[key]||(color.fn[key]=function(value){var match,vtype=jQuery.type(value),fn="alpha"===key?this._hsla?"hsla":"rgba":spaceName,local=this[fn](),cur=local[prop.idx];return"undefined"===vtype?cur:("function"===vtype&&(value=value.call(this,cur),vtype=jQuery.type(value)),null==value&&prop.empty?this:("string"===vtype&&(match=rplusequals.exec(value))&&(value=cur+parseFloat(match[2])*("+"===match[1]?1:-1)),local[prop.idx]=value,this[fn](local)))})})}),color.hook=function(hook){var hooks=hook.split(" ");each(hooks,function(i,hook){jQuery.cssHooks[hook]={set:function(elem,value){var parsed,curElem,backgroundColor="";if("transparent"!==value&&("string"!==jQuery.type(value)||(parsed=stringParse(value)))){if(value=color(parsed||value),!support.rgba&&1!==value._rgba[3]){for(curElem="backgroundColor"===hook?elem.parentNode:elem;(""===backgroundColor||"transparent"===backgroundColor)&&curElem&&curElem.style;)try{backgroundColor=jQuery.css(curElem,"backgroundColor"),curElem=curElem.parentNode}catch(e){}value=value.blend(backgroundColor&&"transparent"!==backgroundColor?backgroundColor:"_default")}value=value.toRgbaString()}try{elem.style[hook]=value}catch(e){}}},jQuery.fx.step[hook]=function(fx){fx.colorInit||(fx.start=color(fx.elem,hook),fx.end=color(fx.end),fx.colorInit=!0),jQuery.cssHooks[hook].set(fx.elem,fx.start.transition(fx.end,fx.pos))}})},color.hook(stepHooks),jQuery.cssHooks.borderColor={expand:function(value){var expanded={};return each(["Top","Right","Bottom","Left"],function(i,part){expanded["border"+part+"Color"]=value}),expanded}},colors=jQuery.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function getElementStyles(elem){var key,len,style=elem.ownerDocument.defaultView?elem.ownerDocument.defaultView.getComputedStyle(elem,null):elem.currentStyle,styles={};if(style&&style.length&&style[0]&&style[style[0]])for(len=style.length;len--;)key=style[len],"string"==typeof style[key]&&(styles[$.camelCase(key)]=style[key]);else for(key in style)"string"==typeof style[key]&&(styles[key]=style[key]);return styles}function styleDifference(oldStyle,newStyle){var name,value,diff={};for(name in newStyle)value=newStyle[name],oldStyle[name]!==value&&(shorthandStyles[name]||!$.fx.step[name]&&isNaN(parseFloat(value))||(diff[name]=value));return diff}var classAnimationActions=["add","remove","toggle"],shorthandStyles={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};$.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(_,prop){$.fx.step[prop]=function(fx){("none"!==fx.end&&!fx.setAttr||1===fx.pos&&!fx.setAttr)&&(jQuery.style(fx.elem,prop,fx.end),fx.setAttr=!0)}}),$.fn.addBack||($.fn.addBack=function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}),$.effects.animateClass=function(value,duration,easing,callback){var o=$.speed(duration,easing,callback);return this.queue(function(){var applyClassChange,animated=$(this),baseClass=animated.attr("class")||"",allAnimations=o.children?animated.find("*").addBack():animated;allAnimations=allAnimations.map(function(){return{el:$(this),start:getElementStyles(this)}}),applyClassChange=function(){$.each(classAnimationActions,function(i,action){value[action]&&animated[action+"Class"](value[action])})},applyClassChange(),allAnimations=allAnimations.map(function(){return this.end=getElementStyles(this.el[0]),this.diff=styleDifference(this.start,this.end),this}),animated.attr("class",baseClass),allAnimations=allAnimations.map(function(){var styleInfo=this,dfd=$.Deferred(),opts=$.extend({},o,{queue:!1,complete:function(){dfd.resolve(styleInfo)}});return this.el.animate(this.diff,opts),dfd.promise()}),$.when.apply($,allAnimations.get()).done(function(){applyClassChange(),$.each(arguments,function(){var el=this.el;$.each(this.diff,function(key){el.css(key,"")})}),o.complete.call(animated[0])})})},$.fn.extend({addClass:function(orig){return function(classNames,speed,easing,callback){return speed?$.effects.animateClass.call(this,{add:classNames},speed,easing,callback):orig.apply(this,arguments)}}($.fn.addClass),removeClass:function(orig){return function(classNames,speed,easing,callback){return arguments.length>1?$.effects.animateClass.call(this,{remove:classNames},speed,easing,callback):orig.apply(this,arguments)}}($.fn.removeClass),toggleClass:function(orig){return function(classNames,force,speed,easing,callback){return"boolean"==typeof force||force===undefined?speed?$.effects.animateClass.call(this,force?{add:classNames}:{remove:classNames},speed,easing,callback):orig.apply(this,arguments):$.effects.animateClass.call(this,{toggle:classNames},force,speed,easing)}}($.fn.toggleClass),switchClass:function(remove,add,speed,easing,callback){return $.effects.animateClass.call(this,{add:add,remove:remove},speed,easing,callback)}})}(),function(){function _normalizeArguments(effect,options,speed,callback){return $.isPlainObject(effect)&&(options=effect,effect=effect.effect),effect={effect:effect},null==options&&(options={}),$.isFunction(options)&&(callback=options,speed=null,options={}),("number"==typeof options||$.fx.speeds[options])&&(callback=speed,speed=options,options={}),$.isFunction(speed)&&(callback=speed,speed=null),options&&$.extend(effect,options),speed=speed||options.duration,effect.duration=$.fx.off?0:"number"==typeof speed?speed:speed in $.fx.speeds?$.fx.speeds[speed]:$.fx.speeds._default,effect.complete=callback||options.complete,effect}function standardAnimationOption(option){return!(option&&"number"!=typeof option&&!$.fx.speeds[option])||("string"==typeof option&&!$.effects.effect[option]||(!!$.isFunction(option)||"object"==typeof option&&!option.effect))}$.extend($.effects,{version:"1.10.4",save:function(element,set){for(var i=0;i<set.length;i++)null!==set[i]&&element.data(dataSpace+set[i],element[0].style[set[i]])},restore:function(element,set){var val,i;for(i=0;i<set.length;i++)null!==set[i]&&(val=element.data(dataSpace+set[i]),val===undefined&&(val=""),element.css(set[i],val))},setMode:function(el,mode){return"toggle"===mode&&(mode=el.is(":hidden")?"show":"hide"),mode},getBaseline:function(origin,original){var y,x;switch(origin[0]){case"top":y=0;break;case"middle":y=.5;break;case"bottom":y=1;break;default:y=origin[0]/original.height}switch(origin[1]){case"left":x=0;break;case"center":x=.5;break;case"right":x=1;break;default:x=origin[1]/original.width}return{x:x,y:y}},createWrapper:function(element){if(element.parent().is(".ui-effects-wrapper"))return element.parent();var props={width:element.outerWidth(!0),height:element.outerHeight(!0),float:element.css("float")},wrapper=$("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),size={width:element.width(),height:element.height()},active=document.activeElement;try{active.id}catch(e){active=document.body}return element.wrap(wrapper),(element[0]===active||$.contains(element[0],active))&&$(active).focus(),wrapper=element.parent(),"static"===element.css("position")?(wrapper.css({position:"relative"}),element.css({position:"relative"})):($.extend(props,{position:element.css("position"),zIndex:element.css("z-index")}),$.each(["top","left","bottom","right"],function(i,pos){props[pos]=element.css(pos),isNaN(parseInt(props[pos],10))&&(props[pos]="auto")}),element.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),element.css(size),wrapper.css(props).show()},removeWrapper:function(element){var active=document.activeElement;return element.parent().is(".ui-effects-wrapper")&&(element.parent().replaceWith(element),(element[0]===active||$.contains(element[0],active))&&$(active).focus()),element},setTransition:function(element,list,factor,value){return value=value||{},$.each(list,function(i,x){var unit=element.cssUnit(x);unit[0]>0&&(value[x]=unit[0]*factor+unit[1])}),value}}),$.fn.extend({effect:function(){function run(next){function done(){$.isFunction(complete)&&complete.call(elem[0]),$.isFunction(next)&&next()}var elem=$(this),complete=args.complete,mode=args.mode;(elem.is(":hidden")?"hide"===mode:"show"===mode)?(elem[mode](),done()):effectMethod.call(elem[0],args,done)}var args=_normalizeArguments.apply(this,arguments),mode=args.mode,queue=args.queue,effectMethod=$.effects.effect[args.effect];return $.fx.off||!effectMethod?mode?this[mode](args.duration,args.complete):this.each(function(){args.complete&&args.complete.call(this)}):!1===queue?this.each(run):this.queue(queue||"fx",run)},show:function(orig){return function(option){if(standardAnimationOption(option))return orig.apply(this,arguments);var args=_normalizeArguments.apply(this,arguments);return args.mode="show",this.effect.call(this,args)}}($.fn.show),hide:function(orig){return function(option){if(standardAnimationOption(option))return orig.apply(this,arguments)
;var args=_normalizeArguments.apply(this,arguments);return args.mode="hide",this.effect.call(this,args)}}($.fn.hide),toggle:function(orig){return function(option){if(standardAnimationOption(option)||"boolean"==typeof option)return orig.apply(this,arguments);var args=_normalizeArguments.apply(this,arguments);return args.mode="toggle",this.effect.call(this,args)}}($.fn.toggle),cssUnit:function(key){var style=this.css(key),val=[];return $.each(["em","px","%","pt"],function(i,unit){style.indexOf(unit)>0&&(val=[parseFloat(style),unit])}),val}})}(),function(){var baseEasings={};$.each(["Quad","Cubic","Quart","Quint","Expo"],function(i,name){baseEasings[name]=function(p){return Math.pow(p,i+2)}}),$.extend(baseEasings,{Sine:function(p){return 1-Math.cos(p*Math.PI/2)},Circ:function(p){return 1-Math.sqrt(1-p*p)},Elastic:function(p){return 0===p||1===p?p:-Math.pow(2,8*(p-1))*Math.sin((80*(p-1)-7.5)*Math.PI/15)},Back:function(p){return p*p*(3*p-2)},Bounce:function(p){for(var pow2,bounce=4;p<((pow2=Math.pow(2,--bounce))-1)/11;);return 1/Math.pow(4,3-bounce)-7.5625*Math.pow((3*pow2-2)/22-p,2)}}),$.each(baseEasings,function(name,easeIn){$.easing["easeIn"+name]=easeIn,$.easing["easeOut"+name]=function(p){return 1-easeIn(1-p)},$.easing["easeInOut"+name]=function(p){return p<.5?easeIn(2*p)/2:1-easeIn(-2*p+2)/2}})}()}(jQuery),function($,undefined){var uid=0,hideProps={},showProps={};hideProps.height=hideProps.paddingTop=hideProps.paddingBottom=hideProps.borderTopWidth=hideProps.borderBottomWidth="hide",showProps.height=showProps.paddingTop=showProps.paddingBottom=showProps.borderTopWidth=showProps.borderBottomWidth="show",$.widget("ui.accordion",{version:"1.10.4",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var options=this.options;this.prevShow=this.prevHide=$(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),options.collapsible||!1!==options.active&&null!=options.active||(options.active=0),this._processPanels(),options.active<0&&(options.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():$(),content:this.active.length?this.active.next():$()}},_createIcons:function(){var icons=this.options.icons;icons&&($("<span>").addClass("ui-accordion-header-icon ui-icon "+icons.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(icons.header).addClass(icons.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var contents;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),contents=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),"content"!==this.options.heightStyle&&contents.css("height","")},_setOption:function(key,value){if("active"===key)return void this._activate(value);"event"===key&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(value)),this._super(key,value),"collapsible"!==key||value||!1!==this.options.active||this._activate(0),"icons"===key&&(this._destroyIcons(),value&&this._createIcons()),"disabled"===key&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!value)},_keydown:function(event){if(!event.altKey&&!event.ctrlKey){var keyCode=$.ui.keyCode,length=this.headers.length,currentIndex=this.headers.index(event.target),toFocus=!1;switch(event.keyCode){case keyCode.RIGHT:case keyCode.DOWN:toFocus=this.headers[(currentIndex+1)%length];break;case keyCode.LEFT:case keyCode.UP:toFocus=this.headers[(currentIndex-1+length)%length];break;case keyCode.SPACE:case keyCode.ENTER:this._eventHandler(event);break;case keyCode.HOME:toFocus=this.headers[0];break;case keyCode.END:toFocus=this.headers[length-1]}toFocus&&($(event.target).attr("tabIndex",-1),$(toFocus).attr("tabIndex",0),toFocus.focus(),event.preventDefault())}},_panelKeyDown:function(event){event.keyCode===$.ui.keyCode.UP&&event.ctrlKey&&$(event.currentTarget).prev().focus()},refresh:function(){var options=this.options;this._processPanels(),!1===options.active&&!0===options.collapsible||!this.headers.length?(options.active=!1,this.active=$()):!1===options.active?this._activate(0):this.active.length&&!$.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(options.active=!1,this.active=$()):this._activate(Math.max(0,options.active-1)):options.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var maxHeight,options=this.options,heightStyle=options.heightStyle,parent=this.element.parent(),accordionId=this.accordionId="ui-accordion-"+(this.element.attr("id")||++uid);this.active=this._findActive(options.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(i){var header=$(this),headerId=header.attr("id"),panel=header.next(),panelId=panel.attr("id");headerId||(headerId=accordionId+"-header-"+i,header.attr("id",headerId)),panelId||(panelId=accordionId+"-panel-"+i,panel.attr("id",panelId)),header.attr("aria-controls",panelId),panel.attr("aria-labelledby",headerId)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(options.event),"fill"===heightStyle?(maxHeight=parent.height(),this.element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");"absolute"!==position&&"fixed"!==position&&(maxHeight-=elem.outerHeight(!0))}),this.headers.each(function(){maxHeight-=$(this).outerHeight(!0)}),this.headers.next().each(function(){$(this).height(Math.max(0,maxHeight-$(this).innerHeight()+$(this).height()))}).css("overflow","auto")):"auto"===heightStyle&&(maxHeight=0,this.headers.next().each(function(){maxHeight=Math.max(maxHeight,$(this).css("height","").height())}).height(maxHeight))},_activate:function(index){var active=this._findActive(index)[0];active!==this.active[0]&&(active=active||this.active[0],this._eventHandler({target:active,currentTarget:active,preventDefault:$.noop}))},_findActive:function(selector){return"number"==typeof selector?this.headers.eq(selector):$()},_setupEvents:function(event){var events={keydown:"_keydown"};event&&$.each(event.split(" "),function(index,eventName){events[eventName]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,events),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(event){var options=this.options,active=this.active,clicked=$(event.currentTarget),clickedIsActive=clicked[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():clicked.next(),toHide=active.next(),eventData={oldHeader:active,oldPanel:toHide,newHeader:collapsing?$():clicked,newPanel:toShow};event.preventDefault(),clickedIsActive&&!options.collapsible||!1===this._trigger("beforeActivate",event,eventData)||(options.active=!collapsing&&this.headers.index(clicked),this.active=clickedIsActive?$():clicked,this._toggle(eventData),active.removeClass("ui-accordion-header-active ui-state-active"),options.icons&&active.children(".ui-accordion-header-icon").removeClass(options.icons.activeHeader).addClass(options.icons.header),clickedIsActive||(clicked.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),options.icons&&clicked.children(".ui-accordion-header-icon").removeClass(options.icons.header).addClass(options.icons.activeHeader),clicked.next().addClass("ui-accordion-content-active")))},_toggle:function(data){var toShow=data.newPanel,toHide=this.prevShow.length?this.prevShow:data.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=toShow,this.prevHide=toHide,this.options.animate?this._animate(toShow,toHide,data):(toHide.hide(),toShow.show(),this._toggleComplete(data)),toHide.attr({"aria-hidden":"true"}),toHide.prev().attr("aria-selected","false"),toShow.length&&toHide.length?toHide.prev().attr({tabIndex:-1,"aria-expanded":"false"}):toShow.length&&this.headers.filter(function(){return 0===$(this).attr("tabIndex")}).attr("tabIndex",-1),toShow.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(toShow,toHide,data){var total,easing,duration,that=this,adjust=0,down=toShow.length&&(!toHide.length||toShow.index()<toHide.index()),animate=this.options.animate||{},options=down&&animate.down||animate,complete=function(){that._toggleComplete(data)};return"number"==typeof options&&(duration=options),"string"==typeof options&&(easing=options),easing=easing||options.easing||animate.easing,duration=duration||options.duration||animate.duration,toHide.length?toShow.length?(total=toShow.show().outerHeight(),toHide.animate(hideProps,{duration:duration,easing:easing,step:function(now,fx){fx.now=Math.round(now)}}),void toShow.hide().animate(showProps,{duration:duration,easing:easing,complete:complete,step:function(now,fx){fx.now=Math.round(now),"height"!==fx.prop?adjust+=fx.now:"content"!==that.options.heightStyle&&(fx.now=Math.round(total-toHide.outerHeight()-adjust),adjust=0)}})):toHide.animate(hideProps,duration,easing,complete):toShow.animate(showProps,duration,easing,complete)},_toggleComplete:function(data){var toHide=data.oldPanel;toHide.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),toHide.length&&(toHide.parent()[0].className=toHide.parent()[0].className),this._trigger("activate",null,data)}})}(jQuery),function($,undefined){$.widget("ui.autocomplete",{version:"1.10.4",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var suppressKeyPress,suppressKeyPressRepeat,suppressInput,nodeName=this.element[0].nodeName.toLowerCase(),isTextarea="textarea"===nodeName,isInput="input"===nodeName;this.isMultiLine=!!isTextarea||!isInput&&this.element.prop("isContentEditable"),this.valueMethod=this.element[isTextarea||isInput?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(event){if(this.element.prop("readOnly"))return suppressKeyPress=!0,suppressInput=!0,void(suppressKeyPressRepeat=!0);suppressKeyPress=!1,suppressInput=!1,suppressKeyPressRepeat=!1;var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:suppressKeyPress=!0,this._move("previousPage",event);break;case keyCode.PAGE_DOWN:suppressKeyPress=!0,this._move("nextPage",event);break;case keyCode.UP:suppressKeyPress=!0,this._keyEvent("previous",event);break;case keyCode.DOWN:suppressKeyPress=!0,this._keyEvent("next",event);break;case keyCode.ENTER:case keyCode.NUMPAD_ENTER:this.menu.active&&(suppressKeyPress=!0,event.preventDefault(),this.menu.select(event));break;case keyCode.TAB:this.menu.active&&this.menu.select(event);break;case keyCode.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(event),event.preventDefault());break;default:suppressKeyPressRepeat=!0,this._searchTimeout(event)}},keypress:function(event){if(suppressKeyPress)return suppressKeyPress=!1,void(this.isMultiLine&&!this.menu.element.is(":visible")||event.preventDefault());if(!suppressKeyPressRepeat){var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:this._move("previousPage",event);break;case keyCode.PAGE_DOWN:this._move("nextPage",event);break;case keyCode.UP:this._keyEvent("previous",event);break;case keyCode.DOWN:this._keyEvent("next",event)}}},input:function(event){if(suppressInput)return suppressInput=!1,void event.preventDefault();this._searchTimeout(event)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(event){if(this.cancelBlur)return void delete this.cancelBlur;clearTimeout(this.searching),this.close(event),this._change(event)}}),this._initSource(),this.menu=$("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(event){event.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var menuElement=this.menu.element[0];$(event.target).closest(".ui-menu-item").length||this._delay(function(){var that=this;this.document.one("mousedown",function(event){event.target===that.element[0]||event.target===menuElement||$.contains(menuElement,event.target)||that.close()})})},menufocus:function(event,ui){if(this.isNewMenu&&(this.isNewMenu=!1,event.originalEvent&&/^mouse/.test(event.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){$(event.target).trigger(event.originalEvent)});var item=ui.item.data("ui-autocomplete-item");!1!==this._trigger("focus",event,{item:item})?event.originalEvent&&/^key/.test(event.originalEvent.type)&&this._value(item.value):this.liveRegion.text(item.value)},menuselect:function(event,ui){var item=ui.item.data("ui-autocomplete-item"),previous=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=previous,this._delay(function(){this.previous=previous,this.selectedItem=item})),!1!==this._trigger("select",event,{item:item})&&this._value(item.value),this.term=this._value(),this.close(event),this.selectedItem=item}}),this.liveRegion=$("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(key,value){this._super(key,value),"source"===key&&this._initSource(),"appendTo"===key&&this.menu.element.appendTo(this._appendTo()),"disabled"===key&&value&&this.xhr&&this.xhr.abort()},_appendTo:function(){var element=this.options.appendTo;return element&&(element=element.jquery||element.nodeType?$(element):this.document.find(element).eq(0)),element||(element=this.element.closest(".ui-front")),element.length||(element=this.document[0].body),element},_initSource:function(){var array,url,that=this;$.isArray(this.options.source)?(array=this.options.source,this.source=function(request,response){response($.ui.autocomplete.filter(array,request.term))}):"string"==typeof this.options.source?(url=this.options.source,this.source=function(request,response){that.xhr&&that.xhr.abort(),that.xhr=$.ajax({url:url,data:request,dataType:"json",success:function(data){response(data)},error:function(){response([])}})}):this.source=this.options.source},_searchTimeout:function(event){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,event))},this.options.delay)},search:function(value,event){return value=null!=value?value:this._value(),this.term=this._value(),value.length<this.options.minLength?this.close(event):!1!==this._trigger("search",event)?this._search(value):void 0},_search:function(value){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:value},this._response())},_response:function(){var index=++this.requestIndex;return $.proxy(function(content){index===this.requestIndex&&this.__response(content),--this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(content){content&&(content=this._normalize(content)),this._trigger("response",null,{content:content}),!this.options.disabled&&content&&content.length&&!this.cancelSearch?(this._suggest(content),this._trigger("open")):this._close()},close:function(event){this.cancelSearch=!0,this._close(event)},_close:function(event){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",event))},_change:function(event){this.previous!==this._value()&&this._trigger("change",event,{item:this.selectedItem})},_normalize:function(items){return items.length&&items[0].label&&items[0].value?items:$.map(items,function(item){return"string"==typeof item?{label:item,value:item}:$.extend({label:item.label||item.value,value:item.value||item.label},item)})},_suggest:function(items){var ul=this.menu.element.empty();this._renderMenu(ul,items),this.isNewMenu=!0,this.menu.refresh(),ul.show(),this._resizeMenu(),ul.position($.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var ul=this.menu.element;ul.outerWidth(Math.max(ul.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(ul,items){var that=this;$.each(items,function(index,item){that._renderItemData(ul,item)})},_renderItemData:function(ul,item){return this._renderItem(ul,item).data("ui-autocomplete-item",item)},_renderItem:function(ul,item){return $("<li>").append($("<a>").text(item.label)).appendTo(ul)},_move:function(direction,event){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(direction)||this.menu.isLastItem()&&/^next/.test(direction)?(this._value(this.term),void this.menu.blur()):void this.menu[direction](event):void this.search(null,event)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(keyEvent,event){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(keyEvent,event),event.preventDefault())}}),$.extend($.ui.autocomplete,{escapeRegex:function(value){return value.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(array,term){var matcher=new RegExp($.ui.autocomplete.escapeRegex(term),"i");return $.grep(array,function(value){return matcher.test(value.label||value.value||value)})}}),$.widget("ui.autocomplete",$.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(amount){return amount+(amount>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(content){var message;this._superApply(arguments),this.options.disabled||this.cancelSearch||(message=content&&content.length?this.options.messages.results(content.length):this.options.messages.noResults,this.liveRegion.text(message))}})}(jQuery),function($,undefined){var lastActive,baseClasses="ui-button ui-widget ui-state-default ui-corner-all",typeClasses="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",formResetHandler=function(){var form=$(this);setTimeout(function(){form.find(":ui-button").button("refresh")},1)},radioGroup=function(radio){var name=radio.name,form=radio.form,radios=$([]);return name&&(name=name.replace(/'/g,"\\'"),radios=form?$(form).find("[name='"+name+"']"):$("[name='"+name+"']",radio.ownerDocument).filter(function(){return!this.form})),radios};$.widget("ui.button",{version:"1.10.4",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,formResetHandler),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var that=this,options=this.options,toggleButton="checkbox"===this.type||"radio"===this.type,activeClass=toggleButton?"":"ui-state-active";null===options.label&&(options.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(baseClasses).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){options.disabled||this===lastActive&&$(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){options.disabled||$(this).removeClass(activeClass)}).bind("click"+this.eventNamespace,function(event){options.disabled&&(event.preventDefault(),event.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),toggleButton&&this.element.bind("change"+this.eventNamespace,function(){that.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(options.disabled)return!1}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(options.disabled)return!1;$(this).addClass("ui-state-active"),that.buttonElement.attr("aria-pressed","true");var radio=that.element[0];radioGroup(radio).not(radio).map(function(){return $(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){if(options.disabled)return!1;$(this).addClass("ui-state-active"),lastActive=this,that.document.one("mouseup",function(){lastActive=null})}).bind("mouseup"+this.eventNamespace,function(){if(options.disabled)return!1;$(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(event){if(options.disabled)return!1;event.keyCode!==$.ui.keyCode.SPACE&&event.keyCode!==$.ui.keyCode.ENTER||$(this).addClass("ui-state-active")}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){$(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(event){event.keyCode===$.ui.keyCode.SPACE&&$(this).click()})),this._setOption("disabled",options.disabled),this._resetButton()},_determineButtonType:function(){var ancestor,labelSelector,checked;this.element.is("[type=checkbox]")?this.type="checkbox":this.element.is("[type=radio]")?this.type="radio":this.element.is("input")?this.type="input":this.type="button","checkbox"===this.type||"radio"===this.type?(ancestor=this.element.parents().last(),labelSelector="label[for='"+this.element.attr("id")+"']",this.buttonElement=ancestor.find(labelSelector),this.buttonElement.length||(ancestor=ancestor.length?ancestor.siblings():this.element.siblings(),this.buttonElement=ancestor.filter(labelSelector),this.buttonElement.length||(this.buttonElement=ancestor.find(labelSelector))),this.element.addClass("ui-helper-hidden-accessible"),checked=this.element.is(":checked"),checked&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",checked)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(baseClasses+" ui-state-active "+typeClasses).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(key,value){if(this._super(key,value),"disabled"===key)return this.element.prop("disabled",!!value),void(value&&this.buttonElement.removeClass("ui-state-focus"));this._resetButton()},refresh:function(){var isDisabled=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");isDisabled!==this.options.disabled&&this._setOption("disabled",isDisabled),"radio"===this.type?radioGroup(this.element[0]).each(function(){$(this).is(":checked")?$(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):$(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var buttonElement=this.buttonElement.removeClass(typeClasses),buttonText=$("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(buttonElement.empty()).text(),icons=this.options.icons,multipleIcons=icons.primary&&icons.secondary,buttonClasses=[];icons.primary||icons.secondary?(this.options.text&&buttonClasses.push("ui-button-text-icon"+(multipleIcons?"s":icons.primary?"-primary":"-secondary")),icons.primary&&buttonElement.prepend("<span class='ui-button-icon-primary ui-icon "+icons.primary+"'></span>"),icons.secondary&&buttonElement.append("<span class='ui-button-icon-secondary ui-icon "+icons.secondary+"'></span>"),this.options.text||(buttonClasses.push(multipleIcons?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||buttonElement.attr("title",$.trim(buttonText)))):buttonClasses.push("ui-button-text-only"),buttonElement.addClass(buttonClasses.join(" "))}}),$.widget("ui.buttonset",{version:"1.10.4",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(key,value){"disabled"===key&&this.buttons.button("option",key,value),this._super(key,value)},refresh:function(){var rtl="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return $(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(rtl?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(rtl?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return $(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function($,undefined){function Datepicker(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},$.extend(this._defaults,this.regional[""]),this.dpDiv=bindHover($("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function bindHover(dpDiv){var selector="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return dpDiv.delegate(selector,"mouseout",function(){$(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&$(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&$(this).removeClass("ui-datepicker-next-hover")}).delegate(selector,"mouseover",function(){$.datepicker._isDisabledDatepicker(instActive.inline?dpDiv.parent()[0]:instActive.input[0])||($(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),$(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&$(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&$(this).addClass("ui-datepicker-next-hover"))})}function extendRemove(target,props){$.extend(target,props);for(var name in props)null==props[name]&&(target[name]=props[name]);return target}$.extend($.ui,{datepicker:{version:"1.10.4"}});var instActive,PROP_NAME="datepicker";$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(settings){return extendRemove(this._defaults,settings||{}),this},_attachDatepicker:function(target,settings){var nodeName,inline,inst;nodeName=target.nodeName.toLowerCase(),inline="div"===nodeName||"span"===nodeName,target.id||(this.uuid+=1,target.id="dp"+this.uuid),inst=this._newInst($(target),inline),inst.settings=$.extend({},settings||{}),"input"===nodeName?this._connectDatepicker(target,inst):inline&&this._inlineDatepicker(target,inst)},_newInst:function(target,inline){return{id:target[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:target,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:inline,dpDiv:inline?bindHover($("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(target,inst){var input=$(target);inst.append=$([]),inst.trigger=$([]),input.hasClass(this.markerClassName)||(this._attachments(input,inst),
input.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(inst),$.data(target,PROP_NAME,inst),inst.settings.disabled&&this._disableDatepicker(target))},_attachments:function(input,inst){var showOn,buttonText,buttonImage,appendText=this._get(inst,"appendText"),isRTL=this._get(inst,"isRTL");inst.append&&inst.append.remove(),appendText&&(inst.append=$("<span class='"+this._appendClass+"'>"+appendText+"</span>"),input[isRTL?"before":"after"](inst.append)),input.unbind("focus",this._showDatepicker),inst.trigger&&inst.trigger.remove(),showOn=this._get(inst,"showOn"),"focus"!==showOn&&"both"!==showOn||input.focus(this._showDatepicker),"button"!==showOn&&"both"!==showOn||(buttonText=this._get(inst,"buttonText"),buttonImage=this._get(inst,"buttonImage"),inst.trigger=$(this._get(inst,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:buttonImage,alt:buttonText,title:buttonText}):$("<button type='button'></button>").addClass(this._triggerClass).html(buttonImage?$("<img/>").attr({src:buttonImage,alt:buttonText,title:buttonText}):buttonText)),input[isRTL?"before":"after"](inst.trigger),inst.trigger.click(function(){return $.datepicker._datepickerShowing&&$.datepicker._lastInput===input[0]?$.datepicker._hideDatepicker():$.datepicker._datepickerShowing&&$.datepicker._lastInput!==input[0]?($.datepicker._hideDatepicker(),$.datepicker._showDatepicker(input[0])):$.datepicker._showDatepicker(input[0]),!1}))},_autoSize:function(inst){if(this._get(inst,"autoSize")&&!inst.inline){var findMax,max,maxI,i,date=new Date(2009,11,20),dateFormat=this._get(inst,"dateFormat");dateFormat.match(/[DM]/)&&(findMax=function(names){for(max=0,maxI=0,i=0;i<names.length;i++)names[i].length>max&&(max=names[i].length,maxI=i);return maxI},date.setMonth(findMax(this._get(inst,dateFormat.match(/MM/)?"monthNames":"monthNamesShort"))),date.setDate(findMax(this._get(inst,dateFormat.match(/DD/)?"dayNames":"dayNamesShort"))+20-date.getDay())),inst.input.attr("size",this._formatDate(inst,date).length)}},_inlineDatepicker:function(target,inst){var divSpan=$(target);divSpan.hasClass(this.markerClassName)||(divSpan.addClass(this.markerClassName).append(inst.dpDiv),$.data(target,PROP_NAME,inst),this._setDate(inst,this._getDefaultDate(inst),!0),this._updateDatepicker(inst),this._updateAlternate(inst),inst.settings.disabled&&this._disableDatepicker(target),inst.dpDiv.css("display","block"))},_dialogDatepicker:function(input,date,onSelect,settings,pos){var id,browserWidth,browserHeight,scrollX,scrollY,inst=this._dialogInst;return inst||(this.uuid+=1,id="dp"+this.uuid,this._dialogInput=$("<input type='text' id='"+id+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),$("body").append(this._dialogInput),inst=this._dialogInst=this._newInst(this._dialogInput,!1),inst.settings={},$.data(this._dialogInput[0],PROP_NAME,inst)),extendRemove(inst.settings,settings||{}),date=date&&date.constructor===Date?this._formatDate(inst,date):date,this._dialogInput.val(date),this._pos=pos?pos.length?pos:[pos.pageX,pos.pageY]:null,this._pos||(browserWidth=document.documentElement.clientWidth,browserHeight=document.documentElement.clientHeight,scrollX=document.documentElement.scrollLeft||document.body.scrollLeft,scrollY=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[browserWidth/2-100+scrollX,browserHeight/2-150+scrollY]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),inst.settings.onSelect=onSelect,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),$.blockUI&&$.blockUI(this.dpDiv),$.data(this._dialogInput[0],PROP_NAME,inst),this},_destroyDatepicker:function(target){var nodeName,$target=$(target),inst=$.data(target,PROP_NAME);$target.hasClass(this.markerClassName)&&(nodeName=target.nodeName.toLowerCase(),$.removeData(target,PROP_NAME),"input"===nodeName?(inst.append.remove(),inst.trigger.remove(),$target.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):"div"!==nodeName&&"span"!==nodeName||$target.removeClass(this.markerClassName).empty())},_enableDatepicker:function(target){var nodeName,inline,$target=$(target),inst=$.data(target,PROP_NAME);$target.hasClass(this.markerClassName)&&(nodeName=target.nodeName.toLowerCase(),"input"===nodeName?(target.disabled=!1,inst.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!==nodeName&&"span"!==nodeName||(inline=$target.children("."+this._inlineClass),inline.children().removeClass("ui-state-disabled"),inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=$.map(this._disabledInputs,function(value){return value===target?null:value}))},_disableDatepicker:function(target){var nodeName,inline,$target=$(target),inst=$.data(target,PROP_NAME);$target.hasClass(this.markerClassName)&&(nodeName=target.nodeName.toLowerCase(),"input"===nodeName?(target.disabled=!0,inst.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!==nodeName&&"span"!==nodeName||(inline=$target.children("."+this._inlineClass),inline.children().addClass("ui-state-disabled"),inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=$.map(this._disabledInputs,function(value){return value===target?null:value}),this._disabledInputs[this._disabledInputs.length]=target)},_isDisabledDatepicker:function(target){if(!target)return!1;for(var i=0;i<this._disabledInputs.length;i++)if(this._disabledInputs[i]===target)return!0;return!1},_getInst:function(target){try{return $.data(target,PROP_NAME)}catch(err){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(target,name,value){var settings,date,minDate,maxDate,inst=this._getInst(target);if(2===arguments.length&&"string"==typeof name)return"defaults"===name?$.extend({},$.datepicker._defaults):inst?"all"===name?$.extend({},inst.settings):this._get(inst,name):null;settings=name||{},"string"==typeof name&&(settings={},settings[name]=value),inst&&(this._curInst===inst&&this._hideDatepicker(),date=this._getDateDatepicker(target,!0),minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),extendRemove(inst.settings,settings),null!==minDate&&settings.dateFormat!==undefined&&settings.minDate===undefined&&(inst.settings.minDate=this._formatDate(inst,minDate)),null!==maxDate&&settings.dateFormat!==undefined&&settings.maxDate===undefined&&(inst.settings.maxDate=this._formatDate(inst,maxDate)),"disabled"in settings&&(settings.disabled?this._disableDatepicker(target):this._enableDatepicker(target)),this._attachments($(target),inst),this._autoSize(inst),this._setDate(inst,date),this._updateAlternate(inst),this._updateDatepicker(inst))},_changeDatepicker:function(target,name,value){this._optionDatepicker(target,name,value)},_refreshDatepicker:function(target){var inst=this._getInst(target);inst&&this._updateDatepicker(inst)},_setDateDatepicker:function(target,date){var inst=this._getInst(target);inst&&(this._setDate(inst,date),this._updateDatepicker(inst),this._updateAlternate(inst))},_getDateDatepicker:function(target,noDefault){var inst=this._getInst(target);return inst&&!inst.inline&&this._setDateFromField(inst,noDefault),inst?this._getDate(inst):null},_doKeyDown:function(event){var onSelect,dateStr,sel,inst=$.datepicker._getInst(event.target),handled=!0,isRTL=inst.dpDiv.is(".ui-datepicker-rtl");if(inst._keyEvent=!0,$.datepicker._datepickerShowing)switch(event.keyCode){case 9:$.datepicker._hideDatepicker(),handled=!1;break;case 13:return sel=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",inst.dpDiv),sel[0]&&$.datepicker._selectDay(event.target,inst.selectedMonth,inst.selectedYear,sel[0]),onSelect=$.datepicker._get(inst,"onSelect"),onSelect?(dateStr=$.datepicker._formatDate(inst),onSelect.apply(inst.input?inst.input[0]:null,[dateStr,inst])):$.datepicker._hideDatepicker(),!1;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(event.target,event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths"),"M");break;case 34:$.datepicker._adjustDate(event.target,event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths"),"M");break;case 35:(event.ctrlKey||event.metaKey)&&$.datepicker._clearDate(event.target),handled=event.ctrlKey||event.metaKey;break;case 36:(event.ctrlKey||event.metaKey)&&$.datepicker._gotoToday(event.target),handled=event.ctrlKey||event.metaKey;break;case 37:(event.ctrlKey||event.metaKey)&&$.datepicker._adjustDate(event.target,isRTL?1:-1,"D"),handled=event.ctrlKey||event.metaKey,event.originalEvent.altKey&&$.datepicker._adjustDate(event.target,event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths"),"M");break;case 38:(event.ctrlKey||event.metaKey)&&$.datepicker._adjustDate(event.target,-7,"D"),handled=event.ctrlKey||event.metaKey;break;case 39:(event.ctrlKey||event.metaKey)&&$.datepicker._adjustDate(event.target,isRTL?-1:1,"D"),handled=event.ctrlKey||event.metaKey,event.originalEvent.altKey&&$.datepicker._adjustDate(event.target,event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths"),"M");break;case 40:(event.ctrlKey||event.metaKey)&&$.datepicker._adjustDate(event.target,7,"D"),handled=event.ctrlKey||event.metaKey;break;default:handled=!1}else 36===event.keyCode&&event.ctrlKey?$.datepicker._showDatepicker(this):handled=!1;handled&&(event.preventDefault(),event.stopPropagation())},_doKeyPress:function(event){var chars,chr,inst=$.datepicker._getInst(event.target);if($.datepicker._get(inst,"constrainInput"))return chars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat")),chr=String.fromCharCode(null==event.charCode?event.keyCode:event.charCode),event.ctrlKey||event.metaKey||chr<" "||!chars||chars.indexOf(chr)>-1},_doKeyUp:function(event){var date,inst=$.datepicker._getInst(event.target);if(inst.input.val()!==inst.lastVal)try{date=$.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),inst.input?inst.input.val():null,$.datepicker._getFormatConfig(inst)),date&&($.datepicker._setDateFromField(inst),$.datepicker._updateAlternate(inst),$.datepicker._updateDatepicker(inst))}catch(err){}return!0},_showDatepicker:function(input){if(input=input.target||input,"input"!==input.nodeName.toLowerCase()&&(input=$("input",input.parentNode)[0]),!$.datepicker._isDisabledDatepicker(input)&&$.datepicker._lastInput!==input){var inst,beforeShow,beforeShowSettings,isFixed,offset,showAnim,duration;inst=$.datepicker._getInst(input),$.datepicker._curInst&&$.datepicker._curInst!==inst&&($.datepicker._curInst.dpDiv.stop(!0,!0),inst&&$.datepicker._datepickerShowing&&$.datepicker._hideDatepicker($.datepicker._curInst.input[0])),beforeShow=$.datepicker._get(inst,"beforeShow"),beforeShowSettings=beforeShow?beforeShow.apply(input,[input,inst]):{},!1!==beforeShowSettings&&(extendRemove(inst.settings,beforeShowSettings),inst.lastVal=null,$.datepicker._lastInput=input,$.datepicker._setDateFromField(inst),$.datepicker._inDialog&&(input.value=""),$.datepicker._pos||($.datepicker._pos=$.datepicker._findPos(input),$.datepicker._pos[1]+=input.offsetHeight),isFixed=!1,$(input).parents().each(function(){return!(isFixed|="fixed"===$(this).css("position"))}),offset={left:$.datepicker._pos[0],top:$.datepicker._pos[1]},$.datepicker._pos=null,inst.dpDiv.empty(),inst.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),$.datepicker._updateDatepicker(inst),offset=$.datepicker._checkOffset(inst,offset,isFixed),inst.dpDiv.css({position:$.datepicker._inDialog&&$.blockUI?"static":isFixed?"fixed":"absolute",display:"none",left:offset.left+"px",top:offset.top+"px"}),inst.inline||(showAnim=$.datepicker._get(inst,"showAnim"),duration=$.datepicker._get(inst,"duration"),inst.dpDiv.zIndex($(input).zIndex()+1),$.datepicker._datepickerShowing=!0,$.effects&&$.effects.effect[showAnim]?inst.dpDiv.show(showAnim,$.datepicker._get(inst,"showOptions"),duration):inst.dpDiv[showAnim||"show"](showAnim?duration:null),$.datepicker._shouldFocusInput(inst)&&inst.input.focus(),$.datepicker._curInst=inst))}},_updateDatepicker:function(inst){this.maxRows=4,instActive=inst,inst.dpDiv.empty().append(this._generateHTML(inst)),this._attachHandlers(inst),inst.dpDiv.find("."+this._dayOverClass+" a").mouseover();var origyearshtml,numMonths=this._getNumberOfMonths(inst),cols=numMonths[1];inst.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),cols>1&&inst.dpDiv.addClass("ui-datepicker-multi-"+cols).css("width",17*cols+"em"),inst.dpDiv[(1!==numMonths[0]||1!==numMonths[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),inst.dpDiv[(this._get(inst,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),inst===$.datepicker._curInst&&$.datepicker._datepickerShowing&&$.datepicker._shouldFocusInput(inst)&&inst.input.focus(),inst.yearshtml&&(origyearshtml=inst.yearshtml,setTimeout(function(){origyearshtml===inst.yearshtml&&inst.yearshtml&&inst.dpDiv.find("select.ui-datepicker-year:first").replaceWith(inst.yearshtml),origyearshtml=inst.yearshtml=null},0))},_shouldFocusInput:function(inst){return inst.input&&inst.input.is(":visible")&&!inst.input.is(":disabled")&&!inst.input.is(":focus")},_checkOffset:function(inst,offset,isFixed){var dpWidth=inst.dpDiv.outerWidth(),dpHeight=inst.dpDiv.outerHeight(),inputWidth=inst.input?inst.input.outerWidth():0,inputHeight=inst.input?inst.input.outerHeight():0,viewWidth=document.documentElement.clientWidth+(isFixed?0:$(document).scrollLeft()),viewHeight=document.documentElement.clientHeight+(isFixed?0:$(document).scrollTop());return offset.left-=this._get(inst,"isRTL")?dpWidth-inputWidth:0,offset.left-=isFixed&&offset.left===inst.input.offset().left?$(document).scrollLeft():0,offset.top-=isFixed&&offset.top===inst.input.offset().top+inputHeight?$(document).scrollTop():0,offset.left-=Math.min(offset.left,offset.left+dpWidth>viewWidth&&viewWidth>dpWidth?Math.abs(offset.left+dpWidth-viewWidth):0),offset.top-=Math.min(offset.top,offset.top+dpHeight>viewHeight&&viewHeight>dpHeight?Math.abs(dpHeight+inputHeight):0),offset},_findPos:function(obj){for(var position,inst=this._getInst(obj),isRTL=this._get(inst,"isRTL");obj&&("hidden"===obj.type||1!==obj.nodeType||$.expr.filters.hidden(obj));)obj=obj[isRTL?"previousSibling":"nextSibling"];return position=$(obj).offset(),[position.left,position.top]},_hideDatepicker:function(input){var showAnim,duration,postProcess,onClose,inst=this._curInst;!inst||input&&inst!==$.data(input,PROP_NAME)||this._datepickerShowing&&(showAnim=this._get(inst,"showAnim"),duration=this._get(inst,"duration"),postProcess=function(){$.datepicker._tidyDialog(inst)},$.effects&&($.effects.effect[showAnim]||$.effects[showAnim])?inst.dpDiv.hide(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess):inst.dpDiv["slideDown"===showAnim?"slideUp":"fadeIn"===showAnim?"fadeOut":"hide"](showAnim?duration:null,postProcess),showAnim||postProcess(),this._datepickerShowing=!1,onClose=this._get(inst,"onClose"),onClose&&onClose.apply(inst.input?inst.input[0]:null,[inst.input?inst.input.val():"",inst]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(inst){inst.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(event){if($.datepicker._curInst){var $target=$(event.target),inst=$.datepicker._getInst($target[0]);($target[0].id===$.datepicker._mainDivId||0!==$target.parents("#"+$.datepicker._mainDivId).length||$target.hasClass($.datepicker.markerClassName)||$target.closest("."+$.datepicker._triggerClass).length||!$.datepicker._datepickerShowing||$.datepicker._inDialog&&$.blockUI)&&(!$target.hasClass($.datepicker.markerClassName)||$.datepicker._curInst===inst)||$.datepicker._hideDatepicker()}},_adjustDate:function(id,offset,period){var target=$(id),inst=this._getInst(target[0]);this._isDisabledDatepicker(target[0])||(this._adjustInstDate(inst,offset+("M"===period?this._get(inst,"showCurrentAtPos"):0),period),this._updateDatepicker(inst))},_gotoToday:function(id){var date,target=$(id),inst=this._getInst(target[0]);this._get(inst,"gotoCurrent")&&inst.currentDay?(inst.selectedDay=inst.currentDay,inst.drawMonth=inst.selectedMonth=inst.currentMonth,inst.drawYear=inst.selectedYear=inst.currentYear):(date=new Date,inst.selectedDay=date.getDate(),inst.drawMonth=inst.selectedMonth=date.getMonth(),inst.drawYear=inst.selectedYear=date.getFullYear()),this._notifyChange(inst),this._adjustDate(target)},_selectMonthYear:function(id,select,period){var target=$(id),inst=this._getInst(target[0]);inst["selected"+("M"===period?"Month":"Year")]=inst["draw"+("M"===period?"Month":"Year")]=parseInt(select.options[select.selectedIndex].value,10),this._notifyChange(inst),this._adjustDate(target)},_selectDay:function(id,month,year,td){var inst,target=$(id);$(td).hasClass(this._unselectableClass)||this._isDisabledDatepicker(target[0])||(inst=this._getInst(target[0]),inst.selectedDay=inst.currentDay=$("a",td).html(),inst.selectedMonth=inst.currentMonth=month,inst.selectedYear=inst.currentYear=year,this._selectDate(id,this._formatDate(inst,inst.currentDay,inst.currentMonth,inst.currentYear)))},_clearDate:function(id){var target=$(id);this._selectDate(target,"")},_selectDate:function(id,dateStr){var onSelect,target=$(id),inst=this._getInst(target[0]);dateStr=null!=dateStr?dateStr:this._formatDate(inst),inst.input&&inst.input.val(dateStr),this._updateAlternate(inst),onSelect=this._get(inst,"onSelect"),onSelect?onSelect.apply(inst.input?inst.input[0]:null,[dateStr,inst]):inst.input&&inst.input.trigger("change"),inst.inline?this._updateDatepicker(inst):(this._hideDatepicker(),this._lastInput=inst.input[0],"object"!=typeof inst.input[0]&&inst.input.focus(),this._lastInput=null)},_updateAlternate:function(inst){var altFormat,date,dateStr,altField=this._get(inst,"altField");altField&&(altFormat=this._get(inst,"altFormat")||this._get(inst,"dateFormat"),date=this._getDate(inst),dateStr=this.formatDate(altFormat,date,this._getFormatConfig(inst)),$(altField).each(function(){$(this).val(dateStr)}))},noWeekends:function(date){var day=date.getDay();return[day>0&&day<6,""]},iso8601Week:function(date){var time,checkDate=new Date(date.getTime());return checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7)),time=checkDate.getTime(),checkDate.setMonth(0),checkDate.setDate(1),Math.floor(Math.round((time-checkDate)/864e5)/7)+1},parseDate:function(format,value,settings){if(null==format||null==value)throw"Invalid arguments";if(""===(value="object"==typeof value?value.toString():value+""))return null;var iFormat,dim,extra,date,iValue=0,shortYearCutoffTemp=(settings?settings.shortYearCutoff:null)||this._defaults.shortYearCutoff,shortYearCutoff="string"!=typeof shortYearCutoffTemp?shortYearCutoffTemp:(new Date).getFullYear()%100+parseInt(shortYearCutoffTemp,10),dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,year=-1,month=-1,day=-1,doy=-1,literal=!1,lookAhead=function(match){var matches=iFormat+1<format.length&&format.charAt(iFormat+1)===match;return matches&&iFormat++,matches},getNumber=function(match){var isDoubled=lookAhead(match),size="@"===match?14:"!"===match?20:"y"===match&&isDoubled?4:"o"===match?3:2,digits=new RegExp("^\\d{1,"+size+"}"),num=value.substring(iValue).match(digits);if(!num)throw"Missing number at position "+iValue;return iValue+=num[0].length,parseInt(num[0],10)},getName=function(match,shortNames,longNames){var index=-1,names=$.map(lookAhead(match)?longNames:shortNames,function(v,k){return[[k,v]]}).sort(function(a,b){return-(a[1].length-b[1].length)});if($.each(names,function(i,pair){var name=pair[1];if(value.substr(iValue,name.length).toLowerCase()===name.toLowerCase())return index=pair[0],iValue+=name.length,!1}),-1!==index)return index+1;throw"Unknown name at position "+iValue},checkLiteral=function(){if(value.charAt(iValue)!==format.charAt(iFormat))throw"Unexpected literal at position "+iValue;iValue++};for(iFormat=0;iFormat<format.length;iFormat++)if(literal)"'"!==format.charAt(iFormat)||lookAhead("'")?checkLiteral():literal=!1;else switch(format.charAt(iFormat)){case"d":day=getNumber("d");break;case"D":getName("D",dayNamesShort,dayNames);break;case"o":doy=getNumber("o");break;case"m":month=getNumber("m");break;case"M":month=getName("M",monthNamesShort,monthNames);break;case"y":year=getNumber("y");break;case"@":date=new Date(getNumber("@")),year=date.getFullYear(),month=date.getMonth()+1,day=date.getDate();break;case"!":date=new Date((getNumber("!")-this._ticksTo1970)/1e4),year=date.getFullYear(),month=date.getMonth()+1,day=date.getDate();break;case"'":lookAhead("'")?checkLiteral():literal=!0;break;default:checkLiteral()}if(iValue<value.length&&(extra=value.substr(iValue),!/^\s+/.test(extra)))throw"Extra/unparsed characters found in date: "+extra;if(-1===year?year=(new Date).getFullYear():year<100&&(year+=(new Date).getFullYear()-(new Date).getFullYear()%100+(year<=shortYearCutoff?0:-100)),doy>-1)for(month=1,day=doy;;){if(dim=this._getDaysInMonth(year,month-1),day<=dim)break;month++,day-=dim}if(date=this._daylightSavingAdjust(new Date(year,month-1,day)),date.getFullYear()!==year||date.getMonth()+1!==month||date.getDate()!==day)throw"Invalid date";return date},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(format,date,settings){if(!date)return"";var iFormat,dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,lookAhead=function(match){var matches=iFormat+1<format.length&&format.charAt(iFormat+1)===match;return matches&&iFormat++,matches},formatNumber=function(match,value,len){var num=""+value;if(lookAhead(match))for(;num.length<len;)num="0"+num;return num},formatName=function(match,value,shortNames,longNames){return lookAhead(match)?longNames[value]:shortNames[value]},output="",literal=!1;if(date)for(iFormat=0;iFormat<format.length;iFormat++)if(literal)"'"!==format.charAt(iFormat)||lookAhead("'")?output+=format.charAt(iFormat):literal=!1;else switch(format.charAt(iFormat)){case"d":output+=formatNumber("d",date.getDate(),2);break;case"D":output+=formatName("D",date.getDay(),dayNamesShort,dayNames);break;case"o":output+=formatNumber("o",Math.round((new Date(date.getFullYear(),date.getMonth(),date.getDate()).getTime()-new Date(date.getFullYear(),0,0).getTime())/864e5),3);break;case"m":output+=formatNumber("m",date.getMonth()+1,2);break;case"M":output+=formatName("M",date.getMonth(),monthNamesShort,monthNames);break;case"y":output+=lookAhead("y")?date.getFullYear():(date.getYear()%100<10?"0":"")+date.getYear()%100;break;case"@":output+=date.getTime();break;case"!":output+=1e4*date.getTime()+this._ticksTo1970;break;case"'":lookAhead("'")?output+="'":literal=!0;break;default:output+=format.charAt(iFormat)}return output},_possibleChars:function(format){var iFormat,chars="",literal=!1,lookAhead=function(match){var matches=iFormat+1<format.length&&format.charAt(iFormat+1)===match;return matches&&iFormat++,matches};for(iFormat=0;iFormat<format.length;iFormat++)if(literal)"'"!==format.charAt(iFormat)||lookAhead("'")?chars+=format.charAt(iFormat):literal=!1;else switch(format.charAt(iFormat)){case"d":case"m":case"y":case"@":chars+="0123456789";break;case"D":case"M":return null;case"'":lookAhead("'")?chars+="'":literal=!0;break;default:chars+=format.charAt(iFormat)}return chars},_get:function(inst,name){return inst.settings[name]!==undefined?inst.settings[name]:this._defaults[name]},_setDateFromField:function(inst,noDefault){if(inst.input.val()!==inst.lastVal){var dateFormat=this._get(inst,"dateFormat"),dates=inst.lastVal=inst.input?inst.input.val():null,defaultDate=this._getDefaultDate(inst),date=defaultDate,settings=this._getFormatConfig(inst);try{date=this.parseDate(dateFormat,dates,settings)||defaultDate}catch(event){dates=noDefault?"":dates}inst.selectedDay=date.getDate(),inst.drawMonth=inst.selectedMonth=date.getMonth(),inst.drawYear=inst.selectedYear=date.getFullYear(),inst.currentDay=dates?date.getDate():0,inst.currentMonth=dates?date.getMonth():0,inst.currentYear=dates?date.getFullYear():0,this._adjustInstDate(inst)}},_getDefaultDate:function(inst){return this._restrictMinMax(inst,this._determineDate(inst,this._get(inst,"defaultDate"),new Date))},_determineDate:function(inst,date,defaultDate){var offsetNumeric=function(offset){var date=new Date;return date.setDate(date.getDate()+offset),date},offsetString=function(offset){try{return $.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),offset,$.datepicker._getFormatConfig(inst))}catch(e){}for(var date=(offset.toLowerCase().match(/^c/)?$.datepicker._getDate(inst):null)||new Date,year=date.getFullYear(),month=date.getMonth(),day=date.getDate(),pattern=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,matches=pattern.exec(offset);matches;){switch(matches[2]||"d"){case"d":case"D":day+=parseInt(matches[1],10);break;case"w":case"W":day+=7*parseInt(matches[1],10);break;case"m":case"M":month+=parseInt(matches[1],10),day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break;case"y":case"Y":year+=parseInt(matches[1],10),day=Math.min(day,$.datepicker._getDaysInMonth(year,month))}matches=pattern.exec(offset)}return new Date(year,month,day)},newDate=null==date||""===date?defaultDate:"string"==typeof date?offsetString(date):"number"==typeof date?isNaN(date)?defaultDate:offsetNumeric(date):new Date(date.getTime());return newDate=newDate&&"Invalid Date"===newDate.toString()?defaultDate:newDate,newDate&&(newDate.setHours(0),newDate.setMinutes(0),newDate.setSeconds(0),newDate.setMilliseconds(0)),this._daylightSavingAdjust(newDate)},_daylightSavingAdjust:function(date){return date?(date.setHours(date.getHours()>12?date.getHours()+2:0),date):null},_setDate:function(inst,date,noChange){var clear=!date,origMonth=inst.selectedMonth,origYear=inst.selectedYear,newDate=this._restrictMinMax(inst,this._determineDate(inst,date,new Date));inst.selectedDay=inst.currentDay=newDate.getDate(),inst.drawMonth=inst.selectedMonth=inst.currentMonth=newDate.getMonth(),inst.drawYear=inst.selectedYear=inst.currentYear=newDate.getFullYear(),origMonth===inst.selectedMonth&&origYear===inst.selectedYear||noChange||this._notifyChange(inst),this._adjustInstDate(inst),inst.input&&inst.input.val(clear?"":this._formatDate(inst))},_getDate:function(inst){return!inst.currentYear||inst.input&&""===inst.input.val()?null:this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay))},_attachHandlers:function(inst){var stepMonths=this._get(inst,"stepMonths"),id="#"+inst.id.replace(/\\\\/g,"\\");inst.dpDiv.find("[data-handler]").map(function(){var handler={prev:function(){$.datepicker._adjustDate(id,-stepMonths,"M")},next:function(){$.datepicker._adjustDate(id,+stepMonths,"M")},hide:function(){$.datepicker._hideDatepicker()},today:function(){$.datepicker._gotoToday(id)},selectDay:function(){return $.datepicker._selectDay(id,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return $.datepicker._selectMonthYear(id,this,"M"),!1},selectYear:function(){return $.datepicker._selectMonthYear(id,this,"Y"),!1}};$(this).bind(this.getAttribute("data-event"),handler[this.getAttribute("data-handler")])})},_generateHTML:function(inst){var maxDraw,prevText,prev,nextText,next,currentText,gotoDate,controls,buttonPanel,firstDay,showWeek,dayNames,dayNamesMin,monthNames,monthNamesShort,beforeShowDay,showOtherMonths,selectOtherMonths,defaultDate,html,dow,row,group,col,selectedDate,cornerClass,calender,thead,day,daysInMonth,leadDays,curRows,numRows,printDate,dRow,tbody,daySettings,otherMonth,unselectable,tempDate=new Date,today=this._daylightSavingAdjust(new Date(tempDate.getFullYear(),tempDate.getMonth(),tempDate.getDate())),isRTL=this._get(inst,"isRTL"),showButtonPanel=this._get(inst,"showButtonPanel"),hideIfNoPrevNext=this._get(inst,"hideIfNoPrevNext"),navigationAsDateFormat=this._get(inst,"navigationAsDateFormat"),numMonths=this._getNumberOfMonths(inst),showCurrentAtPos=this._get(inst,"showCurrentAtPos"),stepMonths=this._get(inst,"stepMonths"),isMultiMonth=1!==numMonths[0]||1!==numMonths[1],currentDate=this._daylightSavingAdjust(inst.currentDay?new Date(inst.currentYear,inst.currentMonth,inst.currentDay):new Date(9999,9,9)),minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),drawMonth=inst.drawMonth-showCurrentAtPos,drawYear=inst.drawYear;if(drawMonth<0&&(drawMonth+=12,drawYear--),maxDate)for(maxDraw=this._daylightSavingAdjust(new Date(maxDate.getFullYear(),maxDate.getMonth()-numMonths[0]*numMonths[1]+1,maxDate.getDate())),maxDraw=minDate&&maxDraw<minDate?minDate:maxDraw;this._daylightSavingAdjust(new Date(drawYear,drawMonth,1))>maxDraw;)--drawMonth<0&&(drawMonth=11,drawYear--);for(inst.drawMonth=drawMonth,inst.drawYear=drawYear,prevText=this._get(inst,"prevText"),prevText=navigationAsDateFormat?this.formatDate(prevText,this._daylightSavingAdjust(new Date(drawYear,drawMonth-stepMonths,1)),this._getFormatConfig(inst)):prevText,prev=this._canAdjustMonth(inst,-1,drawYear,drawMonth)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>":hideIfNoPrevNext?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>",nextText=this._get(inst,"nextText"),nextText=navigationAsDateFormat?this.formatDate(nextText,this._daylightSavingAdjust(new Date(drawYear,drawMonth+stepMonths,1)),this._getFormatConfig(inst)):nextText,next=this._canAdjustMonth(inst,1,drawYear,drawMonth)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>":hideIfNoPrevNext?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>",currentText=this._get(inst,"currentText"),gotoDate=this._get(inst,"gotoCurrent")&&inst.currentDay?currentDate:today,currentText=navigationAsDateFormat?this.formatDate(currentText,gotoDate,this._getFormatConfig(inst)):currentText,controls=inst.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(inst,"closeText")+"</button>",
buttonPanel=showButtonPanel?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(isRTL?controls:"")+(this._isInRange(inst,gotoDate)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+currentText+"</button>":"")+(isRTL?"":controls)+"</div>":"",firstDay=parseInt(this._get(inst,"firstDay"),10),firstDay=isNaN(firstDay)?0:firstDay,showWeek=this._get(inst,"showWeek"),dayNames=this._get(inst,"dayNames"),dayNamesMin=this._get(inst,"dayNamesMin"),monthNames=this._get(inst,"monthNames"),monthNamesShort=this._get(inst,"monthNamesShort"),beforeShowDay=this._get(inst,"beforeShowDay"),showOtherMonths=this._get(inst,"showOtherMonths"),selectOtherMonths=this._get(inst,"selectOtherMonths"),defaultDate=this._getDefaultDate(inst),html="",row=0;row<numMonths[0];row++){for(group="",this.maxRows=4,col=0;col<numMonths[1];col++){if(selectedDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,inst.selectedDay)),cornerClass=" ui-corner-all",calender="",isMultiMonth){if(calender+="<div class='ui-datepicker-group",numMonths[1]>1)switch(col){case 0:calender+=" ui-datepicker-group-first",cornerClass=" ui-corner-"+(isRTL?"right":"left");break;case numMonths[1]-1:calender+=" ui-datepicker-group-last",cornerClass=" ui-corner-"+(isRTL?"left":"right");break;default:calender+=" ui-datepicker-group-middle",cornerClass=""}calender+="'>"}for(calender+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+cornerClass+"'>"+(/all|left/.test(cornerClass)&&0===row?isRTL?next:prev:"")+(/all|right/.test(cornerClass)&&0===row?isRTL?prev:next:"")+this._generateMonthYearHeader(inst,drawMonth,drawYear,minDate,maxDate,row>0||col>0,monthNames,monthNamesShort)+"</div><table class='ui-datepicker-calendar'><thead><tr>",thead=showWeek?"<th class='ui-datepicker-week-col'>"+this._get(inst,"weekHeader")+"</th>":"",dow=0;dow<7;dow++)day=(dow+firstDay)%7,thead+="<th"+((dow+firstDay+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+dayNames[day]+"'>"+dayNamesMin[day]+"</span></th>";for(calender+=thead+"</tr></thead><tbody>",daysInMonth=this._getDaysInMonth(drawYear,drawMonth),drawYear===inst.selectedYear&&drawMonth===inst.selectedMonth&&(inst.selectedDay=Math.min(inst.selectedDay,daysInMonth)),leadDays=(this._getFirstDayOfMonth(drawYear,drawMonth)-firstDay+7)%7,curRows=Math.ceil((leadDays+daysInMonth)/7),numRows=isMultiMonth&&this.maxRows>curRows?this.maxRows:curRows,this.maxRows=numRows,printDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,1-leadDays)),dRow=0;dRow<numRows;dRow++){for(calender+="<tr>",tbody=showWeek?"<td class='ui-datepicker-week-col'>"+this._get(inst,"calculateWeek")(printDate)+"</td>":"",dow=0;dow<7;dow++)daySettings=beforeShowDay?beforeShowDay.apply(inst.input?inst.input[0]:null,[printDate]):[!0,""],otherMonth=printDate.getMonth()!==drawMonth,unselectable=otherMonth&&!selectOtherMonths||!daySettings[0]||minDate&&printDate<minDate||maxDate&&printDate>maxDate,tbody+="<td class='"+((dow+firstDay+6)%7>=5?" ui-datepicker-week-end":"")+(otherMonth?" ui-datepicker-other-month":"")+(printDate.getTime()===selectedDate.getTime()&&drawMonth===inst.selectedMonth&&inst._keyEvent||defaultDate.getTime()===printDate.getTime()&&defaultDate.getTime()===selectedDate.getTime()?" "+this._dayOverClass:"")+(unselectable?" "+this._unselectableClass+" ui-state-disabled":"")+(otherMonth&&!showOtherMonths?"":" "+daySettings[1]+(printDate.getTime()===currentDate.getTime()?" "+this._currentClass:"")+(printDate.getTime()===today.getTime()?" ui-datepicker-today":""))+"'"+(otherMonth&&!showOtherMonths||!daySettings[2]?"":" title='"+daySettings[2].replace(/'/g,"&#39;")+"'")+(unselectable?"":" data-handler='selectDay' data-event='click' data-month='"+printDate.getMonth()+"' data-year='"+printDate.getFullYear()+"'")+">"+(otherMonth&&!showOtherMonths?"&#xa0;":unselectable?"<span class='ui-state-default'>"+printDate.getDate()+"</span>":"<a class='ui-state-default"+(printDate.getTime()===today.getTime()?" ui-state-highlight":"")+(printDate.getTime()===currentDate.getTime()?" ui-state-active":"")+(otherMonth?" ui-priority-secondary":"")+"' href='#'>"+printDate.getDate()+"</a>")+"</td>",printDate.setDate(printDate.getDate()+1),printDate=this._daylightSavingAdjust(printDate);calender+=tbody+"</tr>"}drawMonth++,drawMonth>11&&(drawMonth=0,drawYear++),calender+="</tbody></table>"+(isMultiMonth?"</div>"+(numMonths[0]>0&&col===numMonths[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),group+=calender}html+=group}return html+=buttonPanel,inst._keyEvent=!1,html},_generateMonthYearHeader:function(inst,drawMonth,drawYear,minDate,maxDate,secondary,monthNames,monthNamesShort){var inMinYear,inMaxYear,month,years,thisYear,determineYear,year,endYear,changeMonth=this._get(inst,"changeMonth"),changeYear=this._get(inst,"changeYear"),showMonthAfterYear=this._get(inst,"showMonthAfterYear"),html="<div class='ui-datepicker-title'>",monthHtml="";if(secondary||!changeMonth)monthHtml+="<span class='ui-datepicker-month'>"+monthNames[drawMonth]+"</span>";else{for(inMinYear=minDate&&minDate.getFullYear()===drawYear,inMaxYear=maxDate&&maxDate.getFullYear()===drawYear,monthHtml+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",month=0;month<12;month++)(!inMinYear||month>=minDate.getMonth())&&(!inMaxYear||month<=maxDate.getMonth())&&(monthHtml+="<option value='"+month+"'"+(month===drawMonth?" selected='selected'":"")+">"+monthNamesShort[month]+"</option>");monthHtml+="</select>"}if(showMonthAfterYear||(html+=monthHtml+(!secondary&&changeMonth&&changeYear?"":"&#xa0;")),!inst.yearshtml)if(inst.yearshtml="",secondary||!changeYear)html+="<span class='ui-datepicker-year'>"+drawYear+"</span>";else{for(years=this._get(inst,"yearRange").split(":"),thisYear=(new Date).getFullYear(),determineYear=function(value){var year=value.match(/c[+\-].*/)?drawYear+parseInt(value.substring(1),10):value.match(/[+\-].*/)?thisYear+parseInt(value,10):parseInt(value,10);return isNaN(year)?thisYear:year},year=determineYear(years[0]),endYear=Math.max(year,determineYear(years[1]||"")),year=minDate?Math.max(year,minDate.getFullYear()):year,endYear=maxDate?Math.min(endYear,maxDate.getFullYear()):endYear,inst.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";year<=endYear;year++)inst.yearshtml+="<option value='"+year+"'"+(year===drawYear?" selected='selected'":"")+">"+year+"</option>";inst.yearshtml+="</select>",html+=inst.yearshtml,inst.yearshtml=null}return html+=this._get(inst,"yearSuffix"),showMonthAfterYear&&(html+=(!secondary&&changeMonth&&changeYear?"":"&#xa0;")+monthHtml),html+="</div>"},_adjustInstDate:function(inst,offset,period){var year=inst.drawYear+("Y"===period?offset:0),month=inst.drawMonth+("M"===period?offset:0),day=Math.min(inst.selectedDay,this._getDaysInMonth(year,month))+("D"===period?offset:0),date=this._restrictMinMax(inst,this._daylightSavingAdjust(new Date(year,month,day)));inst.selectedDay=date.getDate(),inst.drawMonth=inst.selectedMonth=date.getMonth(),inst.drawYear=inst.selectedYear=date.getFullYear(),"M"!==period&&"Y"!==period||this._notifyChange(inst)},_restrictMinMax:function(inst,date){var minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),newDate=minDate&&date<minDate?minDate:date;return maxDate&&newDate>maxDate?maxDate:newDate},_notifyChange:function(inst){var onChange=this._get(inst,"onChangeMonthYear");onChange&&onChange.apply(inst.input?inst.input[0]:null,[inst.selectedYear,inst.selectedMonth+1,inst])},_getNumberOfMonths:function(inst){var numMonths=this._get(inst,"numberOfMonths");return null==numMonths?[1,1]:"number"==typeof numMonths?[1,numMonths]:numMonths},_getMinMaxDate:function(inst,minMax){return this._determineDate(inst,this._get(inst,minMax+"Date"),null)},_getDaysInMonth:function(year,month){return 32-this._daylightSavingAdjust(new Date(year,month,32)).getDate()},_getFirstDayOfMonth:function(year,month){return new Date(year,month,1).getDay()},_canAdjustMonth:function(inst,offset,curYear,curMonth){var numMonths=this._getNumberOfMonths(inst),date=this._daylightSavingAdjust(new Date(curYear,curMonth+(offset<0?offset:numMonths[0]*numMonths[1]),1));return offset<0&&date.setDate(this._getDaysInMonth(date.getFullYear(),date.getMonth())),this._isInRange(inst,date)},_isInRange:function(inst,date){var yearSplit,currentYear,minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),minYear=null,maxYear=null,years=this._get(inst,"yearRange");return years&&(yearSplit=years.split(":"),currentYear=(new Date).getFullYear(),minYear=parseInt(yearSplit[0],10),maxYear=parseInt(yearSplit[1],10),yearSplit[0].match(/[+\-].*/)&&(minYear+=currentYear),yearSplit[1].match(/[+\-].*/)&&(maxYear+=currentYear)),(!minDate||date.getTime()>=minDate.getTime())&&(!maxDate||date.getTime()<=maxDate.getTime())&&(!minYear||date.getFullYear()>=minYear)&&(!maxYear||date.getFullYear()<=maxYear)},_getFormatConfig:function(inst){var shortYearCutoff=this._get(inst,"shortYearCutoff");return shortYearCutoff="string"!=typeof shortYearCutoff?shortYearCutoff:(new Date).getFullYear()%100+parseInt(shortYearCutoff,10),{shortYearCutoff:shortYearCutoff,dayNamesShort:this._get(inst,"dayNamesShort"),dayNames:this._get(inst,"dayNames"),monthNamesShort:this._get(inst,"monthNamesShort"),monthNames:this._get(inst,"monthNames")}},_formatDate:function(inst,day,month,year){day||(inst.currentDay=inst.selectedDay,inst.currentMonth=inst.selectedMonth,inst.currentYear=inst.selectedYear);var date=day?"object"==typeof day?day:this._daylightSavingAdjust(new Date(year,month,day)):this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay));return this.formatDate(this._get(inst,"dateFormat"),date,this._getFormatConfig(inst))}}),$.fn.datepicker=function(options){if(!this.length)return this;$.datepicker.initialized||($(document).mousedown($.datepicker._checkExternalClick),$.datepicker.initialized=!0),0===$("#"+$.datepicker._mainDivId).length&&$("body").append($.datepicker.dpDiv);var otherArgs=Array.prototype.slice.call(arguments,1);return"string"!=typeof options||"isDisabled"!==options&&"getDate"!==options&&"widget"!==options?"option"===options&&2===arguments.length&&"string"==typeof arguments[1]?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs)):this.each(function(){"string"==typeof options?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this].concat(otherArgs)):$.datepicker._attachDatepicker(this,options)}):$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))},$.datepicker=new Datepicker,$.datepicker.initialized=!1,$.datepicker.uuid=(new Date).getTime(),$.datepicker.version="1.10.4"}(jQuery),function($,undefined){var sizeRelatedOptions={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};$.widget("ui.dialog",{version:"1.10.4",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(pos){var topOffset=$(this).css(pos).offset().top;topOffset<0&&$(this).css("top",pos.top-topOffset)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&$.fn.draggable&&this._makeDraggable(),this.options.resizable&&$.fn.resizable&&this._makeResizable(),this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var element=this.options.appendTo;return element&&(element.jquery||element.nodeType)?$(element):this.document.find(element||"body").eq(0)},_destroy:function(){var next,originalPosition=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),next=originalPosition.parent.children().eq(originalPosition.index),next.length&&next[0]!==this.element[0]?next.before(this.element):originalPosition.parent.append(this.element)},widget:function(){return this.uiDialog},disable:$.noop,enable:$.noop,close:function(event){var activeElement,that=this;if(this._isOpen&&!1!==this._trigger("beforeClose",event)){if(this._isOpen=!1,this._destroyOverlay(),!this.opener.filter(":focusable").focus().length)try{activeElement=this.document[0].activeElement,activeElement&&"body"!==activeElement.nodeName.toLowerCase()&&$(activeElement).blur()}catch(error){}this._hide(this.uiDialog,this.options.hide,function(){that._trigger("close",event)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(event,silent){var moved=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;return moved&&!silent&&this._trigger("focus",event),moved},open:function(){var that=this;if(this._isOpen)return void(this._moveToTop()&&this._focusTabbable());this._isOpen=!0,this.opener=$(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){that._focusTabbable(),that._trigger("focus")}),this._trigger("open")},_focusTabbable:function(){var hasFocus=this.element.find("[autofocus]");hasFocus.length||(hasFocus=this.element.find(":tabbable")),hasFocus.length||(hasFocus=this.uiDialogButtonPane.find(":tabbable")),hasFocus.length||(hasFocus=this.uiDialogTitlebarClose.filter(":tabbable")),hasFocus.length||(hasFocus=this.uiDialog),hasFocus.eq(0).focus()},_keepFocus:function(event){function checkFocus(){var activeElement=this.document[0].activeElement;this.uiDialog[0]===activeElement||$.contains(this.uiDialog[0],activeElement)||this._focusTabbable()}event.preventDefault(),checkFocus.call(this),this._delay(checkFocus)},_createWrapper:function(){this.uiDialog=$("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(event){if(this.options.closeOnEscape&&!event.isDefaultPrevented()&&event.keyCode&&event.keyCode===$.ui.keyCode.ESCAPE)return event.preventDefault(),void this.close(event);if(event.keyCode===$.ui.keyCode.TAB){var tabbables=this.uiDialog.find(":tabbable"),first=tabbables.filter(":first"),last=tabbables.filter(":last");event.target!==last[0]&&event.target!==this.uiDialog[0]||event.shiftKey?event.target!==first[0]&&event.target!==this.uiDialog[0]||!event.shiftKey||(last.focus(1),event.preventDefault()):(first.focus(1),event.preventDefault())}},mousedown:function(event){this._moveToTop(event)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var uiDialogTitle;this.uiDialogTitlebar=$("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(event){$(event.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=$("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(event){event.preventDefault(),this.close(event)}}),uiDialogTitle=$("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(uiDialogTitle),this.uiDialog.attr({"aria-labelledby":uiDialogTitle.attr("id")})},_title:function(title){this.options.title||title.html("&#160;"),title.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=$("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=$("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var that=this,buttons=this.options.buttons;if(this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),$.isEmptyObject(buttons)||$.isArray(buttons)&&!buttons.length)return void this.uiDialog.removeClass("ui-dialog-buttons");$.each(buttons,function(name,props){var click,buttonOptions;props=$.isFunction(props)?{click:props,text:name}:props,props=$.extend({type:"button"},props),click=props.click,props.click=function(){click.apply(that.element[0],arguments)},buttonOptions={icons:props.icons,text:props.showText},delete props.icons,delete props.showText,$("<button></button>",props).button(buttonOptions).appendTo(that.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog)},_makeDraggable:function(){function filteredUi(ui){return{position:ui.position,offset:ui.offset}}var that=this,options=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(event,ui){$(this).addClass("ui-dialog-dragging"),that._blockFrames(),that._trigger("dragStart",event,filteredUi(ui))},drag:function(event,ui){that._trigger("drag",event,filteredUi(ui))},stop:function(event,ui){options.position=[ui.position.left-that.document.scrollLeft(),ui.position.top-that.document.scrollTop()],$(this).removeClass("ui-dialog-dragging"),that._unblockFrames(),that._trigger("dragStop",event,filteredUi(ui))}})},_makeResizable:function(){function filteredUi(ui){return{originalPosition:ui.originalPosition,originalSize:ui.originalSize,position:ui.position,size:ui.size}}var that=this,options=this.options,handles=options.resizable,position=this.uiDialog.css("position"),resizeHandles="string"==typeof handles?handles:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:options.maxWidth,maxHeight:options.maxHeight,minWidth:options.minWidth,minHeight:this._minHeight(),handles:resizeHandles,start:function(event,ui){$(this).addClass("ui-dialog-resizing"),that._blockFrames(),that._trigger("resizeStart",event,filteredUi(ui))},resize:function(event,ui){that._trigger("resize",event,filteredUi(ui))},stop:function(event,ui){options.height=$(this).height(),options.width=$(this).width(),$(this).removeClass("ui-dialog-resizing"),that._unblockFrames(),that._trigger("resizeStop",event,filteredUi(ui))}}).css("position",position)},_minHeight:function(){var options=this.options;return"auto"===options.height?options.minHeight:Math.min(options.minHeight,options.height)},_position:function(){var isVisible=this.uiDialog.is(":visible");isVisible||this.uiDialog.show(),this.uiDialog.position(this.options.position),isVisible||this.uiDialog.hide()},_setOptions:function(options){var that=this,resize=!1,resizableOptions={};$.each(options,function(key,value){that._setOption(key,value),key in sizeRelatedOptions&&(resize=!0),key in resizableRelatedOptions&&(resizableOptions[key]=value)}),resize&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",resizableOptions)},_setOption:function(key,value){var isDraggable,isResizable,uiDialog=this.uiDialog;"dialogClass"===key&&uiDialog.removeClass(this.options.dialogClass).addClass(value),"disabled"!==key&&(this._super(key,value),"appendTo"===key&&this.uiDialog.appendTo(this._appendTo()),"buttons"===key&&this._createButtons(),"closeText"===key&&this.uiDialogTitlebarClose.button({label:""+value}),"draggable"===key&&(isDraggable=uiDialog.is(":data(ui-draggable)"),isDraggable&&!value&&uiDialog.draggable("destroy"),!isDraggable&&value&&this._makeDraggable()),"position"===key&&this._position(),"resizable"===key&&(isResizable=uiDialog.is(":data(ui-resizable)"),isResizable&&!value&&uiDialog.resizable("destroy"),isResizable&&"string"==typeof value&&uiDialog.resizable("option","handles",value),isResizable||!1===value||this._makeResizable()),"title"===key&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var nonContentHeight,minContentHeight,maxContentHeight,options=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),options.minWidth>options.width&&(options.width=options.minWidth),nonContentHeight=this.uiDialog.css({height:"auto",width:options.width}).outerHeight(),minContentHeight=Math.max(0,options.minHeight-nonContentHeight),maxContentHeight="number"==typeof options.maxHeight?Math.max(0,options.maxHeight-nonContentHeight):"none","auto"===options.height?this.element.css({minHeight:minContentHeight,maxHeight:maxContentHeight,height:"auto"}):this.element.height(Math.max(0,options.height-nonContentHeight)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var iframe=$(this);return $("<div>").css({position:"absolute",width:iframe.outerWidth(),height:iframe.outerHeight()}).appendTo(iframe.parent()).offset(iframe.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(event){return!!$(event.target).closest(".ui-dialog").length||!!$(event.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var that=this,widgetFullName=this.widgetFullName;$.ui.dialog.overlayInstances||this._delay(function(){$.ui.dialog.overlayInstances&&this.document.bind("focusin.dialog",function(event){that._allowInteraction(event)||(event.preventDefault(),$(".ui-dialog:visible:last .ui-dialog-content").data(widgetFullName)._focusTabbable())})}),this.overlay=$("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),$.ui.dialog.overlayInstances++}},_destroyOverlay:function(){this.options.modal&&this.overlay&&($.ui.dialog.overlayInstances--,$.ui.dialog.overlayInstances||this.document.unbind("focusin.dialog"),this.overlay.remove(),this.overlay=null)}}),$.ui.dialog.overlayInstances=0,!1!==$.uiBackCompat&&$.widget("ui.dialog",$.ui.dialog,{_position:function(){var isVisible,position=this.options.position,myAt=[],offset=[0,0];position?(("string"==typeof position||"object"==typeof position&&"0"in position)&&(myAt=position.split?position.split(" "):[position[0],position[1]],1===myAt.length&&(myAt[1]=myAt[0]),$.each(["left","top"],function(i,offsetPosition){+myAt[i]===myAt[i]&&(offset[i]=myAt[i],myAt[i]=offsetPosition)}),position={my:myAt[0]+(offset[0]<0?offset[0]:"+"+offset[0])+" "+myAt[1]+(offset[1]<0?offset[1]:"+"+offset[1]),at:myAt.join(" ")}),position=$.extend({},$.ui.dialog.prototype.options.position,position)):position=$.ui.dialog.prototype.options.position,isVisible=this.uiDialog.is(":visible"),isVisible||this.uiDialog.show(),this.uiDialog.position(position),isVisible||this.uiDialog.hide()}})}(jQuery),function($,undefined){var rvertical=/up|down|vertical/,rpositivemotion=/up|left|vertical|horizontal/;$.effects.effect.blind=function(o,done){var wrapper,distance,margin,el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),direction=o.direction||"up",vertical=rvertical.test(direction),ref=vertical?"height":"width",ref2=vertical?"top":"left",motion=rpositivemotion.test(direction),animation={},show="show"===mode;el.parent().is(".ui-effects-wrapper")?$.effects.save(el.parent(),props):$.effects.save(el,props),el.show(),wrapper=$.effects.createWrapper(el).css({overflow:"hidden"}),distance=wrapper[ref](),margin=parseFloat(wrapper.css(ref2))||0,animation[ref]=show?distance:0,motion||(el.css(vertical?"bottom":"right",0).css(vertical?"top":"left","auto").css({position:"absolute"}),animation[ref2]=show?margin:distance+margin),show&&(wrapper.css(ref,0),motion||wrapper.css(ref2,margin+distance)),wrapper.animate(animation,{duration:o.duration,easing:o.easing,queue:!1,complete:function(){"hide"===mode&&el.hide(),$.effects.restore(el,props),$.effects.removeWrapper(el),done()}})}}(jQuery),function($,undefined){$.effects.effect.bounce=function(o,done){var i,upAnim,downAnim,el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"effect"),hide="hide"===mode,show="show"===mode,direction=o.direction||"up",distance=o.distance,times=o.times||5,anims=2*times+(show||hide?1:0),speed=o.duration/anims,easing=o.easing,ref="up"===direction||"down"===direction?"top":"left",motion="up"===direction||"left"===direction,queue=el.queue(),queuelen=queue.length;for((show||hide)&&props.push("opacity"),$.effects.save(el,props),el.show(),$.effects.createWrapper(el),distance||(distance=el["top"===ref?"outerHeight":"outerWidth"]()/3),show&&(downAnim={opacity:1},downAnim[ref]=0,el.css("opacity",0).css(ref,motion?2*-distance:2*distance).animate(downAnim,speed,easing)),hide&&(distance/=Math.pow(2,times-1)),downAnim={},downAnim[ref]=0,i=0;i<times;i++)upAnim={},upAnim[ref]=(motion?"-=":"+=")+distance,el.animate(upAnim,speed,easing).animate(downAnim,speed,easing),distance=hide?2*distance:distance/2;hide&&(upAnim={opacity:0},upAnim[ref]=(motion?"-=":"+=")+distance,el.animate(upAnim,speed,easing)),el.queue(function(){hide&&el.hide(),$.effects.restore(el,props),$.effects.removeWrapper(el),done()}),queuelen>1&&queue.splice.apply(queue,[1,0].concat(queue.splice(queuelen,anims+1))),el.dequeue()}}(jQuery),function($,undefined){$.effects.effect.clip=function(o,done){var wrapper,animate,distance,el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),show="show"===mode,direction=o.direction||"vertical",vert="vertical"===direction,size=vert?"height":"width",position=vert?"top":"left",animation={};$.effects.save(el,props),el.show(),wrapper=$.effects.createWrapper(el).css({overflow:"hidden"}),animate="IMG"===el[0].tagName?wrapper:el,distance=animate[size](),show&&(animate.css(size,0),animate.css(position,distance/2)),animation[size]=show?distance:0,animation[position]=show?0:distance/2,animate.animate(animation,{queue:!1,duration:o.duration,easing:o.easing,complete:function(){show||el.hide(),$.effects.restore(el,props),$.effects.removeWrapper(el),done()}})}}(jQuery),function($,undefined){$.effects.effect.drop=function(o,done){var distance,el=$(this),props=["position","top","bottom","left","right","opacity","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),show="show"===mode,direction=o.direction||"left",ref="up"===direction||"down"===direction?"top":"left",motion="up"===direction||"left"===direction?"pos":"neg",animation={opacity:show?1:0};$.effects.save(el,props),el.show(),$.effects.createWrapper(el),distance=o.distance||el["top"===ref?"outerHeight":"outerWidth"](!0)/2,show&&el.css("opacity",0).css(ref,"pos"===motion?-distance:distance),animation[ref]=(show?"pos"===motion?"+=":"-=":"pos"===motion?"-=":"+=")+distance,el.animate(animation,{queue:!1,duration:o.duration,easing:o.easing,complete:function(){"hide"===mode&&el.hide(),$.effects.restore(el,props),$.effects.removeWrapper(el),done()}})}}(jQuery),function($,undefined){$.effects.effect.explode=function(o,done){function childComplete(){pieces.push(this),pieces.length===rows*cells&&animComplete()}function animComplete(){el.css({visibility:"visible"}),$(pieces).remove(),show||el.hide(),done()}var i,j,left,top,mx,my,rows=o.pieces?Math.round(Math.sqrt(o.pieces)):3,cells=rows,el=$(this),mode=$.effects.setMode(el,o.mode||"hide"),show="show"===mode,offset=el.show().css("visibility","hidden").offset(),width=Math.ceil(el.outerWidth()/cells),height=Math.ceil(el.outerHeight()/rows),pieces=[];for(i=0;i<rows;i++)for(top=offset.top+i*height,my=i-(rows-1)/2,j=0;j<cells;j++)left=offset.left+j*width,mx=j-(cells-1)/2,el.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-j*width,top:-i*height}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:width,height:height,left:left+(show?mx*width:0),top:top+(show?my*height:0),opacity:show?0:1}).animate({left:left+(show?0:mx*width),top:top+(show?0:my*height),opacity:show?1:0},o.duration||500,o.easing,childComplete)}}(jQuery),function($,undefined){$.effects.effect.fade=function(o,done){var el=$(this),mode=$.effects.setMode(el,o.mode||"toggle");el.animate({opacity:mode},{queue:!1,duration:o.duration,easing:o.easing,complete:done})}}(jQuery),function($,undefined){$.effects.effect.fold=function(o,done){var wrapper,distance,el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),show="show"===mode,hide="hide"===mode,size=o.size||15,percent=/([0-9]+)%/.exec(size),horizFirst=!!o.horizFirst,widthFirst=show!==horizFirst,ref=widthFirst?["width","height"]:["height","width"],duration=o.duration/2,animation1={},animation2={};$.effects.save(el,props),el.show(),wrapper=$.effects.createWrapper(el).css({overflow:"hidden"}),distance=widthFirst?[wrapper.width(),wrapper.height()]:[wrapper.height(),wrapper.width()],percent&&(size=parseInt(percent[1],10)/100*distance[hide?0:1]),show&&wrapper.css(horizFirst?{height:0,width:size}:{height:size,width:0}),animation1[ref[0]]=show?distance[0]:size,animation2[ref[1]]=show?distance[1]:0,wrapper.animate(animation1,duration,o.easing).animate(animation2,duration,o.easing,function(){hide&&el.hide(),$.effects.restore(el,props),$.effects.removeWrapper(el),done()})}}(jQuery),function($,undefined){$.effects.effect.highlight=function(o,done){var elem=$(this),props=["backgroundImage","backgroundColor","opacity"],mode=$.effects.setMode(elem,o.mode||"show"),animation={backgroundColor:elem.css("backgroundColor")};"hide"===mode&&(animation.opacity=0),$.effects.save(elem,props),elem.show().css({backgroundImage:"none",backgroundColor:o.color||"#ffff99"}).animate(animation,{queue:!1,duration:o.duration,easing:o.easing,complete:function(){"hide"===mode&&elem.hide(),$.effects.restore(elem,props),done()}})}}(jQuery),function($,undefined){$.effects.effect.pulsate=function(o,done){var i,elem=$(this),mode=$.effects.setMode(elem,o.mode||"show"),show="show"===mode,hide="hide"===mode,showhide=show||"hide"===mode,anims=2*(o.times||5)+(showhide?1:0),duration=o.duration/anims,animateTo=0,queue=elem.queue(),queuelen=queue.length;for(!show&&elem.is(":visible")||(elem.css("opacity",0).show(),animateTo=1),i=1;i<anims;i++)elem.animate({opacity:animateTo},duration,o.easing),animateTo=1-animateTo;elem.animate({opacity:animateTo},duration,o.easing),elem.queue(function(){hide&&elem.hide(),done()}),queuelen>1&&queue.splice.apply(queue,[1,0].concat(queue.splice(queuelen,anims+1))),elem.dequeue()}}(jQuery),function($,undefined){$.effects.effect.puff=function(o,done){var elem=$(this),mode=$.effects.setMode(elem,o.mode||"hide"),hide="hide"===mode,percent=parseInt(o.percent,10)||150,factor=percent/100,original={height:elem.height(),width:elem.width(),outerHeight:elem.outerHeight(),
outerWidth:elem.outerWidth()};$.extend(o,{effect:"scale",queue:!1,fade:!0,mode:mode,complete:done,percent:hide?percent:100,from:hide?original:{height:original.height*factor,width:original.width*factor,outerHeight:original.outerHeight*factor,outerWidth:original.outerWidth*factor}}),elem.effect(o)},$.effects.effect.scale=function(o,done){var el=$(this),options=$.extend(!0,{},o),mode=$.effects.setMode(el,o.mode||"effect"),percent=parseInt(o.percent,10)||(0===parseInt(o.percent,10)?0:"hide"===mode?0:100),direction=o.direction||"both",origin=o.origin,original={height:el.height(),width:el.width(),outerHeight:el.outerHeight(),outerWidth:el.outerWidth()},factor={y:"horizontal"!==direction?percent/100:1,x:"vertical"!==direction?percent/100:1};options.effect="size",options.queue=!1,options.complete=done,"effect"!==mode&&(options.origin=origin||["middle","center"],options.restore=!0),options.from=o.from||("show"===mode?{height:0,width:0,outerHeight:0,outerWidth:0}:original),options.to={height:original.height*factor.y,width:original.width*factor.x,outerHeight:original.outerHeight*factor.y,outerWidth:original.outerWidth*factor.x},options.fade&&("show"===mode&&(options.from.opacity=0,options.to.opacity=1),"hide"===mode&&(options.from.opacity=1,options.to.opacity=0)),el.effect(options)},$.effects.effect.size=function(o,done){var original,baseline,factor,el=$(this),props0=["position","top","bottom","left","right","width","height","overflow","opacity"],props1=["position","top","bottom","left","right","overflow","opacity"],props2=["width","height","overflow"],cProps=["fontSize"],vProps=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],hProps=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],mode=$.effects.setMode(el,o.mode||"effect"),restore=o.restore||"effect"!==mode,scale=o.scale||"both",origin=o.origin||["middle","center"],position=el.css("position"),props=restore?props0:props1,zero={height:0,width:0,outerHeight:0,outerWidth:0};"show"===mode&&el.show(),original={height:el.height(),width:el.width(),outerHeight:el.outerHeight(),outerWidth:el.outerWidth()},"toggle"===o.mode&&"show"===mode?(el.from=o.to||zero,el.to=o.from||original):(el.from=o.from||("show"===mode?zero:original),el.to=o.to||("hide"===mode?zero:original)),factor={from:{y:el.from.height/original.height,x:el.from.width/original.width},to:{y:el.to.height/original.height,x:el.to.width/original.width}},"box"!==scale&&"both"!==scale||(factor.from.y!==factor.to.y&&(props=props.concat(vProps),el.from=$.effects.setTransition(el,vProps,factor.from.y,el.from),el.to=$.effects.setTransition(el,vProps,factor.to.y,el.to)),factor.from.x!==factor.to.x&&(props=props.concat(hProps),el.from=$.effects.setTransition(el,hProps,factor.from.x,el.from),el.to=$.effects.setTransition(el,hProps,factor.to.x,el.to))),"content"!==scale&&"both"!==scale||factor.from.y!==factor.to.y&&(props=props.concat(cProps).concat(props2),el.from=$.effects.setTransition(el,cProps,factor.from.y,el.from),el.to=$.effects.setTransition(el,cProps,factor.to.y,el.to)),$.effects.save(el,props),el.show(),$.effects.createWrapper(el),el.css("overflow","hidden").css(el.from),origin&&(baseline=$.effects.getBaseline(origin,original),el.from.top=(original.outerHeight-el.outerHeight())*baseline.y,el.from.left=(original.outerWidth-el.outerWidth())*baseline.x,el.to.top=(original.outerHeight-el.to.outerHeight)*baseline.y,el.to.left=(original.outerWidth-el.to.outerWidth)*baseline.x),el.css(el.from),"content"!==scale&&"both"!==scale||(vProps=vProps.concat(["marginTop","marginBottom"]).concat(cProps),hProps=hProps.concat(["marginLeft","marginRight"]),props2=props0.concat(vProps).concat(hProps),el.find("*[width]").each(function(){var child=$(this),c_original={height:child.height(),width:child.width(),outerHeight:child.outerHeight(),outerWidth:child.outerWidth()};restore&&$.effects.save(child,props2),child.from={height:c_original.height*factor.from.y,width:c_original.width*factor.from.x,outerHeight:c_original.outerHeight*factor.from.y,outerWidth:c_original.outerWidth*factor.from.x},child.to={height:c_original.height*factor.to.y,width:c_original.width*factor.to.x,outerHeight:c_original.height*factor.to.y,outerWidth:c_original.width*factor.to.x},factor.from.y!==factor.to.y&&(child.from=$.effects.setTransition(child,vProps,factor.from.y,child.from),child.to=$.effects.setTransition(child,vProps,factor.to.y,child.to)),factor.from.x!==factor.to.x&&(child.from=$.effects.setTransition(child,hProps,factor.from.x,child.from),child.to=$.effects.setTransition(child,hProps,factor.to.x,child.to)),child.css(child.from),child.animate(child.to,o.duration,o.easing,function(){restore&&$.effects.restore(child,props2)})})),el.animate(el.to,{queue:!1,duration:o.duration,easing:o.easing,complete:function(){0===el.to.opacity&&el.css("opacity",el.from.opacity),"hide"===mode&&el.hide(),$.effects.restore(el,props),restore||("static"===position?el.css({position:"relative",top:el.to.top,left:el.to.left}):$.each(["top","left"],function(idx,pos){el.css(pos,function(_,str){var val=parseInt(str,10),toRef=idx?el.to.left:el.to.top;return"auto"===str?toRef+"px":val+toRef+"px"})})),$.effects.removeWrapper(el),done()}})}}(jQuery),function($,undefined){$.effects.effect.shake=function(o,done){var i,el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"effect"),direction=o.direction||"left",distance=o.distance||20,times=o.times||3,anims=2*times+1,speed=Math.round(o.duration/anims),ref="up"===direction||"down"===direction?"top":"left",positiveMotion="up"===direction||"left"===direction,animation={},animation1={},animation2={},queue=el.queue(),queuelen=queue.length;for($.effects.save(el,props),el.show(),$.effects.createWrapper(el),animation[ref]=(positiveMotion?"-=":"+=")+distance,animation1[ref]=(positiveMotion?"+=":"-=")+2*distance,animation2[ref]=(positiveMotion?"-=":"+=")+2*distance,el.animate(animation,speed,o.easing),i=1;i<times;i++)el.animate(animation1,speed,o.easing).animate(animation2,speed,o.easing);el.animate(animation1,speed,o.easing).animate(animation,speed/2,o.easing).queue(function(){"hide"===mode&&el.hide(),$.effects.restore(el,props),$.effects.removeWrapper(el),done()}),queuelen>1&&queue.splice.apply(queue,[1,0].concat(queue.splice(queuelen,anims+1))),el.dequeue()}}(jQuery),function($,undefined){$.effects.effect.slide=function(o,done){var distance,el=$(this),props=["position","top","bottom","left","right","width","height"],mode=$.effects.setMode(el,o.mode||"show"),show="show"===mode,direction=o.direction||"left",ref="up"===direction||"down"===direction?"top":"left",positiveMotion="up"===direction||"left"===direction,animation={};$.effects.save(el,props),el.show(),distance=o.distance||el["top"===ref?"outerHeight":"outerWidth"](!0),$.effects.createWrapper(el).css({overflow:"hidden"}),show&&el.css(ref,positiveMotion?isNaN(distance)?"-"+distance:-distance:distance),animation[ref]=(show?positiveMotion?"+=":"-=":positiveMotion?"-=":"+=")+distance,el.animate(animation,{queue:!1,duration:o.duration,easing:o.easing,complete:function(){"hide"===mode&&el.hide(),$.effects.restore(el,props),$.effects.removeWrapper(el),done()}})}}(jQuery),function($,undefined){$.effects.effect.transfer=function(o,done){var elem=$(this),target=$(o.to),targetFixed="fixed"===target.css("position"),body=$("body"),fixTop=targetFixed?body.scrollTop():0,fixLeft=targetFixed?body.scrollLeft():0,endPosition=target.offset(),animation={top:endPosition.top-fixTop,left:endPosition.left-fixLeft,height:target.innerHeight(),width:target.innerWidth()},startPosition=elem.offset(),transfer=$("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(o.className).css({top:startPosition.top-fixTop,left:startPosition.left-fixLeft,height:elem.innerHeight(),width:elem.innerWidth(),position:targetFixed?"fixed":"absolute"}).animate(animation,o.duration,o.easing,function(){transfer.remove(),done()})}}(jQuery),function($,undefined){$.widget("ui.menu",{version:"1.10.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,$.proxy(function(event){this.options.disabled&&event.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(event){event.preventDefault()},"click .ui-state-disabled > a":function(event){event.preventDefault()},"click .ui-menu-item:has(a)":function(event){var target=$(event.target).closest(".ui-menu-item");!this.mouseHandled&&target.not(".ui-state-disabled").length&&(this.select(event),event.isPropagationStopped()||(this.mouseHandled=!0),target.has(".ui-menu").length?this.expand(event):!this.element.is(":focus")&&$(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(event){var target=$(event.currentTarget);target.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(event,target)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(event,keepActiveItem){var item=this.active||this.element.children(".ui-menu-item").eq(0);keepActiveItem||this.focus(event,item)},blur:function(event){this._delay(function(){$.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(event)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(event){$(event.target).closest(".ui-menu").length||this.collapseAll(event),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var elem=$(this);elem.data("ui-menu-submenu-carat")&&elem.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(event){function escape(value){return value.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var match,prev,character,skip,regex,preventDefault=!0;switch(event.keyCode){case $.ui.keyCode.PAGE_UP:this.previousPage(event);break;case $.ui.keyCode.PAGE_DOWN:this.nextPage(event);break;case $.ui.keyCode.HOME:this._move("first","first",event);break;case $.ui.keyCode.END:this._move("last","last",event);break;case $.ui.keyCode.UP:this.previous(event);break;case $.ui.keyCode.DOWN:this.next(event);break;case $.ui.keyCode.LEFT:this.collapse(event);break;case $.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(event);break;case $.ui.keyCode.ENTER:case $.ui.keyCode.SPACE:this._activate(event);break;case $.ui.keyCode.ESCAPE:this.collapse(event);break;default:preventDefault=!1,prev=this.previousFilter||"",character=String.fromCharCode(event.keyCode),skip=!1,clearTimeout(this.filterTimer),character===prev?skip=!0:character=prev+character,regex=new RegExp("^"+escape(character),"i"),match=this.activeMenu.children(".ui-menu-item").filter(function(){return regex.test($(this).children("a").text())}),match=skip&&-1!==match.index(this.active.next())?this.active.nextAll(".ui-menu-item"):match,match.length||(character=String.fromCharCode(event.keyCode),regex=new RegExp("^"+escape(character),"i"),match=this.activeMenu.children(".ui-menu-item").filter(function(){return regex.test($(this).children("a").text())})),match.length?(this.focus(event,match),match.length>1?(this.previousFilter=character,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}preventDefault&&event.preventDefault()},_activate:function(event){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(event):this.select(event))},refresh:function(){var menus,icon=this.options.icons.submenu,submenus=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),submenus.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var menu=$(this),item=menu.prev("a"),submenuCarat=$("<span>").addClass("ui-menu-icon ui-icon "+icon).data("ui-menu-submenu-carat",!0);item.attr("aria-haspopup","true").prepend(submenuCarat),menu.attr("aria-labelledby",item.attr("id"))}),menus=submenus.add(this.element),menus.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),menus.children(":not(.ui-menu-item)").each(function(){var item=$(this);/[^\-\u2014\u2013\s]/.test(item.text())||item.addClass("ui-widget-content ui-menu-divider")}),menus.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!$.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(key,value){"icons"===key&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(value.submenu),this._super(key,value)},focus:function(event,item){var nested,focused;this.blur(event,event&&"focus"===event.type),this._scrollIntoView(item),this.active=item.first(),focused=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",focused.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),event&&"keydown"===event.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),nested=item.children(".ui-menu"),nested.length&&event&&/^mouse/.test(event.type)&&this._startOpening(nested),this.activeMenu=item.parent(),this._trigger("focus",event,{item:item})},_scrollIntoView:function(item){var borderTop,paddingTop,offset,scroll,elementHeight,itemHeight;this._hasScroll()&&(borderTop=parseFloat($.css(this.activeMenu[0],"borderTopWidth"))||0,paddingTop=parseFloat($.css(this.activeMenu[0],"paddingTop"))||0,offset=item.offset().top-this.activeMenu.offset().top-borderTop-paddingTop,scroll=this.activeMenu.scrollTop(),elementHeight=this.activeMenu.height(),itemHeight=item.height(),offset<0?this.activeMenu.scrollTop(scroll+offset):offset+itemHeight>elementHeight&&this.activeMenu.scrollTop(scroll+offset-elementHeight+itemHeight))},blur:function(event,fromFocus){fromFocus||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",event,{item:this.active}))},_startOpening:function(submenu){clearTimeout(this.timer),"true"===submenu.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(submenu)},this.delay))},_open:function(submenu){var position=$.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(submenu.parents(".ui-menu")).hide().attr("aria-hidden","true"),submenu.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(position)},collapseAll:function(event,all){clearTimeout(this.timer),this.timer=this._delay(function(){var currentMenu=all?this.element:$(event&&event.target).closest(this.element.find(".ui-menu"));currentMenu.length||(currentMenu=this.element),this._close(currentMenu),this.blur(event),this.activeMenu=currentMenu},this.delay)},_close:function(startMenu){startMenu||(startMenu=this.active?this.active.parent():this.element),startMenu.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(event){var newItem=this.active&&this.active.parent().closest(".ui-menu-item",this.element);newItem&&newItem.length&&(this._close(),this.focus(event,newItem))},expand:function(event){var newItem=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();newItem&&newItem.length&&(this._open(newItem.parent()),this._delay(function(){this.focus(event,newItem)}))},next:function(event){this._move("next","first",event)},previous:function(event){this._move("prev","last",event)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(direction,filter,event){var next;this.active&&(next="first"===direction||"last"===direction?this.active["first"===direction?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[direction+"All"](".ui-menu-item").eq(0)),next&&next.length&&this.active||(next=this.activeMenu.children(".ui-menu-item")[filter]()),this.focus(event,next)},nextPage:function(event){var item,base,height;if(!this.active)return void this.next(event);this.isLastItem()||(this._hasScroll()?(base=this.active.offset().top,height=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return item=$(this),item.offset().top-base-height<0}),this.focus(event,item)):this.focus(event,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]()))},previousPage:function(event){var item,base,height;if(!this.active)return void this.next(event);this.isFirstItem()||(this._hasScroll()?(base=this.active.offset().top,height=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return item=$(this),item.offset().top-base+height>0}),this.focus(event,item)):this.focus(event,this.activeMenu.children(".ui-menu-item").first()))},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(event){this.active=this.active||$(event.target).closest(".ui-menu-item");var ui={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(event,!0),this._trigger("select",event,ui)}})}(jQuery),function($,undefined){function getOffsets(offsets,width,height){return[parseFloat(offsets[0])*(rpercent.test(offsets[0])?width/100:1),parseFloat(offsets[1])*(rpercent.test(offsets[1])?height/100:1)]}function parseCss(element,property){return parseInt($.css(element,property),10)||0}function getDimensions(elem){var raw=elem[0];return 9===raw.nodeType?{width:elem.width(),height:elem.height(),offset:{top:0,left:0}}:$.isWindow(raw)?{width:elem.width(),height:elem.height(),offset:{top:elem.scrollTop(),left:elem.scrollLeft()}}:raw.preventDefault?{width:0,height:0,offset:{top:raw.pageY,left:raw.pageX}}:{width:elem.outerWidth(),height:elem.outerHeight(),offset:elem.offset()}}$.ui=$.ui||{};var cachedScrollbarWidth,max=Math.max,abs=Math.abs,round=Math.round,rhorizontal=/left|center|right/,rvertical=/top|center|bottom/,roffset=/[\+\-]\d+(\.[\d]+)?%?/,rposition=/^\w+/,rpercent=/%$/,_position=$.fn.position;$.position={scrollbarWidth:function(){if(cachedScrollbarWidth!==undefined)return cachedScrollbarWidth;var w1,w2,div=$("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),innerDiv=div.children()[0];return $("body").append(div),w1=innerDiv.offsetWidth,div.css("overflow","scroll"),w2=innerDiv.offsetWidth,w1===w2&&(w2=div[0].clientWidth),div.remove(),cachedScrollbarWidth=w1-w2},getScrollInfo:function(within){var overflowX=within.isWindow||within.isDocument?"":within.element.css("overflow-x"),overflowY=within.isWindow||within.isDocument?"":within.element.css("overflow-y"),hasOverflowX="scroll"===overflowX||"auto"===overflowX&&within.width<within.element[0].scrollWidth;return{width:"scroll"===overflowY||"auto"===overflowY&&within.height<within.element[0].scrollHeight?$.position.scrollbarWidth():0,height:hasOverflowX?$.position.scrollbarWidth():0}},getWithinInfo:function(element){var withinElement=$(element||window),isWindow=$.isWindow(withinElement[0]);return{element:withinElement,isWindow:isWindow,isDocument:!!withinElement[0]&&9===withinElement[0].nodeType,offset:withinElement.offset()||{left:0,top:0},scrollLeft:withinElement.scrollLeft(),scrollTop:withinElement.scrollTop(),width:isWindow?withinElement.width():withinElement.outerWidth(),height:isWindow?withinElement.height():withinElement.outerHeight()}}},$.fn.position=function(options){if(!options||!options.of)return _position.apply(this,arguments);options=$.extend({},options);var atOffset,targetWidth,targetHeight,targetOffset,basePosition,dimensions,target=$(options.of),within=$.position.getWithinInfo(options.within),scrollInfo=$.position.getScrollInfo(within),collision=(options.collision||"flip").split(" "),offsets={};return dimensions=getDimensions(target),target[0].preventDefault&&(options.at="left top"),targetWidth=dimensions.width,targetHeight=dimensions.height,targetOffset=dimensions.offset,basePosition=$.extend({},targetOffset),$.each(["my","at"],function(){var horizontalOffset,verticalOffset,pos=(options[this]||"").split(" ");1===pos.length&&(pos=rhorizontal.test(pos[0])?pos.concat(["center"]):rvertical.test(pos[0])?["center"].concat(pos):["center","center"]),pos[0]=rhorizontal.test(pos[0])?pos[0]:"center",pos[1]=rvertical.test(pos[1])?pos[1]:"center",horizontalOffset=roffset.exec(pos[0]),verticalOffset=roffset.exec(pos[1]),offsets[this]=[horizontalOffset?horizontalOffset[0]:0,verticalOffset?verticalOffset[0]:0],options[this]=[rposition.exec(pos[0])[0],rposition.exec(pos[1])[0]]}),1===collision.length&&(collision[1]=collision[0]),"right"===options.at[0]?basePosition.left+=targetWidth:"center"===options.at[0]&&(basePosition.left+=targetWidth/2),"bottom"===options.at[1]?basePosition.top+=targetHeight:"center"===options.at[1]&&(basePosition.top+=targetHeight/2),atOffset=getOffsets(offsets.at,targetWidth,targetHeight),basePosition.left+=atOffset[0],basePosition.top+=atOffset[1],this.each(function(){var collisionPosition,using,elem=$(this),elemWidth=elem.outerWidth(),elemHeight=elem.outerHeight(),marginLeft=parseCss(this,"marginLeft"),marginTop=parseCss(this,"marginTop"),collisionWidth=elemWidth+marginLeft+parseCss(this,"marginRight")+scrollInfo.width,collisionHeight=elemHeight+marginTop+parseCss(this,"marginBottom")+scrollInfo.height,position=$.extend({},basePosition),myOffset=getOffsets(offsets.my,elem.outerWidth(),elem.outerHeight());"right"===options.my[0]?position.left-=elemWidth:"center"===options.my[0]&&(position.left-=elemWidth/2),"bottom"===options.my[1]?position.top-=elemHeight:"center"===options.my[1]&&(position.top-=elemHeight/2),position.left+=myOffset[0],position.top+=myOffset[1],$.support.offsetFractions||(position.left=round(position.left),position.top=round(position.top)),collisionPosition={marginLeft:marginLeft,marginTop:marginTop},$.each(["left","top"],function(i,dir){$.ui.position[collision[i]]&&$.ui.position[collision[i]][dir](position,{targetWidth:targetWidth,targetHeight:targetHeight,elemWidth:elemWidth,elemHeight:elemHeight,collisionPosition:collisionPosition,collisionWidth:collisionWidth,collisionHeight:collisionHeight,offset:[atOffset[0]+myOffset[0],atOffset[1]+myOffset[1]],my:options.my,at:options.at,within:within,elem:elem})}),options.using&&(using=function(props){var left=targetOffset.left-position.left,right=left+targetWidth-elemWidth,top=targetOffset.top-position.top,bottom=top+targetHeight-elemHeight,feedback={target:{element:target,left:targetOffset.left,top:targetOffset.top,width:targetWidth,height:targetHeight},element:{element:elem,left:position.left,top:position.top,width:elemWidth,height:elemHeight},horizontal:right<0?"left":left>0?"right":"center",vertical:bottom<0?"top":top>0?"bottom":"middle"};targetWidth<elemWidth&&abs(left+right)<targetWidth&&(feedback.horizontal="center"),targetHeight<elemHeight&&abs(top+bottom)<targetHeight&&(feedback.vertical="middle"),max(abs(left),abs(right))>max(abs(top),abs(bottom))?feedback.important="horizontal":feedback.important="vertical",options.using.call(this,props,feedback)}),elem.offset($.extend(position,{using:using}))})},$.ui.position={fit:{left:function(position,data){var newOverRight,within=data.within,withinOffset=within.isWindow?within.scrollLeft:within.offset.left,outerWidth=within.width,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=withinOffset-collisionPosLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-withinOffset;data.collisionWidth>outerWidth?overLeft>0&&overRight<=0?(newOverRight=position.left+overLeft+data.collisionWidth-outerWidth-withinOffset,position.left+=overLeft-newOverRight):position.left=overRight>0&&overLeft<=0?withinOffset:overLeft>overRight?withinOffset+outerWidth-data.collisionWidth:withinOffset:overLeft>0?position.left+=overLeft:overRight>0?position.left-=overRight:position.left=max(position.left-collisionPosLeft,position.left)},top:function(position,data){var newOverBottom,within=data.within,withinOffset=within.isWindow?within.scrollTop:within.offset.top,outerHeight=data.within.height,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=withinOffset-collisionPosTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-withinOffset;data.collisionHeight>outerHeight?overTop>0&&overBottom<=0?(newOverBottom=position.top+overTop+data.collisionHeight-outerHeight-withinOffset,position.top+=overTop-newOverBottom):position.top=overBottom>0&&overTop<=0?withinOffset:overTop>overBottom?withinOffset+outerHeight-data.collisionHeight:withinOffset:overTop>0?position.top+=overTop:overBottom>0?position.top-=overBottom:position.top=max(position.top-collisionPosTop,position.top)}},flip:{left:function(position,data){var newOverRight,newOverLeft,within=data.within,withinOffset=within.offset.left+within.scrollLeft,outerWidth=within.width,offsetLeft=within.isWindow?within.scrollLeft:within.offset.left,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=collisionPosLeft-offsetLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-offsetLeft,myOffset="left"===data.my[0]?-data.elemWidth:"right"===data.my[0]?data.elemWidth:0,atOffset="left"===data.at[0]?data.targetWidth:"right"===data.at[0]?-data.targetWidth:0,offset=-2*data.offset[0];overLeft<0?((newOverRight=position.left+myOffset+atOffset+offset+data.collisionWidth-outerWidth-withinOffset)<0||newOverRight<abs(overLeft))&&(position.left+=myOffset+atOffset+offset):overRight>0&&((newOverLeft=position.left-data.collisionPosition.marginLeft+myOffset+atOffset+offset-offsetLeft)>0||abs(newOverLeft)<overRight)&&(position.left+=myOffset+atOffset+offset)},top:function(position,data){var newOverTop,newOverBottom,within=data.within,withinOffset=within.offset.top+within.scrollTop,outerHeight=within.height,offsetTop=within.isWindow?within.scrollTop:within.offset.top,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=collisionPosTop-offsetTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-offsetTop,top="top"===data.my[1],myOffset=top?-data.elemHeight:"bottom"===data.my[1]?data.elemHeight:0,atOffset="top"===data.at[1]?data.targetHeight:"bottom"===data.at[1]?-data.targetHeight:0,offset=-2*data.offset[1];overTop<0?(newOverBottom=position.top+myOffset+atOffset+offset+data.collisionHeight-outerHeight-withinOffset,position.top+myOffset+atOffset+offset>overTop&&(newOverBottom<0||newOverBottom<abs(overTop))&&(position.top+=myOffset+atOffset+offset)):overBottom>0&&(newOverTop=position.top-data.collisionPosition.marginTop+myOffset+atOffset+offset-offsetTop,position.top+myOffset+atOffset+offset>overBottom&&(newOverTop>0||abs(newOverTop)<overBottom)&&(position.top+=myOffset+atOffset+offset))}},flipfit:{left:function(){$.ui.position.flip.left.apply(this,arguments),$.ui.position.fit.left.apply(this,arguments)},top:function(){$.ui.position.flip.top.apply(this,arguments),$.ui.position.fit.top.apply(this,arguments)}}},function(){var testElement,testElementParent,testElementStyle,offsetLeft,i,body=document.getElementsByTagName("body")[0],div=document.createElement("div");testElement=document.createElement(body?"div":"body"),testElementStyle={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},body&&$.extend(testElementStyle,{position:"absolute",left:"-1000px",top:"-1000px"});for(i in testElementStyle)testElement.style[i]=testElementStyle[i];testElement.appendChild(div),testElementParent=body||document.documentElement,testElementParent.insertBefore(testElement,testElementParent.firstChild),div.style.cssText="position: absolute; left: 10.7432222px;",offsetLeft=$(div).offset().left,$.support.offsetFractions=offsetLeft>10&&offsetLeft<11,testElement.innerHTML="",testElementParent.removeChild(testElement)}()}(jQuery),function($,undefined){$.widget("ui.progressbar",{version:"1.10.4",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=$("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(newValue){if(newValue===undefined)return this.options.value;this.options.value=this._constrainedValue(newValue),this._refreshValue()},_constrainedValue:function(newValue){return newValue===undefined&&(newValue=this.options.value),this.indeterminate=!1===newValue,"number"!=typeof newValue&&(newValue=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,newValue))},_setOptions:function(options){var value=options.value;delete options.value,this._super(options),this.options.value=this._constrainedValue(value),this._refreshValue()},_setOption:function(key,value){"max"===key&&(value=Math.max(this.min,value)),this._super(key,value)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var value=this.options.value,percentage=this._percentage();this.valueDiv.toggle(this.indeterminate||value>this.min).toggleClass("ui-corner-right",value===this.options.max).width(percentage.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=$("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":value}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==value&&(this.oldValue=value,this._trigger("change")),value===this.options.max&&this._trigger("complete")}})}(jQuery),function($,undefined){var numPages=5;$.widget("ui.slider",$.ui.mouse,{version:"1.10.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,
this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var i,handleCount,options=this.options,existingHandles=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),handles=[];for(handleCount=options.values&&options.values.length||1,existingHandles.length>handleCount&&(existingHandles.slice(handleCount).remove(),existingHandles=existingHandles.slice(0,handleCount)),i=existingHandles.length;i<handleCount;i++)handles.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");this.handles=existingHandles.add($(handles.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(i){$(this).data("ui-slider-handle-index",i)})},_createRange:function(){var options=this.options,classes="";options.range?(!0===options.range&&(options.values?options.values.length&&2!==options.values.length?options.values=[options.values[0],options.values[0]]:$.isArray(options.values)&&(options.values=options.values.slice(0)):options.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=$("<div></div>").appendTo(this.element),classes="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(classes+("min"===options.range||"max"===options.range?" ui-slider-range-"+options.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){var elements=this.handles.add(this.range).filter("a");this._off(elements),this._on(elements,this._handleEvents),this._hoverable(elements),this._focusable(elements)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(event){var position,normValue,distance,closestHandle,index,offset,mouseOverHandle,that=this,o=this.options;return!o.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),position={x:event.pageX,y:event.pageY},normValue=this._normValueFromMouse(position),distance=this._valueMax()-this._valueMin()+1,this.handles.each(function(i){var thisDistance=Math.abs(normValue-that.values(i));(distance>thisDistance||distance===thisDistance&&(i===that._lastChangedValue||that.values(i)===o.min))&&(distance=thisDistance,closestHandle=$(this),index=i)}),!1!==this._start(event,index)&&(this._mouseSliding=!0,this._handleIndex=index,closestHandle.addClass("ui-state-active").focus(),offset=closestHandle.offset(),mouseOverHandle=!$(event.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=mouseOverHandle?{left:0,top:0}:{left:event.pageX-offset.left-closestHandle.width()/2,top:event.pageY-offset.top-closestHandle.height()/2-(parseInt(closestHandle.css("borderTopWidth"),10)||0)-(parseInt(closestHandle.css("borderBottomWidth"),10)||0)+(parseInt(closestHandle.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(event,index,normValue),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(event){var position={x:event.pageX,y:event.pageY},normValue=this._normValueFromMouse(position);return this._slide(event,this._handleIndex,normValue),!1},_mouseStop:function(event){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(event,this._handleIndex),this._change(event,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(position){var pixelTotal,pixelMouse,percentMouse,valueTotal,valueMouse;return"horizontal"===this.orientation?(pixelTotal=this.elementSize.width,pixelMouse=position.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(pixelTotal=this.elementSize.height,pixelMouse=position.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),percentMouse=pixelMouse/pixelTotal,percentMouse>1&&(percentMouse=1),percentMouse<0&&(percentMouse=0),"vertical"===this.orientation&&(percentMouse=1-percentMouse),valueTotal=this._valueMax()-this._valueMin(),valueMouse=this._valueMin()+percentMouse*valueTotal,this._trimAlignValue(valueMouse)},_start:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};return this.options.values&&this.options.values.length&&(uiHash.value=this.values(index),uiHash.values=this.values()),this._trigger("start",event,uiHash)},_slide:function(event,index,newVal){var otherVal,newValues,allowed;this.options.values&&this.options.values.length?(otherVal=this.values(index?0:1),2===this.options.values.length&&!0===this.options.range&&(0===index&&newVal>otherVal||1===index&&newVal<otherVal)&&(newVal=otherVal),newVal!==this.values(index)&&(newValues=this.values(),newValues[index]=newVal,allowed=this._trigger("slide",event,{handle:this.handles[index],value:newVal,values:newValues}),otherVal=this.values(index?0:1),!1!==allowed&&this.values(index,newVal))):newVal!==this.value()&&!1!==(allowed=this._trigger("slide",event,{handle:this.handles[index],value:newVal}))&&this.value(newVal)},_stop:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};this.options.values&&this.options.values.length&&(uiHash.value=this.values(index),uiHash.values=this.values()),this._trigger("stop",event,uiHash)},_change:function(event,index){if(!this._keySliding&&!this._mouseSliding){var uiHash={handle:this.handles[index],value:this.value()};this.options.values&&this.options.values.length&&(uiHash.value=this.values(index),uiHash.values=this.values()),this._lastChangedValue=index,this._trigger("change",event,uiHash)}},value:function(newValue){return arguments.length?(this.options.value=this._trimAlignValue(newValue),this._refreshValue(),void this._change(null,0)):this._value()},values:function(index,newValue){var vals,newValues,i;if(arguments.length>1)return this.options.values[index]=this._trimAlignValue(newValue),this._refreshValue(),void this._change(null,index);if(!arguments.length)return this._values();if(!$.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(index):this.value();for(vals=this.options.values,newValues=arguments[0],i=0;i<vals.length;i+=1)vals[i]=this._trimAlignValue(newValues[i]),this._change(null,i);this._refreshValue()},_setOption:function(key,value){var i,valsLength=0;switch("range"===key&&!0===this.options.range&&("min"===value?(this.options.value=this._values(0),this.options.values=null):"max"===value&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),$.isArray(this.options.values)&&(valsLength=this.options.values.length),$.Widget.prototype._setOption.apply(this,arguments),key){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),i=0;i<valsLength;i+=1)this._change(null,i);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var val=this.options.value;return val=this._trimAlignValue(val)},_values:function(index){var val,vals,i;if(arguments.length)return val=this.options.values[index],val=this._trimAlignValue(val);if(this.options.values&&this.options.values.length){for(vals=this.options.values.slice(),i=0;i<vals.length;i+=1)vals[i]=this._trimAlignValue(vals[i]);return vals}return[]},_trimAlignValue:function(val){if(val<=this._valueMin())return this._valueMin();if(val>=this._valueMax())return this._valueMax();var step=this.options.step>0?this.options.step:1,valModStep=(val-this._valueMin())%step,alignValue=val-valModStep;return 2*Math.abs(valModStep)>=step&&(alignValue+=valModStep>0?step:-step),parseFloat(alignValue.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var lastValPercent,valPercent,value,valueMin,valueMax,oRange=this.options.range,o=this.options,that=this,animate=!this._animateOff&&o.animate,_set={};this.options.values&&this.options.values.length?this.handles.each(function(i){valPercent=(that.values(i)-that._valueMin())/(that._valueMax()-that._valueMin())*100,_set["horizontal"===that.orientation?"left":"bottom"]=valPercent+"%",$(this).stop(1,1)[animate?"animate":"css"](_set,o.animate),!0===that.options.range&&("horizontal"===that.orientation?(0===i&&that.range.stop(1,1)[animate?"animate":"css"]({left:valPercent+"%"},o.animate),1===i&&that.range[animate?"animate":"css"]({width:valPercent-lastValPercent+"%"},{queue:!1,duration:o.animate})):(0===i&&that.range.stop(1,1)[animate?"animate":"css"]({bottom:valPercent+"%"},o.animate),1===i&&that.range[animate?"animate":"css"]({height:valPercent-lastValPercent+"%"},{queue:!1,duration:o.animate}))),lastValPercent=valPercent}):(value=this.value(),valueMin=this._valueMin(),valueMax=this._valueMax(),valPercent=valueMax!==valueMin?(value-valueMin)/(valueMax-valueMin)*100:0,_set["horizontal"===this.orientation?"left":"bottom"]=valPercent+"%",this.handle.stop(1,1)[animate?"animate":"css"](_set,o.animate),"min"===oRange&&"horizontal"===this.orientation&&this.range.stop(1,1)[animate?"animate":"css"]({width:valPercent+"%"},o.animate),"max"===oRange&&"horizontal"===this.orientation&&this.range[animate?"animate":"css"]({width:100-valPercent+"%"},{queue:!1,duration:o.animate}),"min"===oRange&&"vertical"===this.orientation&&this.range.stop(1,1)[animate?"animate":"css"]({height:valPercent+"%"},o.animate),"max"===oRange&&"vertical"===this.orientation&&this.range[animate?"animate":"css"]({height:100-valPercent+"%"},{queue:!1,duration:o.animate}))},_handleEvents:{keydown:function(event){var curVal,newVal,step,index=$(event.target).data("ui-slider-handle-index");switch(event.keyCode){case $.ui.keyCode.HOME:case $.ui.keyCode.END:case $.ui.keyCode.PAGE_UP:case $.ui.keyCode.PAGE_DOWN:case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(event.preventDefault(),!this._keySliding&&(this._keySliding=!0,$(event.target).addClass("ui-state-active"),!1===this._start(event,index)))return}switch(step=this.options.step,curVal=newVal=this.options.values&&this.options.values.length?this.values(index):this.value(),event.keyCode){case $.ui.keyCode.HOME:newVal=this._valueMin();break;case $.ui.keyCode.END:newVal=this._valueMax();break;case $.ui.keyCode.PAGE_UP:newVal=this._trimAlignValue(curVal+(this._valueMax()-this._valueMin())/numPages);break;case $.ui.keyCode.PAGE_DOWN:newVal=this._trimAlignValue(curVal-(this._valueMax()-this._valueMin())/numPages);break;case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:if(curVal===this._valueMax())return;newVal=this._trimAlignValue(curVal+step);break;case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(curVal===this._valueMin())return;newVal=this._trimAlignValue(curVal-step)}this._slide(event,index,newVal)},click:function(event){event.preventDefault()},keyup:function(event){var index=$(event.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(event,index),this._change(event,index),$(event.target).removeClass("ui-state-active"))}}})}(jQuery),function($){function modifier(fn){return function(){var previous=this.element.val();fn.apply(this,arguments),this._refresh(),previous!==this.element.val()&&this._trigger("change")}}$.widget("ui.spinner",{version:"1.10.4",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var options={},element=this.element;return $.each(["min","max","step"],function(i,option){var value=element.attr(option);void 0!==value&&value.length&&(options[option]=value)}),options},_events:{keydown:function(event){this._start(event)&&this._keydown(event)&&event.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(event){if(this.cancelBlur)return void delete this.cancelBlur;this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",event)},mousewheel:function(event,delta){if(delta){if(!this.spinning&&!this._start(event))return!1;this._spin((delta>0?1:-1)*this.options.step,event),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(event)},100),event.preventDefault()}},"mousedown .ui-spinner-button":function(event){function checkFocus(){this.element[0]===this.document[0].activeElement||(this.element.focus(),this.previous=previous,this._delay(function(){this.previous=previous}))}var previous;previous=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),event.preventDefault(),checkFocus.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,checkFocus.call(this)}),!1!==this._start(event)&&this._repeat(null,$(event.currentTarget).hasClass("ui-spinner-up")?1:-1,event)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(event){if($(event.currentTarget).hasClass("ui-state-active"))return!1!==this._start(event)&&void this._repeat(null,$(event.currentTarget).hasClass("ui-spinner-up")?1:-1,event)},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var uiSpinner=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=uiSpinner.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*uiSpinner.height())&&uiSpinner.height()>0&&uiSpinner.height(uiSpinner.height()),this.options.disabled&&this.disable()},_keydown:function(event){var options=this.options,keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.UP:return this._repeat(null,1,event),!0;case keyCode.DOWN:return this._repeat(null,-1,event),!0;case keyCode.PAGE_UP:return this._repeat(null,options.page,event),!0;case keyCode.PAGE_DOWN:return this._repeat(null,-options.page,event),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(event){return!(!this.spinning&&!1===this._trigger("start",event))&&(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(i,steps,event){i=i||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,steps,event)},i),this._spin(steps*this.options.step,event)},_spin:function(step,event){var value=this.value()||0;this.counter||(this.counter=1),value=this._adjustValue(value+step*this._increment(this.counter)),this.spinning&&!1===this._trigger("spin",event,{value:value})||(this._value(value),this.counter++)},_increment:function(i){var incremental=this.options.incremental;return incremental?$.isFunction(incremental)?incremental(i):Math.floor(i*i*i/5e4-i*i/500+17*i/200+1):1},_precision:function(){var precision=this._precisionOf(this.options.step);return null!==this.options.min&&(precision=Math.max(precision,this._precisionOf(this.options.min))),precision},_precisionOf:function(num){var str=num.toString(),decimal=str.indexOf(".");return-1===decimal?0:str.length-decimal-1},_adjustValue:function(value){var base,aboveMin,options=this.options;return base=null!==options.min?options.min:0,aboveMin=value-base,aboveMin=Math.round(aboveMin/options.step)*options.step,value=base+aboveMin,value=parseFloat(value.toFixed(this._precision())),null!==options.max&&value>options.max?options.max:null!==options.min&&value<options.min?options.min:value},_stop:function(event){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",event))},_setOption:function(key,value){if("culture"===key||"numberFormat"===key){var prevValue=this._parse(this.element.val());return this.options[key]=value,void this.element.val(this._format(prevValue))}"max"!==key&&"min"!==key&&"step"!==key||"string"==typeof value&&(value=this._parse(value)),"icons"===key&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(value.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(value.down)),this._super(key,value),"disabled"===key&&(value?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:modifier(function(options){this._super(options),this._value(this.element.val())}),_parse:function(val){return"string"==typeof val&&""!==val&&(val=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(val,10,this.options.culture):+val),""===val||isNaN(val)?null:val},_format:function(value){return""===value?"":window.Globalize&&this.options.numberFormat?Globalize.format(value,this.options.numberFormat,this.options.culture):value},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(value,allowAny){var parsed;""!==value&&null!==(parsed=this._parse(value))&&(allowAny||(parsed=this._adjustValue(parsed)),value=this._format(parsed)),this.element.val(value),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:modifier(function(steps){this._stepUp(steps)}),_stepUp:function(steps){this._start()&&(this._spin((steps||1)*this.options.step),this._stop())},stepDown:modifier(function(steps){this._stepDown(steps)}),_stepDown:function(steps){this._start()&&(this._spin((steps||1)*-this.options.step),this._stop())},pageUp:modifier(function(pages){this._stepUp((pages||1)*this.options.page)}),pageDown:modifier(function(pages){this._stepDown((pages||1)*this.options.page)}),value:function(newVal){if(!arguments.length)return this._parse(this.element.val());modifier(this._value).call(this,newVal)},widget:function(){return this.uiSpinner}})}(jQuery),function($,undefined){function getNextTabId(){return++tabId}function isLocal(anchor){return anchor=anchor.cloneNode(!1),anchor.hash.length>1&&decodeURIComponent(anchor.href.replace(rhash,""))===decodeURIComponent(location.href.replace(rhash,""))}var tabId=0,rhash=/#.*$/;$.widget("ui.tabs",{version:"1.10.4",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var that=this,options=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",options.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(event){$(this).is(".ui-state-disabled")&&event.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){$(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),options.active=this._initialActive(),$.isArray(options.disabled)&&(options.disabled=$.unique(options.disabled.concat($.map(this.tabs.filter(".ui-state-disabled"),function(li){return that.tabs.index(li)}))).sort()),!1!==this.options.active&&this.anchors.length?this.active=this._findActive(options.active):this.active=$(),this._refresh(),this.active.length&&this.load(options.active)},_initialActive:function(){var active=this.options.active,collapsible=this.options.collapsible,locationHash=location.hash.substring(1);return null===active&&(locationHash&&this.tabs.each(function(i,tab){if($(tab).attr("aria-controls")===locationHash)return active=i,!1}),null===active&&(active=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),null!==active&&-1!==active||(active=!!this.tabs.length&&0)),!1!==active&&-1===(active=this.tabs.index(this.tabs.eq(active)))&&(active=!collapsible&&0),!collapsible&&!1===active&&this.anchors.length&&(active=0),active},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):$()}},_tabKeydown:function(event){var focusedTab=$(this.document[0].activeElement).closest("li"),selectedIndex=this.tabs.index(focusedTab),goingForward=!0;if(!this._handlePageNav(event)){switch(event.keyCode){case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:selectedIndex++;break;case $.ui.keyCode.UP:case $.ui.keyCode.LEFT:goingForward=!1,selectedIndex--;break;case $.ui.keyCode.END:selectedIndex=this.anchors.length-1;break;case $.ui.keyCode.HOME:selectedIndex=0;break;case $.ui.keyCode.SPACE:return event.preventDefault(),clearTimeout(this.activating),void this._activate(selectedIndex);case $.ui.keyCode.ENTER:return event.preventDefault(),clearTimeout(this.activating),void this._activate(selectedIndex!==this.options.active&&selectedIndex);default:return}event.preventDefault(),clearTimeout(this.activating),selectedIndex=this._focusNextTab(selectedIndex,goingForward),event.ctrlKey||(focusedTab.attr("aria-selected","false"),this.tabs.eq(selectedIndex).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",selectedIndex)},this.delay))}},_panelKeydown:function(event){this._handlePageNav(event)||event.ctrlKey&&event.keyCode===$.ui.keyCode.UP&&(event.preventDefault(),this.active.focus())},_handlePageNav:function(event){return event.altKey&&event.keyCode===$.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):event.altKey&&event.keyCode===$.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(index,goingForward){function constrain(){return index>lastTabIndex&&(index=0),index<0&&(index=lastTabIndex),index}for(var lastTabIndex=this.tabs.length-1;-1!==$.inArray(constrain(),this.options.disabled);)index=goingForward?index+1:index-1;return index},_focusNextTab:function(index,goingForward){return index=this._findNextTab(index,goingForward),this.tabs.eq(index).focus(),index},_setOption:function(key,value){return"active"===key?void this._activate(value):"disabled"===key?void this._setupDisabled(value):(this._super(key,value),"collapsible"===key&&(this.element.toggleClass("ui-tabs-collapsible",value),value||!1!==this.options.active||this._activate(0)),"event"===key&&this._setupEvents(value),void("heightStyle"===key&&this._setupHeightStyle(value)))},_tabId:function(tab){return tab.attr("aria-controls")||"ui-tabs-"+getNextTabId()},_sanitizeSelector:function(hash){return hash?hash.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var options=this.options,lis=this.tablist.children(":has(a[href])");options.disabled=$.map(lis.filter(".ui-state-disabled"),function(tab){return lis.index(tab)}),this._processTabs(),!1!==options.active&&this.anchors.length?this.active.length&&!$.contains(this.tablist[0],this.active[0])?this.tabs.length===options.disabled.length?(options.active=!1,this.active=$()):this._activate(this._findNextTab(Math.max(0,options.active-1),!1)):options.active=this.tabs.index(this.active):(options.active=!1,this.active=$()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var that=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return $("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=$(),this.anchors.each(function(i,anchor){var selector,panel,panelId,anchorId=$(anchor).uniqueId().attr("id"),tab=$(anchor).closest("li"),originalAriaControls=tab.attr("aria-controls");isLocal(anchor)?(selector=anchor.hash,panel=that.element.find(that._sanitizeSelector(selector))):(panelId=that._tabId(tab),selector="#"+panelId,panel=that.element.find(selector),panel.length||(panel=that._createPanel(panelId),panel.insertAfter(that.panels[i-1]||that.tablist)),panel.attr("aria-live","polite")),panel.length&&(that.panels=that.panels.add(panel)),originalAriaControls&&tab.data("ui-tabs-aria-controls",originalAriaControls),tab.attr({"aria-controls":selector.substring(1),"aria-labelledby":anchorId}),panel.attr("aria-labelledby",anchorId)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(id){return $("<div>").attr("id",id).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(disabled){$.isArray(disabled)&&(disabled.length?disabled.length===this.anchors.length&&(disabled=!0):disabled=!1);for(var li,i=0;li=this.tabs[i];i++)!0===disabled||-1!==$.inArray(i,disabled)?$(li).addClass("ui-state-disabled").attr("aria-disabled","true"):$(li).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=disabled},_setupEvents:function(event){var events={click:function(event){event.preventDefault()}};event&&$.each(event.split(" "),function(index,eventName){events[eventName]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,events),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(heightStyle){var maxHeight,parent=this.element.parent();"fill"===heightStyle?(maxHeight=parent.height(),maxHeight-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");"absolute"!==position&&"fixed"!==position&&(maxHeight-=elem.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){maxHeight-=$(this).outerHeight(!0)}),this.panels.each(function(){$(this).height(Math.max(0,maxHeight-$(this).innerHeight()+$(this).height()))}).css("overflow","auto")):"auto"===heightStyle&&(maxHeight=0,this.panels.each(function(){maxHeight=Math.max(maxHeight,$(this).height("").height())}).height(maxHeight))},_eventHandler:function(event){var options=this.options,active=this.active,anchor=$(event.currentTarget),tab=anchor.closest("li"),clickedIsActive=tab[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():this._getPanelForTab(tab),toHide=active.length?this._getPanelForTab(active):$(),eventData={oldTab:active,oldPanel:toHide,newTab:collapsing?$():tab,newPanel:toShow};event.preventDefault(),tab.hasClass("ui-state-disabled")||tab.hasClass("ui-tabs-loading")||this.running||clickedIsActive&&!options.collapsible||!1===this._trigger("beforeActivate",event,eventData)||(options.active=!collapsing&&this.tabs.index(tab),this.active=clickedIsActive?$():tab,this.xhr&&this.xhr.abort(),toHide.length||toShow.length||$.error("jQuery UI Tabs: Mismatching fragment identifier."),toShow.length&&this.load(this.tabs.index(tab),event),this._toggle(event,eventData))},_toggle:function(event,eventData){function complete(){that.running=!1,that._trigger("activate",event,eventData)}function show(){eventData.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),toShow.length&&that.options.show?that._show(toShow,that.options.show,complete):(toShow.show(),complete())}var that=this,toShow=eventData.newPanel,toHide=eventData.oldPanel;this.running=!0,toHide.length&&this.options.hide?this._hide(toHide,this.options.hide,function(){eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),show()}):(eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),toHide.hide(),show()),toHide.attr({"aria-expanded":"false","aria-hidden":"true"}),eventData.oldTab.attr("aria-selected","false"),toShow.length&&toHide.length?eventData.oldTab.attr("tabIndex",-1):toShow.length&&this.tabs.filter(function(){return 0===$(this).attr("tabIndex")}).attr("tabIndex",-1),toShow.attr({"aria-expanded":"true","aria-hidden":"false"}),eventData.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(index){var anchor,active=this._findActive(index);active[0]!==this.active[0]&&(active.length||(active=this.active),anchor=active.find(".ui-tabs-anchor")[0],this._eventHandler({target:anchor,currentTarget:anchor,preventDefault:$.noop}))},_findActive:function(index){return!1===index?$():this.tabs.eq(index)},_getIndex:function(index){return"string"==typeof index&&(index=this.anchors.index(this.anchors.filter("[href$='"+index+"']"))),index},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){$.data(this,"ui-tabs-destroy")?$(this).remove():$(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var li=$(this),prev=li.data("ui-tabs-aria-controls");prev?li.attr("aria-controls",prev).removeData("ui-tabs-aria-controls"):li.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(index){var disabled=this.options.disabled;!1!==disabled&&(index===undefined?disabled=!1:(index=this._getIndex(index),disabled=$.isArray(disabled)?$.map(disabled,function(num){return num!==index?num:null}):$.map(this.tabs,function(li,num){return num!==index?num:null})),
this._setupDisabled(disabled))},disable:function(index){var disabled=this.options.disabled;if(!0!==disabled){if(index===undefined)disabled=!0;else{if(index=this._getIndex(index),-1!==$.inArray(index,disabled))return;disabled=$.isArray(disabled)?$.merge([index],disabled).sort():[index]}this._setupDisabled(disabled)}},load:function(index,event){index=this._getIndex(index);var that=this,tab=this.tabs.eq(index),anchor=tab.find(".ui-tabs-anchor"),panel=this._getPanelForTab(tab),eventData={tab:tab,panel:panel};isLocal(anchor[0])||(this.xhr=$.ajax(this._ajaxSettings(anchor,event,eventData)),this.xhr&&"canceled"!==this.xhr.statusText&&(tab.addClass("ui-tabs-loading"),panel.attr("aria-busy","true"),this.xhr.success(function(response){setTimeout(function(){panel.html(response),that._trigger("load",event,eventData)},1)}).complete(function(jqXHR,status){setTimeout(function(){"abort"===status&&that.panels.stop(!1,!0),tab.removeClass("ui-tabs-loading"),panel.removeAttr("aria-busy"),jqXHR===that.xhr&&delete that.xhr},1)})))},_ajaxSettings:function(anchor,event,eventData){var that=this;return{url:anchor.attr("href"),beforeSend:function(jqXHR,settings){return that._trigger("beforeLoad",event,$.extend({jqXHR:jqXHR,ajaxSettings:settings},eventData))}}},_getPanelForTab:function(tab){var id=$(tab).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+id))}})}(jQuery),function($){function addDescribedBy(elem,id){var describedby=(elem.attr("aria-describedby")||"").split(/\s+/);describedby.push(id),elem.data("ui-tooltip-id",id).attr("aria-describedby",$.trim(describedby.join(" ")))}function removeDescribedBy(elem){var id=elem.data("ui-tooltip-id"),describedby=(elem.attr("aria-describedby")||"").split(/\s+/),index=$.inArray(id,describedby);-1!==index&&describedby.splice(index,1),elem.removeData("ui-tooltip-id"),describedby=$.trim(describedby.join(" ")),describedby?elem.attr("aria-describedby",describedby):elem.removeAttr("aria-describedby")}var increments=0;$.widget("ui.tooltip",{version:"1.10.4",options:{content:function(){var title=$(this).attr("title")||"";return $("<a>").text(title).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(key,value){var that=this;if("disabled"===key)return this[value?"_disable":"_enable"](),void(this.options[key]=value);this._super(key,value),"content"===key&&$.each(this.tooltips,function(id,element){that._updateContent(element)})},_disable:function(){var that=this;$.each(this.tooltips,function(id,element){var event=$.Event("blur");event.target=event.currentTarget=element[0],that.close(event,!0)}),this.element.find(this.options.items).addBack().each(function(){var element=$(this);element.is("[title]")&&element.data("ui-tooltip-title",element.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var element=$(this);element.data("ui-tooltip-title")&&element.attr("title",element.data("ui-tooltip-title"))})},open:function(event){var that=this,target=$(event?event.target:this.element).closest(this.options.items);target.length&&!target.data("ui-tooltip-id")&&(target.attr("title")&&target.data("ui-tooltip-title",target.attr("title")),target.data("ui-tooltip-open",!0),event&&"mouseover"===event.type&&target.parents().each(function(){var blurEvent,parent=$(this);parent.data("ui-tooltip-open")&&(blurEvent=$.Event("blur"),blurEvent.target=blurEvent.currentTarget=this,that.close(blurEvent,!0)),parent.attr("title")&&(parent.uniqueId(),that.parents[this.id]={element:this,title:parent.attr("title")},parent.attr("title",""))}),this._updateContent(target,event))},_updateContent:function(target,event){var content,contentOption=this.options.content,that=this,eventType=event?event.type:null;if("string"==typeof contentOption)return this._open(event,target,contentOption);(content=contentOption.call(target[0],function(response){target.data("ui-tooltip-open")&&that._delay(function(){event&&(event.type=eventType),this._open(event,target,response)})}))&&this._open(event,target,content)},_open:function(event,target,content){function position(event){positionOption.of=event,tooltip.is(":hidden")||tooltip.position(positionOption)}var tooltip,events,delayedShow,positionOption=$.extend({},this.options.position);if(content){if(tooltip=this._find(target),tooltip.length)return void tooltip.find(".ui-tooltip-content").html(content);target.is("[title]")&&(event&&"mouseover"===event.type?target.attr("title",""):target.removeAttr("title")),tooltip=this._tooltip(target),addDescribedBy(target,tooltip.attr("id")),tooltip.find(".ui-tooltip-content").html(content),this.options.track&&event&&/^mouse/.test(event.type)?(this._on(this.document,{mousemove:position}),position(event)):tooltip.position($.extend({of:target},this.options.position)),tooltip.hide(),this._show(tooltip,this.options.show),this.options.show&&this.options.show.delay&&(delayedShow=this.delayedShow=setInterval(function(){tooltip.is(":visible")&&(position(positionOption.of),clearInterval(delayedShow))},$.fx.interval)),this._trigger("open",event,{tooltip:tooltip}),events={keyup:function(event){if(event.keyCode===$.ui.keyCode.ESCAPE){var fakeEvent=$.Event(event);fakeEvent.currentTarget=target[0],this.close(fakeEvent,!0)}},remove:function(){this._removeTooltip(tooltip)}},event&&"mouseover"!==event.type||(events.mouseleave="close"),event&&"focusin"!==event.type||(events.focusout="close"),this._on(!0,target,events)}},close:function(event){var that=this,target=$(event?event.currentTarget:this.element),tooltip=this._find(target);this.closing||(clearInterval(this.delayedShow),target.data("ui-tooltip-title")&&target.attr("title",target.data("ui-tooltip-title")),removeDescribedBy(target),tooltip.stop(!0),this._hide(tooltip,this.options.hide,function(){that._removeTooltip($(this))}),target.removeData("ui-tooltip-open"),this._off(target,"mouseleave focusout keyup"),target[0]!==this.element[0]&&this._off(target,"remove"),this._off(this.document,"mousemove"),event&&"mouseleave"===event.type&&$.each(this.parents,function(id,parent){$(parent.element).attr("title",parent.title),delete that.parents[id]}),this.closing=!0,this._trigger("close",event,{tooltip:tooltip}),this.closing=!1)},_tooltip:function(element){var id="ui-tooltip-"+increments++,tooltip=$("<div>").attr({id:id,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return $("<div>").addClass("ui-tooltip-content").appendTo(tooltip),tooltip.appendTo(this.document[0].body),this.tooltips[id]=element,tooltip},_find:function(target){var id=target.data("ui-tooltip-id");return id?$("#"+id):$()},_removeTooltip:function(tooltip){tooltip.remove(),delete this.tooltips[tooltip.attr("id")]},_destroy:function(){var that=this;$.each(this.tooltips,function(id,element){var event=$.Event("blur");event.target=event.currentTarget=element[0],that.close(event,!0),$("#"+id).remove(),element.data("ui-tooltip-title")&&(element.attr("title",element.data("ui-tooltip-title")),element.removeData("ui-tooltip-title"))})}})}(jQuery),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(a){"use strict";var b=a.fn.jquery.split(" ")[0].split(".");if(b[0]<2&&b[1]<9||1==b[0]&&9==b[1]&&b[2]<1||b[0]>3)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(jQuery),function(a){"use strict";function b(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]};return!1}a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one("bsTransitionEnd",function(){c=!0});var e=function(){c||a(d).trigger(a.support.transition.end)};return setTimeout(e,b),this},a(function(){a.support.transition=b(),a.support.transition&&(a.event.special.bsTransitionEnd={bindType:a.support.transition.end,delegateType:a.support.transition.end,handle:function(b){if(a(b.target).is(this))return b.handleObj.handler.apply(this,arguments)}})})}(jQuery),function(a){"use strict";function b(b){return this.each(function(){var c=a(this),e=c.data("bs.alert");e||c.data("bs.alert",e=new d(this)),"string"==typeof b&&e[b].call(c)})}var c='[data-dismiss="alert"]',d=function(b){a(b).on("click",c,this.close)};d.VERSION="3.3.7",d.TRANSITION_DURATION=150,d.prototype.close=function(b){function c(){g.detach().trigger("closed.bs.alert").remove()}var e=a(this),f=e.attr("data-target");f||(f=e.attr("href"),f=f&&f.replace(/.*(?=#[^\s]*$)/,""));var g=a("#"===f?[]:f);b&&b.preventDefault(),g.length||(g=e.closest(".alert")),g.trigger(b=a.Event("close.bs.alert")),b.isDefaultPrevented()||(g.removeClass("in"),a.support.transition&&g.hasClass("fade")?g.one("bsTransitionEnd",c).emulateTransitionEnd(d.TRANSITION_DURATION):c())};var e=a.fn.alert;a.fn.alert=b,a.fn.alert.Constructor=d,a.fn.alert.noConflict=function(){return a.fn.alert=e,this},a(document).on("click.bs.alert.data-api",c,d.prototype.close)}(jQuery),function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.button"),f="object"==typeof b&&b;e||d.data("bs.button",e=new c(this,f)),"toggle"==b?e.toggle():b&&e.setState(b)})}var c=function(b,d){this.$element=a(b),this.options=a.extend({},c.DEFAULTS,d),this.isLoading=!1};c.VERSION="3.3.7",c.DEFAULTS={loadingText:"loading..."},c.prototype.setState=function(b){var c="disabled",d=this.$element,e=d.is("input")?"val":"html",f=d.data();b+="Text",null==f.resetText&&d.data("resetText",d[e]()),setTimeout(a.proxy(function(){d[e](null==f[b]?this.options[b]:f[b]),"loadingText"==b?(this.isLoading=!0,d.addClass(c).attr(c,c).prop(c,!0)):this.isLoading&&(this.isLoading=!1,d.removeClass(c).removeAttr(c).prop(c,!1))},this),0)},c.prototype.toggle=function(){var a=!0,b=this.$element.closest('[data-toggle="buttons"]');if(b.length){var c=this.$element.find("input");"radio"==c.prop("type")?(c.prop("checked")&&(a=!1),b.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==c.prop("type")&&(c.prop("checked")!==this.$element.hasClass("active")&&(a=!1),this.$element.toggleClass("active")),c.prop("checked",this.$element.hasClass("active")),a&&c.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var d=a.fn.button;a.fn.button=b,a.fn.button.Constructor=c,a.fn.button.noConflict=function(){return a.fn.button=d,this},a(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(c){var d=a(c.target).closest(".btn");b.call(d,"toggle"),a(c.target).is('input[type="radio"], input[type="checkbox"]')||(c.preventDefault(),d.is("input,button")?d.trigger("focus"):d.find("input:visible,button:visible").first().trigger("focus"))}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(b){a(b.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(b.type))})}(jQuery),function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.carousel"),f=a.extend({},c.DEFAULTS,d.data(),"object"==typeof b&&b),g="string"==typeof b?b:f.slide;e||d.data("bs.carousel",e=new c(this,f)),"number"==typeof b?e.to(b):g?e[g]():f.interval&&e.pause().cycle()})}var c=function(b,c){this.$element=a(b),this.$indicators=this.$element.find(".carousel-indicators"),this.options=c,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",a.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",a.proxy(this.pause,this)).on("mouseleave.bs.carousel",a.proxy(this.cycle,this))};c.VERSION="3.3.7",c.TRANSITION_DURATION=600,c.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},c.prototype.keydown=function(a){if(!/input|textarea/i.test(a.target.tagName)){switch(a.which){case 37:this.prev();break;case 39:this.next();break;default:return}a.preventDefault()}},c.prototype.cycle=function(b){return b||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this},c.prototype.getItemIndex=function(a){return this.$items=a.parent().children(".item"),this.$items.index(a||this.$active)},c.prototype.getItemForDirection=function(a,b){var c=this.getItemIndex(b);if(("prev"==a&&0===c||"next"==a&&c==this.$items.length-1)&&!this.options.wrap)return b;var e="prev"==a?-1:1,f=(c+e)%this.$items.length;return this.$items.eq(f)},c.prototype.to=function(a){var b=this,c=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(a>this.$items.length-1||a<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){b.to(a)}):c==a?this.pause().cycle():this.slide(a>c?"next":"prev",this.$items.eq(a))},c.prototype.pause=function(b){return b||(this.paused=!0),this.$element.find(".next, .prev").length&&a.support.transition&&(this.$element.trigger(a.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},c.prototype.next=function(){if(!this.sliding)return this.slide("next")},c.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},c.prototype.slide=function(b,d){var e=this.$element.find(".item.active"),f=d||this.getItemForDirection(b,e),g=this.interval,h="next"==b?"left":"right",i=this;if(f.hasClass("active"))return this.sliding=!1;var j=f[0],k=a.Event("slide.bs.carousel",{relatedTarget:j,direction:h});if(this.$element.trigger(k),!k.isDefaultPrevented()){if(this.sliding=!0,g&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var l=a(this.$indicators.children()[this.getItemIndex(f)]);l&&l.addClass("active")}var m=a.Event("slid.bs.carousel",{relatedTarget:j,direction:h});return a.support.transition&&this.$element.hasClass("slide")?(f.addClass(b),f[0].offsetWidth,e.addClass(h),f.addClass(h),e.one("bsTransitionEnd",function(){f.removeClass([b,h].join(" ")).addClass("active"),e.removeClass(["active",h].join(" ")),i.sliding=!1,setTimeout(function(){i.$element.trigger(m)},0)}).emulateTransitionEnd(c.TRANSITION_DURATION)):(e.removeClass("active"),f.addClass("active"),this.sliding=!1,this.$element.trigger(m)),g&&this.cycle(),this}};var d=a.fn.carousel;a.fn.carousel=b,a.fn.carousel.Constructor=c,a.fn.carousel.noConflict=function(){return a.fn.carousel=d,this};var e=function(c){var d,e=a(this),f=a(e.attr("data-target")||(d=e.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,""));if(f.hasClass("carousel")){var g=a.extend({},f.data(),e.data()),h=e.attr("data-slide-to");h&&(g.interval=!1),b.call(f,g),h&&f.data("bs.carousel").to(h),c.preventDefault()}};a(document).on("click.bs.carousel.data-api","[data-slide]",e).on("click.bs.carousel.data-api","[data-slide-to]",e),a(window).on("load",function(){a('[data-ride="carousel"]').each(function(){var c=a(this);b.call(c,c.data())})})}(jQuery),function(a){"use strict";function b(b){var c,d=b.attr("data-target")||(c=b.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"");return a(d)}function c(b){return this.each(function(){var c=a(this),e=c.data("bs.collapse"),f=a.extend({},d.DEFAULTS,c.data(),"object"==typeof b&&b);!e&&f.toggle&&/show|hide/.test(b)&&(f.toggle=!1),e||c.data("bs.collapse",e=new d(this,f)),"string"==typeof b&&e[b]()})}var d=function(b,c){this.$element=a(b),this.options=a.extend({},d.DEFAULTS,c),this.$trigger=a('[data-toggle="collapse"][href="#'+b.id+'"],[data-toggle="collapse"][data-target="#'+b.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};d.VERSION="3.3.7",d.TRANSITION_DURATION=350,d.DEFAULTS={toggle:!0},d.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},d.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var b,e=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(e&&e.length&&(b=e.data("bs.collapse"))&&b.transitioning)){var f=a.Event("show.bs.collapse");if(this.$element.trigger(f),!f.isDefaultPrevented()){e&&e.length&&(c.call(e,"hide"),b||e.data("bs.collapse",null));var g=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[g](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var h=function(){this.$element.removeClass("collapsing").addClass("collapse in")[g](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!a.support.transition)return h.call(this);var i=a.camelCase(["scroll",g].join("-"));this.$element.one("bsTransitionEnd",a.proxy(h,this)).emulateTransitionEnd(d.TRANSITION_DURATION)[g](this.$element[0][i])}}}},d.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var b=a.Event("hide.bs.collapse");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.dimension();this.$element[c](this.$element[c]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var e=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return a.support.transition?void this.$element[c](0).one("bsTransitionEnd",a.proxy(e,this)).emulateTransitionEnd(d.TRANSITION_DURATION):e.call(this)}}},d.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},d.prototype.getParent=function(){return a(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(a.proxy(function(c,d){var e=a(d);this.addAriaAndCollapsedClass(b(e),e)},this)).end()},d.prototype.addAriaAndCollapsedClass=function(a,b){var c=a.hasClass("in");a.attr("aria-expanded",c),b.toggleClass("collapsed",!c).attr("aria-expanded",c)};var e=a.fn.collapse;a.fn.collapse=c,a.fn.collapse.Constructor=d,a.fn.collapse.noConflict=function(){return a.fn.collapse=e,this},a(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(d){var e=a(this);e.attr("data-target")||d.preventDefault();var f=b(e),g=f.data("bs.collapse"),h=g?"toggle":e.data();c.call(f,h)})}(jQuery),function(a){"use strict";function b(b){var c=b.attr("data-target");c||(c=b.attr("href"),c=c&&/#[A-Za-z]/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));var d=c&&a(c);return d&&d.length?d:b.parent()}function c(c){c&&3===c.which||(a(e).remove(),a(f).each(function(){var d=a(this),e=b(d),f={relatedTarget:this};e.hasClass("open")&&(c&&"click"==c.type&&/input|textarea/i.test(c.target.tagName)&&a.contains(e[0],c.target)||(e.trigger(c=a.Event("hide.bs.dropdown",f)),c.isDefaultPrevented()||(d.attr("aria-expanded","false"),e.removeClass("open").trigger(a.Event("hidden.bs.dropdown",f)))))}))}function d(b){return this.each(function(){var c=a(this),d=c.data("bs.dropdown");d||c.data("bs.dropdown",d=new g(this)),"string"==typeof b&&d[b].call(c)})}var e=".dropdown-backdrop",f='[data-toggle="dropdown"]',g=function(b){a(b).on("click.bs.dropdown",this.toggle)};g.VERSION="3.3.7",g.prototype.toggle=function(d){var e=a(this);if(!e.is(".disabled, :disabled")){var f=b(e),g=f.hasClass("open");if(c(),!g){"ontouchstart"in document.documentElement&&!f.closest(".navbar-nav").length&&a(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(a(this)).on("click",c);var h={relatedTarget:this};if(f.trigger(d=a.Event("show.bs.dropdown",h)),d.isDefaultPrevented())return;e.trigger("focus").attr("aria-expanded","true"),f.toggleClass("open").trigger(a.Event("shown.bs.dropdown",h))}return!1}},g.prototype.keydown=function(c){if(/(38|40|27|32)/.test(c.which)&&!/input|textarea/i.test(c.target.tagName)){var d=a(this);if(c.preventDefault(),c.stopPropagation(),!d.is(".disabled, :disabled")){var e=b(d),g=e.hasClass("open");if(!g&&27!=c.which||g&&27==c.which)return 27==c.which&&e.find(f).trigger("focus"),d.trigger("click");var h=" li:not(.disabled):visible a",i=e.find(".dropdown-menu"+h);if(i.length){var j=i.index(c.target);38==c.which&&j>0&&j--,40==c.which&&j<i.length-1&&j++,~j||(j=0),i.eq(j).trigger("focus")}}}};var h=a.fn.dropdown;a.fn.dropdown=d,a.fn.dropdown.Constructor=g,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=h,this},a(document).on("click.bs.dropdown.data-api",c).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",f,g.prototype.toggle).on("keydown.bs.dropdown.data-api",f,g.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",g.prototype.keydown)}(jQuery),function(a){"use strict";function b(b,d){return this.each(function(){var e=a(this),f=e.data("bs.modal"),g=a.extend({},c.DEFAULTS,e.data(),"object"==typeof b&&b);f||e.data("bs.modal",f=new c(this,g)),"string"==typeof b?f[b](d):g.show&&f.show(d)})}var c=function(b,c){this.options=c,this.$body=a(document.body),this.$element=a(b),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,a.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};c.VERSION="3.3.7",c.TRANSITION_DURATION=300,c.BACKDROP_TRANSITION_DURATION=150,c.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},c.prototype.toggle=function(a){return this.isShown?this.hide():this.show(a)},c.prototype.show=function(b){var d=this,e=a.Event("show.bs.modal",{relatedTarget:b});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){d.$element.one("mouseup.dismiss.bs.modal",function(b){a(b.target).is(d.$element)&&(d.ignoreBackdropClick=!0)})}),this.backdrop(function(){var e=a.support.transition&&d.$element.hasClass("fade");d.$element.parent().length||d.$element.appendTo(d.$body),d.$element.show().scrollTop(0),d.adjustDialog(),e&&d.$element[0].offsetWidth,d.$element.addClass("in"),d.enforceFocus();var f=a.Event("shown.bs.modal",{relatedTarget:b});e?d.$dialog.one("bsTransitionEnd",function(){d.$element.trigger("focus").trigger(f)}).emulateTransitionEnd(c.TRANSITION_DURATION):d.$element.trigger("focus").trigger(f)}))},c.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",a.proxy(this.hideModal,this)).emulateTransitionEnd(c.TRANSITION_DURATION):this.hideModal())},c.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){document===a.target||this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.trigger("focus")},this))},c.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},c.prototype.resize=function(){this.isShown?a(window).on("resize.bs.modal",a.proxy(this.handleUpdate,this)):a(window).off("resize.bs.modal")},c.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.$body.removeClass("modal-open"),a.resetAdjustments(),a.resetScrollbar(),a.$element.trigger("hidden.bs.modal")})},c.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},c.prototype.backdrop=function(b){var d=this,e=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var f=a.support.transition&&e;if(this.$backdrop=a(document.createElement("div")).addClass("modal-backdrop "+e).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",a.proxy(function(a){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(a.target===a.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),f&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;f?this.$backdrop.one("bsTransitionEnd",b).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):b()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var g=function(){d.removeBackdrop(),b&&b()};a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",g).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):g()}else b&&b()},c.prototype.handleUpdate=function(){this.adjustDialog()},c.prototype.adjustDialog=function(){var a=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&a?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!a?this.scrollbarWidth:""})},c.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},c.prototype.checkScrollbar=function(){var a=window.innerWidth;if(!a){var b=document.documentElement.getBoundingClientRect();a=b.right-Math.abs(b.left)}this.bodyIsOverflowing=document.body.clientWidth<a,this.scrollbarWidth=this.measureScrollbar()},c.prototype.setScrollbar=function(){var a=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",a+this.scrollbarWidth)},c.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},c.prototype.measureScrollbar=function(){var a=document.createElement("div");a.className="modal-scrollbar-measure",this.$body.append(a);var b=a.offsetWidth-a.clientWidth;return this.$body[0].removeChild(a),b};var d=a.fn.modal;a.fn.modal=b,a.fn.modal.Constructor=c,a.fn.modal.noConflict=function(){return a.fn.modal=d,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(c){var d=a(this),e=d.attr("href"),f=a(d.attr("data-target")||e&&e.replace(/.*(?=#[^\s]+$)/,"")),g=f.data("bs.modal")?"toggle":a.extend({remote:!/#/.test(e)&&e},f.data(),d.data());d.is("a")&&c.preventDefault(),f.one("show.bs.modal",function(a){a.isDefaultPrevented()||f.one("hidden.bs.modal",function(){d.is(":visible")&&d.trigger("focus")})}),b.call(f,g,this)})}(jQuery),function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.tooltip"),f="object"==typeof b&&b;!e&&/destroy|hide/.test(b)||(e||d.data("bs.tooltip",e=new c(this,f)),"string"==typeof b&&e[b]())})}var c=function(a,b){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",a,b)};c.VERSION="3.3.7",c.TRANSITION_DURATION=150,c.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},c.prototype.init=function(b,c,d){if(this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.$viewport=this.options.viewport&&a(a.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focusin",i="hover"==g?"mouseleave":"focusout";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.getOptions=function(b){return b=a.extend({},this.getDefaults(),this.$element.data(),b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},c.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},c.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),b instanceof a.Event&&(c.inState["focusin"==b.type?"focus":"hover"]=!0),c.tip().hasClass("in")||"in"==c.hoverState?void(c.hoverState="in"):(clearTimeout(c.timeout),c.hoverState="in",c.options.delay&&c.options.delay.show?void(c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)):c.show())},c.prototype.isInStateTrue=function(){for(var a in this.inState)if(this.inState[a])return!0;return!1},c.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);if(c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),b instanceof a.Event&&(c.inState["focusout"==b.type?"focus":"hover"]=!1),!c.isInStateTrue())return clearTimeout(c.timeout),c.hoverState="out",c.options.delay&&c.options.delay.hide?void(c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)):c.hide()},c.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(b);var d=a.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(b.isDefaultPrevented()||!d)return;var e=this,f=this.tip(),g=this.getUID(this.type);this.setContent(),f.attr("id",g),this.$element.attr("aria-describedby",g),this.options.animation&&f.addClass("fade");var h="function"==typeof this.options.placement?this.options.placement.call(this,f[0],this.$element[0]):this.options.placement,i=/\s?auto?\s?/i,j=i.test(h);j&&(h=h.replace(i,"")||"top"),f.detach().css({top:0,left:0,display:"block"}).addClass(h).data("bs."+this.type,this),this.options.container?f.appendTo(this.options.container):f.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var k=this.getPosition(),l=f[0].offsetWidth,m=f[0].offsetHeight;if(j){var n=h,o=this.getPosition(this.$viewport);h="bottom"==h&&k.bottom+m>o.bottom?"top":"top"==h&&k.top-m<o.top?"bottom":"right"==h&&k.right+l>o.width?"left":"left"==h&&k.left-l<o.left?"right":h,f.removeClass(n).addClass(h)}var p=this.getCalculatedOffset(h,k,l,m);this.applyPlacement(p,h);var q=function(){var a=e.hoverState;e.$element.trigger("shown.bs."+e.type),e.hoverState=null,"out"==a&&e.leave(e)};a.support.transition&&this.$tip.hasClass("fade")?f.one("bsTransitionEnd",q).emulateTransitionEnd(c.TRANSITION_DURATION):q()}},c.prototype.applyPlacement=function(b,c){var d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),b.top+=g,b.left+=h,
a.offset.setOffset(d[0],a.extend({using:function(a){d.css({top:Math.round(a.top),left:Math.round(a.left)})}},b),0),d.addClass("in");var i=d[0].offsetWidth,j=d[0].offsetHeight;"top"==c&&j!=f&&(b.top=b.top+f-j);var k=this.getViewportAdjustedDelta(c,b,i,j);k.left?b.left+=k.left:b.top+=k.top;var l=/top|bottom/.test(c),m=l?2*k.left-e+i:2*k.top-f+j,n=l?"offsetWidth":"offsetHeight";d.offset(b),this.replaceArrow(m,d[0][n],l)},c.prototype.replaceArrow=function(a,b,c){this.arrow().css(c?"left":"top",50*(1-a/b)+"%").css(c?"top":"left","")},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},c.prototype.hide=function(b){function d(){"in"!=e.hoverState&&f.detach(),e.$element&&e.$element.removeAttr("aria-describedby").trigger("hidden.bs."+e.type),b&&b()}var e=this,f=a(this.$tip),g=a.Event("hide.bs."+this.type);if(this.$element.trigger(g),!g.isDefaultPrevented())return f.removeClass("in"),a.support.transition&&f.hasClass("fade")?f.one("bsTransitionEnd",d).emulateTransitionEnd(c.TRANSITION_DURATION):d(),this.hoverState=null,this},c.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},c.prototype.hasContent=function(){return this.getTitle()},c.prototype.getPosition=function(b){b=b||this.$element;var c=b[0],d="BODY"==c.tagName,e=c.getBoundingClientRect();null==e.width&&(e=a.extend({},e,{width:e.right-e.left,height:e.bottom-e.top}));var f=window.SVGElement&&c instanceof window.SVGElement,g=d?{top:0,left:0}:f?null:b.offset(),h={scroll:d?document.documentElement.scrollTop||document.body.scrollTop:b.scrollTop()},i=d?{width:a(window).width(),height:a(window).height()}:null;return a.extend({},e,h,i,g)},c.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},c.prototype.getViewportAdjustedDelta=function(a,b,c,d){var e={top:0,left:0};if(!this.$viewport)return e;var f=this.options.viewport&&this.options.viewport.padding||0,g=this.getPosition(this.$viewport);if(/right|left/.test(a)){var h=b.top-f-g.scroll,i=b.top+f-g.scroll+d;h<g.top?e.top=g.top-h:i>g.top+g.height&&(e.top=g.top+g.height-i)}else{var j=b.left-f,k=b.left+f+c;j<g.left?e.left=g.left-j:k>g.right&&(e.left=g.left+g.width-k)}return e},c.prototype.getTitle=function(){var b=this.$element,c=this.options;return b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},c.prototype.getUID=function(a){do{a+=~~(1e6*Math.random())}while(document.getElementById(a));return a},c.prototype.tip=function(){if(!this.$tip&&(this.$tip=a(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},c.prototype.enable=function(){this.enabled=!0},c.prototype.disable=function(){this.enabled=!1},c.prototype.toggleEnabled=function(){this.enabled=!this.enabled},c.prototype.toggle=function(b){var c=this;b&&((c=a(b.currentTarget).data("bs."+this.type))||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c))),b?(c.inState.click=!c.inState.click,c.isInStateTrue()?c.enter(c):c.leave(c)):c.tip().hasClass("in")?c.leave(c):c.enter(c)},c.prototype.destroy=function(){var a=this;clearTimeout(this.timeout),this.hide(function(){a.$element.off("."+a.type).removeData("bs."+a.type),a.$tip&&a.$tip.detach(),a.$tip=null,a.$arrow=null,a.$viewport=null,a.$element=null})};var d=a.fn.tooltip;a.fn.tooltip=b,a.fn.tooltip.Constructor=c,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=d,this}}(jQuery),function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.popover"),f="object"==typeof b&&b;!e&&/destroy|hide/.test(b)||(e||d.data("bs.popover",e=new c(this,f)),"string"==typeof b&&e[b]())})}var c=function(a,b){this.init("popover",a,b)};if(!a.fn.tooltip)throw new Error("Popover requires tooltip.js");c.VERSION="3.3.7",c.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),c.prototype=a.extend({},a.fn.tooltip.Constructor.prototype),c.prototype.constructor=c,c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".popover-title")[this.options.html?"html":"text"](b),a.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof c?"html":"append":"text"](c),a.removeClass("fade top bottom left right in"),a.find(".popover-title").html()||a.find(".popover-title").hide()},c.prototype.hasContent=function(){return this.getTitle()||this.getContent()},c.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var d=a.fn.popover;a.fn.popover=b,a.fn.popover.Constructor=c,a.fn.popover.noConflict=function(){return a.fn.popover=d,this}}(jQuery),function(a){"use strict";function b(c,d){this.$body=a(document.body),this.$scrollElement=a(a(c).is(document.body)?window:c),this.options=a.extend({},b.DEFAULTS,d),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",a.proxy(this.process,this)),this.refresh(),this.process()}function c(c){return this.each(function(){var d=a(this),e=d.data("bs.scrollspy"),f="object"==typeof c&&c;e||d.data("bs.scrollspy",e=new b(this,f)),"string"==typeof c&&e[c]()})}b.VERSION="3.3.7",b.DEFAULTS={offset:10},b.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},b.prototype.refresh=function(){var b=this,c="offset",d=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),a.isWindow(this.$scrollElement[0])||(c="position",d=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var b=a(this),e=b.data("target")||b.attr("href"),f=/^#./.test(e)&&a(e);return f&&f.length&&f.is(":visible")&&[[f[c]().top+d,e]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){b.offsets.push(this[0]),b.targets.push(this[1])})},b.prototype.process=function(){var a,b=this.$scrollElement.scrollTop()+this.options.offset,c=this.getScrollHeight(),d=this.options.offset+c-this.$scrollElement.height(),e=this.offsets,f=this.targets,g=this.activeTarget;if(this.scrollHeight!=c&&this.refresh(),b>=d)return g!=(a=f[f.length-1])&&this.activate(a);if(g&&b<e[0])return this.activeTarget=null,this.clear();for(a=e.length;a--;)g!=f[a]&&b>=e[a]&&(void 0===e[a+1]||b<e[a+1])&&this.activate(f[a])},b.prototype.activate=function(b){this.activeTarget=b,this.clear();var c=this.selector+'[data-target="'+b+'"],'+this.selector+'[href="'+b+'"]',d=a(c).parents("li").addClass("active");d.parent(".dropdown-menu").length&&(d=d.closest("li.dropdown").addClass("active")),d.trigger("activate.bs.scrollspy")},b.prototype.clear=function(){a(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var d=a.fn.scrollspy;a.fn.scrollspy=c,a.fn.scrollspy.Constructor=b,a.fn.scrollspy.noConflict=function(){return a.fn.scrollspy=d,this},a(window).on("load.bs.scrollspy.data-api",function(){a('[data-spy="scroll"]').each(function(){var b=a(this);c.call(b,b.data())})})}(jQuery),function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.tab");e||d.data("bs.tab",e=new c(this)),"string"==typeof b&&e[b]()})}var c=function(b){this.element=a(b)};c.VERSION="3.3.7",c.TRANSITION_DURATION=150,c.prototype.show=function(){var b=this.element,c=b.closest("ul:not(.dropdown-menu)"),d=b.data("target");if(d||(d=b.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,"")),!b.parent("li").hasClass("active")){var e=c.find(".active:last a"),f=a.Event("hide.bs.tab",{relatedTarget:b[0]}),g=a.Event("show.bs.tab",{relatedTarget:e[0]});if(e.trigger(f),b.trigger(g),!g.isDefaultPrevented()&&!f.isDefaultPrevented()){var h=a(d);this.activate(b.closest("li"),c),this.activate(h,h.parent(),function(){e.trigger({type:"hidden.bs.tab",relatedTarget:b[0]}),b.trigger({type:"shown.bs.tab",relatedTarget:e[0]})})}}},c.prototype.activate=function(b,d,e){function f(){g.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),b.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),h?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade"),b.parent(".dropdown-menu").length&&b.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),e&&e()}var g=d.find("> .active"),h=e&&a.support.transition&&(g.length&&g.hasClass("fade")||!!d.find("> .fade").length);g.length&&h?g.one("bsTransitionEnd",f).emulateTransitionEnd(c.TRANSITION_DURATION):f(),g.removeClass("in")};var d=a.fn.tab;a.fn.tab=b,a.fn.tab.Constructor=c,a.fn.tab.noConflict=function(){return a.fn.tab=d,this};var e=function(c){c.preventDefault(),b.call(a(this),"show")};a(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',e).on("click.bs.tab.data-api",'[data-toggle="pill"]',e)}(jQuery),function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.affix"),f="object"==typeof b&&b;e||d.data("bs.affix",e=new c(this,f)),"string"==typeof b&&e[b]()})}var c=function(b,d){this.options=a.extend({},c.DEFAULTS,d),this.$target=a(this.options.target).on("scroll.bs.affix.data-api",a.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",a.proxy(this.checkPositionWithEventLoop,this)),this.$element=a(b),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};c.VERSION="3.3.7",c.RESET="affix affix-top affix-bottom",c.DEFAULTS={offset:0,target:window},c.prototype.getState=function(a,b,c,d){var e=this.$target.scrollTop(),f=this.$element.offset(),g=this.$target.height();if(null!=c&&"top"==this.affixed)return e<c&&"top";if("bottom"==this.affixed)return null!=c?!(e+this.unpin<=f.top)&&"bottom":!(e+g<=a-d)&&"bottom";var h=null==this.affixed,i=h?e:f.top,j=h?g:b;return null!=c&&e<=c?"top":null!=d&&i+j>=a-d&&"bottom"},c.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(c.RESET).addClass("affix");var a=this.$target.scrollTop(),b=this.$element.offset();return this.pinnedOffset=b.top-a},c.prototype.checkPositionWithEventLoop=function(){setTimeout(a.proxy(this.checkPosition,this),1)},c.prototype.checkPosition=function(){if(this.$element.is(":visible")){var b=this.$element.height(),d=this.options.offset,e=d.top,f=d.bottom,g=Math.max(a(document).height(),a(document.body).height());"object"!=typeof d&&(f=e=d),"function"==typeof e&&(e=d.top(this.$element)),"function"==typeof f&&(f=d.bottom(this.$element));var h=this.getState(g,b,e,f);if(this.affixed!=h){null!=this.unpin&&this.$element.css("top","");var i="affix"+(h?"-"+h:""),j=a.Event(i+".bs.affix");if(this.$element.trigger(j),j.isDefaultPrevented())return;this.affixed=h,this.unpin="bottom"==h?this.getPinnedOffset():null,this.$element.removeClass(c.RESET).addClass(i).trigger(i.replace("affix","affixed")+".bs.affix")}"bottom"==h&&this.$element.offset({top:g-b-f})}};var d=a.fn.affix;a.fn.affix=b,a.fn.affix.Constructor=c,a.fn.affix.noConflict=function(){return a.fn.affix=d,this},a(window).on("load",function(){a('[data-spy="affix"]').each(function(){var c=a(this),d=c.data();d.offset=d.offset||{},null!=d.offsetBottom&&(d.offset.bottom=d.offsetBottom),null!=d.offsetTop&&(d.offset.top=d.offsetTop),b.call(c,d)})})}(jQuery),function(a){"use strict";function b(){var a=document.createElement("mm"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]};return!1}function c(b){return this.each(function(){var c=a(this),d=c.data("mm"),f=a.extend({},e.DEFAULTS,c.data(),"object"==typeof b&&b);d||c.data("mm",d=new e(this,f)),"string"==typeof b&&d[b]()})}a.fn.emulateTransitionEnd=function(b){var c=!1,e=this;a(this).one("mmTransitionEnd",function(){c=!0});var f=function(){c||a(e).trigger(d.end)};return setTimeout(f,b),this};var d=b();d&&(a.event.special.mmTransitionEnd={bindType:d.end,delegateType:d.end,handle:function(b){return a(b.target).is(this)?b.handleObj.handler.apply(this,arguments):void 0}});var e=function(b,c){this.$element=a(b),this.options=a.extend({},e.DEFAULTS,c),this.transitioning=null,this.init()};e.TRANSITION_DURATION=350,e.DEFAULTS={toggle:!0,doubleTapToGo:!1,activeClass:"active"},e.prototype.init=function(){var b=this,c=this.options.activeClass;this.$element.find("li."+c).has("ul").children("ul").addClass("collapse in"),this.$element.find("li").not("."+c).has("ul").children("ul").addClass("collapse"),this.options.doubleTapToGo&&this.$element.find("li."+c).has("ul").children("a").addClass("doubleTapToGo"),this.$element.find("li").has("ul").children("a").on("click.metisMenu",function(d){var e=a(this),f=e.parent("li"),g=f.children("ul");return d.preventDefault(),f.hasClass(c)?b.hide(g):b.show(g),b.options.doubleTapToGo&&b.doubleTapToGo(e)&&"#"!==e.attr("href")&&""!==e.attr("href")?(d.stopPropagation(),void(document.location=e.attr("href"))):void 0})},e.prototype.doubleTapToGo=function(a){var b=this.$element;return a.hasClass("doubleTapToGo")?(a.removeClass("doubleTapToGo"),!0):a.parent().children("ul").length?(b.find(".doubleTapToGo").removeClass("doubleTapToGo"),a.addClass("doubleTapToGo"),!1):void 0},e.prototype.show=function(b){var c=this.options.activeClass,f=a(b),g=f.parent("li");if(!this.transitioning&&!f.hasClass("in")){g.addClass(c),this.options.toggle&&this.hide(g.siblings().children("ul.in")),f.removeClass("collapse").addClass("collapsing").height(0),this.transitioning=1;var h=function(){f.removeClass("collapsing").addClass("collapse in").height(""),this.transitioning=0};return d?void f.one("mmTransitionEnd",a.proxy(h,this)).emulateTransitionEnd(e.TRANSITION_DURATION).height(f[0].scrollHeight):h.call(this)}},e.prototype.hide=function(b){var c=this.options.activeClass,f=a(b);if(!this.transitioning&&f.hasClass("in")){f.parent("li").removeClass(c),f.height(f.height())[0].offsetHeight,f.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var g=function(){this.transitioning=0,f.removeClass("collapsing").addClass("collapse")};return d?void f.height(0).one("mmTransitionEnd",a.proxy(g,this)).emulateTransitionEnd(e.TRANSITION_DURATION):g.call(this)}};var f=a.fn.metisMenu;a.fn.metisMenu=c,a.fn.metisMenu.Constructor=e,a.fn.metisMenu.noConflict=function(){return a.fn.metisMenu=f,this}}(jQuery),function(e){e.fn.extend({slimScroll:function(g){var a=e.extend({width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px"},g);return this.each(function(){function v(d){if(r){d=d||window.event;var c=0;d.wheelDelta&&(c=-d.wheelDelta/120),d.detail&&(c=d.detail/3),e(d.target||d.srcTarget||d.srcElement).closest("."+a.wrapperClass).is(b.parent())&&m(c,!0),d.preventDefault&&!k&&d.preventDefault(),k||(d.returnValue=!1)}}function m(d,e,g){k=!1;var f=d,h=b.outerHeight()-c.outerHeight();e&&(f=parseInt(c.css("top"))+d*parseInt(a.wheelStep)/100*c.outerHeight(),f=Math.min(Math.max(f,0),h),f=0<d?Math.ceil(f):Math.floor(f),c.css({top:f+"px"})),l=parseInt(c.css("top"))/(b.outerHeight()-c.outerHeight()),f=l*(b[0].scrollHeight-b.outerHeight()),g&&(f=d,d=f/b[0].scrollHeight*b.outerHeight(),d=Math.min(Math.max(d,0),h),c.css({top:d+"px"})),b.scrollTop(f),b.trigger("slimscrolling",~~f),w(),p()}function x(){u=Math.max(b.outerHeight()/b[0].scrollHeight*b.outerHeight(),30),c.css({height:u+"px"});var a=u==b.outerHeight()?"none":"block";c.css({display:a})}function w(){x(),clearTimeout(B),l==~~l?(k=a.allowPageScroll,C!=l&&b.trigger("slimscroll",0==~~l?"top":"bottom")):k=!1,C=l,u>=b.outerHeight()?k=!0:(c.stop(!0,!0).fadeIn("fast"),a.railVisible&&h.stop(!0,!0).fadeIn("fast"))}function p(){a.alwaysVisible||(B=setTimeout(function(){a.disableFadeOut&&r||y||z||(c.fadeOut("slow"),h.fadeOut("slow"))},1e3))}var r,y,z,B,A,u,l,C,k=!1,b=e(this);if(b.parent().hasClass(a.wrapperClass)){var n=b.scrollTop(),c=b.closest("."+a.barClass),h=b.closest("."+a.railClass);if(x(),e.isPlainObject(g)){if("height"in g&&"auto"==g.height){b.parent().css("height","auto"),b.css("height","auto");var q=b.parent().parent().height();b.parent().css("height",q),b.css("height",q)}if("scrollTo"in g)n=parseInt(a.scrollTo);else if("scrollBy"in g)n+=parseInt(a.scrollBy);else if("destroy"in g)return c.remove(),h.remove(),void b.unwrap();m(n,!1,!0)}}else if(!(e.isPlainObject(g)&&"destroy"in g)){a.height="auto"==a.height?b.parent().height():a.height,n=e("<div></div>").addClass(a.wrapperClass).css({position:"relative",overflow:"hidden",width:a.width,height:a.height}),b.css({overflow:"hidden",width:a.width,height:a.height});var h=e("<div></div>").addClass(a.railClass).css({width:a.size,height:"100%",position:"absolute",top:0,display:a.alwaysVisible&&a.railVisible?"block":"none","border-radius":a.railBorderRadius,background:a.railColor,opacity:a.railOpacity,zIndex:90}),c=e("<div></div>").addClass(a.barClass).css({background:a.color,width:a.size,position:"absolute",top:0,opacity:a.opacity,display:a.alwaysVisible?"block":"none","border-radius":a.borderRadius,BorderRadius:a.borderRadius,MozBorderRadius:a.borderRadius,WebkitBorderRadius:a.borderRadius,zIndex:99}),q="right"==a.position?{right:a.distance}:{left:a.distance};h.css(q),c.css(q),b.wrap(n),b.parent().append(c),b.parent().append(h),a.railDraggable&&c.bind("mousedown",function(a){var b=e(document);return z=!0,t=parseFloat(c.css("top")),pageY=a.pageY,b.bind("mousemove.slimscroll",function(a){currTop=t+a.pageY-pageY,c.css("top",currTop),m(0,c.position().top,!1)}),b.bind("mouseup.slimscroll",function(a){z=!1,p(),b.unbind(".slimscroll")}),!1}).bind("selectstart.slimscroll",function(a){return a.stopPropagation(),a.preventDefault(),!1}),h.hover(function(){w()},function(){p()}),c.hover(function(){y=!0},function(){y=!1}),b.hover(function(){r=!0,w(),p()},function(){r=!1,p()}),b.bind("touchstart",function(a,b){a.originalEvent.touches.length&&(A=a.originalEvent.touches[0].pageY)}),b.bind("touchmove",function(b){k||b.originalEvent.preventDefault(),b.originalEvent.touches.length&&(m((A-b.originalEvent.touches[0].pageY)/a.touchScrollStep,!0),A=b.originalEvent.touches[0].pageY)}),x(),"bottom"===a.start?(c.css({top:b.outerHeight()-c.outerHeight()}),m(0,!0)):"top"!==a.start&&(m(e(a.start).position().top,null,!0),a.alwaysVisible||c.hide()),window.addEventListener?(this.addEventListener("DOMMouseScroll",v,!1),this.addEventListener("mousewheel",v,!1)):document.attachEvent("onmousewheel",v)}}),this}}),e.fn.extend({slimscroll:e.fn.slimScroll})}(jQuery),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X=[].slice,Y={}.hasOwnProperty,Z=function(a,b){function c(){this.constructor=a}for(var d in b)Y.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},$=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};for(u={catchupTime:100,initialRate:.03,minTime:250,ghostTime:100,maxProgressPerFrame:20,easeFactor:1.25,startOnPageLoad:!0,restartOnPushState:!0,restartOnRequestAfter:500,target:"body",elements:{checkInterval:100,selectors:["body"]},eventLag:{minSamples:10,sampleCount:3,lagThreshold:3},ajax:{trackMethods:["GET"],trackWebSockets:!0,ignoreURLs:[]}},C=function(){var a;return null!=(a="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance.now():void 0)?a:+new Date},E=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,t=window.cancelAnimationFrame||window.mozCancelAnimationFrame,null==E&&(E=function(a){return setTimeout(a,50)},t=function(a){return clearTimeout(a)}),G=function(a){var b,c;return b=C(),(c=function(){var d;return d=C()-b,d>=33?(b=C(),a(d,function(){return E(c)})):setTimeout(c,33-d)})()},F=function(){var a,b,c;return c=arguments[0],b=arguments[1],a=3<=arguments.length?X.call(arguments,2):[],"function"==typeof c[b]?c[b].apply(c,a):c[b]},v=function(){var a,b,c,d,e,f,g;for(b=arguments[0],d=2<=arguments.length?X.call(arguments,1):[],f=0,g=d.length;g>f;f++)if(c=d[f])for(a in c)Y.call(c,a)&&(e=c[a],null!=b[a]&&"object"==typeof b[a]&&null!=e&&"object"==typeof e?v(b[a],e):b[a]=e);return b},q=function(a){var b,c,d,e,f;for(c=b=0,e=0,f=a.length;f>e;e++)d=a[e],c+=Math.abs(d),b++;return c/b},x=function(a,b){var c,d,e;if(null==a&&(a="options"),null==b&&(b=!0),e=document.querySelector("[data-pace-"+a+"]")){if(c=e.getAttribute("data-pace-"+a),!b)return c;try{return JSON.parse(c)}catch(f){return d=f,"undefined"!=typeof console&&null!==console?console.error("Error parsing inline pace options",d):void 0}}},g=function(){function a(){}return a.prototype.on=function(a,b,c,d){var e;return null==d&&(d=!1),null==this.bindings&&(this.bindings={}),null==(e=this.bindings)[a]&&(e[a]=[]),this.bindings[a].push({handler:b,ctx:c,once:d})},a.prototype.once=function(a,b,c){return this.on(a,b,c,!0)},a.prototype.off=function(a,b){var c,d,e;if(null!=(null!=(d=this.bindings)?d[a]:void 0)){if(null==b)return delete this.bindings[a];for(c=0,e=[];c<this.bindings[a].length;)e.push(this.bindings[a][c].handler===b?this.bindings[a].splice(c,1):c++);return e}},a.prototype.trigger=function(){var a,b,c,d,e,f,g,h,i;if(c=arguments[0],a=2<=arguments.length?X.call(arguments,1):[],null!=(g=this.bindings)?g[c]:void 0){for(e=0,i=[];e<this.bindings[c].length;)h=this.bindings[c][e],d=h.handler,b=h.ctx,f=h.once,d.apply(null!=b?b:this,a),i.push(f?this.bindings[c].splice(e,1):e++);return i}},a}(),j=window.Pace||{},window.Pace=j,v(j,g.prototype),D=j.options=v({},u,window.paceOptions,x()),U=["ajax","document","eventLag","elements"],Q=0,S=U.length;S>Q;Q++)K=U[Q],!0===D[K]&&(D[K]=u[K]);i=function(a){function b(){return V=b.__super__.constructor.apply(this,arguments)}return Z(b,a),b}(Error),b=function(){function a(){this.progress=0}return a.prototype.getElement=function(){var a;if(null==this.el){if(!(a=document.querySelector(D.target)))throw new i;this.el=document.createElement("div"),this.el.className="pace pace-active",document.body.className=document.body.className.replace(/pace-done/g,""),document.body.className+=" pace-running",this.el.innerHTML='<div class="pace-progress">\n  <div class="pace-progress-inner"></div>\n</div>\n<div class="pace-activity"></div>',null!=a.firstChild?a.insertBefore(this.el,a.firstChild):a.appendChild(this.el)}return this.el},a.prototype.finish=function(){var a;return a=this.getElement(),a.className=a.className.replace("pace-active",""),a.className+=" pace-inactive",document.body.className=document.body.className.replace("pace-running",""),document.body.className+=" pace-done"},a.prototype.update=function(a){return this.progress=a,this.render()},a.prototype.destroy=function(){try{this.getElement().parentNode.removeChild(this.getElement())}catch(a){i=a}return this.el=void 0},a.prototype.render=function(){var a,b,c,d,e,f,g;if(null==document.querySelector(D.target))return!1;for(a=this.getElement(),d="translate3d("+this.progress+"%, 0, 0)",g=["webkitTransform","msTransform","transform"],e=0,f=g.length;f>e;e++)b=g[e],a.children[0].style[b]=d;return(!this.lastRenderedProgress||this.lastRenderedProgress|0!==this.progress|0)&&(a.children[0].setAttribute("data-progress-text",(0|this.progress)+"%"),this.progress>=100?c="99":(c=this.progress<10?"0":"",c+=0|this.progress),a.children[0].setAttribute("data-progress",""+c)),this.lastRenderedProgress=this.progress},a.prototype.done=function(){return this.progress>=100},a}(),h=function(){function a(){this.bindings={}}return a.prototype.trigger=function(a,b){var c,d,e,f,g;if(null!=this.bindings[a]){for(f=this.bindings[a],g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(c.call(this,b));return g}},a.prototype.on=function(a,b){var c;return null==(c=this.bindings)[a]&&(c[a]=[]),this.bindings[a].push(b)},a}(),P=window.XMLHttpRequest,O=window.XDomainRequest,N=window.WebSocket,w=function(a,b){var d,e,f;f=[];for(d in b.prototype)try{e=b.prototype[d],f.push(null==a[d]&&"function"!=typeof e?a[d]=e:void 0)}catch(g){g}return f},A=[],j.ignore=function(){var a,b,c;return b=arguments[0],a=2<=arguments.length?X.call(arguments,1):[],A.unshift("ignore"),c=b.apply(null,a),A.shift(),c},j.track=function(){var a,b,c;return b=arguments[0],a=2<=arguments.length?X.call(arguments,1):[],A.unshift("track"),c=b.apply(null,a),A.shift(),c},J=function(a){var b;if(null==a&&(a="GET"),"track"===A[0])return"force";if(!A.length&&D.ajax){if("socket"===a&&D.ajax.trackWebSockets)return!0;if(b=a.toUpperCase(),$.call(D.ajax.trackMethods,b)>=0)return!0}return!1},k=function(a){function b(){var a,c=this;b.__super__.constructor.apply(this,arguments),a=function(a){var b;return b=a.open,a.open=function(d,e){return J(d)&&c.trigger("request",{type:d,url:e,request:a}),b.apply(a,arguments)}},window.XMLHttpRequest=function(b){var c;return c=new P(b),a(c),c};try{w(window.XMLHttpRequest,P)}catch(d){}if(null!=O){window.XDomainRequest=function(){var b;return b=new O,a(b),b};try{w(window.XDomainRequest,O)}catch(d){}}if(null!=N&&D.ajax.trackWebSockets){window.WebSocket=function(a,b){var d;return d=null!=b?new N(a,b):new N(a),J("socket")&&c.trigger("request",{type:"socket",url:a,protocols:b,request:d}),d};try{w(window.WebSocket,N)}catch(d){}}}return Z(b,a),b}(h),R=null,y=function(){return null==R&&(R=new k),R},I=function(a){var b,c,d,e;for(e=D.ajax.ignoreURLs,c=0,d=e.length;d>c;c++)if("string"==typeof(b=e[c])){if(-1!==a.indexOf(b))return!0}else if(b.test(a))return!0;return!1},y().on("request",function(b){var c,d,e,f,g;return f=b.type,e=b.request,g=b.url,I(g)?void 0:j.running||!1===D.restartOnRequestAfter&&"force"!==J(f)?void 0:(d=arguments,c=D.restartOnRequestAfter||0,"boolean"==typeof c&&(c=0),setTimeout(function(){var c,g,h,i,k;if("socket"===f?e.readyState<2:0<(h=e.readyState)&&4>h){for(j.restart(),i=j.sources,k=[],c=0,g=i.length;g>c;c++){if((K=i[c])instanceof a){K.watch.apply(K,d);break}k.push(void 0)}return k}},c))}),a=function(){function a(){var a=this;this.elements=[],y().on("request",function(){return a.watch.apply(a,arguments)})}return a.prototype.watch=function(a){var b,c,d,e;return d=a.type,b=a.request,e=a.url,I(e)?void 0:(c="socket"===d?new n(b):new o(b),this.elements.push(c))},a}(),o=function(){function a(a){var b,d,e,f,g,h=this;if(this.progress=0,null!=window.ProgressEvent)for(null,a.addEventListener("progress",function(a){return h.progress=a.lengthComputable?100*a.loaded/a.total:h.progress+(100-h.progress)/2},!1),g=["load","abort","timeout","error"],d=0,e=g.length;e>d;d++)b=g[d],a.addEventListener(b,function(){return h.progress=100},!1);else f=a.onreadystatechange,a.onreadystatechange=function(){var b;return 0===(b=a.readyState)||4===b?h.progress=100:3===a.readyState&&(h.progress=50),"function"==typeof f?f.apply(null,arguments):void 0}}return a}(),n=function(){function a(a){var b,c,d,e,f=this;for(this.progress=0,e=["error","open"],c=0,d=e.length;d>c;c++)b=e[c],a.addEventListener(b,function(){return f.progress=100},!1)}return a}(),d=function(){function a(a){var b,c,d,f;for(null==a&&(a={}),this.elements=[],null==a.selectors&&(a.selectors=[]),f=a.selectors,c=0,d=f.length;d>c;c++)b=f[c],this.elements.push(new e(b))}return a}(),e=function(){function a(a){this.selector=a,this.progress=0,this.check()}return a.prototype.check=function(){var a=this;return document.querySelector(this.selector)?this.done():setTimeout(function(){return a.check()},D.elements.checkInterval)},a.prototype.done=function(){return this.progress=100},a}(),c=function(){function a(){var a,b,c=this;this.progress=null!=(b=this.states[document.readyState])?b:100,a=document.onreadystatechange,document.onreadystatechange=function(){return null!=c.states[document.readyState]&&(c.progress=c.states[document.readyState]),"function"==typeof a?a.apply(null,arguments):void 0}}return a.prototype.states={loading:0,interactive:50,complete:100},a}(),f=function(){function a(){var a,b,c,d,e,f=this;this.progress=0,a=0,e=[],d=0,c=C(),b=setInterval(function(){var g;return g=C()-c-50,c=C(),e.push(g),e.length>D.eventLag.sampleCount&&e.shift(),a=q(e),++d>=D.eventLag.minSamples&&a<D.eventLag.lagThreshold?(f.progress=100,clearInterval(b)):f.progress=3/(a+3)*100},50)}return a}(),m=function(){function a(a){this.source=a,this.last=this.sinceLastUpdate=0,this.rate=D.initialRate,this.catchup=0,this.progress=this.lastProgress=0,null!=this.source&&(this.progress=F(this.source,"progress"))}return a.prototype.tick=function(a,b){var c;return null==b&&(b=F(this.source,"progress")),b>=100&&(this.done=!0),b===this.last?this.sinceLastUpdate+=a:(this.sinceLastUpdate&&(this.rate=(b-this.last)/this.sinceLastUpdate),this.catchup=(b-this.progress)/D.catchupTime,this.sinceLastUpdate=0,this.last=b),b>this.progress&&(this.progress+=this.catchup*a),c=1-Math.pow(this.progress/100,D.easeFactor),this.progress+=c*this.rate*a,this.progress=Math.min(this.lastProgress+D.maxProgressPerFrame,this.progress),this.progress=Math.max(0,this.progress),this.progress=Math.min(100,this.progress),this.lastProgress=this.progress,this.progress},a}(),L=null,H=null,r=null,M=null,p=null,s=null,j.running=!1,z=function(){return D.restartOnPushState?j.restart():void 0},null!=window.history.pushState&&(T=window.history.pushState,window.history.pushState=function(){return z(),T.apply(window.history,arguments)}),null!=window.history.replaceState&&(W=window.history.replaceState,window.history.replaceState=function(){return z(),W.apply(window.history,arguments)}),l={ajax:a,elements:d,document:c,eventLag:f},(B=function(){var a,c,d,e,f,g,h,i;for(j.sources=L=[],g=["ajax","elements","document","eventLag"],c=0,e=g.length;e>c;c++)a=g[c],!1!==D[a]&&L.push(new l[a](D[a]));for(i=null!=(h=D.extraSources)?h:[],d=0,f=i.length;f>d;d++)K=i[d],L.push(new K(D));return j.bar=r=new b,H=[],M=new m})(),j.stop=function(){return j.trigger("stop"),j.running=!1,r.destroy(),s=!0,null!=p&&("function"==typeof t&&t(p),p=null),B()},j.restart=function(){return j.trigger("restart"),j.stop(),j.start()},j.go=function(){var a;return j.running=!0,r.render(),a=C(),s=!1,p=G(function(b,c){var d,e,f,g,h,i,k,n,o,p,q,t,u,v,w;for(100-r.progress,e=p=0,f=!0,i=q=0,u=L.length;u>q;i=++q)for(K=L[i],o=null!=H[i]?H[i]:H[i]=[],h=null!=(w=K.elements)?w:[K],k=t=0,v=h.length;v>t;k=++t)g=h[k],n=null!=o[k]?o[k]:o[k]=new m(g),f&=n.done,n.done||(e++,p+=n.tick(b));return d=p/e,r.update(M.tick(b,d)),r.done()||f||s?(r.update(100),j.trigger("done"),setTimeout(function(){return r.finish(),j.running=!1,j.trigger("hide")},Math.max(D.ghostTime,Math.max(D.minTime-(C()-a),0)))):c()})},j.start=function(a){v(D,a),j.running=!0;try{r.render()}catch(b){i=b}return document.querySelector(".pace")?(j.trigger("start"),j.go()):setTimeout(j.start,50)},"function"==typeof define&&define.amd?define(function(){return j
}):"object"==typeof exports?module.exports=j:D.startOnPageLoad&&j.start()}.call(this),$(document).ready(function(){function fix_height(){var heightWithoutNavbar=$("body > #wrapper").height()-61;$(".sidebard-panel").css("min-height",heightWithoutNavbar+"px");var navbarHeigh=$("nav.navbar-default").height(),wrapperHeigh=$("#page-wrapper").height();navbarHeigh>wrapperHeigh&&$("#page-wrapper").css("min-height",navbarHeigh-61+"px"),navbarHeigh<wrapperHeigh&&$("#page-wrapper").css("min-height",$(window).height()-61+"px"),$("body").hasClass("fixed-nav")&&(navbarHeigh>wrapperHeigh?$("#page-wrapper").css("min-height",navbarHeigh-61+"px"):$("#page-wrapper").css("min-height",$(window).height()-60-61+"px"))}$(window).bind("load resize scroll",function(){$("body").hasClass("body-small")||fix_height()}),$(window).scroll(function(){$(window).scrollTop()>0&&!$("body").hasClass("fixed-nav")?$("#right-sidebar").addClass("sidebar-top"):$("#right-sidebar").removeClass("sidebar-top")}),setTimeout(function(){fix_height()},1e3),$(function(){$(window).bind("load resize",function(){$(document).width()<769?$("body").addClass("body-small"):$("body").removeClass("body-small")})}),$(function(){var close=window.swal.close;window.swal.close=function(){close(),window.onkeydown=null}})}),function(A,e,B){"use strict";function C(a){var c=[];return v(c,e.noop).chars(a),c.join("")}function h(a,c){var l,b={},d=a.split(",");for(l=0;l<d.length;l++)b[c?e.lowercase(d[l]):d[l]]=!0;return b}function D(a,c){null===a||a===B?a="":"string"!=typeof a&&(a=""+a),g.innerHTML=a;var b=5;do{if(0===b)throw w("uinput");b--,11>=document.documentMode&&n(g),a=g.innerHTML,g.innerHTML=a}while(a!==g.innerHTML);for(b=g.firstChild;b;){switch(b.nodeType){case 1:c.start(b.nodeName.toLowerCase(),E(b.attributes));break;case 3:c.chars(b.textContent)}var d;if(!((d=b.firstChild)||(1==b.nodeType&&c.end(b.nodeName.toLowerCase()),d=b.nextSibling)))for(;null==d&&(b=b.parentNode)!==g;)d=b.nextSibling,1==b.nodeType&&c.end(b.nodeName.toLowerCase());b=d}for(;b=g.firstChild;)g.removeChild(b)}function E(a){for(var c={},b=0,d=a.length;b<d;b++){var l=a[b];c[l.name]=l.value}return c}function x(a){return a.replace(/&/g,"&amp;").replace(F,function(a){var b=a.charCodeAt(0);return a=a.charCodeAt(1),"&#"+(1024*(b-55296)+(a-56320)+65536)+";"}).replace(G,function(a){return"&#"+a.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function v(a,c){var b=!1,d=e.bind(a,a.push);return{start:function(a,f){a=e.lowercase(a),!b&&H[a]&&(b=a),b||!0!==t[a]||(d("<"),d(a),e.forEach(f,function(b,f){var g=e.lowercase(f),h="img"===a&&"src"===g||"background"===g;!0!==I[g]||!0===y[g]&&!c(b,h)||(d(" "),d(f),d('="'),d(x(b)),d('"'))}),d(">"))},end:function(a){a=e.lowercase(a),b||!0!==t[a]||!0===z[a]||(d("</"),d(a),d(">")),a==b&&(b=!1)},chars:function(a){b||d(x(a))}}}function n(a){if(a.nodeType===Node.ELEMENT_NODE)for(var c=a.attributes,b=0,d=c.length;b<d;b++){var e=c[b],f=e.name.toLowerCase();"xmlns:ns1"!==f&&0!==f.indexOf("ns1:")||(a.removeAttributeNode(e),b--,d--)}(c=a.firstChild)&&n(c),(c=a.nextSibling)&&n(c)}var g,w=e.$$minErr("$sanitize"),F=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,G=/([^\#-~ |!])/g,z=h("area,br,col,hr,img,wbr"),q=h("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),k=h("rp,rt"),u=e.extend({},k,q),q=e.extend({},q,h("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,section,table,ul")),k=e.extend({},k,h("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),J=h("circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,stop,svg,switch,text,title,tspan"),H=h("script,style"),t=e.extend({},z,q,k,u),y=h("background,cite,href,longdesc,src,xlink:href"),u=h("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,tabindex,target,title,type,valign,value,vspace,width"),k=h("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan",!0),I=e.extend({},y,k,u);!function(a){if(!a.document||!a.document.implementation)throw w("noinert");a=a.document.implementation.createHTMLDocument("inert");var c=(a.documentElement||a.getDocumentElement()).getElementsByTagName("body");1===c.length?g=c[0]:(c=a.createElement("html"),g=a.createElement("body"),c.appendChild(g),a.appendChild(c))}(A),e.module("ngSanitize",[]).provider("$sanitize",function(){var a=!1;this.$get=["$$sanitizeUri",function(c){return a&&e.extend(t,J),function(a){var d=[];return D(a,v(d,function(a,b){return!/^unsafe:/.test(c(a,b))})),d.join("")}}],this.enableSvg=function(c){return e.isDefined(c)?(a=c,this):a}}),e.module("ngSanitize").filter("linky",["$sanitize",function(a){var c=/((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"\u201d\u2019]/i,b=/^mailto:/i,d=e.$$minErr("linky"),g=e.isString;return function(f,h,m){function k(a){a&&p.push(C(a))}function q(a,b){var c;if(p.push("<a "),e.isFunction(m)&&(m=m(a)),e.isObject(m))for(c in m)p.push(c+'="'+m[c]+'" ');else m={};!e.isDefined(h)||"target"in m||p.push('target="',h,'" '),p.push('href="',a.replace(/"/g,"&quot;"),'">'),k(b),p.push("</a>")}if(null==f||""===f)return f;if(!g(f))throw d("notstring",f);for(var s,n,r=f,p=[];f=r.match(c);)s=f[0],f[2]||f[4]||(s=(f[3]?"http://":"mailto:")+s),n=f.index,k(r.substr(0,n)),q(s,f[0].replace(b,"")),r=r.substring(n+f[0].length);return k(r),a(p.join(""))}}])}(window,window.angular),function(){"use strict";function e(e){var n=[];return angular.forEach(e.requires,function(e){-1===l.indexOf(e)&&n.push(e)}),n}function n(e){try{return angular.module(e)}catch(n){if(/No module/.test(n)||n.message.indexOf("$injector:nomod")>-1)return!1}}function r(e){try{return angular.module(e)}catch(n){throw(/No module/.test(n)||n.message.indexOf("$injector:nomod")>-1)&&(n.message='The module "'+e+'" that you are trying to load does not exist. '+n.message),n}}function a(e,n,r,a){if(n){var t,i,u,l;for(t=0,i=n.length;i>t;t++)if(u=n[t],angular.isArray(u)){if(null!==e){if(!e.hasOwnProperty(u[0]))throw new Error("unsupported provider "+u[0]);l=e[u[0]]}var s=o(u,r);if("invoke"!==u[1])s&&angular.isDefined(l)&&l[u[1]].apply(l,u[2]);else{var f=function(e){var n=c.indexOf(r+"-"+e);(-1===n||a)&&(-1===n&&c.push(r+"-"+e),angular.isDefined(l)&&l[u[1]].apply(l,u[2]))};if(angular.isFunction(u[2][0]))f(u[2][0]);else if(angular.isArray(u[2][0]))for(var d=0,g=u[2][0].length;g>d;d++)angular.isFunction(u[2][0][d])&&f(u[2][0][d])}}}}function t(e,n,r){if(n){var o,u,s,f=[];for(o=n.length-1;o>=0;o--)if(u=n[o],"string"!=typeof u&&(u=i(u)),u&&-1===d.indexOf(u)){var c=-1===l.indexOf(u);if(s=angular.module(u),c&&(l.push(u),t(e,s.requires,r)),s._runBlocks.length>0)for(g[u]=[];s._runBlocks.length>0;)g[u].push(s._runBlocks.shift());angular.isDefined(g[u])&&(c||r.rerun)&&(f=f.concat(g[u])),a(e,s._invokeQueue,u,r.reconfig),a(e,s._configBlocks,u,r.reconfig),p(c?"ocLazyLoad.moduleLoaded":"ocLazyLoad.moduleReloaded",u),n.pop(),d.push(u)}var h=e.getInstanceInjector();angular.forEach(f,function(e){h.invoke(e)})}}function o(e,n){var r=e[2][0],a=e[1],t=!1;angular.isUndefined(f[n])&&(f[n]={}),angular.isUndefined(f[n][a])&&(f[n][a]=[]);var o=function(e){t=!0,f[n][a].push(e),p("ocLazyLoad.componentLoaded",[n,a,e])};if(angular.isString(r)&&-1===f[n][a].indexOf(r))o(r);else{if(!angular.isObject(r))return!1;angular.forEach(r,function(e){angular.isString(e)&&-1===f[n][a].indexOf(e)&&o(e)})}return t}function i(e){var n=null;return angular.isString(e)?n=e:angular.isObject(e)&&e.hasOwnProperty("name")&&angular.isString(e.name)&&(n=e.name),n}function u(e){if(0===s.length){var n=[e],r=["ng:app","ng-app","x-ng-app","data-ng-app"],t=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/,o=function(e){return e&&n.push(e)};angular.forEach(r,function(n){r[n]=!0,o(document.getElementById(n)),n=n.replace(":","\\:"),e[0].querySelectorAll&&(angular.forEach(e[0].querySelectorAll("."+n),o),angular.forEach(e[0].querySelectorAll("."+n+"\\:"),o),angular.forEach(e[0].querySelectorAll("["+n+"]"),o))}),angular.forEach(n,function(n){if(0===s.length){var a=" "+e.className+" ",o=t.exec(a);o?s.push((o[2]||"").replace(/\s+/g,",")):angular.forEach(n.attributes,function(e){0===s.length&&r[e.name]&&s.push(e.value)})}})}if(0===s.length)throw"No module found during bootstrap, unable to init ocLazyLoad";var i=function u(e){if(-1===l.indexOf(e)){l.push(e);var n=angular.module(e);a(null,n._invokeQueue,e),a(null,n._configBlocks,e),angular.forEach(n.requires,u)}};angular.forEach(s,function(e){i(e)})}var l=["ng"],s=[],f={},c=[],d=[],g={},h=angular.module("oc.lazyLoad",["ng"]),p=angular.noop;h.provider("$ocLazyLoad",["$controllerProvider","$provide","$compileProvider","$filterProvider","$injector","$animateProvider",function(a,o,s,f,c,g){var h,m,v,y={},L={$controllerProvider:a,$compileProvider:s,$filterProvider:f,$provide:o,$injector:c,$animateProvider:g},w=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0],O=!1,j=!1;u(angular.element(window.document)),this.$get=["$log","$q","$templateCache","$http","$rootElement","$rootScope","$cacheFactory","$interval",function(a,o,u,s,f,c,g,E){var $,x=g("ocLazyLoad"),b=!1,z=!1;O||(a={},a.error=angular.noop,a.warn=angular.noop,a.info=angular.noop),L.getInstanceInjector=function(){return $||($=f.data("$injector")||angular.injector())},p=function(e,n){j&&c.$broadcast(e,n),O&&a.info(e,n)};var P=function(e,n,r){var a,t,i=o.defer(),u=function(e){var n=(new Date).getTime();return e.indexOf("?")>=0?"&"===e.substring(0,e.length-1)?e+"_dc="+n:e+"&_dc="+n:e+"?_dc="+n};switch(angular.isUndefined(x.get(n))&&x.put(n,i.promise),e){case"css":a=document.createElement("link"),a.type="text/css",a.rel="stylesheet",a.href=!1===r.cache?u(n):n;break;case"js":a=document.createElement("script"),a.src=!1===r.cache?u(n):n;break;default:i.reject(new Error('Requested type "'+e+'" is not known. Could not inject "'+n+'"'))}a.onload=a.onreadystatechange=function(){a.readyState&&!/^c|loade/.test(a.readyState)||t||(a.onload=a.onreadystatechange=null,t=1,p("ocLazyLoad.fileLoaded",n),i.resolve())},a.onerror=function(){i.reject(new Error("Unable to load "+n))},a.async=r.serie?0:1;var l=w.lastChild;if(r.insertBefore){var s=angular.element(r.insertBefore);s&&s.length>0&&(l=s[0])}if(w.insertBefore(a,l),"css"==e){if(!b){var f=navigator.userAgent.toLowerCase();if(/iP(hone|od|ad)/.test(navigator.platform)){var c=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),d=parseFloat([parseInt(c[1],10),parseInt(c[2],10),parseInt(c[3]||0,10)].join("."));z=6>d}else if(f.indexOf("android")>-1){var g=parseFloat(f.slice(f.indexOf("android")+8));z=4.4>g}else if(f.indexOf("safari")>-1&&-1==f.indexOf("chrome")){var h=parseFloat(f.match(/version\/([\.\d]+)/i)[1]);z=6>h}}if(z)var m=1e3,v=E(function(){try{a.sheet.cssRules,E.cancel(v),a.onload()}catch(e){--m<=0&&a.onerror()}},20)}return i.promise};angular.isUndefined(h)&&(h=function(e,n,r){var a=[];angular.forEach(e,function(e){a.push(P("js",e,r))}),o.all(a).then(function(){n()},function(e){n(e)})},h.ocLazyLoadLoader=!0),angular.isUndefined(m)&&(m=function(e,n,r){var a=[];angular.forEach(e,function(e){a.push(P("css",e,r))}),o.all(a).then(function(){n()},function(e){n(e)})},m.ocLazyLoadLoader=!0),angular.isUndefined(v)&&(v=function(e,n,r){var a=[];return angular.forEach(e,function(e){var n=o.defer();a.push(n.promise),s.get(e,r).success(function(r){angular.isString(r)&&r.length>0&&angular.forEach(angular.element(r),function(e){"SCRIPT"===e.nodeName&&"text/ng-template"===e.type&&u.put(e.id,e.innerHTML)}),angular.isUndefined(x.get(e))&&x.put(e,!0),n.resolve()}).error(function(r){n.reject(new Error('Unable to load template file "'+e+'": '+r))})}),o.all(a).then(function(){n()},function(e){n(e)})},v.ocLazyLoadLoader=!0);var D=function(e,n){var r=[],t=[],i=[],u=[],l=null;angular.extend(n||{},e);var s=function(e){l=x.get(e),angular.isUndefined(l)||!1===n.cache?/\.(css|less)[^\.]*$/.test(e)&&-1===r.indexOf(e)?r.push(e):/\.(htm|html)[^\.]*$/.test(e)&&-1===t.indexOf(e)?t.push(e):-1===i.indexOf(e)&&i.push(e):l&&u.push(l)};if(n.serie?s(n.files.shift()):angular.forEach(n.files,function(e){s(e)}),r.length>0){var f=o.defer();m(r,function(e){angular.isDefined(e)&&m.hasOwnProperty("ocLazyLoadLoader")?(a.error(e),f.reject(e)):f.resolve()},n),u.push(f.promise)}if(t.length>0){var c=o.defer();v(t,function(e){angular.isDefined(e)&&v.hasOwnProperty("ocLazyLoadLoader")?(a.error(e),c.reject(e)):c.resolve()},n),u.push(c.promise)}if(i.length>0){var d=o.defer();h(i,function(e){angular.isDefined(e)&&h.hasOwnProperty("ocLazyLoadLoader")?(a.error(e),d.reject(e)):d.resolve()},n),u.push(d.promise)}return n.serie&&n.files.length>0?o.all(u).then(function(){return D(e,n)}):o.all(u)};return{getModuleConfig:function(e){if(!angular.isString(e))throw new Error("You need to give the name of the module to get");return y[e]?y[e]:null},setModuleConfig:function(e){if(!angular.isObject(e))throw new Error("You need to give the module config object to set");return y[e.name]=e,e},getModules:function(){return l},isLoaded:function(e){var r=function(e){var r=l.indexOf(e)>-1;return r||(r=!!n(e)),r};if(angular.isString(e)&&(e=[e]),angular.isArray(e)){var a,t;for(a=0,t=e.length;t>a;a++)if(!r(e[a]))return!1;return!0}throw new Error("You need to define the module(s) name(s)")},load:function(u,s){var f,c,g=this,h=null,p=[],m=[],v=o.defer();if(angular.isUndefined(s)&&(s={}),angular.isArray(u))return angular.forEach(u,function(e){e&&m.push(g.load(e,s))}),o.all(m).then(function(){v.resolve(u)},function(e){v.reject(e)}),v.promise;if(f=i(u),"string"==typeof u?(h=g.getModuleConfig(u))||(h={files:[u]},f=null):"object"==typeof u&&(h=g.setModuleConfig(u)),null===h?(c='Module "'+f+'" is not configured, cannot load.',a.error(c),v.reject(new Error(c))):angular.isDefined(h.template)&&(angular.isUndefined(h.files)&&(h.files=[]),angular.isString(h.template)?h.files.push(h.template):angular.isArray(h.template)&&h.files.concat(h.template)),p.push=function(e){-1===this.indexOf(e)&&Array.prototype.push.apply(this,arguments)},angular.isDefined(f)&&n(f)&&-1!==l.indexOf(f)&&(p.push(f),angular.isUndefined(h.files)))return v.resolve(),v.promise;var y={};angular.extend(y,s,h);var w=function O(t){var u,l,s,f,c=[];if(null===(u=i(t)))return o.when();try{l=r(u)}catch(d){var h=o.defer();return a.error(d.message),h.reject(d),h.promise}return s=e(l),angular.forEach(s,function(e){if("string"==typeof e){var r=g.getModuleConfig(e);if(null===r)return void p.push(e);e=r}return n(e.name)?void("string"!=typeof t&&(f=e.files.filter(function(n){return g.getModuleConfig(e.name).files.indexOf(n)<0}),0!==f.length&&a.warn('Module "',u,'" attempted to redefine configuration for dependency. "',e.name,'"\n Additional Files Loaded:',f),c.push(D(e.files,y).then(function(){return O(e)})))):("object"==typeof e&&(e.hasOwnProperty("name")&&e.name&&(g.setModuleConfig(e),p.push(e.name)),e.hasOwnProperty("css")&&0!==e.css.length&&angular.forEach(e.css,function(e){P("css",e,y)})),void(e.hasOwnProperty("files")&&0!==e.files.length&&e.files&&c.push(D(e,y).then(function(){return O(e)}))))}),o.all(c)};return D(h,y).then(function(){null===f?v.resolve(u):(p.push(f),w(f).then(function(){try{d=[],t(L,p,y)}catch(e){return a.error(e.message),void v.reject(e)}v.resolve(u)},function(e){v.reject(e)}))},function(e){v.reject(e)}),v.promise}}}],this.config=function(e){if(angular.isDefined(e.jsLoader)||angular.isDefined(e.asyncLoader)){if(!angular.isFunction(e.jsLoader||e.asyncLoader))throw"The js loader needs to be a function";h=e.jsLoader||e.asyncLoader}if(angular.isDefined(e.cssLoader)){if(!angular.isFunction(e.cssLoader))throw"The css loader needs to be a function";m=e.cssLoader}if(angular.isDefined(e.templatesLoader)){if(!angular.isFunction(e.templatesLoader))throw"The template loader needs to be a function";v=e.templatesLoader}angular.isDefined(e.modules)&&(angular.isArray(e.modules)?angular.forEach(e.modules,function(e){y[e.name]=e}):y[e.modules.name]=e.modules),angular.isDefined(e.debug)&&(O=e.debug),angular.isDefined(e.events)&&(j=e.events)}}]),h.directive("ocLazyLoad",["$ocLazyLoad","$compile","$animate","$parse",function(e,n,r,a){return{restrict:"A",terminal:!0,priority:1e3,compile:function(t){var o=t[0].innerHTML;return t.html(""),function(t,i,u){var l=a(u.ocLazyLoad);t.$watch(function(){return l(t)||u.ocLazyLoad},function(a){angular.isDefined(a)&&e.load(a).then(function(){r.enter(n(o)(t),null,i)})},!0)}}}}]);var m=angular.bootstrap;angular.bootstrap=function(e,n,r){return s=n.slice(),m(e,n,r)},Array.prototype.indexOf||(Array.prototype.indexOf=function(e,n){var r;if(null==this)throw new TypeError('"this" is null or not defined');var a=Object(this),t=a.length>>>0;if(0===t)return-1;var o=+n||0;if(1/0===Math.abs(o)&&(o=0),o>=t)return-1;for(r=Math.max(o>=0?o:t-Math.abs(o),0);t>r;){if(r in a&&a[r]===e)return r;r++}return-1})}(),"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="ui.router"),function(a,b,c){"use strict";function d(a,b){return N(new(N(function(){},{prototype:a})),b)}function e(a){return M(arguments,function(b){b!==a&&M(b,function(b,c){a.hasOwnProperty(c)||(a[c]=b)})}),a}function f(a,b){var c=[];for(var d in a.path){if(a.path[d]!==b.path[d])break;c.push(a.path[d])}return c}function g(a){if(Object.keys)return Object.keys(a);var b=[];return M(a,function(a,c){b.push(c)}),b}function h(a,b){if(Array.prototype.indexOf)return a.indexOf(b,Number(arguments[2])||0);var c=a.length>>>0,d=Number(arguments[2])||0;for(0>(d=0>d?Math.ceil(d):Math.floor(d))&&(d+=c);c>d;d++)if(d in a&&a[d]===b)return d;return-1}function i(a,b,c,d){var e,i=f(c,d),j={},k=[];for(var l in i)if(i[l].params&&(e=g(i[l].params),e.length))for(var m in e)h(k,e[m])>=0||(k.push(e[m]),j[e[m]]=a[e[m]]);return N({},j,b)}function j(a,b,c){if(!c){c=[];for(var d in a)c.push(d)}for(var e=0;e<c.length;e++){var f=c[e];if(a[f]!=b[f])return!1}return!0}function k(a,b){var c={};return M(a,function(a){c[a]=b[a]}),c}function l(a){var b={},c=Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments,1));return M(c,function(c){c in a&&(b[c]=a[c])}),b}function m(a){var b={},c=Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments,1));for(var d in a)-1==h(c,d)&&(b[d]=a[d]);return b}function n(a,b){var c=L(a),d=c?[]:{};return M(a,function(a,e){b(a,e)&&(d[c?d.length:e]=a)}),d}function o(a,b){var c=L(a)?[]:{};return M(a,function(a,d){c[d]=b(a,d)}),c}function p(a,b){var d=1,f=2,i={},j=[],k=i,l=N(a.when(i),{$$promises:i,$$values:i});this.study=function(i){function n(a,c){if(s[c]!==f){if(r.push(c),s[c]===d)throw r.splice(0,h(r,c)),new Error("Cyclic dependency: "+r.join(" -> "));if(s[c]=d,J(a))q.push(c,[function(){return b.get(a)}],j);else{var e=b.annotate(a);M(e,function(a){a!==c&&i.hasOwnProperty(a)&&n(i[a],a)}),q.push(c,a,e)}r.pop(),s[c]=f}}function o(a){return K(a)&&a.then&&a.$$promises}if(!K(i))throw new Error("'invocables' must be an object");var p=g(i||{}),q=[],r=[],s={};return M(i,n),i=r=s=null,function(d,f,g){function h(){--u||(v||e(t,f.$$values),r.$$values=t,r.$$promises=r.$$promises||!0,delete r.$$inheritedValues,n.resolve(t))}function i(a){r.$$failure=a,n.reject(a)}function j(c,e,f){function j(a){l.reject(a),i(a)}function k(){if(!H(r.$$failure))try{l.resolve(b.invoke(e,g,t)),l.promise.then(function(a){t[c]=a,h()},j)}catch(a){j(a)}}var l=a.defer(),m=0;M(f,function(a){s.hasOwnProperty(a)&&!d.hasOwnProperty(a)&&(m++,s[a].then(function(b){t[a]=b,--m||k()},j))}),m||k(),s[c]=l.promise}if(o(d)&&g===c&&(g=f,f=d,d=null),d){if(!K(d))throw new Error("'locals' must be an object")}else d=k;if(f){if(!o(f))throw new Error("'parent' must be a promise returned by $resolve.resolve()")}else f=l;var n=a.defer(),r=n.promise,s=r.$$promises={},t=N({},d),u=1+q.length/3,v=!1;if(H(f.$$failure))return i(f.$$failure),r;f.$$inheritedValues&&e(t,m(f.$$inheritedValues,p)),N(s,f.$$promises),f.$$values?(v=e(t,m(f.$$values,p)),r.$$inheritedValues=m(f.$$values,p),h()):(f.$$inheritedValues&&(r.$$inheritedValues=m(f.$$inheritedValues,p)),f.then(h,i));for(var w=0,x=q.length;x>w;w+=3)d.hasOwnProperty(q[w])?h():j(q[w],q[w+1],q[w+2]);return r}},this.resolve=function(a,b,c,d){return this.study(a)(b,c,d)}}function q(a,b,c){this.fromConfig=function(a,b,c){return H(a.template)?this.fromString(a.template,b):H(a.templateUrl)?this.fromUrl(a.templateUrl,b):H(a.templateProvider)?this.fromProvider(a.templateProvider,b,c):null},this.fromString=function(a,b){return I(a)?a(b):a},this.fromUrl=function(c,d){return I(c)&&(c=c(d)),null==c?null:a.get(c,{cache:b,headers:{Accept:"text/html"}}).then(function(a){return a.data})},this.fromProvider=function(a,b,d){return c.invoke(a,null,d||{params:b})}}function r(a,b,e){function f(b,c,d,e){if(q.push(b),o[b])return o[b];if(!/^\w+(-+\w+)*(?:\[\])?$/.test(b))throw new Error("Invalid parameter name '"+b+"' in pattern '"+a+"'");if(p[b])throw new Error("Duplicate parameter name '"+b+"' in pattern '"+a+"'");return p[b]=new P.Param(b,c,d,e),p[b]}function g(a,b,c,d){var e=["",""],f=a.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&");if(!b)return f;switch(c){case!1:e=["(",")"+(d?"?":"")];break;case!0:e=["?(",")?"];break;default:e=["("+c+"|",")?"]}return f+e[0]+b+e[1]}function h(e,f){var g,h,i,j,k;return g=e[2]||e[3],k=b.params[g],i=a.substring(m,e.index),h=f?e[4]:e[4]||("*"==e[1]?".*":null),j=P.type(h||"string")||d(P.type("string"),{pattern:new RegExp(h,b.caseInsensitive?"i":c)}),{id:g,regexp:h,segment:i,type:j,cfg:k}}b=N({params:{}},K(b)?b:{});var i,j=/([:*])([\w\[\]]+)|\{([\w\[\]]+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,k=/([:]?)([\w\[\]-]+)|\{([\w\[\]-]+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,l="^",m=0,n=this.segments=[],o=e?e.params:{},p=this.params=e?e.params.$$new():new P.ParamSet,q=[];this.source=a;for(var r,s,t;(i=j.exec(a))&&(r=h(i,!1),!(r.segment.indexOf("?")>=0));)s=f(r.id,r.type,r.cfg,"path"),l+=g(r.segment,s.type.pattern.source,s.squash,s.isOptional),n.push(r.segment),m=j.lastIndex;t=a.substring(m);var u=t.indexOf("?");if(u>=0){var v=this.sourceSearch=t.substring(u);if(t=t.substring(0,u),this.sourcePath=a.substring(0,m+u),v.length>0)for(m=0;i=k.exec(v);)r=h(i,!0),s=f(r.id,r.type,r.cfg,"search"),m=j.lastIndex}else this.sourcePath=a,this.sourceSearch="";l+=g(t)+(!1===b.strict?"/?":"")+"$",n.push(t),this.regexp=new RegExp(l,b.caseInsensitive?"i":c),this.prefix=n[0],this.$$paramNames=q}function s(a){N(this,a)}function t(){function a(a){return null!=a?a.toString().replace(/\//g,"%2F"):a}function e(a){return null!=a?a.toString().replace(/%2F/g,"/"):a}function f(){return{strict:p,caseInsensitive:m}}function i(a){return I(a)||L(a)&&I(a[a.length-1])}function j(){for(;w.length;){var a=w.shift();if(a.pattern)throw new Error("You cannot override a type's .pattern at runtime.");b.extend(u[a.name],l.invoke(a.def))}}function k(a){N(this,a||{})}P=this;var l,m=!1,p=!0,q=!1,u={},v=!0,w=[],x={string:{encode:a,decode:e,is:function(a){return null==a||!H(a)||"string"==typeof a},pattern:/[^/]*/},int:{encode:a,decode:function(a){return parseInt(a,10)},is:function(a){return H(a)&&this.decode(a.toString())===a},pattern:/\d+/},bool:{encode:function(a){return a?1:0},decode:function(a){return 0!==parseInt(a,10)},is:function(a){return!0===a||!1===a},pattern:/0|1/},date:{encode:function(a){return this.is(a)?[a.getFullYear(),("0"+(a.getMonth()+1)).slice(-2),("0"+a.getDate()).slice(-2)].join("-"):c},decode:function(a){if(this.is(a))return a;var b=this.capture.exec(a);return b?new Date(b[1],b[2]-1,b[3]):c},is:function(a){return a instanceof Date&&!isNaN(a.valueOf())},equals:function(a,b){return this.is(a)&&this.is(b)&&a.toISOString()===b.toISOString()},pattern:/[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])/,capture:/([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])/},json:{encode:b.toJson,decode:b.fromJson,is:b.isObject,equals:b.equals,pattern:/[^/]*/},any:{encode:b.identity,decode:b.identity,equals:b.equals,pattern:/.*/}};t.$$getDefaultValue=function(a){if(!i(a.value))return a.value;if(!l)throw new Error("Injectable functions cannot be called at configuration time");return l.invoke(a.value)},this.caseInsensitive=function(a){return H(a)&&(m=a),m},this.strictMode=function(a){return H(a)&&(p=a),p},this.defaultSquashPolicy=function(a){if(!H(a))return q;if(!0!==a&&!1!==a&&!J(a))throw new Error("Invalid squash policy: "+a+". Valid policies: false, true, arbitrary-string");return q=a,a},this.compile=function(a,b){return new r(a,N(f(),b))},this.isMatcher=function(a){if(!K(a))return!1;var b=!0;return M(r.prototype,function(c,d){I(c)&&(b=b&&H(a[d])&&I(a[d]))}),b},this.type=function(a,b,c){if(!H(b))return u[a];if(u.hasOwnProperty(a))throw new Error("A type named '"+a+"' has already been defined.");return u[a]=new s(N({name:a},b)),c&&(w.push({name:a,def:c}),v||j()),this},M(x,function(a,b){u[b]=new s(N({name:b},a))}),u=d(u,{}),this.$get=["$injector",function(a){return l=a,v=!1,j(),M(x,function(a,b){u[b]||(u[b]=new s(a))}),this}],this.Param=function(a,b,d,e){function f(a){var b=K(a)?g(a):[];return-1===h(b,"value")&&-1===h(b,"type")&&-1===h(b,"squash")&&-1===h(b,"array")&&(a={value:a}),a.$$fn=i(a.value)?a.value:function(){return a.value},a}function j(b,c,d){if(b.type&&c)throw new Error("Param '"+a+"' has two type configurations.");return c||(b.type?b.type instanceof s?b.type:new s(b.type):"config"===d?u.any:u.string)}function k(){var b={array:"search"===e&&"auto"},c=a.match(/\[\]$/)?{array:!0}:{};return N(b,c,d).array}function m(a,b){var c=a.squash;if(!b||!1===c)return!1;if(!H(c)||null==c)return q;if(!0===c||J(c))return c;throw new Error("Invalid squash policy: '"+c+"'. Valid policies: false, true, or arbitrary string")}function p(a,b,d,e){var f,g,i=[{from:"",to:d||b?c:""},{from:null,to:d||b?c:""}];return f=L(a.replace)?a.replace:[],J(e)&&f.push({from:e,to:c}),g=o(f,function(a){return a.from}),n(i,function(a){return-1===h(g,a.from)}).concat(f)}function r(){if(!l)throw new Error("Injectable functions cannot be called at configuration time");var a=l.invoke(d.$$fn);if(null!==a&&a!==c&&!w.type.is(a))throw new Error("Default value ("+a+") for parameter '"+w.id+"' is not an instance of Type ("+w.type.name+")");return a}function t(a){function b(a){return function(b){return b.from===a}}function c(a){var c=o(n(w.replace,b(a)),function(a){return a.to});return c.length?c[0]:a}return a=c(a),H(a)?w.type.$normalize(a):r()}function v(){return"{Param:"+a+" "+b+" squash: '"+z+"' optional: "+y+"}"}var w=this;d=f(d),b=j(d,b,e);var x=k();b=x?b.$asArray(x,"search"===e):b,"string"!==b.name||x||"path"!==e||d.value!==c||(d.value="");var y=d.value!==c,z=m(d,y),A=p(d,x,y,z);N(this,{id:a,type:b,location:e,array:x,squash:z,replace:A,isOptional:y,value:t,dynamic:c,config:d,toString:v})},k.prototype={$$new:function(){return d(this,N(new k,{$$parent:this}))},$$keys:function(){for(var a=[],b=[],c=this,d=g(k.prototype);c;)b.push(c),c=c.$$parent;return b.reverse(),M(b,function(b){M(g(b),function(b){-1===h(a,b)&&-1===h(d,b)&&a.push(b)})}),a},$$values:function(a){var b={},c=this;return M(c.$$keys(),function(d){b[d]=c[d].value(a&&a[d])}),b},$$equals:function(a,b){var c=!0,d=this;return M(d.$$keys(),function(e){var f=a&&a[e],g=b&&b[e];d[e].type.equals(f,g)||(c=!1)}),c},$$validates:function(a){var d,e,f,g,h,i=this.$$keys();for(d=0;d<i.length&&(e=this[i[d]],(f=a[i[d]])!==c&&null!==f||!e.isOptional);d++){if(g=e.type.$normalize(f),!e.type.is(g))return!1;if(h=e.type.encode(g),b.isString(h)&&!e.type.pattern.exec(h))return!1}return!0},$$parent:c},this.ParamSet=k}function u(a,d){function e(a){var b=/^\^((?:\\[^a-zA-Z0-9]|[^\\\[\]\^$*+?.()|{}]+)*)/.exec(a.source);return null!=b?b[1].replace(/\\(.)/g,"$1"):""}function f(a,b){return a.replace(/\$(\$|\d{1,2})/,function(a,c){return b["$"===c?0:Number(c)]})}function g(a,b,c){if(!c)return!1;var d=a.invoke(b,b,{$match:c});return!H(d)||d}function h(d,e,f,g){function h(a,b,c){return"/"===p?a:b?p.slice(0,-1)+a:c?p.slice(1)+a:a}function m(a){function b(a){var b=a(f,d);return!!b&&(J(b)&&d.replace().url(b),!0)}if(!a||!a.defaultPrevented){o&&d.url(),o=c;var e,g=j.length;for(e=0;g>e;e++)if(b(j[e]))return;k&&b(k)}}function n(){return i=i||e.$on("$locationChangeSuccess",m)}var o,p=g.baseHref(),q=d.url();return l||n(),{sync:function(){m()},listen:function(){return n()},update:function(a){return a?void(q=d.url()):void(d.url()!==q&&(d.url(q),d.replace()))},push:function(a,b,e){var f=a.format(b||{});null!==f&&b&&b["#"]&&(f+="#"+b["#"]),d.url(f),o=e&&e.$$avoidResync?d.url():c,e&&e.replace&&d.replace()},href:function(c,e,f){if(!c.validates(e))return null;var g=a.html5Mode();b.isObject(g)&&(g=g.enabled);var i=c.format(e);if(f=f||{},g||null===i||(i="#"+a.hashPrefix()+i),null!==i&&e&&e["#"]&&(i+="#"+e["#"]),i=h(i,g,f.absolute),!f.absolute||!i)return i;var j=!g&&i?"/":"",k=d.port();return k=80===k||443===k?"":":"+k,[d.protocol(),"://",d.host(),k,j,i].join("")}}}var i,j=[],k=null,l=!1;this.rule=function(a){if(!I(a))throw new Error("'rule' must be a function");return j.push(a),this},this.otherwise=function(a){if(J(a)){var b=a;a=function(){return b}}else if(!I(a))throw new Error("'rule' must be a function");return k=a,this},this.when=function(a,b){var c,h=J(b);if(J(a)&&(a=d.compile(a)),!h&&!I(b)&&!L(b))throw new Error("invalid 'handler' in when()");var i={matcher:function(a,b){return h&&(c=d.compile(b),b=["$match",function(a){return c.format(a)}]),N(function(c,d){return g(c,b,a.exec(d.path(),d.search()))},{prefix:J(a.prefix)?a.prefix:""})},regex:function(a,b){if(a.global||a.sticky)throw new Error("when() RegExp must not be global or sticky");return h&&(c=b,b=["$match",function(a){return f(c,a)}]),N(function(c,d){return g(c,b,a.exec(d.path()))},{prefix:e(a)})}},j={matcher:d.isMatcher(a),regex:a instanceof RegExp};for(var k in j)if(j[k])return this.rule(i[k](a,b));throw new Error("invalid 'what' in when()")},this.deferIntercept=function(a){a===c&&(a=!0),l=a},this.$get=h,h.$inject=["$location","$rootScope","$injector","$browser"]}function v(a,e){function f(a){return 0===a.indexOf(".")||0===a.indexOf("^")}function m(a,b){if(!a)return c;var d=J(a),e=d?a:a.name;if(f(e)){if(!b)throw new Error("No reference point given for path '"+e+"'");b=m(b);for(var h=e.split("."),i=0,j=h.length,k=b;j>i;i++)if(""!==h[i]||0!==i){if("^"!==h[i])break;if(!k.parent)throw new Error("Path '"+e+"' not valid for state '"+b.name+"'");k=k.parent}else k=b;h=h.slice(i).join("."),e=k.name+(k.name&&h?".":"")+h}var l=z[e];return!l||!d&&(d||l!==a&&l.self!==a)?c:l}function n(a,b){A[a]||(A[a]=[]),A[a].push(b)}function p(a){for(var b=A[a]||[];b.length;)q(b.shift())}function q(b){b=d(b,{
self:b,resolve:b.resolve||{},toString:function(){return this.name}});var c=b.name;if(!J(c)||c.indexOf("@")>=0)throw new Error("State must have a valid name");if(z.hasOwnProperty(c))throw new Error("State '"+c+"'' is already defined");var e=-1!==c.indexOf(".")?c.substring(0,c.lastIndexOf(".")):J(b.parent)?b.parent:K(b.parent)&&J(b.parent.name)?b.parent.name:"";if(e&&!z[e])return n(e,b.self);for(var f in C)I(C[f])&&(b[f]=C[f](b,C.$delegates[f]));return z[c]=b,!b[B]&&b.url&&a.when(b.url,["$match","$stateParams",function(a,c){y.$current.navigable==b&&j(a,c)||y.transitionTo(b,a,{inherit:!0,location:!1})}]),p(c),b}function r(a){return a.indexOf("*")>-1}function s(a){for(var b=a.split("."),c=y.$current.name.split("."),d=0,e=b.length;e>d;d++)"*"===b[d]&&(c[d]="*");return"**"===b[0]&&(c=c.slice(h(c,b[1])),c.unshift("**")),"**"===b[b.length-1]&&(c.splice(h(c,b[b.length-2])+1,Number.MAX_VALUE),c.push("**")),b.length==c.length&&c.join("")===b.join("")}function t(a,b){return J(a)&&!H(b)?C[a]:I(b)&&J(a)?(C[a]&&!C.$delegates[a]&&(C.$delegates[a]=C[a]),C[a]=b,this):this}function u(a,b){return K(a)?b=a:b.name=a,q(b),this}function v(a,e,f,h,l,n,p,q,t){function u(b,c,d,f){var g=a.$broadcast("$stateNotFound",b,c,d);if(g.defaultPrevented)return p.update(),D;if(!g.retry)return null;if(f.$retry)return p.update(),E;var h=y.transition=e.when(g.retry);return h.then(function(){return h!==y.transition?A:(b.options.$retry=!0,y.transitionTo(b.to,b.toParams,b.options))},function(){return D}),p.update(),h}function v(a,c,d,g,i,j){function m(){var c=[];return M(a.views,function(d,e){var g=d.resolve&&d.resolve!==a.resolve?d.resolve:{};g.$template=[function(){return f.load(e,{view:d,locals:i.globals,params:n,notify:j.notify})||""}],c.push(l.resolve(g,i.globals,i.resolve,a).then(function(c){if(I(d.controllerProvider)||L(d.controllerProvider)){var f=b.extend({},g,i.globals);c.$$controller=h.invoke(d.controllerProvider,null,f)}else c.$$controller=d.controller;c.$$state=a,c.$$controllerAs=d.controllerAs,i[e]=c}))}),e.all(c).then(function(){return i.globals})}var n=d?c:k(a.params.$$keys(),c),o={$stateParams:n};i.resolve=l.resolve(a.resolve,o,i.resolve,a);var p=[i.resolve.then(function(a){i.globals=a})];return g&&p.push(g),e.all(p).then(m).then(function(a){return i})}var A=e.reject(new Error("transition superseded")),C=e.reject(new Error("transition prevented")),D=e.reject(new Error("transition aborted")),E=e.reject(new Error("transition failed"));return x.locals={resolve:null,globals:{$stateParams:{}}},y={params:{},current:x.self,$current:x,transition:null},y.reload=function(a){return y.transitionTo(y.current,n,{reload:a||!0,inherit:!1,notify:!0})},y.go=function(a,b,c){return y.transitionTo(a,b,N({inherit:!0,relative:y.$current},c))},y.transitionTo=function(b,c,f){c=c||{},f=N({location:!0,inherit:!1,relative:null,notify:!0,reload:!1,$retry:!1},f||{});var g,j=y.$current,l=y.params,o=j.path,q=m(b,f.relative),r=c["#"];if(!H(q)){var s={to:b,toParams:c,options:f},t=u(s,j.self,l,f);if(t)return t;if(b=s.to,c=s.toParams,f=s.options,q=m(b,f.relative),!H(q)){if(!f.relative)throw new Error("No such state '"+b+"'");throw new Error("Could not resolve '"+b+"' from state '"+f.relative+"'")}}if(q[B])throw new Error("Cannot transition to abstract state '"+b+"'");if(f.inherit&&(c=i(n,c||{},y.$current,q)),!q.params.$$validates(c))return E;c=q.params.$$values(c),b=q;var z=b.path,D=0,F=z[D],G=x.locals,I=[];if(f.reload){if(J(f.reload)||K(f.reload)){if(K(f.reload)&&!f.reload.name)throw new Error("Invalid reload state object");var L=!0===f.reload?o[0]:m(f.reload);if(f.reload&&!L)throw new Error("No such reload state '"+(J(f.reload)?f.reload:f.reload.name)+"'");for(;F&&F===o[D]&&F!==L;)G=I[D]=F.locals,D++,F=z[D]}}else for(;F&&F===o[D]&&F.ownParams.$$equals(c,l);)G=I[D]=F.locals,D++,F=z[D];if(w(b,c,j,l,G,f))return r&&(c["#"]=r),y.params=c,O(y.params,n),f.location&&b.navigable&&b.navigable.url&&(p.push(b.navigable.url,c,{$$avoidResync:!0,replace:"replace"===f.location}),p.update(!0)),y.transition=null,e.when(y.current);if(c=k(b.params.$$keys(),c||{}),f.notify&&a.$broadcast("$stateChangeStart",b.self,c,j.self,l).defaultPrevented)return a.$broadcast("$stateChangeCancel",b.self,c,j.self,l),p.update(),C;for(var M=e.when(G),P=D;P<z.length;P++,F=z[P])G=I[P]=d(G),M=v(F,c,F===b,M,G,f);var Q=y.transition=M.then(function(){var d,e,g;if(y.transition!==Q)return A;for(d=o.length-1;d>=D;d--)g=o[d],g.self.onExit&&h.invoke(g.self.onExit,g.self,g.locals.globals),g.locals=null;for(d=D;d<z.length;d++)e=z[d],e.locals=I[d],e.self.onEnter&&h.invoke(e.self.onEnter,e.self,e.locals.globals);return r&&(c["#"]=r),y.transition!==Q?A:(y.$current=b,y.current=b.self,y.params=c,O(y.params,n),y.transition=null,f.location&&b.navigable&&p.push(b.navigable.url,b.navigable.locals.globals.$stateParams,{$$avoidResync:!0,replace:"replace"===f.location}),f.notify&&a.$broadcast("$stateChangeSuccess",b.self,c,j.self,l),p.update(!0),y.current)},function(d){return y.transition!==Q?A:(y.transition=null,g=a.$broadcast("$stateChangeError",b.self,c,j.self,l,d),g.defaultPrevented||p.update(),e.reject(d))});return Q},y.is=function(a,b,d){d=N({relative:y.$current},d||{});var e=m(a,d.relative);return H(e)?y.$current===e&&(!b||j(e.params.$$values(b),n)):c},y.includes=function(a,b,d){if(d=N({relative:y.$current},d||{}),J(a)&&r(a)){if(!s(a))return!1;a=y.$current.name}var e=m(a,d.relative);return H(e)?!!H(y.$current.includes[e.name])&&(!b||j(e.params.$$values(b),n,g(b))):c},y.href=function(a,b,d){d=N({lossy:!0,inherit:!0,absolute:!1,relative:y.$current},d||{});var e=m(a,d.relative);if(!H(e))return null;d.inherit&&(b=i(n,b||{},y.$current,e));var f=e&&d.lossy?e.navigable:e;return f&&f.url!==c&&null!==f.url?p.href(f.url,k(e.params.$$keys().concat("#"),b||{}),{absolute:d.absolute}):null},y.get=function(a,b){if(0===arguments.length)return o(g(z),function(a){return z[a].self});var c=m(a,b||y.$current);return c&&c.self?c.self:null},y}function w(a,b,c,d,e,f){function g(a,b,c){function d(b){return"search"!=a.params[b].location}var e=a.params.$$keys().filter(d),f=l.apply({},[a.params].concat(e));return new P.ParamSet(f).$$equals(b,c)}return!(f.reload||a!==c||!(e===c.locals||!1===a.self.reloadOnSearch&&g(c,d,b)))||void 0}var x,y,z={},A={},B="abstract",C={parent:function(a){if(H(a.parent)&&a.parent)return m(a.parent);var b=/^(.+)\.[^.]+$/.exec(a.name);return b?m(b[1]):x},data:function(a){return a.parent&&a.parent.data&&(a.data=a.self.data=N({},a.parent.data,a.data)),a.data},url:function(a){var b=a.url,c={params:a.params||{}};if(J(b))return"^"==b.charAt(0)?e.compile(b.substring(1),c):(a.parent.navigable||x).url.concat(b,c);if(!b||e.isMatcher(b))return b;throw new Error("Invalid url '"+b+"' in state '"+a+"'")},navigable:function(a){return a.url?a:a.parent?a.parent.navigable:null},ownParams:function(a){var b=a.url&&a.url.params||new P.ParamSet;return M(a.params||{},function(a,c){b[c]||(b[c]=new P.Param(c,null,a,"config"))}),b},params:function(a){return a.parent&&a.parent.params?N(a.parent.params.$$new(),a.ownParams):new P.ParamSet},views:function(a){var b={};return M(H(a.views)?a.views:{"":a},function(c,d){d.indexOf("@")<0&&(d+="@"+a.parent.name),b[d]=c}),b},path:function(a){return a.parent?a.parent.path.concat(a):[]},includes:function(a){var b=a.parent?N({},a.parent.includes):{};return b[a.name]=!0,b},$delegates:{}};x=q({name:"",url:"^",views:null,abstract:!0}),x.navigable=null,this.decorator=t,this.state=u,this.$get=v,v.$inject=["$rootScope","$q","$view","$injector","$resolve","$stateParams","$urlRouter","$location","$urlMatcherFactory"]}function w(){function a(a,b){return{load:function(c,d){var e;return d=N({template:null,controller:null,view:null,locals:null,notify:!0,async:!0,params:{}},d),d.view&&(e=b.fromConfig(d.view,d.params,d.locals)),e&&d.notify&&a.$broadcast("$viewContentLoading",d),e}}}this.$get=a,a.$inject=["$rootScope","$templateFactory"]}function x(){var a=!1;this.useAnchorScroll=function(){a=!0},this.$get=["$anchorScroll","$timeout",function(b,c){return a?b:function(a){return c(function(){a[0].scrollIntoView()},0,!1)}}]}function y(a,c,d,e){function f(){return c.has?function(a){return c.has(a)?c.get(a):null}:function(a){try{return c.get(a)}catch(b){return null}}}function g(a,b){var c=function(){return{enter:function(a,b,c){b.after(a),c()},leave:function(a,b){a.remove(),b()}}};if(j)return{enter:function(a,b,c){var d=j.enter(a,null,b,c);d&&d.then&&d.then(c)},leave:function(a,b){var c=j.leave(a,b);c&&c.then&&c.then(b)}};if(i){var d=i&&i(b,a);return{enter:function(a,b,c){d.enter(a,null,b),c()},leave:function(a,b){d.leave(a),b()}}}return c()}var h=f(),i=h("$animator"),j=h("$animate");return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",compile:function(c,f,h){return function(c,f,i){function j(){l&&(l.remove(),l=null),n&&(n.$destroy(),n=null),m&&(r.leave(m,function(){l=null}),l=m,m=null)}function k(g){var k,l=A(c,i,f,e),s=l&&a.$current&&a.$current.locals[l];if(g||s!==o){k=c.$new(),o=a.$current.locals[l];var t=h(k,function(a){r.enter(a,f,function(){n&&n.$emit("$viewContentAnimationEnded"),(b.isDefined(q)&&!q||c.$eval(q))&&d(a)}),j()});m=t,n=k,n.$emit("$viewContentLoaded"),n.$eval(p)}}var l,m,n,o,p=i.onload||"",q=i.autoscroll,r=g(i,c);c.$on("$stateChangeSuccess",function(){k(!1)}),c.$on("$viewContentLoading",function(){k(!1)}),k(!0)}}}}function z(a,b,c,d){return{restrict:"ECA",priority:-400,compile:function(e){var f=e.html();return function(e,g,h){var i=c.$current,j=A(e,h,g,d),k=i&&i.locals[j];if(k){g.data("$uiView",{name:j,state:k.$$state}),g.html(k.$template?k.$template:f);var l=a(g.contents());if(k.$$controller){k.$scope=e,k.$element=g;var m=b(k.$$controller,k);k.$$controllerAs&&(e[k.$$controllerAs]=m),g.data("$ngControllerController",m),g.children().data("$ngControllerController",m)}l(e)}}}}}function A(a,b,c,d){var e=d(b.uiView||b.name||"")(a),f=c.inheritedData("$uiView");return e.indexOf("@")>=0?e:e+"@"+(f?f.state.name:"")}function B(a,b){var c,d=a.match(/^\s*({[^}]*})\s*$/);if(d&&(a=b+"("+d[1]+")"),!(c=a.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/))||4!==c.length)throw new Error("Invalid state ref '"+a+"'");return{state:c[1],paramExpr:c[3]||null}}function C(a){var b=a.parent().inheritedData("$uiView");return b&&b.state&&b.state.name?b.state:void 0}function D(a,c){var d=["location","inherit","reload","absolute"];return{restrict:"A",require:["?^uiSrefActive","?^uiSrefActiveEq"],link:function(e,f,g,h){var i=B(g.uiSref,a.current.name),j=null,k=C(f)||a.$current,l="[object SVGAnimatedString]"===Object.prototype.toString.call(f.prop("href"))?"xlink:href":"href",m=null,n="A"===f.prop("tagName").toUpperCase(),o="FORM"===f[0].nodeName,p=o?"action":l,q=!0,r={relative:k,inherit:!0},s=e.$eval(g.uiSrefOpts)||{};b.forEach(d,function(a){a in s&&(r[a]=s[a])});var t=function(c){if(c&&(j=b.copy(c)),q){m=a.href(i.state,j,r);var d=h[1]||h[0];return d&&d.$$addStateInfo(i.state,j),null===m?(q=!1,!1):void g.$set(p,m)}};i.paramExpr&&(e.$watch(i.paramExpr,function(a,b){a!==j&&t(a)},!0),j=b.copy(e.$eval(i.paramExpr))),t(),o||f.bind("click",function(b){if(!((b.which||b.button)>1||b.ctrlKey||b.metaKey||b.shiftKey||f.attr("target"))){var e=c(function(){a.go(i.state,j,r)});b.preventDefault();var g=n&&!m?1:0;b.preventDefault=function(){g--<=0&&c.cancel(e)}}})}}}function E(a,b,c){return{restrict:"A",controller:["$scope","$element","$attrs",function(b,d,e){function f(){g()?d.addClass(i):d.removeClass(i)}function g(){for(var a=0;a<j.length;a++)if(h(j[a].state,j[a].params))return!0;return!1}function h(b,c){return void 0!==e.uiSrefActiveEq?a.is(b.name,c):a.includes(b.name,c)}var i,j=[];i=c(e.uiSrefActiveEq||e.uiSrefActive||"",!1)(b),this.$$addStateInfo=function(b,c){var e=a.get(b,C(d));j.push({state:e||{name:b},params:c}),f()},b.$on("$stateChangeSuccess",f)}]}}function F(a){var b=function(b){return a.is(b)};return b.$stateful=!0,b}function G(a){var b=function(b){return a.includes(b)};return b.$stateful=!0,b}var H=b.isDefined,I=b.isFunction,J=b.isString,K=b.isObject,L=b.isArray,M=b.forEach,N=b.extend,O=b.copy;b.module("ui.router.util",["ng"]),b.module("ui.router.router",["ui.router.util"]),b.module("ui.router.state",["ui.router.router","ui.router.util"]),b.module("ui.router",["ui.router.state"]),b.module("ui.router.compat",["ui.router"]),p.$inject=["$q","$injector"],b.module("ui.router.util").service("$resolve",p),q.$inject=["$http","$templateCache","$injector"],b.module("ui.router.util").service("$templateFactory",q);var P;r.prototype.concat=function(a,b){var c={caseInsensitive:P.caseInsensitive(),strict:P.strictMode(),squash:P.defaultSquashPolicy()};return new r(this.sourcePath+a+this.sourceSearch,N(c,b),this)},r.prototype.toString=function(){return this.source},r.prototype.exec=function(a,b){function c(a){function b(a){return a.split("").reverse().join("")}function c(a){return a.replace(/\\-/g,"-")}return o(o(b(a).split(/-(?!\\)/),b),c).reverse()}var d=this.regexp.exec(a);if(!d)return null;b=b||{};var e,f,g,h=this.parameters(),i=h.length,j=this.segments.length-1,k={};if(j!==d.length-1)throw new Error("Unbalanced capture group in route '"+this.source+"'");for(e=0;j>e;e++){g=h[e];var l=this.params[g],m=d[e+1];for(f=0;f<l.replace;f++)l.replace[f].from===m&&(m=l.replace[f].to);m&&!0===l.array&&(m=c(m)),k[g]=l.value(m)}for(;i>e;e++)g=h[e],k[g]=this.params[g].value(b[g]);return k},r.prototype.parameters=function(a){return H(a)?this.params[a]||null:this.$$paramNames},r.prototype.validates=function(a){return this.params.$$validates(a)},r.prototype.format=function(a){function b(a){return encodeURIComponent(a).replace(/-/g,function(a){return"%5C%"+a.charCodeAt(0).toString(16).toUpperCase()})}a=a||{};var c=this.segments,d=this.parameters(),e=this.params;if(!this.validates(a))return null;var f,g=!1,h=c.length-1,i=d.length,j=c[0];for(f=0;i>f;f++){var k=h>f,l=d[f],m=e[l],n=m.value(a[l]),p=m.isOptional&&m.type.equals(m.value(),n),q=!!p&&m.squash,r=m.type.encode(n);if(k){var s=c[f+1];if(!1===q)null!=r&&(j+=L(r)?o(r,b).join("-"):encodeURIComponent(r)),j+=s;else if(!0===q){var t=j.match(/\/$/)?/\/?(.*)/:/(.*)/;j+=s.match(t)[1]}else J(q)&&(j+=q+s)}else{if(null==r||p&&!1!==q)continue;L(r)||(r=[r]),r=o(r,encodeURIComponent).join("&"+l+"="),j+=(g?"&":"?")+l+"="+r,g=!0}}return j},s.prototype.is=function(a,b){return!0},s.prototype.encode=function(a,b){return a},s.prototype.decode=function(a,b){return a},s.prototype.equals=function(a,b){return a==b},s.prototype.$subPattern=function(){var a=this.pattern.toString();return a.substr(1,a.length-2)},s.prototype.pattern=/.*/,s.prototype.toString=function(){return"{Type:"+this.name+"}"},s.prototype.$normalize=function(a){return this.is(a)?a:this.decode(a)},s.prototype.$asArray=function(a,b){function d(a,b){function d(a,b){return function(){return a[b].apply(a,arguments)}}function e(a){return L(a)?a:H(a)?[a]:[]}function f(a){switch(a.length){case 0:return c;case 1:return"auto"===b?a[0]:a;default:return a}}function g(a){return!a}function h(a,b){return function(c){c=e(c);var d=o(c,a);return!0===b?0===n(d,g).length:f(d)}}function i(a){return function(b,c){var d=e(b),f=e(c);if(d.length!==f.length)return!1;for(var g=0;g<d.length;g++)if(!a(d[g],f[g]))return!1;return!0}}this.encode=h(d(a,"encode")),this.decode=h(d(a,"decode")),this.is=h(d(a,"is"),!0),this.equals=i(d(a,"equals")),this.pattern=a.pattern,this.$normalize=h(d(a,"$normalize")),this.name=a.name,this.$arrayMode=b}if(!a)return this;if("auto"===a&&!b)throw new Error("'auto' array mode is for query parameters only");return new d(this,a)},b.module("ui.router.util").provider("$urlMatcherFactory",t),b.module("ui.router.util").run(["$urlMatcherFactory",function(a){}]),u.$inject=["$locationProvider","$urlMatcherFactoryProvider"],b.module("ui.router.router").provider("$urlRouter",u),v.$inject=["$urlRouterProvider","$urlMatcherFactoryProvider"],b.module("ui.router.state").value("$stateParams",{}).provider("$state",v),w.$inject=[],b.module("ui.router.state").provider("$view",w),b.module("ui.router.state").provider("$uiViewScroll",x),y.$inject=["$state","$injector","$uiViewScroll","$interpolate"],z.$inject=["$compile","$controller","$state","$interpolate"],b.module("ui.router.state").directive("uiView",y),b.module("ui.router.state").directive("uiView",z),D.$inject=["$state","$timeout"],E.$inject=["$state","$stateParams","$interpolate"],b.module("ui.router.state").directive("uiSref",D).directive("uiSrefActive",E).directive("uiSrefActiveEq",E),F.$inject=["$state"],G.$inject=["$state"],b.module("ui.router.state").filter("isState",F).filter("includedByState",G)}(window,window.angular),angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.collapse","ui.bootstrap.accordion","ui.bootstrap.alert","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.dateparser","ui.bootstrap.isClass","ui.bootstrap.position","ui.bootstrap.datepicker","ui.bootstrap.debounce","ui.bootstrap.dropdown","ui.bootstrap.stackedMap","ui.bootstrap.modal","ui.bootstrap.paging","ui.bootstrap.pager","ui.bootstrap.pagination","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.typeahead"]),angular.module("ui.bootstrap.tpls",["uib/template/accordion/accordion-group.html","uib/template/accordion/accordion.html","uib/template/alert/alert.html","uib/template/carousel/carousel.html","uib/template/carousel/slide.html","uib/template/datepicker/datepicker.html","uib/template/datepicker/day.html","uib/template/datepicker/month.html","uib/template/datepicker/popup.html","uib/template/datepicker/year.html","uib/template/modal/backdrop.html","uib/template/modal/window.html","uib/template/pager/pager.html","uib/template/pagination/pagination.html","uib/template/tooltip/tooltip-html-popup.html","uib/template/tooltip/tooltip-popup.html","uib/template/tooltip/tooltip-template-popup.html","uib/template/popover/popover-html.html","uib/template/popover/popover-template.html","uib/template/popover/popover.html","uib/template/progressbar/bar.html","uib/template/progressbar/progress.html","uib/template/progressbar/progressbar.html","uib/template/rating/rating.html","uib/template/tabs/tab.html","uib/template/tabs/tabset.html","uib/template/timepicker/timepicker.html","uib/template/typeahead/typeahead-match.html","uib/template/typeahead/typeahead-popup.html"]),angular.module("ui.bootstrap.collapse",[]).directive("uibCollapse",["$animate","$q","$parse","$injector",function(a,b,c,d){var e=d.has("$animateCss")?d.get("$animateCss"):null;return{link:function(d,f,g){function h(){f.hasClass("collapse")&&f.hasClass("in")||b.resolve(l(d)).then(function(){f.removeClass("collapse").addClass("collapsing").attr("aria-expanded",!0).attr("aria-hidden",!1),e?e(f,{addClass:"in",easing:"ease",to:{height:f[0].scrollHeight+"px"}}).start().finally(i):a.addClass(f,"in",{to:{height:f[0].scrollHeight+"px"}}).then(i)})}function i(){f.removeClass("collapsing").addClass("collapse").css({height:"auto"}),m(d)}function j(){return f.hasClass("collapse")||f.hasClass("in")?void b.resolve(n(d)).then(function(){f.css({height:f[0].scrollHeight+"px"}).removeClass("collapse").addClass("collapsing").attr("aria-expanded",!1).attr("aria-hidden",!0),e?e(f,{removeClass:"in",to:{height:"0"}}).start().finally(k):a.removeClass(f,"in",{to:{height:"0"}}).then(k)}):k()}function k(){f.css({height:"0"}),f.removeClass("collapsing").addClass("collapse"),o(d)}var l=c(g.expanding),m=c(g.expanded),n=c(g.collapsing),o=c(g.collapsed);d.$eval(g.uibCollapse)||f.addClass("in").addClass("collapse").attr("aria-expanded",!0).attr("aria-hidden",!1).css({height:"auto"}),d.$watch(g.uibCollapse,function(a){a?j():h()})}}}]),angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse"]).constant("uibAccordionConfig",{closeOthers:!0}).controller("UibAccordionController",["$scope","$attrs","uibAccordionConfig",function(a,b,c){this.groups=[],this.closeOthers=function(d){(angular.isDefined(b.closeOthers)?a.$eval(b.closeOthers):c.closeOthers)&&angular.forEach(this.groups,function(a){a!==d&&(a.isOpen=!1)})},this.addGroup=function(a){var b=this;this.groups.push(a),a.$on("$destroy",function(c){b.removeGroup(a)})},this.removeGroup=function(a){var b=this.groups.indexOf(a);-1!==b&&this.groups.splice(b,1)}}]).directive("uibAccordion",function(){return{controller:"UibAccordionController",controllerAs:"accordion",transclude:!0,templateUrl:function(a,b){return b.templateUrl||"uib/template/accordion/accordion.html"}}}).directive("uibAccordionGroup",function(){return{require:"^uibAccordion",transclude:!0,replace:!0,templateUrl:function(a,b){return b.templateUrl||"uib/template/accordion/accordion-group.html"},scope:{heading:"@",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(a){this.heading=a}},link:function(a,b,c,d){d.addGroup(a),a.openClass=c.openClass||"panel-open",a.panelClass=c.panelClass||"panel-default",a.$watch("isOpen",function(c){b.toggleClass(a.openClass,!!c),c&&d.closeOthers(a)}),a.toggleOpen=function(b){a.isDisabled||b&&32!==b.which||(a.isOpen=!a.isOpen)};var e="accordiongroup-"+a.$id+"-"+Math.floor(1e4*Math.random());a.headingId=e+"-tab",a.panelId=e+"-panel"}}}).directive("uibAccordionHeading",function(){return{transclude:!0,template:"",replace:!0,require:"^uibAccordionGroup",link:function(a,b,c,d,e){d.setHeading(e(a,angular.noop))}}}).directive("uibAccordionTransclude",function(){return{require:"^uibAccordionGroup",link:function(a,b,c,d){a.$watch(function(){return d[c.uibAccordionTransclude]},function(a){a&&(b.find("span").html(""),b.find("span").append(a))})}}}),angular.module("ui.bootstrap.alert",[]).controller("UibAlertController",["$scope","$attrs","$interpolate","$timeout",function(a,b,c,d){a.closeable=!!b.close;var e=angular.isDefined(b.dismissOnTimeout)?c(b.dismissOnTimeout)(a.$parent):null;e&&d(function(){a.close()},parseInt(e,10))}]).directive("uibAlert",function(){return{controller:"UibAlertController",controllerAs:"alert",templateUrl:function(a,b){return b.templateUrl||"uib/template/alert/alert.html"},transclude:!0,replace:!0,scope:{type:"@",close:"&"}}}),angular.module("ui.bootstrap.buttons",[]).constant("uibButtonConfig",{activeClass:"active",toggleEvent:"click"}).controller("UibButtonsController",["uibButtonConfig",function(a){this.activeClass=a.activeClass||"active",this.toggleEvent=a.toggleEvent||"click"}]).directive("uibBtnRadio",["$parse",function(a){return{require:["uibBtnRadio","ngModel"],controller:"UibButtonsController",controllerAs:"buttons",link:function(b,c,d,e){var f=e[0],g=e[1],h=a(d.uibUncheckable);c.find("input").css({display:"none"}),g.$render=function(){c.toggleClass(f.activeClass,angular.equals(g.$modelValue,b.$eval(d.uibBtnRadio)))},c.on(f.toggleEvent,function(){if(!d.disabled){var a=c.hasClass(f.activeClass);(!a||angular.isDefined(d.uncheckable))&&b.$apply(function(){g.$setViewValue(a?null:b.$eval(d.uibBtnRadio)),g.$render()})}}),d.uibUncheckable&&b.$watch(h,function(a){d.$set("uncheckable",a?"":null)})}}}]).directive("uibBtnCheckbox",function(){return{require:["uibBtnCheckbox","ngModel"],controller:"UibButtonsController",controllerAs:"button",link:function(a,b,c,d){function e(){return g(c.btnCheckboxTrue,!0)}function f(){return g(c.btnCheckboxFalse,!1)}function g(b,c){return angular.isDefined(b)?a.$eval(b):c}var h=d[0],i=d[1];b.find("input").css({display:"none"}),i.$render=function(){b.toggleClass(h.activeClass,angular.equals(i.$modelValue,e()))},b.on(h.toggleEvent,function(){c.disabled||a.$apply(function(){i.$setViewValue(b.hasClass(h.activeClass)?f():e()),i.$render()})})}}}),angular.module("ui.bootstrap.carousel",[]).controller("UibCarouselController",["$scope","$element","$interval","$timeout","$animate",function(a,b,c,d,e){function f(){for(;s.length;)s.shift()}function g(a){if(angular.isUndefined(p[a].index))return p[a];for(var b=0,c=p.length;c>b;++b)if(p[b].index===a)return p[b]}function h(c,d,g){t||(angular.extend(c,{direction:g,active:!0}),angular.extend(o.currentSlide||{},{direction:g,active:!1}),e.enabled(b)&&!a.$currentTransition&&c.$element&&o.slides.length>1&&(c.$element.data(q,c.direction),o.currentSlide&&o.currentSlide.$element&&o.currentSlide.$element.data(q,c.direction),a.$currentTransition=!0,e.on("addClass",c.$element,function(b,c){if("close"===c&&(a.$currentTransition=null,e.off("addClass",b),s.length)){var d=s.pop(),g=a.indexOfSlide(d),i=g>o.getCurrentIndex()?"next":"prev";f(),h(d,g,i)}})),o.currentSlide=c,r=d,k())}function i(){m&&(c.cancel(m),m=null)}function j(b){b.length||(a.$currentTransition=null,f())}function k(){i();var b=+a.interval;!isNaN(b)&&b>0&&(m=c(l,b))}function l(){var b=+a.interval;n&&!isNaN(b)&&b>0&&p.length?a.next():a.pause()}var m,n,o=this,p=o.slides=a.slides=[],q="uib-slideDirection",r=-1,s=[];o.currentSlide=null;var t=!1;o.addSlide=function(b,c){b.$element=c,p.push(b),1===p.length||b.active?(a.$currentTransition&&(a.$currentTransition=null),o.select(p[p.length-1]),1===p.length&&a.play()):b.active=!1},o.getCurrentIndex=function(){return o.currentSlide&&angular.isDefined(o.currentSlide.index)?+o.currentSlide.index:r},o.next=a.next=function(){var b=(o.getCurrentIndex()+1)%p.length;return 0===b&&a.noWrap()?void a.pause():o.select(g(b),"next")},o.prev=a.prev=function(){var b=o.getCurrentIndex()-1<0?p.length-1:o.getCurrentIndex()-1;return a.noWrap()&&b===p.length-1?void a.pause():o.select(g(b),"prev")},o.removeSlide=function(a){angular.isDefined(a.index)&&p.sort(function(a,b){return+a.index>+b.index});var b=s.indexOf(a);-1!==b&&s.splice(b,1);var c=p.indexOf(a);p.splice(c,1),d(function(){p.length>0&&a.active?c>=p.length?o.select(p[c-1]):o.select(p[c]):r>c&&r--}),0===p.length&&(o.currentSlide=null,f())},o.select=a.select=function(b,c){var d=a.indexOfSlide(b);void 0===c&&(c=d>o.getCurrentIndex()?"next":"prev"),b&&b!==o.currentSlide&&!a.$currentTransition?h(b,d,c):b&&b!==o.currentSlide&&a.$currentTransition&&(s.push(b),b.active=!1)},a.indexOfSlide=function(a){return angular.isDefined(a.index)?+a.index:p.indexOf(a)},a.isActive=function(a){return o.currentSlide===a},a.pause=function(){a.noPause||(n=!1,i())},a.play=function(){n||(n=!0,k())},a.$on("$destroy",function(){t=!0,i()}),a.$watch("noTransition",function(a){e.enabled(b,!a)}),a.$watch("interval",k),a.$watchCollection("slides",j)}]).directive("uibCarousel",function(){return{transclude:!0,replace:!0,controller:"UibCarouselController",controllerAs:"carousel",templateUrl:function(a,b){return b.templateUrl||"uib/template/carousel/carousel.html"},scope:{interval:"=",noTransition:"=",noPause:"=",noWrap:"&"}}}).directive("uibSlide",function(){return{require:"^uibCarousel",transclude:!0,replace:!0,templateUrl:function(a,b){return b.templateUrl||"uib/template/carousel/slide.html"},scope:{active:"=?",actual:"=?",index:"=?"},link:function(a,b,c,d){d.addSlide(a,b),a.$on("$destroy",function(){d.removeSlide(a)}),a.$watch("active",function(b){b&&d.select(a)})}}}).animation(".item",["$animateCss",function(a){function b(a,b,c){a.removeClass(b),c&&c()}var c="uib-slideDirection";return{beforeAddClass:function(d,e,f){if("active"===e){var g=!1,h=d.data(c),i="next"===h?"left":"right",j=b.bind(this,d,i+" "+h,f);return d.addClass(h),a(d,{addClass:i}).start().done(j),function(){g=!0}}f()},beforeRemoveClass:function(d,e,f){if("active"===e){var g=!1,h=d.data(c),i="next"===h?"left":"right",j=b.bind(this,d,i,f);return a(d,{addClass:i}).start().done(j),function(){g=!0}}f()}}}]),angular.module("ui.bootstrap.dateparser",[]).service("uibDateParser",["$log","$locale","dateFilter","orderByFilter",function(a,b,c,d){function e(a,b){var c=[],e=a.split(""),f=a.indexOf("'");if(f>-1){var g=!1;a=a.split("");for(var h=f;h<a.length;h++)g?("'"===a[h]&&(h+1<a.length&&"'"===a[h+1]?(a[h+1]="$",e[h+1]=""):(e[h]="",g=!1)),a[h]="$"):"'"===a[h]&&(a[h]="$",e[h]="",g=!0);a=a.join("")}return angular.forEach(n,function(d){var f=a.indexOf(d.key);if(f>-1){a=a.split(""),e[f]="("+d.regex+")",a[f]="$";for(var g=f+1,h=f+d.key.length;h>g;g++)e[g]="",a[g]="$";a=a.join(""),c.push({index:f,key:d.key,apply:d[b],matcher:d.regex})}}),{regex:new RegExp("^"+e.join("")+"$"),map:d(c,"index")}}function f(a,b,c){return!(1>c)&&(1===b&&c>28?29===c&&(a%4==0&&a%100!=0||a%400==0):3!==b&&5!==b&&8!==b&&10!==b||31>c)}function g(a){return parseInt(a,10)}function h(a,b){return a&&b?l(a,b):a}function i(a,b){return a&&b?l(a,b,!0):a}function j(a,b){var c=Date.parse("Jan 01, 1970 00:00:00 "+a)/6e4;return isNaN(c)?b:c}function k(a,b){return a=new Date(a.getTime()),a.setMinutes(a.getMinutes()+b),a}function l(a,b,c){return c=c?-1:1,k(a,c*(j(b,a.getTimezoneOffset())-a.getTimezoneOffset()))}var m,n,o=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;this.init=function(){m=b.id,this.parsers={},this.formatters={},n=[{key:"yyyy",regex:"\\d{4}",apply:function(a){this.year=+a},formatter:function(a){var b=new Date;return b.setFullYear(Math.abs(a.getFullYear())),c(b,"yyyy")}},{key:"yy",regex:"\\d{2}",apply:function(a){this.year=+a+2e3},formatter:function(a){var b=new Date;return b.setFullYear(Math.abs(a.getFullYear())),c(b,"yy")}},{key:"y",regex:"\\d{1,4}",apply:function(a){this.year=+a},formatter:function(a){var b=new Date;return b.setFullYear(Math.abs(a.getFullYear())),c(b,"y")}},{key:"M!",regex:"0?[1-9]|1[0-2]",apply:function(a){this.month=a-1},formatter:function(a){return/^[0-9]$/.test(a.getMonth())?c(a,"MM"):c(a,"M")}},{key:"MMMM",regex:b.DATETIME_FORMATS.MONTH.join("|"),apply:function(a){this.month=b.DATETIME_FORMATS.MONTH.indexOf(a)},formatter:function(a){return c(a,"MMMM")}},{key:"MMM",regex:b.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(a){this.month=b.DATETIME_FORMATS.SHORTMONTH.indexOf(a)},formatter:function(a){return c(a,"MMM")}},{key:"MM",regex:"0[1-9]|1[0-2]",apply:function(a){this.month=a-1},formatter:function(a){return c(a,"MM")}},{key:"M",regex:"[1-9]|1[0-2]",apply:function(a){this.month=a-1},formatter:function(a){return c(a,"M")}},{key:"d!",regex:"[0-2]?[0-9]{1}|3[0-1]{1}",apply:function(a){this.date=+a},formatter:function(a){return/^[1-9]$/.test(a.getDate())?c(a,"dd"):c(a,"d")}},{key:"dd",regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(a){this.date=+a},formatter:function(a){return c(a,"dd")}},{key:"d",regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(a){this.date=+a},formatter:function(a){return c(a,"d")}},{key:"EEEE",regex:b.DATETIME_FORMATS.DAY.join("|"),formatter:function(a){return c(a,"EEEE")}},{key:"EEE",regex:b.DATETIME_FORMATS.SHORTDAY.join("|"),formatter:function(a){return c(a,"EEE")}},{key:"HH",regex:"(?:0|1)[0-9]|2[0-3]",apply:function(a){this.hours=+a},formatter:function(a){return c(a,"HH")}},{key:"hh",regex:"0[0-9]|1[0-2]",apply:function(a){this.hours=+a},formatter:function(a){return c(a,"hh")}},{key:"H",regex:"1?[0-9]|2[0-3]",apply:function(a){this.hours=+a},formatter:function(a){return c(a,"H")}},{key:"h",regex:"[0-9]|1[0-2]",apply:function(a){this.hours=+a},formatter:function(a){return c(a,"h")}},{key:"mm",regex:"[0-5][0-9]",apply:function(a){this.minutes=+a},formatter:function(a){return c(a,"mm")}},{key:"m",regex:"[0-9]|[1-5][0-9]",apply:function(a){this.minutes=+a},formatter:function(a){return c(a,"m")}},{key:"sss",regex:"[0-9][0-9][0-9]",apply:function(a){this.milliseconds=+a},formatter:function(a){return c(a,"sss")}},{key:"ss",regex:"[0-5][0-9]",apply:function(a){this.seconds=+a},formatter:function(a){return c(a,"ss")}},{key:"s",regex:"[0-9]|[1-5][0-9]",apply:function(a){this.seconds=+a},formatter:function(a){return c(a,"s")}},{key:"a",regex:b.DATETIME_FORMATS.AMPMS.join("|"),apply:function(a){12===this.hours&&(this.hours=0),"PM"===a&&(this.hours+=12)},formatter:function(a){return c(a,"a")}},{key:"Z",regex:"[+-]\\d{4}",apply:function(a){var b=a.match(/([+-])(\d{2})(\d{2})/),c=b[1],d=b[2],e=b[3];this.hours+=g(c+d),this.minutes+=g(c+e)},formatter:function(a){return c(a,"Z")}},{key:"ww",regex:"[0-4][0-9]|5[0-3]",formatter:function(a){return c(a,"ww")}},{key:"w",regex:"[0-9]|[1-4][0-9]|5[0-3]",formatter:function(a){return c(a,"w")}},{key:"GGGG",regex:b.DATETIME_FORMATS.ERANAMES.join("|").replace(/\s/g,"\\s"),formatter:function(a){return c(a,"GGGG")}},{key:"GGG",regex:b.DATETIME_FORMATS.ERAS.join("|"),
formatter:function(a){return c(a,"GGG")}},{key:"GG",regex:b.DATETIME_FORMATS.ERAS.join("|"),formatter:function(a){return c(a,"GG")}},{key:"G",regex:b.DATETIME_FORMATS.ERAS.join("|"),formatter:function(a){return c(a,"G")}}]},this.init(),this.filter=function(a,c){if(!angular.isDate(a)||isNaN(a)||!c)return"";c=b.DATETIME_FORMATS[c]||c,b.id!==m&&this.init(),this.formatters[c]||(this.formatters[c]=e(c,"formatter"));var d=this.formatters[c],f=d.map,g=c;return f.reduce(function(b,c,d){var e=g.match(new RegExp("(.*)"+c.key));return e&&angular.isString(e[1])&&(b+=e[1],g=g.replace(e[1]+c.key,"")),c.apply?b+c.apply.call(null,a):b},"")},this.parse=function(c,d,g){if(!angular.isString(c)||!d)return c;d=b.DATETIME_FORMATS[d]||d,d=d.replace(o,"\\$&"),b.id!==m&&this.init(),this.parsers[d]||(this.parsers[d]=e(d,"apply"));var h=this.parsers[d],i=h.regex,j=h.map,k=c.match(i),l=!1;if(k&&k.length){var n,p;angular.isDate(g)&&!isNaN(g.getTime())?n={year:g.getFullYear(),month:g.getMonth(),date:g.getDate(),hours:g.getHours(),minutes:g.getMinutes(),seconds:g.getSeconds(),milliseconds:g.getMilliseconds()}:(g&&a.warn("dateparser:","baseDate is not a valid date"),n={year:1900,month:0,date:1,hours:0,minutes:0,seconds:0,milliseconds:0});for(var q=1,r=k.length;r>q;q++){var s=j[q-1];"Z"===s.matcher&&(l=!0),s.apply&&s.apply.call(n,k[q])}var t=l?Date.prototype.setUTCFullYear:Date.prototype.setFullYear,u=l?Date.prototype.setUTCHours:Date.prototype.setHours;return f(n.year,n.month,n.date)&&(!angular.isDate(g)||isNaN(g.getTime())||l?(p=new Date(0),t.call(p,n.year,n.month,n.date),u.call(p,n.hours||0,n.minutes||0,n.seconds||0,n.milliseconds||0)):(p=new Date(g),t.call(p,n.year,n.month,n.date),u.call(p,n.hours,n.minutes,n.seconds,n.milliseconds))),p}},this.toTimezone=h,this.fromTimezone=i,this.timezoneToOffset=j,this.addDateMinutes=k,this.convertTimezoneToLocal=l}]),angular.module("ui.bootstrap.isClass",[]).directive("uibIsClass",["$animate",function(a){var b=/^\s*([\s\S]+?)\s+on\s+([\s\S]+?)\s*$/,c=/^\s*([\s\S]+?)\s+for\s+([\s\S]+?)\s*$/;return{restrict:"A",compile:function(d,e){function f(a,b,c){i.push(a),j.push({scope:a,element:b}),o.forEach(function(b,c){g(b,a)}),a.$on("$destroy",h)}function g(b,d){var e=b.match(c),f=d.$eval(e[1]),g=e[2],h=k[b];if(!h){var i=function(b){var c=null;j.some(function(a){return a.scope.$eval(m)===b?(c=a,!0):void 0}),h.lastActivated!==c&&(h.lastActivated&&a.removeClass(h.lastActivated.element,f),c&&a.addClass(c.element,f),h.lastActivated=c)};k[b]=h={lastActivated:null,scope:d,watchFn:i,compareWithExp:g,watcher:d.$watch(g,i)}}h.watchFn(d.$eval(g))}function h(a){var b=a.targetScope,c=i.indexOf(b);if(i.splice(c,1),j.splice(c,1),i.length){var d=i[0];angular.forEach(k,function(a){a.scope===b&&(a.watcher=d.$watch(a.compareWithExp,a.watchFn),a.scope=d)})}else k={}}var i=[],j=[],k={},l=e.uibIsClass.match(b),m=l[2],n=l[1],o=n.split(",");return f}}}]),angular.module("ui.bootstrap.position",[]).factory("$uibPosition",["$document","$window",function(a,b){var c,d={normal:/(auto|scroll)/,hidden:/(auto|scroll|hidden)/},e={auto:/\s?auto?\s?/i,primary:/^(top|bottom|left|right)$/,secondary:/^(top|bottom|left|right|center)$/,vertical:/^(top|bottom)$/};return{getRawNode:function(a){return a[0]||a},parseStyle:function(a){return a=parseFloat(a),isFinite(a)?a:0},offsetParent:function(c){function d(a){return"static"===(b.getComputedStyle(a).position||"static")}c=this.getRawNode(c);for(var e=c.offsetParent||a[0].documentElement;e&&e!==a[0].documentElement&&d(e);)e=e.offsetParent;return e||a[0].documentElement},scrollbarWidth:function(){if(angular.isUndefined(c)){var b=angular.element('<div style="position: absolute; top: -9999px; width: 50px; height: 50px; overflow: scroll;"></div>');a.find("body").append(b),c=b[0].offsetWidth-b[0].clientWidth,c=isFinite(c)?c:0,b.remove()}return c},scrollParent:function(c,e){c=this.getRawNode(c);var f=e?d.hidden:d.normal,g=a[0].documentElement,h=b.getComputedStyle(c),i="absolute"===h.position,j=c.parentElement||g;if(j===g||"fixed"===h.position)return g;for(;j.parentElement&&j!==g;){var k=b.getComputedStyle(j);if(i&&"static"!==k.position&&(i=!1),!i&&f.test(k.overflow+k.overflowY+k.overflowX))break;j=j.parentElement}return j},position:function(c,d){c=this.getRawNode(c);var e=this.offset(c);if(d){var f=b.getComputedStyle(c);e.top-=this.parseStyle(f.marginTop),e.left-=this.parseStyle(f.marginLeft)}var g=this.offsetParent(c),h={top:0,left:0};return g!==a[0].documentElement&&(h=this.offset(g),h.top+=g.clientTop-g.scrollTop,h.left+=g.clientLeft-g.scrollLeft),{width:Math.round(angular.isNumber(e.width)?e.width:c.offsetWidth),height:Math.round(angular.isNumber(e.height)?e.height:c.offsetHeight),top:Math.round(e.top-h.top),left:Math.round(e.left-h.left)}},offset:function(c){c=this.getRawNode(c);var d=c.getBoundingClientRect();return{width:Math.round(angular.isNumber(d.width)?d.width:c.offsetWidth),height:Math.round(angular.isNumber(d.height)?d.height:c.offsetHeight),top:Math.round(d.top+(b.pageYOffset||a[0].documentElement.scrollTop)),left:Math.round(d.left+(b.pageXOffset||a[0].documentElement.scrollLeft))}},viewportOffset:function(c,d,e){c=this.getRawNode(c),e=!1!==e;var f=c.getBoundingClientRect(),g={top:0,left:0,bottom:0,right:0},h=d?a[0].documentElement:this.scrollParent(c),i=h.getBoundingClientRect();if(g.top=i.top+h.clientTop,g.left=i.left+h.clientLeft,h===a[0].documentElement&&(g.top+=b.pageYOffset,g.left+=b.pageXOffset),g.bottom=g.top+h.clientHeight,g.right=g.left+h.clientWidth,e){var j=b.getComputedStyle(h);g.top+=this.parseStyle(j.paddingTop),g.bottom-=this.parseStyle(j.paddingBottom),g.left+=this.parseStyle(j.paddingLeft),g.right-=this.parseStyle(j.paddingRight)}return{top:Math.round(f.top-g.top),bottom:Math.round(g.bottom-f.bottom),left:Math.round(f.left-g.left),right:Math.round(g.right-f.right)}},parsePlacement:function(a){var b=e.auto.test(a);return b&&(a=a.replace(e.auto,"")),a=a.split("-"),a[0]=a[0]||"top",e.primary.test(a[0])||(a[0]="top"),a[1]=a[1]||"center",e.secondary.test(a[1])||(a[1]="center"),a[2]=!!b,a},positionElements:function(a,c,d,f){a=this.getRawNode(a),c=this.getRawNode(c);var g=angular.isDefined(c.offsetWidth)?c.offsetWidth:c.prop("offsetWidth"),h=angular.isDefined(c.offsetHeight)?c.offsetHeight:c.prop("offsetHeight");d=this.parsePlacement(d);var i=f?this.offset(a):this.position(a),j={top:0,left:0,placement:""};if(d[2]){var k=this.viewportOffset(a),l=b.getComputedStyle(c),m={width:g+Math.round(Math.abs(this.parseStyle(l.marginLeft)+this.parseStyle(l.marginRight))),height:h+Math.round(Math.abs(this.parseStyle(l.marginTop)+this.parseStyle(l.marginBottom)))};if(d[0]="top"===d[0]&&m.height>k.top&&m.height<=k.bottom?"bottom":"bottom"===d[0]&&m.height>k.bottom&&m.height<=k.top?"top":"left"===d[0]&&m.width>k.left&&m.width<=k.right?"right":"right"===d[0]&&m.width>k.right&&m.width<=k.left?"left":d[0],d[1]="top"===d[1]&&m.height-i.height>k.bottom&&m.height-i.height<=k.top?"bottom":"bottom"===d[1]&&m.height-i.height>k.top&&m.height-i.height<=k.bottom?"top":"left"===d[1]&&m.width-i.width>k.right&&m.width-i.width<=k.left?"right":"right"===d[1]&&m.width-i.width>k.left&&m.width-i.width<=k.right?"left":d[1],"center"===d[1])if(e.vertical.test(d[0])){var n=i.width/2-g/2;k.left+n<0&&m.width-i.width<=k.right?d[1]="left":k.right+n<0&&m.width-i.width<=k.left&&(d[1]="right")}else{var o=i.height/2-m.height/2;k.top+o<0&&m.height-i.height<=k.bottom?d[1]="top":k.bottom+o<0&&m.height-i.height<=k.top&&(d[1]="bottom")}}switch(d[0]){case"top":j.top=i.top-h;break;case"bottom":j.top=i.top+i.height;break;case"left":j.left=i.left-g;break;case"right":j.left=i.left+i.width}switch(d[1]){case"top":j.top=i.top;break;case"bottom":j.top=i.top+i.height-h;break;case"left":j.left=i.left;break;case"right":j.left=i.left+i.width-g;break;case"center":e.vertical.test(d[0])?j.left=i.left+i.width/2-g/2:j.top=i.top+i.height/2-h/2}return j.top=Math.round(j.top),j.left=Math.round(j.left),j.placement="center"===d[1]?d[0]:d[0]+"-"+d[1],j},positionArrow:function(a,c){a=this.getRawNode(a);var d=a.querySelector(".tooltip-inner, .popover-inner");if(d){var f=angular.element(d).hasClass("tooltip-inner"),g=f?a.querySelector(".tooltip-arrow"):a.querySelector(".arrow");if(g){if(c=this.parsePlacement(c),"center"===c[1])return void angular.element(g).css({top:"",bottom:"",right:"",left:"",margin:""});var h="border-"+c[0]+"-width",i=b.getComputedStyle(g)[h],j="border-";j+=e.vertical.test(c[0])?c[0]+"-"+c[1]:c[1]+"-"+c[0],j+="-radius";var k=b.getComputedStyle(f?d:a)[j],l={top:"auto",bottom:"auto",left:"auto",right:"auto",margin:0};switch(c[0]){case"top":l.bottom=f?"0":"-"+i;break;case"bottom":l.top=f?"0":"-"+i;break;case"left":l.right=f?"0":"-"+i;break;case"right":l.left=f?"0":"-"+i}l[c[1]]=k,angular.element(g).css(l)}}}}}]),angular.module("ui.bootstrap.datepicker",["ui.bootstrap.dateparser","ui.bootstrap.isClass","ui.bootstrap.position"]).value("$datepickerSuppressError",!1).constant("uibDatepickerConfig",{datepickerMode:"day",formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",maxDate:null,maxMode:"year",minDate:null,minMode:"day",ngModelOptions:{},shortcutPropagation:!1,showWeeks:!0,yearColumns:5,yearRows:4}).controller("UibDatepickerController",["$scope","$attrs","$parse","$interpolate","$locale","$log","dateFilter","uibDatepickerConfig","$datepickerSuppressError","uibDateParser",function(a,b,c,d,e,f,g,h,i,j){var k=this,l={$setViewValue:angular.noop},m={},n=[];this.modes=["day","month","year"],b.datepickerOptions?angular.forEach(["formatDay","formatDayHeader","formatDayTitle","formatMonth","formatMonthTitle","formatYear","initDate","maxDate","maxMode","minDate","minMode","showWeeks","shortcutPropagation","startingDay","yearColumns","yearRows"],function(b){switch(b){case"formatDay":case"formatDayHeader":case"formatDayTitle":case"formatMonth":case"formatMonthTitle":case"formatYear":k[b]=angular.isDefined(a.datepickerOptions[b])?d(a.datepickerOptions[b])(a.$parent):h[b];break;case"showWeeks":case"shortcutPropagation":case"yearColumns":case"yearRows":k[b]=angular.isDefined(a.datepickerOptions[b])?a.datepickerOptions[b]:h[b];break;case"startingDay":angular.isDefined(a.datepickerOptions.startingDay)?k.startingDay=a.datepickerOptions.startingDay:angular.isNumber(h.startingDay)?k.startingDay=h.startingDay:k.startingDay=(e.DATETIME_FORMATS.FIRSTDAYOFWEEK+8)%7;break;case"maxDate":case"minDate":a.datepickerOptions[b]?a.$watch(function(){return a.datepickerOptions[b]},function(a){a?angular.isDate(a)?k[b]=j.fromTimezone(new Date(a),m.timezone):k[b]=new Date(g(a,"medium")):k[b]=null,k.refreshView()}):k[b]=h[b]?j.fromTimezone(new Date(h[b]),m.timezone):null;break;case"maxMode":case"minMode":a.datepickerOptions[b]?a.$watch(function(){return a.datepickerOptions[b]},function(c){k[b]=a[b]=angular.isDefined(c)?c:datepickerOptions[b],("minMode"===b&&k.modes.indexOf(a.datepickerMode)<k.modes.indexOf(k[b])||"maxMode"===b&&k.modes.indexOf(a.datepickerMode)>k.modes.indexOf(k[b]))&&(a.datepickerMode=k[b])}):k[b]=a[b]=h[b]||null;break;case"initDate":a.datepickerOptions.initDate?(this.activeDate=j.fromTimezone(a.datepickerOptions.initDate,m.timezone)||new Date,a.$watch(function(){return a.datepickerOptions.initDate},function(a){a&&(l.$isEmpty(l.$modelValue)||l.$invalid)&&(k.activeDate=j.fromTimezone(a,m.timezone),k.refreshView())})):this.activeDate=new Date}}):(angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle"],function(c){k[c]=angular.isDefined(b[c])?d(b[c])(a.$parent):h[c]}),angular.forEach(["showWeeks","yearRows","yearColumns","shortcutPropagation"],function(c){k[c]=angular.isDefined(b[c])?a.$parent.$eval(b[c]):h[c]}),angular.isDefined(b.startingDay)?k.startingDay=a.$parent.$eval(b.startingDay):angular.isNumber(h.startingDay)?k.startingDay=h.startingDay:k.startingDay=(e.DATETIME_FORMATS.FIRSTDAYOFWEEK+8)%7,angular.forEach(["minDate","maxDate"],function(c){b[c]?n.push(a.$parent.$watch(b[c],function(a){a?angular.isDate(a)?k[c]=j.fromTimezone(new Date(a),m.timezone):k[c]=new Date(g(a,"medium")):k[c]=null,k.refreshView()})):k[c]=h[c]?j.fromTimezone(new Date(h[c]),m.timezone):null}),angular.forEach(["minMode","maxMode"],function(c){b[c]?n.push(a.$parent.$watch(b[c],function(d){k[c]=a[c]=angular.isDefined(d)?d:b[c],("minMode"===c&&k.modes.indexOf(a.datepickerMode)<k.modes.indexOf(k[c])||"maxMode"===c&&k.modes.indexOf(a.datepickerMode)>k.modes.indexOf(k[c]))&&(a.datepickerMode=k[c])})):k[c]=a[c]=h[c]||null}),angular.isDefined(b.initDate)?(this.activeDate=j.fromTimezone(a.$parent.$eval(b.initDate),m.timezone)||new Date,n.push(a.$parent.$watch(b.initDate,function(a){a&&(l.$isEmpty(l.$modelValue)||l.$invalid)&&(k.activeDate=j.fromTimezone(a,m.timezone),k.refreshView())}))):this.activeDate=new Date),a.datepickerMode=a.datepickerMode||h.datepickerMode,a.uniqueId="datepicker-"+a.$id+"-"+Math.floor(1e4*Math.random()),a.disabled=angular.isDefined(b.disabled)||!1,angular.isDefined(b.ngDisabled)&&n.push(a.$parent.$watch(b.ngDisabled,function(b){a.disabled=b,k.refreshView()})),a.isActive=function(b){return 0===k.compare(b.date,k.activeDate)&&(a.activeDateId=b.uid,!0)},this.init=function(a){l=a,m=a.$options||h.ngModelOptions,l.$modelValue&&(this.activeDate=l.$modelValue),l.$render=function(){k.render()}},this.render=function(){if(l.$viewValue){var a=new Date(l.$viewValue);!isNaN(a)?this.activeDate=j.fromTimezone(a,m.timezone):i||f.error('Datepicker directive: "ng-model" value must be a Date object')}this.refreshView()},this.refreshView=function(){if(this.element){a.selectedDt=null,this._refreshView(),a.activeDt&&(a.activeDateId=a.activeDt.uid);var b=l.$viewValue?new Date(l.$viewValue):null;b=j.fromTimezone(b,m.timezone),l.$setValidity("dateDisabled",!b||this.element&&!this.isDisabled(b))}},this.createDateObject=function(b,c){var d=l.$viewValue?new Date(l.$viewValue):null;d=j.fromTimezone(d,m.timezone);var e={date:b,label:j.filter(b,c),selected:d&&0===this.compare(b,d),disabled:this.isDisabled(b),current:0===this.compare(b,new Date),customClass:this.customClass(b)||null};return d&&0===this.compare(b,d)&&(a.selectedDt=e),k.activeDate&&0===this.compare(e.date,k.activeDate)&&(a.activeDt=e),e},this.isDisabled=function(c){return a.disabled||this.minDate&&this.compare(c,this.minDate)<0||this.maxDate&&this.compare(c,this.maxDate)>0||b.dateDisabled&&a.dateDisabled({date:c,mode:a.datepickerMode})},this.customClass=function(b){return a.customClass({date:b,mode:a.datepickerMode})},this.split=function(a,b){for(var c=[];a.length>0;)c.push(a.splice(0,b));return c},a.select=function(b){if(a.datepickerMode===k.minMode){var c=l.$viewValue?j.fromTimezone(new Date(l.$viewValue),m.timezone):new Date(0,0,0,0,0,0,0);c.setFullYear(b.getFullYear(),b.getMonth(),b.getDate()),c=j.toTimezone(c,m.timezone),l.$setViewValue(c),l.$render()}else k.activeDate=b,a.datepickerMode=k.modes[k.modes.indexOf(a.datepickerMode)-1]},a.move=function(a){var b=k.activeDate.getFullYear()+a*(k.step.years||0),c=k.activeDate.getMonth()+a*(k.step.months||0);k.activeDate.setFullYear(b,c,1),k.refreshView()},a.toggleMode=function(b){b=b||1,a.datepickerMode===k.maxMode&&1===b||a.datepickerMode===k.minMode&&-1===b||(a.datepickerMode=k.modes[k.modes.indexOf(a.datepickerMode)+b])},a.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};var o=function(){k.element[0].focus()};a.$on("uib:datepicker.focus",o),a.keydown=function(b){var c=a.keys[b.which];if(c&&!b.shiftKey&&!b.altKey&&!a.disabled)if(b.preventDefault(),k.shortcutPropagation||b.stopPropagation(),"enter"===c||"space"===c){if(k.isDisabled(k.activeDate))return;a.select(k.activeDate)}else!b.ctrlKey||"up"!==c&&"down"!==c?(k.handleKeyDown(c,b),k.refreshView()):a.toggleMode("up"===c?1:-1)},a.$on("$destroy",function(){for(;n.length;)n.shift()()})}]).controller("UibDaypickerController",["$scope","$element","dateFilter",function(a,b,c){function d(a,b){return 1!==b||a%4!=0||a%100==0&&a%400!=0?f[b]:29}function e(a){var b=new Date(a);b.setDate(b.getDate()+4-(b.getDay()||7));var c=b.getTime();return b.setMonth(0),b.setDate(1),Math.floor(Math.round((c-b)/864e5)/7)+1}var f=[31,28,31,30,31,30,31,31,30,31,30,31];this.step={months:1},this.element=b,this.init=function(b){angular.extend(b,this),a.showWeeks=b.showWeeks,b.refreshView()},this.getDates=function(a,b){for(var c,d=new Array(b),e=new Date(a),f=0;b>f;)c=new Date(e),d[f++]=c,e.setDate(e.getDate()+1);return d},this._refreshView=function(){var b=this.activeDate.getFullYear(),d=this.activeDate.getMonth(),f=new Date(this.activeDate);f.setFullYear(b,d,1);var g=this.startingDay-f.getDay(),h=g>0?7-g:-g,i=new Date(f);h>0&&i.setDate(1-h);for(var j=this.getDates(i,42),k=0;42>k;k++)j[k]=angular.extend(this.createDateObject(j[k],this.formatDay),{secondary:j[k].getMonth()!==d,uid:a.uniqueId+"-"+k});a.labels=new Array(7);for(var l=0;7>l;l++)a.labels[l]={abbr:c(j[l].date,this.formatDayHeader),full:c(j[l].date,"EEEE")};if(a.title=c(this.activeDate,this.formatDayTitle),a.rows=this.split(j,7),a.showWeeks){a.weekNumbers=[];for(var m=(11-this.startingDay)%7,n=a.rows.length,o=0;n>o;o++)a.weekNumbers.push(e(a.rows[o][m].date))}},this.compare=function(a,b){var c=new Date(a.getFullYear(),a.getMonth(),a.getDate()),d=new Date(b.getFullYear(),b.getMonth(),b.getDate());return c.setFullYear(a.getFullYear()),d.setFullYear(b.getFullYear()),c-d},this.handleKeyDown=function(a,b){var c=this.activeDate.getDate();if("left"===a)c-=1;else if("up"===a)c-=7;else if("right"===a)c+=1;else if("down"===a)c+=7;else if("pageup"===a||"pagedown"===a){var e=this.activeDate.getMonth()+("pageup"===a?-1:1);this.activeDate.setMonth(e,1),c=Math.min(d(this.activeDate.getFullYear(),this.activeDate.getMonth()),c)}else"home"===a?c=1:"end"===a&&(c=d(this.activeDate.getFullYear(),this.activeDate.getMonth()));this.activeDate.setDate(c)}}]).controller("UibMonthpickerController",["$scope","$element","dateFilter",function(a,b,c){this.step={years:1},this.element=b,this.init=function(a){angular.extend(a,this),a.refreshView()},this._refreshView=function(){for(var b,d=new Array(12),e=this.activeDate.getFullYear(),f=0;12>f;f++)b=new Date(this.activeDate),b.setFullYear(e,f,1),d[f]=angular.extend(this.createDateObject(b,this.formatMonth),{uid:a.uniqueId+"-"+f});a.title=c(this.activeDate,this.formatMonthTitle),a.rows=this.split(d,3)},this.compare=function(a,b){var c=new Date(a.getFullYear(),a.getMonth()),d=new Date(b.getFullYear(),b.getMonth());return c.setFullYear(a.getFullYear()),d.setFullYear(b.getFullYear()),c-d},this.handleKeyDown=function(a,b){var c=this.activeDate.getMonth();if("left"===a)c-=1;else if("up"===a)c-=3;else if("right"===a)c+=1;else if("down"===a)c+=3;else if("pageup"===a||"pagedown"===a){var d=this.activeDate.getFullYear()+("pageup"===a?-1:1);this.activeDate.setFullYear(d)}else"home"===a?c=0:"end"===a&&(c=11);this.activeDate.setMonth(c)}}]).controller("UibYearpickerController",["$scope","$element","dateFilter",function(a,b,c){function d(a){return parseInt((a-1)/f,10)*f+1}var e,f;this.element=b,this.yearpickerInit=function(){e=this.yearColumns,f=this.yearRows*e,this.step={years:f}},this._refreshView=function(){for(var b,c=new Array(f),g=0,h=d(this.activeDate.getFullYear());f>g;g++)b=new Date(this.activeDate),b.setFullYear(h+g,0,1),c[g]=angular.extend(this.createDateObject(b,this.formatYear),{uid:a.uniqueId+"-"+g});a.title=[c[0].label,c[f-1].label].join(" - "),a.rows=this.split(c,e),a.columns=e},this.compare=function(a,b){return a.getFullYear()-b.getFullYear()},this.handleKeyDown=function(a,b){var c=this.activeDate.getFullYear();"left"===a?c-=1:"up"===a?c-=e:"right"===a?c+=1:"down"===a?c+=e:"pageup"===a||"pagedown"===a?c+=("pageup"===a?-1:1)*f:"home"===a?c=d(this.activeDate.getFullYear()):"end"===a&&(c=d(this.activeDate.getFullYear())+f-1),this.activeDate.setFullYear(c)}}]).directive("uibDatepicker",function(){return{replace:!0,templateUrl:function(a,b){return b.templateUrl||"uib/template/datepicker/datepicker.html"},scope:{datepickerMode:"=?",datepickerOptions:"=?",dateDisabled:"&",customClass:"&",shortcutPropagation:"&?"},require:["uibDatepicker","^ngModel"],controller:"UibDatepickerController",controllerAs:"datepicker",link:function(a,b,c,d){var e=d[0],f=d[1];e.init(f)}}}).directive("uibDaypicker",function(){return{replace:!0,templateUrl:function(a,b){return b.templateUrl||"uib/template/datepicker/day.html"},require:["^uibDatepicker","uibDaypicker"],controller:"UibDaypickerController",link:function(a,b,c,d){var e=d[0];d[1].init(e)}}}).directive("uibMonthpicker",function(){return{replace:!0,templateUrl:function(a,b){return b.templateUrl||"uib/template/datepicker/month.html"},require:["^uibDatepicker","uibMonthpicker"],controller:"UibMonthpickerController",link:function(a,b,c,d){var e=d[0];d[1].init(e)}}}).directive("uibYearpicker",function(){return{replace:!0,templateUrl:function(a,b){return b.templateUrl||"uib/template/datepicker/year.html"},require:["^uibDatepicker","uibYearpicker"],controller:"UibYearpickerController",link:function(a,b,c,d){var e=d[0];angular.extend(e,d[1]),e.yearpickerInit(),e.refreshView()}}}).constant("uibDatepickerPopupConfig",{altInputFormats:[],appendToBody:!1,clearText:"Clear",closeOnDateSelection:!0,closeText:"Done",currentText:"Today",datepickerPopup:"yyyy-MM-dd",datepickerPopupTemplateUrl:"uib/template/datepicker/popup.html",datepickerTemplateUrl:"uib/template/datepicker/datepicker.html",html5Types:{date:"yyyy-MM-dd","datetime-local":"yyyy-MM-ddTHH:mm:ss.sss",month:"yyyy-MM"},onOpenFocus:!0,showButtonBar:!0}).controller("UibDatepickerPopupController",["$scope","$element","$attrs","$compile","$parse","$document","$rootScope","$uibPosition","dateFilter","uibDateParser","uibDatepickerPopupConfig","$timeout","uibDatepickerConfig",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}function o(b){var c=j.parse(b,t,a.date);if(isNaN(c))for(var d=0;d<E.length;d++)if(c=j.parse(b,E[d],a.date),!isNaN(c))return c;return c}function p(a){if(angular.isNumber(a)&&(a=new Date(a)),!a)return null;if(angular.isDate(a)&&!isNaN(a))return a;if(angular.isString(a)){var b=o(a);if(!isNaN(b))return j.toTimezone(b,C.timezone)}return B.$options&&B.$options.allowInvalid?a:void 0}function q(a,b){var d=a||b;return!c.ngRequired&&!d||(angular.isNumber(d)&&(d=new Date(d)),!d||(!(!angular.isDate(d)||isNaN(d))||!!angular.isString(d)&&!isNaN(o(b))))}function r(c){if(a.isOpen||!a.disabled){var d=D[0],e=b[0].contains(c.target),f=void 0!==d.contains&&d.contains(c.target);!a.isOpen||e||f||a.$apply(function(){a.isOpen=!1})}}function s(c){27===c.which&&a.isOpen?(c.preventDefault(),c.stopPropagation(),a.$apply(function(){a.isOpen=!1}),b[0].focus()):40!==c.which||a.isOpen||(c.preventDefault(),c.stopPropagation(),a.$apply(function(){a.isOpen=!0}))}var t,u,v,w,x,y,z,A,B,C,D,E,F={},G=!1,H=[];a.watchData={},this.init=function(h){if(B=h,C=h.$options||m.ngModelOptions,u=angular.isDefined(c.closeOnDateSelection)?a.$parent.$eval(c.closeOnDateSelection):k.closeOnDateSelection,v=angular.isDefined(c.datepickerAppendToBody)?a.$parent.$eval(c.datepickerAppendToBody):k.appendToBody,w=angular.isDefined(c.onOpenFocus)?a.$parent.$eval(c.onOpenFocus):k.onOpenFocus,x=angular.isDefined(c.datepickerPopupTemplateUrl)?c.datepickerPopupTemplateUrl:k.datepickerPopupTemplateUrl,y=angular.isDefined(c.datepickerTemplateUrl)?c.datepickerTemplateUrl:k.datepickerTemplateUrl,E=angular.isDefined(c.altInputFormats)?a.$parent.$eval(c.altInputFormats):k.altInputFormats,a.showButtonBar=angular.isDefined(c.showButtonBar)?a.$parent.$eval(c.showButtonBar):k.showButtonBar,k.html5Types[c.type]?(t=k.html5Types[c.type],G=!0):(t=c.uibDatepickerPopup||k.datepickerPopup,c.$observe("uibDatepickerPopup",function(a,b){var c=a||k.datepickerPopup;if(c!==t&&(t=c,B.$modelValue=null,!t))throw new Error("uibDatepickerPopup must have a date format specified.")})),!t)throw new Error("uibDatepickerPopup must have a date format specified.");if(G&&c.uibDatepickerPopup)throw new Error("HTML5 date input types do not support custom formats.");z=angular.element("<div uib-datepicker-popup-wrap><div uib-datepicker></div></div>"),a.ngModelOptions=angular.copy(C),a.ngModelOptions.timezone=null,z.attr({"ng-model":"date","ng-model-options":"ngModelOptions","ng-change":"dateSelection(date)","template-url":x}),A=angular.element(z.children()[0]),A.attr("template-url",y),G&&"month"===c.type&&(A.attr("datepicker-mode",'"month"'),A.attr("min-mode","month")),a.datepickerOptions&&angular.forEach(a.datepickerOptions,function(a,b){-1===["minDate","maxDate","minMode","maxMode","initDate","datepickerMode"].indexOf(b)?A.attr(n(b),a):A.attr(n(b),"datepickerOptions."+b)}),angular.forEach(["minMode","maxMode","datepickerMode","shortcutPropagation"],function(b){if(c[b]){var d=e(c[b]),f={get:function(){return d(a.$parent)}};if(A.attr(n(b),"watchData."+b),"datepickerMode"===b){var g=d.assign;f.set=function(b){g(a.$parent,b)}}Object.defineProperty(a.watchData,b,f)}}),angular.forEach(["minDate","maxDate","initDate"],function(b){if(c[b]){var d=e(c[b]);H.push(a.$parent.$watch(d,function(c){"minDate"===b||"maxDate"===b?(null===c?F[b]=null:angular.isDate(c)?F[b]=j.fromTimezone(new Date(c),C.timezone):F[b]=new Date(i(c,"medium")),a.watchData[b]=null===c?null:F[b]):a.watchData[b]=j.fromTimezone(new Date(c),C.timezone)})),A.attr(n(b),"watchData."+b)}}),c.dateDisabled&&A.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle","showWeeks","startingDay","yearRows","yearColumns"],function(a){angular.isDefined(c[a])&&A.attr(n(a),c[a])}),c.customClass&&A.attr("custom-class","customClass({ date: date, mode: mode })"),G?B.$formatters.push(function(b){return a.date=j.fromTimezone(b,C.timezone),b}):(B.$$parserName="date",B.$validators.date=q,B.$parsers.unshift(p),B.$formatters.push(function(b){return B.$isEmpty(b)?(a.date=b,b):(a.date=j.fromTimezone(b,C.timezone),angular.isNumber(a.date)&&(a.date=new Date(a.date)),j.filter(a.date,t))})),B.$viewChangeListeners.push(function(){a.date=o(B.$viewValue)}),b.on("keydown",s),D=d(z)(a),z.remove(),v?f.find("body").append(D):b.after(D),a.$on("$destroy",function(){for(!0===a.isOpen&&(g.$$phase||a.$apply(function(){a.isOpen=!1})),D.remove(),b.off("keydown",s),f.off("click",r);H.length;)H.shift()()})},a.getText=function(b){return a[b+"Text"]||k[b+"Text"]},a.isDisabled=function(b){return"today"===b&&(b=new Date),a.watchData.minDate&&a.compare(b,F.minDate)<0||a.watchData.maxDate&&a.compare(b,F.maxDate)>0},a.compare=function(a,b){return new Date(a.getFullYear(),a.getMonth(),a.getDate())-new Date(b.getFullYear(),b.getMonth(),b.getDate())},a.dateSelection=function(c){angular.isDefined(c)&&(a.date=c);var d=a.date?j.filter(a.date,t):null;b.val(d),B.$setViewValue(d),u&&(a.isOpen=!1,b[0].focus())},a.keydown=function(c){27===c.which&&(c.stopPropagation(),a.isOpen=!1,b[0].focus())},a.select=function(b){if("today"===b){var c=new Date;angular.isDate(a.date)?(b=new Date(a.date),b.setFullYear(c.getFullYear(),c.getMonth(),c.getDate())):b=new Date(c.setHours(0,0,0,0))}a.dateSelection(b)},a.close=function(){a.isOpen=!1,b[0].focus()},a.disabled=angular.isDefined(c.disabled)||!1,c.ngDisabled&&H.push(a.$parent.$watch(e(c.ngDisabled),function(b){a.disabled=b})),a.$watch("isOpen",function(c){c?a.disabled?a.isOpen=!1:(a.position=v?h.offset(b):h.position(b),a.position.top=a.position.top+b.prop("offsetHeight"),l(function(){w&&a.$broadcast("uib:datepicker.focus"),f.on("click",r)},0,!1)):f.off("click",r)})}]).directive("uibDatepickerPopup",function(){return{require:["ngModel","uibDatepickerPopup"],controller:"UibDatepickerPopupController",scope:{datepickerOptions:"=?",isOpen:"=?",currentText:"@",clearText:"@",closeText:"@",dateDisabled:"&",customClass:"&"},link:function(a,b,c,d){var e=d[0];d[1].init(e)}}}).directive("uibDatepickerPopupWrap",function(){return{replace:!0,transclude:!0,templateUrl:function(a,b){return b.templateUrl||"uib/template/datepicker/popup.html"}}}),angular.module("ui.bootstrap.debounce",[]).factory("$$debounce",["$timeout",function(a){return function(b,c){var d;return function(){var e=this,f=Array.prototype.slice.call(arguments);d&&a.cancel(d),d=a(function(){b.apply(e,f)},c)}}}]),angular.module("ui.bootstrap.dropdown",["ui.bootstrap.position"]).constant("uibDropdownConfig",{appendToOpenClass:"uib-dropdown-open",openClass:"open"}).service("uibDropdownService",["$document","$rootScope",function(a,b){var c=null;this.open=function(b){c||(a.on("click",d),a.on("keydown",e)),c&&c!==b&&(c.isOpen=!1),c=b},this.close=function(b){c===b&&(c=null,a.off("click",d),a.off("keydown",e))};var d=function(a){if(c&&!(a&&"disabled"===c.getAutoClose()||a&&3===a.which)){var d=c.getToggleElement();if(!(a&&d&&d[0].contains(a.target))){var e=c.getDropdownElement();a&&"outsideClick"===c.getAutoClose()&&e&&e[0].contains(a.target)||(c.isOpen=!1,b.$$phase||c.$apply())}}},e=function(a){27===a.which?(c.focusToggleElement(),d()):c.isKeynavEnabled()&&-1!==[38,40].indexOf(a.which)&&c.isOpen&&(a.preventDefault(),a.stopPropagation(),c.focusDropdownEntry(a.which))}}]).controller("UibDropdownController",["$scope","$element","$attrs","$parse","uibDropdownConfig","uibDropdownService","$animate","$uibPosition","$document","$compile","$templateRequest",function(a,b,c,d,e,f,g,h,i,j,k){var l,m,n=this,o=a.$new(),p=e.appendToOpenClass,q=e.openClass,r=angular.noop,s=c.onToggle?d(c.onToggle):angular.noop,t=!1,u=null,v=!1,w=i.find("body");b.addClass("dropdown"),this.init=function(){if(c.isOpen&&(m=d(c.isOpen),r=m.assign,a.$watch(m,function(a){o.isOpen=!!a})),angular.isDefined(c.dropdownAppendTo)){var e=d(c.dropdownAppendTo)(o);e&&(u=angular.element(e))}t=angular.isDefined(c.dropdownAppendToBody),v=angular.isDefined(c.keyboardNav),t&&!u&&(u=w),u&&n.dropdownMenu&&(u.append(n.dropdownMenu),b.on("$destroy",function(){n.dropdownMenu.remove()}))},this.toggle=function(a){return o.isOpen=arguments.length?!!a:!o.isOpen},this.isOpen=function(){return o.isOpen},o.getToggleElement=function(){return n.toggleElement},o.getAutoClose=function(){return c.autoClose||"always"},o.getElement=function(){return b},o.isKeynavEnabled=function(){return v},o.focusDropdownEntry=function(a){var c=n.dropdownMenu?angular.element(n.dropdownMenu).find("a"):b.find("ul").eq(0).find("a");switch(a){case 40:angular.isNumber(n.selectedOption)?n.selectedOption=n.selectedOption===c.length-1?n.selectedOption:n.selectedOption+1:n.selectedOption=0;break;case 38:angular.isNumber(n.selectedOption)?n.selectedOption=0===n.selectedOption?0:n.selectedOption-1:n.selectedOption=c.length-1}c[n.selectedOption].focus()},o.getDropdownElement=function(){return n.dropdownMenu},o.focusToggleElement=function(){n.toggleElement&&n.toggleElement[0].focus()},o.$watch("isOpen",function(c,d){if(u&&n.dropdownMenu){var e,i,m=h.positionElements(b,n.dropdownMenu,"bottom-left",!0);if(e={top:m.top+"px",display:c?"block":"none"},i=n.dropdownMenu.hasClass("dropdown-menu-right"),i?(e.left="auto",e.right=window.innerWidth-(m.left+b.prop("offsetWidth"))+"px"):(e.left=m.left+"px",e.right="auto"),!t){var v=h.offset(u);e.top=m.top-v.top+"px",i?e.right=window.innerWidth-(m.left-v.left+b.prop("offsetWidth"))+"px":e.left=m.left-v.left+"px"}n.dropdownMenu.css(e)}var w=u||b;if(g[c?"addClass":"removeClass"](w,u?p:q).then(function(){angular.isDefined(c)&&c!==d&&s(a,{open:!!c})}),c)n.dropdownMenuTemplateUrl&&k(n.dropdownMenuTemplateUrl).then(function(a){l=o.$new(),j(a.trim())(l,function(a){var b=a;n.dropdownMenu.replaceWith(b),n.dropdownMenu=b})}),o.focusToggleElement(),f.open(o);else{if(n.dropdownMenuTemplateUrl){l&&l.$destroy();var x=angular.element('<ul class="dropdown-menu"></ul>');n.dropdownMenu.replaceWith(x),n.dropdownMenu=x}f.close(o),n.selectedOption=null}angular.isFunction(r)&&r(a,c)}),a.$on("$locationChangeSuccess",function(){"disabled"!==o.getAutoClose()&&(o.isOpen=!1)})}]).directive("uibDropdown",function(){return{
controller:"UibDropdownController",link:function(a,b,c,d){d.init()}}}).directive("uibDropdownMenu",function(){return{restrict:"A",require:"?^uibDropdown",link:function(a,b,c,d){if(d&&!angular.isDefined(c.dropdownNested)){b.addClass("dropdown-menu");var e=c.templateUrl;e&&(d.dropdownMenuTemplateUrl=e),d.dropdownMenu||(d.dropdownMenu=b)}}}}).directive("uibDropdownToggle",function(){return{require:"?^uibDropdown",link:function(a,b,c,d){if(d){b.addClass("dropdown-toggle"),d.toggleElement=b;var e=function(e){e.preventDefault(),b.hasClass("disabled")||c.disabled||a.$apply(function(){d.toggle()})};b.bind("click",e),b.attr({"aria-haspopup":!0,"aria-expanded":!1}),a.$watch(d.isOpen,function(a){b.attr("aria-expanded",!!a)}),a.$on("$destroy",function(){b.unbind("click",e)})}}}}),angular.module("ui.bootstrap.stackedMap",[]).factory("$$stackedMap",function(){return{createNew:function(){var a=[];return{add:function(b,c){a.push({key:b,value:c})},get:function(b){for(var c=0;c<a.length;c++)if(b===a[c].key)return a[c]},keys:function(){for(var b=[],c=0;c<a.length;c++)b.push(a[c].key);return b},top:function(){return a[a.length-1]},remove:function(b){for(var c=-1,d=0;d<a.length;d++)if(b===a[d].key){c=d;break}return a.splice(c,1)[0]},removeTop:function(){return a.splice(a.length-1,1)[0]},length:function(){return a.length}}}}}),angular.module("ui.bootstrap.modal",["ui.bootstrap.stackedMap"]).factory("$$multiMap",function(){return{createNew:function(){var a={};return{entries:function(){return Object.keys(a).map(function(b){return{key:b,value:a[b]}})},get:function(b){return a[b]},hasKey:function(b){return!!a[b]},keys:function(){return Object.keys(a)},put:function(b,c){a[b]||(a[b]=[]),a[b].push(c)},remove:function(b,c){var d=a[b];if(d){var e=d.indexOf(c);-1!==e&&d.splice(e,1),d.length||delete a[b]}}}}}}).provider("$uibResolve",function(){var a=this;this.resolver=null,this.setResolver=function(a){this.resolver=a},this.$get=["$injector","$q",function(b,c){var d=a.resolver?b.get(a.resolver):null;return{resolve:function(a,e,f,g){if(d)return d.resolve(a,e,f,g);var h=[];return angular.forEach(a,function(a){angular.isFunction(a)||angular.isArray(a)?h.push(c.resolve(b.invoke(a))):angular.isString(a)?h.push(c.resolve(b.get(a))):h.push(c.resolve(a))}),c.all(h).then(function(b){var c={},d=0;return angular.forEach(a,function(a,e){c[e]=b[d++]}),c})}}}]}).directive("uibModalBackdrop",["$animateCss","$injector","$uibModalStack",function(a,b,c){function d(b,d,e){e.modalInClass&&(a(d,{addClass:e.modalInClass}).start(),b.$on(c.NOW_CLOSING_EVENT,function(c,f){var g=f();b.modalOptions.animation?a(d,{removeClass:e.modalInClass}).start().then(g):g()}))}return{replace:!0,templateUrl:"uib/template/modal/backdrop.html",compile:function(a,b){return a.addClass(b.backdropClass),d}}}]).directive("uibModalWindow",["$uibModalStack","$q","$animate","$animateCss","$document",function(a,b,c,d,e){return{scope:{index:"@"},replace:!0,transclude:!0,templateUrl:function(a,b){return b.templateUrl||"uib/template/modal/window.html"},link:function(f,g,h){g.addClass(h.windowClass||""),g.addClass(h.windowTopClass||""),f.size=h.size,f.close=function(b){var c=a.getTop();c&&c.value.backdrop&&"static"!==c.value.backdrop&&b.target===b.currentTarget&&(b.preventDefault(),b.stopPropagation(),a.dismiss(c.key,"backdrop click"))},g.on("click",f.close),f.$isRendered=!0;var i=b.defer();h.$observe("modalRender",function(a){"true"===a&&i.resolve()}),i.promise.then(function(){var i=null;h.modalInClass&&(i=d(g,{addClass:h.modalInClass}).start(),f.$on(a.NOW_CLOSING_EVENT,function(a,b){var e=b();d?d(g,{removeClass:h.modalInClass}).start().then(e):c.removeClass(g,h.modalInClass).then(e)})),b.when(i).then(function(){if(!e[0].activeElement||!g[0].contains(e[0].activeElement)){var a=g[0].querySelector("[autofocus]");a?a.focus():g[0].focus()}});var j=a.getTop();j&&a.modalRendered(j.key)})}}}]).directive("uibModalAnimationClass",function(){return{compile:function(a,b){b.modalAnimation&&a.addClass(b.uibModalAnimationClass)}}}).directive("uibModalTransclude",function(){return{link:function(a,b,c,d,e){e(a.$parent,function(a){b.empty(),b.append(a)})}}}).factory("$uibModalStack",["$animate","$animateCss","$document","$compile","$rootScope","$q","$$multiMap","$$stackedMap",function(a,b,c,d,e,f,g,h){function i(){for(var a=-1,b=t.keys(),c=0;c<b.length;c++)t.get(b[c]).value.backdrop&&(a=c);return a}function j(a,b){var c=t.get(a).value,d=c.appendTo;t.remove(a),m(c.modalDomEl,c.modalScope,function(){var b=c.openedClass||s;u.remove(b,a),d.toggleClass(b,u.hasKey(b)),k(!0)},c.closedDeferred),l(),b&&b.focus?b.focus():d.focus&&d.focus()}function k(a){var b;t.length()>0&&(b=t.top().value,b.modalDomEl.toggleClass(b.windowTopClass||"",a))}function l(){if(p&&-1===i()){var a=q;m(p,q,function(){a=null}),p=void 0,q=void 0}}function m(a,c,d,e){function g(){g.done||(g.done=!0,b(a,{event:"leave"}).start().then(function(){a.remove(),e&&e.resolve()}),c.$destroy(),d&&d())}var h,i=null,j=function(){return h||(h=f.defer(),i=h.promise),function(){h.resolve()}};return c.$broadcast(v.NOW_CLOSING_EVENT,j),f.when(i).then(g)}function n(a){if(a.isDefaultPrevented())return a;var b=t.top();if(b)switch(a.which){case 27:b.value.keyboard&&(a.preventDefault(),e.$apply(function(){v.dismiss(b.key,"escape key press")}));break;case 9:v.loadFocusElementList(b);var c=!1;a.shiftKey?(v.isFocusInFirstItem(a)||v.isModalFocused(a,b))&&(c=v.focusLastFocusableElement()):v.isFocusInLastItem(a)&&(c=v.focusFirstFocusableElement()),c&&(a.preventDefault(),a.stopPropagation())}}function o(a,b,c){return!a.value.modalScope.$broadcast("modal.closing",b,c).defaultPrevented}var p,q,r,s="modal-open",t=h.createNew(),u=g.createNew(),v={NOW_CLOSING_EVENT:"modal.stack.now-closing"},w=0;return e.$watch(i,function(a){q&&(q.index=a)}),c.on("keydown",n),e.$on("$destroy",function(){c.off("keydown",n)}),v.open=function(b,f){var g=c[0].activeElement,h=f.openedClass||s;k(!1),t.add(b,{deferred:f.deferred,renderDeferred:f.renderDeferred,closedDeferred:f.closedDeferred,modalScope:f.scope,backdrop:f.backdrop,keyboard:f.keyboard,openedClass:f.openedClass,windowTopClass:f.windowTopClass,animation:f.animation,appendTo:f.appendTo}),u.put(h,b);var j=f.appendTo,l=i();if(!j.length)throw new Error("appendTo element not found. Make sure that the element passed is in DOM.");l>=0&&!p&&(q=e.$new(!0),q.modalOptions=f,q.index=l,p=angular.element('<div uib-modal-backdrop="modal-backdrop"></div>'),p.attr("backdrop-class",f.backdropClass),f.animation&&p.attr("modal-animation","true"),d(p)(q),a.enter(p,j));var m=angular.element('<div uib-modal-window="modal-window"></div>');m.attr({"template-url":f.windowTemplateUrl,"window-class":f.windowClass,"window-top-class":f.windowTopClass,size:f.size,index:t.length()-1,animate:"animate"}).html(f.content),f.animation&&m.attr("modal-animation","true"),a.enter(d(m)(f.scope),j).then(function(){a.addClass(j,h)}),t.top().value.modalDomEl=m,t.top().value.modalOpener=g,v.clearFocusListCache()},v.close=function(a,b){var c=t.get(a);return c&&o(c,b,!0)?(c.value.modalScope.$$uibDestructionScheduled=!0,c.value.deferred.resolve(b),j(a,c.value.modalOpener),!0):!c},v.dismiss=function(a,b){var c=t.get(a);return c&&o(c,b,!1)?(c.value.modalScope.$$uibDestructionScheduled=!0,c.value.deferred.reject(b),j(a,c.value.modalOpener),!0):!c},v.dismissAll=function(a){for(var b=this.getTop();b&&this.dismiss(b.key,a);)b=this.getTop()},v.getTop=function(){return t.top()},v.modalRendered=function(a){var b=t.get(a);b&&b.value.renderDeferred.resolve()},v.focusFirstFocusableElement=function(){return r.length>0&&(r[0].focus(),!0)},v.focusLastFocusableElement=function(){return r.length>0&&(r[r.length-1].focus(),!0)},v.isModalFocused=function(a,b){if(a&&b){var c=b.value.modalDomEl;if(c&&c.length)return(a.target||a.srcElement)===c[0]}return!1},v.isFocusInFirstItem=function(a){return r.length>0&&(a.target||a.srcElement)===r[0]},v.isFocusInLastItem=function(a){return r.length>0&&(a.target||a.srcElement)===r[r.length-1]},v.clearFocusListCache=function(){r=[],w=0},v.loadFocusElementList=function(a){if((void 0===r||!r.length)&&a){var b=a.value.modalDomEl;b&&b.length&&(r=b[0].querySelectorAll("a[href], area[href], input:not([disabled]), button:not([disabled]),select:not([disabled]), textarea:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable=true]"))}},v}]).provider("$uibModal",function(){var a={options:{animation:!0,backdrop:!0,keyboard:!0},$get:["$rootScope","$q","$document","$templateRequest","$controller","$uibResolve","$uibModalStack",function(b,c,d,e,f,g,h){function i(a){return a.template?c.when(a.template):e(angular.isFunction(a.templateUrl)?a.templateUrl():a.templateUrl)}var j={},k=null;return j.getPromiseChain=function(){return k},j.open=function(e){function j(){return r}var l=c.defer(),m=c.defer(),n=c.defer(),o=c.defer(),p={result:l.promise,opened:m.promise,closed:n.promise,rendered:o.promise,close:function(a){return h.close(p,a)},dismiss:function(a){return h.dismiss(p,a)}};if(e=angular.extend({},a.options,e),e.resolve=e.resolve||{},e.appendTo=e.appendTo||d.find("body").eq(0),!e.template&&!e.templateUrl)throw new Error("One of template or templateUrl options is required.");var q,r=c.all([i(e),g.resolve(e.resolve,{},null,null)]);return q=k=c.all([k]).then(j,j).then(function(a){var c=e.scope||b,d=c.$new();d.$close=p.close,d.$dismiss=p.dismiss,d.$on("$destroy",function(){d.$$uibDestructionScheduled||d.$dismiss("$uibUnscheduledDestruction")});var g,i={};e.controller&&(i.$scope=d,i.$uibModalInstance=p,angular.forEach(a[1],function(a,b){i[b]=a}),g=f(e.controller,i),e.controllerAs&&(e.bindToController&&(g.$close=d.$close,g.$dismiss=d.$dismiss,angular.extend(g,c)),d[e.controllerAs]=g)),h.open(p,{scope:d,deferred:l,renderDeferred:o,closedDeferred:n,content:a[0],animation:e.animation,backdrop:e.backdrop,keyboard:e.keyboard,backdropClass:e.backdropClass,windowTopClass:e.windowTopClass,windowClass:e.windowClass,windowTemplateUrl:e.windowTemplateUrl,size:e.size,openedClass:e.openedClass,appendTo:e.appendTo}),m.resolve(!0)},function(a){m.reject(a),l.reject(a)}).finally(function(){k===q&&(k=null)}),p},j}]};return a}),angular.module("ui.bootstrap.paging",[]).factory("uibPaging",["$parse",function(a){return{create:function(b,c,d){b.setNumPages=d.numPages?a(d.numPages).assign:angular.noop,b.ngModelCtrl={$setViewValue:angular.noop},b._watchers=[],b.init=function(e,f){b.ngModelCtrl=e,b.config=f,e.$render=function(){b.render()},d.itemsPerPage?b._watchers.push(c.$parent.$watch(a(d.itemsPerPage),function(a){b.itemsPerPage=parseInt(a,10),c.totalPages=b.calculateTotalPages(),b.updatePage()})):b.itemsPerPage=f.itemsPerPage,c.$watch("totalItems",function(a,d){(angular.isDefined(a)||a!==d)&&(c.totalPages=b.calculateTotalPages(),b.updatePage())})},b.calculateTotalPages=function(){var a=b.itemsPerPage<1?1:Math.ceil(c.totalItems/b.itemsPerPage);return Math.max(a||0,1)},b.render=function(){c.page=parseInt(b.ngModelCtrl.$viewValue,10)||1},c.selectPage=function(a,d){d&&d.preventDefault(),(!c.ngDisabled||!d)&&c.page!==a&&a>0&&a<=c.totalPages&&(d&&d.target&&d.target.blur(),b.ngModelCtrl.$setViewValue(a),b.ngModelCtrl.$render())},c.getText=function(a){return c[a+"Text"]||b.config[a+"Text"]},c.noPrevious=function(){return 1===c.page},c.noNext=function(){return c.page===c.totalPages},b.updatePage=function(){b.setNumPages(c.$parent,c.totalPages),c.page>c.totalPages?c.selectPage(c.totalPages):b.ngModelCtrl.$render()},c.$on("$destroy",function(){for(;b._watchers.length;)b._watchers.shift()()})}}}]),angular.module("ui.bootstrap.pager",["ui.bootstrap.paging"]).controller("UibPagerController",["$scope","$attrs","uibPaging","uibPagerConfig",function(a,b,c,d){a.align=angular.isDefined(b.align)?a.$parent.$eval(b.align):d.align,c.create(this,a,b)}]).constant("uibPagerConfig",{itemsPerPage:10,previousText:" Previous",nextText:"Next ",align:!0}).directive("uibPager",["uibPagerConfig",function(a){return{scope:{totalItems:"=",previousText:"@",nextText:"@",ngDisabled:"="},require:["uibPager","?ngModel"],controller:"UibPagerController",controllerAs:"pager",templateUrl:function(a,b){return b.templateUrl||"uib/template/pager/pager.html"},replace:!0,link:function(b,c,d,e){var f=e[0],g=e[1];g&&f.init(g,a)}}}]),angular.module("ui.bootstrap.pagination",["ui.bootstrap.paging"]).controller("UibPaginationController",["$scope","$attrs","$parse","uibPaging","uibPaginationConfig",function(a,b,c,d,e){function f(a,b,c){return{number:a,text:b,active:c}}function g(a,b){var c=[],d=1,e=b,g=angular.isDefined(i)&&b>i;g&&(j?(d=Math.max(a-Math.floor(i/2),1),(e=d+i-1)>b&&(e=b,d=e-i+1)):(d=(Math.ceil(a/i)-1)*i+1,e=Math.min(d+i-1,b)));for(var h=d;e>=h;h++){var m=f(h,h,h===a);c.push(m)}if(g&&i>0&&(!j||k||l)){if(d>1){if(!l||d>3){var n=f(d-1,"...",!1);c.unshift(n)}if(l){if(3===d){var o=f(2,"2",!1);c.unshift(o)}var p=f(1,"1",!1);c.unshift(p)}}if(b>e){if(!l||b-2>e){var q=f(e+1,"...",!1);c.push(q)}if(l){if(e===b-2){var r=f(b-1,b-1,!1);c.push(r)}var s=f(b,b,!1);c.push(s)}}}return c}var h=this,i=angular.isDefined(b.maxSize)?a.$parent.$eval(b.maxSize):e.maxSize,j=angular.isDefined(b.rotate)?a.$parent.$eval(b.rotate):e.rotate,k=angular.isDefined(b.forceEllipses)?a.$parent.$eval(b.forceEllipses):e.forceEllipses,l=angular.isDefined(b.boundaryLinkNumbers)?a.$parent.$eval(b.boundaryLinkNumbers):e.boundaryLinkNumbers;a.boundaryLinks=angular.isDefined(b.boundaryLinks)?a.$parent.$eval(b.boundaryLinks):e.boundaryLinks,a.directionLinks=angular.isDefined(b.directionLinks)?a.$parent.$eval(b.directionLinks):e.directionLinks,d.create(this,a,b),b.maxSize&&h._watchers.push(a.$parent.$watch(c(b.maxSize),function(a){i=parseInt(a,10),h.render()}));var m=this.render;this.render=function(){m(),a.page>0&&a.page<=a.totalPages&&(a.pages=g(a.page,a.totalPages))}}]).constant("uibPaginationConfig",{itemsPerPage:10,boundaryLinks:!1,boundaryLinkNumbers:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0,forceEllipses:!1}).directive("uibPagination",["$parse","uibPaginationConfig",function(a,b){return{scope:{totalItems:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@",ngDisabled:"="},require:["uibPagination","?ngModel"],controller:"UibPaginationController",controllerAs:"pagination",templateUrl:function(a,b){return b.templateUrl||"uib/template/pagination/pagination.html"},replace:!0,link:function(a,c,d,e){var f=e[0],g=e[1];g&&f.init(g,b)}}}]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.stackedMap"]).provider("$uibTooltip",function(){function a(a){var b=/[A-Z]/g;return a.replace(b,function(a,b){return(b?"-":"")+a.toLowerCase()})}var b={placement:"top",placementClassPrefix:"",animation:!0,popupDelay:0,popupCloseDelay:0,useContentExp:!1},c={mouseenter:"mouseleave",click:"click",outsideClick:"outsideClick",focus:"blur",none:""},d={};this.options=function(a){angular.extend(d,a)},this.setTriggers=function(a){angular.extend(c,a)},this.$get=["$window","$compile","$timeout","$document","$uibPosition","$interpolate","$rootScope","$parse","$$stackedMap",function(e,f,g,h,i,j,k,l,m){function n(a){if(27===a.which){var b=o.top();b&&(b.value.close(),o.removeTop(),b=null)}}var o=m.createNew();return h.on("keypress",n),k.$on("$destroy",function(){h.off("keypress",n)}),function(e,k,m,n){function p(a){var b=(a||n.trigger||m).split(" ");return{show:b,hide:b.map(function(a){return c[a]||a})}}n=angular.extend({},b,d,n);var q=a(e),r=j.startSymbol(),s=j.endSymbol(),t="<div "+q+'-popup title="'+r+"title"+s+'" '+(n.useContentExp?'content-exp="contentExp()" ':'content="'+r+"content"+s+'" ')+'placement="'+r+"placement"+s+'" popup-class="'+r+"popupClass"+s+'" animation="animation" is-open="isOpen"origin-scope="origScope" style="visibility: hidden; display: block; top: -9999px; left: -9999px;"></div>';return{compile:function(a,b){var c=f(t);return function(a,b,d,f){function j(){M.isOpen?q():m()}function m(){(!L||a.$eval(d[k+"Enable"]))&&(u(),x(),M.popupDelay?G||(G=g(r,M.popupDelay,!1)):r())}function q(){s(),M.popupCloseDelay?H||(H=g(t,M.popupCloseDelay,!1)):t()}function r(){return s(),u(),M.content?(v(),void M.$evalAsync(function(){M.isOpen=!0,y(!0),R()})):angular.noop}function s(){G&&(g.cancel(G),G=null),I&&(g.cancel(I),I=null)}function t(){M&&M.$evalAsync(function(){M&&(M.isOpen=!1,y(!1),M.animation?F||(F=g(w,150,!1)):w())})}function u(){H&&(g.cancel(H),H=null),F&&(g.cancel(F),F=null)}function v(){D||(E=M.$new(),D=c(E,function(a){J?h.find("body").append(a):b.after(a)}),z())}function w(){s(),u(),A(),D&&(D.remove(),D=null),E&&(E.$destroy(),E=null)}function x(){M.title=d[k+"Title"],M.content=P?P(a):d[e],M.popupClass=d[k+"Class"],M.placement=angular.isDefined(d[k+"Placement"])?d[k+"Placement"]:n.placement;var b=parseInt(d[k+"PopupDelay"],10),c=parseInt(d[k+"PopupCloseDelay"],10);M.popupDelay=isNaN(b)?n.popupDelay:b,M.popupCloseDelay=isNaN(c)?n.popupCloseDelay:c}function y(b){O&&angular.isFunction(O.assign)&&O.assign(a,b)}function z(){Q.length=0,P?(Q.push(a.$watch(P,function(a){M.content=a,!a&&M.isOpen&&t()})),Q.push(E.$watch(function(){N||(N=!0,E.$$postDigest(function(){N=!1,M&&M.isOpen&&R()}))}))):Q.push(d.$observe(e,function(a){M.content=a,!a&&M.isOpen?t():R()})),Q.push(d.$observe(k+"Title",function(a){M.title=a,M.isOpen&&R()})),Q.push(d.$observe(k+"Placement",function(a){M.placement=a||n.placement,M.isOpen&&R()}))}function A(){Q.length&&(angular.forEach(Q,function(a){a()}),Q.length=0)}function B(a){M&&M.isOpen&&D&&(b[0].contains(a.target)||D[0].contains(a.target)||q())}function C(){var a=d[k+"Trigger"];S(),K=p(a),"none"!==K.show&&K.show.forEach(function(a,c){"outsideClick"===a?(b.on("click",j),h.on("click",B)):a===K.hide[c]?b.on(a,j):a&&(b.on(a,m),b.on(K.hide[c],q)),b.on("keypress",function(a){27===a.which&&q()})})}var D,E,F,G,H,I,J=!!angular.isDefined(n.appendToBody)&&n.appendToBody,K=p(void 0),L=angular.isDefined(d[k+"Enable"]),M=a.$new(!0),N=!1,O=!!angular.isDefined(d[k+"IsOpen"])&&l(d[k+"IsOpen"]),P=!!n.useContentExp&&l(d[e]),Q=[],R=function(){D&&D.html()&&(I||(I=g(function(){D.css({top:0,left:0});var a=i.positionElements(b,D,M.placement,J);D.css({top:a.top+"px",left:a.left+"px",visibility:"visible"}),n.placementClassPrefix&&D.removeClass("top bottom left right"),D.removeClass(n.placementClassPrefix+"top "+n.placementClassPrefix+"top-left "+n.placementClassPrefix+"top-right "+n.placementClassPrefix+"bottom "+n.placementClassPrefix+"bottom-left "+n.placementClassPrefix+"bottom-right "+n.placementClassPrefix+"left "+n.placementClassPrefix+"left-top "+n.placementClassPrefix+"left-bottom "+n.placementClassPrefix+"right "+n.placementClassPrefix+"right-top "+n.placementClassPrefix+"right-bottom");var c=a.placement.split("-");D.addClass(c[0]+" "+n.placementClassPrefix+a.placement),i.positionArrow(D,a.placement),I=null},0,!1)))};M.origScope=a,M.isOpen=!1,o.add(M,{close:t}),M.contentExp=function(){return M.content},d.$observe("disabled",function(a){a&&s(),a&&M.isOpen&&t()}),O&&a.$watch(O,function(a){M&&!a===M.isOpen&&j()});var S=function(){K.show.forEach(function(a){"outsideClick"===a?b.off("click",j):(b.off(a,m),b.off(a,j))}),K.hide.forEach(function(a){"outsideClick"===a?h.off("click",B):b.off(a,q)})};C();var T=a.$eval(d[k+"Animation"]);M.animation=angular.isDefined(T)?!!T:n.animation;var U,V=k+"AppendToBody";U=V in d&&void 0===d[V]||a.$eval(d[V]),J=angular.isDefined(U)?U:J,a.$on("$destroy",function(){S(),w(),o.remove(M),M=null})}}}}}]}).directive("uibTooltipTemplateTransclude",["$animate","$sce","$compile","$templateRequest",function(a,b,c,d){return{link:function(e,f,g){var h,i,j,k=e.$eval(g.tooltipTemplateTranscludeScope),l=0,m=function(){i&&(i.remove(),i=null),h&&(h.$destroy(),h=null),j&&(a.leave(j).then(function(){i=null}),i=j,j=null)};e.$watch(b.parseAsResourceUrl(g.uibTooltipTemplateTransclude),function(b){var g=++l;b?(d(b,!0).then(function(d){if(g===l){var e=k.$new(),i=d,n=c(i)(e,function(b){m(),a.enter(b,f)});h=e,j=n,h.$emit("$includeContentLoaded",b)}},function(){g===l&&(m(),e.$emit("$includeContentError",b))}),e.$emit("$includeContentRequested",b)):m()}),e.$on("$destroy",m)}}}]).directive("uibTooltipClasses",["$uibPosition",function(a){return{restrict:"A",link:function(b,c,d){if(b.placement){var e=a.parsePlacement(b.placement);c.addClass(e[0])}else c.addClass("top");b.popupClass&&c.addClass(b.popupClass),b.animation()&&c.addClass(d.tooltipAnimationClass)}}}]).directive("uibTooltipPopup",function(){return{replace:!0,scope:{content:"@",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"uib/template/tooltip/tooltip-popup.html"}}).directive("uibTooltip",["$uibTooltip",function(a){return a("uibTooltip","tooltip","mouseenter")}]).directive("uibTooltipTemplatePopup",function(){return{replace:!0,scope:{contentExp:"&",placement:"@",popupClass:"@",animation:"&",isOpen:"&",originScope:"&"},templateUrl:"uib/template/tooltip/tooltip-template-popup.html"}}).directive("uibTooltipTemplate",["$uibTooltip",function(a){return a("uibTooltipTemplate","tooltip","mouseenter",{useContentExp:!0})}]).directive("uibTooltipHtmlPopup",function(){return{replace:!0,scope:{contentExp:"&",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"uib/template/tooltip/tooltip-html-popup.html"}}).directive("uibTooltipHtml",["$uibTooltip",function(a){return a("uibTooltipHtml","tooltip","mouseenter",{useContentExp:!0})}]),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("uibPopoverTemplatePopup",function(){return{replace:!0,scope:{title:"@",contentExp:"&",placement:"@",popupClass:"@",animation:"&",isOpen:"&",originScope:"&"},templateUrl:"uib/template/popover/popover-template.html"}}).directive("uibPopoverTemplate",["$uibTooltip",function(a){return a("uibPopoverTemplate","popover","click",{useContentExp:!0})}]).directive("uibPopoverHtmlPopup",function(){return{replace:!0,scope:{contentExp:"&",title:"@",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"uib/template/popover/popover-html.html"}}).directive("uibPopoverHtml",["$uibTooltip",function(a){return a("uibPopoverHtml","popover","click",{useContentExp:!0})}]).directive("uibPopoverPopup",function(){return{replace:!0,scope:{title:"@",content:"@",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"uib/template/popover/popover.html"}}).directive("uibPopover",["$uibTooltip",function(a){return a("uibPopover","popover","click")}]),angular.module("ui.bootstrap.progressbar",[]).constant("uibProgressConfig",{animate:!0,max:100}).controller("UibProgressController",["$scope","$attrs","uibProgressConfig",function(a,b,c){var d=this,e=angular.isDefined(b.animate)?a.$parent.$eval(b.animate):c.animate;this.bars=[],a.max=angular.isDefined(a.max)?a.max:c.max,this.addBar=function(b,c,f){e||c.css({transition:"none"}),this.bars.push(b),b.max=a.max,b.title=f&&angular.isDefined(f.title)?f.title:"progressbar",b.$watch("value",function(a){b.recalculatePercentage()}),b.recalculatePercentage=function(){var a=d.bars.reduce(function(a,b){return b.percent=+(100*b.value/b.max).toFixed(2),a+b.percent},0);a>100&&(b.percent-=a-100)},b.$on("$destroy",function(){c=null,d.removeBar(b)})},this.removeBar=function(a){this.bars.splice(this.bars.indexOf(a),1),this.bars.forEach(function(a){a.recalculatePercentage()})},a.$watch("max",function(b){d.bars.forEach(function(b){b.max=a.max,b.recalculatePercentage()})})}]).directive("uibProgress",function(){return{replace:!0,transclude:!0,controller:"UibProgressController",require:"uibProgress",scope:{max:"=?"},templateUrl:"uib/template/progressbar/progress.html"}}).directive("uibBar",function(){return{replace:!0,transclude:!0,require:"^uibProgress",scope:{value:"=",type:"@"},templateUrl:"uib/template/progressbar/bar.html",link:function(a,b,c,d){d.addBar(a,b,c)}}}).directive("uibProgressbar",function(){return{replace:!0,transclude:!0,controller:"UibProgressController",scope:{value:"=",max:"=?",type:"@"},templateUrl:"uib/template/progressbar/progressbar.html",link:function(a,b,c,d){d.addBar(a,angular.element(b.children()[0]),{title:c.title})}}}),angular.module("ui.bootstrap.rating",[]).constant("uibRatingConfig",{max:5,stateOn:null,stateOff:null,titles:["one","two","three","four","five"]}).controller("UibRatingController",["$scope","$attrs","uibRatingConfig",function(a,b,c){var d={$setViewValue:angular.noop};this.init=function(e){d=e,d.$render=this.render,d.$formatters.push(function(a){return angular.isNumber(a)&&a<<0!==a&&(a=Math.round(a)),a}),this.stateOn=angular.isDefined(b.stateOn)?a.$parent.$eval(b.stateOn):c.stateOn,this.stateOff=angular.isDefined(b.stateOff)?a.$parent.$eval(b.stateOff):c.stateOff;var f=angular.isDefined(b.titles)?a.$parent.$eval(b.titles):c.titles;this.titles=angular.isArray(f)&&f.length>0?f:c.titles;var g=angular.isDefined(b.ratingStates)?a.$parent.$eval(b.ratingStates):new Array(angular.isDefined(b.max)?a.$parent.$eval(b.max):c.max);a.range=this.buildTemplateObjects(g)},this.buildTemplateObjects=function(a){for(var b=0,c=a.length;c>b;b++)a[b]=angular.extend({index:b},{stateOn:this.stateOn,stateOff:this.stateOff,title:this.getTitle(b)},a[b]);return a},this.getTitle=function(a){return a>=this.titles.length?a+1:this.titles[a]},a.rate=function(b){!a.readonly&&b>=0&&b<=a.range.length&&(d.$setViewValue(d.$viewValue===b?0:b),d.$render())},a.enter=function(b){a.readonly||(a.value=b),a.onHover({value:b})},a.reset=function(){a.value=d.$viewValue,a.onLeave()},a.onKeydown=function(b){/(37|38|39|40)/.test(b.which)&&(b.preventDefault(),b.stopPropagation(),a.rate(a.value+(38===b.which||39===b.which?1:-1)))},this.render=function(){a.value=d.$viewValue}}]).directive("uibRating",function(){return{require:["uibRating","ngModel"],scope:{readonly:"=?",onHover:"&",onLeave:"&"},controller:"UibRatingController",templateUrl:"uib/template/rating/rating.html",replace:!0,link:function(a,b,c,d){var e=d[0],f=d[1];e.init(f)}}}),angular.module("ui.bootstrap.tabs",[]).controller("UibTabsetController",["$scope",function(a){var b=this,c=b.tabs=a.tabs=[];b.select=function(a){angular.forEach(c,function(b){b.active&&b!==a&&(b.active=!1,b.onDeselect(),a.selectCalled=!1)}),a.active=!0,a.selectCalled||(a.onSelect(),a.selectCalled=!0)},b.addTab=function(a){c.push(a),1===c.length&&!1!==a.active?a.active=!0:a.active?b.select(a):a.active=!1},b.removeTab=function(a){var e=c.indexOf(a);if(a.active&&c.length>1&&!d){var f=e===c.length-1?e-1:e+1;b.select(c[f])}c.splice(e,1)};var d;a.$on("$destroy",function(){d=!0})}]).directive("uibTabset",function(){return{transclude:!0,replace:!0,scope:{type:"@"},controller:"UibTabsetController",templateUrl:"uib/template/tabs/tabset.html",link:function(a,b,c){a.vertical=!!angular.isDefined(c.vertical)&&a.$parent.$eval(c.vertical),a.justified=!!angular.isDefined(c.justified)&&a.$parent.$eval(c.justified)}}}).directive("uibTab",["$parse",function(a){return{require:"^uibTabset",replace:!0,templateUrl:"uib/template/tabs/tab.html",transclude:!0,scope:{active:"=?",heading:"@",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},controllerAs:"tab",link:function(b,c,d,e,f){b.$watch("active",function(a){a&&e.select(b)}),b.disabled=!1,d.disable&&b.$parent.$watch(a(d.disable),function(a){b.disabled=!!a}),b.select=function(){b.disabled||(b.active=!0)},e.addTab(b),b.$on("$destroy",function(){e.removeTab(b)}),b.$transcludeFn=f}}}]).directive("uibTabHeadingTransclude",function(){return{restrict:"A",require:"^uibTab",link:function(a,b){a.$watch("headingElement",function(a){a&&(b.html(""),b.append(a))})}}}).directive("uibTabContentTransclude",function(){function a(a){return a.tagName&&(a.hasAttribute("uib-tab-heading")||a.hasAttribute("data-uib-tab-heading")||a.hasAttribute("x-uib-tab-heading")||"uib-tab-heading"===a.tagName.toLowerCase()||"data-uib-tab-heading"===a.tagName.toLowerCase()||"x-uib-tab-heading"===a.tagName.toLowerCase())}return{restrict:"A",require:"^uibTabset",link:function(b,c,d){var e=b.$eval(d.uibTabContentTransclude);e.$transcludeFn(e.$parent,function(b){angular.forEach(b,function(b){a(b)?e.headingElement=b:c.append(b)})})}}}),angular.module("ui.bootstrap.timepicker",[]).constant("uibTimepickerConfig",{hourStep:1,minuteStep:1,secondStep:1,showMeridian:!0,showSeconds:!1,meridians:null,readonlyInput:!1,mousewheel:!0,arrowkeys:!0,showSpinners:!0,templateUrl:"uib/template/timepicker/timepicker.html"}).controller("UibTimepickerController",["$scope","$element","$attrs","$parse","$log","$locale","uibTimepickerConfig",function(a,b,c,d,e,f,g){function h(){var b=+a.hours;return(a.showMeridian?b>0&&13>b:b>=0&&24>b)?(a.showMeridian&&(12===b&&(b=0),a.meridian===u[1]&&(b+=12)),b):void 0}function i(){var b=+a.minutes;return b>=0&&60>b?b:void 0}function j(){var b=+a.seconds;return b>=0&&60>b?b:void 0}function k(a){return null===a?"":angular.isDefined(a)&&a.toString().length<2?"0"+a:a.toString()}function l(a){m(),t.$setViewValue(new Date(r)),n(a)}function m(){t.$setValidity("time",!0),a.invalidHours=!1,a.invalidMinutes=!1,a.invalidSeconds=!1}function n(b){if(t.$modelValue){var c=r.getHours(),d=r.getMinutes(),e=r.getSeconds();a.showMeridian&&(c=0===c||12===c?12:c%12),a.hours="h"===b?c:k(c),"m"!==b&&(a.minutes=k(d)),a.meridian=r.getHours()<12?u[0]:u[1],"s"!==b&&(a.seconds=k(e)),a.meridian=r.getHours()<12?u[0]:u[1]}else a.hours=null,a.minutes=null,a.seconds=null,a.meridian=u[0]}function o(a){r=q(r,a),l()}function p(a,b){return q(a,60*b)}function q(a,b){var c=new Date(a.getTime()+1e3*b),d=new Date(a);return d.setHours(c.getHours(),c.getMinutes(),c.getSeconds()),d}var r=new Date,s=[],t={$setViewValue:angular.noop},u=angular.isDefined(c.meridians)?a.$parent.$eval(c.meridians):g.meridians||f.DATETIME_FORMATS.AMPMS;a.tabindex=angular.isDefined(c.tabindex)?c.tabindex:0,b.removeAttr("tabindex"),this.init=function(b,d){t=b,t.$render=this.render,t.$formatters.unshift(function(a){return a?new Date(a):null});var e=d.eq(0),f=d.eq(1),h=d.eq(2);(angular.isDefined(c.mousewheel)?a.$parent.$eval(c.mousewheel):g.mousewheel)&&this.setupMousewheelEvents(e,f,h),(angular.isDefined(c.arrowkeys)?a.$parent.$eval(c.arrowkeys):g.arrowkeys)&&this.setupArrowkeyEvents(e,f,h),a.readonlyInput=angular.isDefined(c.readonlyInput)?a.$parent.$eval(c.readonlyInput):g.readonlyInput,this.setupInputEvents(e,f,h)};var v=g.hourStep;c.hourStep&&s.push(a.$parent.$watch(d(c.hourStep),function(a){v=+a}));var w=g.minuteStep;c.minuteStep&&s.push(a.$parent.$watch(d(c.minuteStep),function(a){w=+a}));var x;s.push(a.$parent.$watch(d(c.min),function(a){var b=new Date(a);x=isNaN(b)?void 0:b}));var y;s.push(a.$parent.$watch(d(c.max),function(a){var b=new Date(a);y=isNaN(b)?void 0:b}));var z=!1;c.ngDisabled&&s.push(a.$parent.$watch(d(c.ngDisabled),function(a){z=a})),a.noIncrementHours=function(){var a=p(r,60*v);return z||a>y||r>a&&x>a},a.noDecrementHours=function(){var a=p(r,60*-v);return z||x>a||a>r&&a>y},a.noIncrementMinutes=function(){var a=p(r,w);return z||a>y||r>a&&x>a},a.noDecrementMinutes=function(){var a=p(r,-w);return z||x>a||a>r&&a>y},a.noIncrementSeconds=function(){var a=q(r,A);return z||a>y||r>a&&x>a},a.noDecrementSeconds=function(){var a=q(r,-A);return z||x>a||a>r&&a>y},a.noToggleMeridian=function(){return r.getHours()<12?z||p(r,720)>y:z||p(r,-720)<x};var A=g.secondStep;c.secondStep&&s.push(a.$parent.$watch(d(c.secondStep),function(a){A=+a})),a.showSeconds=g.showSeconds,c.showSeconds&&s.push(a.$parent.$watch(d(c.showSeconds),function(b){a.showSeconds=!!b})),a.showMeridian=g.showMeridian,c.showMeridian&&s.push(a.$parent.$watch(d(c.showMeridian),function(b){if(a.showMeridian=!!b,t.$error.time){var c=h(),d=i();angular.isDefined(c)&&angular.isDefined(d)&&(r.setHours(c),l())}else n()})),this.setupMousewheelEvents=function(b,c,d){var e=function(a){a.originalEvent&&(a=a.originalEvent);var b=a.wheelDelta?a.wheelDelta:-a.deltaY;return a.detail||b>0};b.bind("mousewheel wheel",function(b){z||a.$apply(e(b)?a.incrementHours():a.decrementHours()),b.preventDefault()}),c.bind("mousewheel wheel",function(b){z||a.$apply(e(b)?a.incrementMinutes():a.decrementMinutes()),b.preventDefault()}),d.bind("mousewheel wheel",function(b){
z||a.$apply(e(b)?a.incrementSeconds():a.decrementSeconds()),b.preventDefault()})},this.setupArrowkeyEvents=function(b,c,d){b.bind("keydown",function(b){z||(38===b.which?(b.preventDefault(),a.incrementHours(),a.$apply()):40===b.which&&(b.preventDefault(),a.decrementHours(),a.$apply()))}),c.bind("keydown",function(b){z||(38===b.which?(b.preventDefault(),a.incrementMinutes(),a.$apply()):40===b.which&&(b.preventDefault(),a.decrementMinutes(),a.$apply()))}),d.bind("keydown",function(b){z||(38===b.which?(b.preventDefault(),a.incrementSeconds(),a.$apply()):40===b.which&&(b.preventDefault(),a.decrementSeconds(),a.$apply()))})},this.setupInputEvents=function(b,c,d){if(a.readonlyInput)return a.updateHours=angular.noop,a.updateMinutes=angular.noop,void(a.updateSeconds=angular.noop);var e=function(b,c,d){t.$setViewValue(null),t.$setValidity("time",!1),angular.isDefined(b)&&(a.invalidHours=b),angular.isDefined(c)&&(a.invalidMinutes=c),angular.isDefined(d)&&(a.invalidSeconds=d)};a.updateHours=function(){var a=h(),b=i();t.$setDirty(),angular.isDefined(a)&&angular.isDefined(b)?(r.setHours(a),r.setMinutes(b),x>r||r>y?e(!0):l("h")):e(!0)},b.bind("blur",function(b){t.$setTouched(),null===a.hours||""===a.hours?e(!0):!a.invalidHours&&a.hours<10&&a.$apply(function(){a.hours=k(a.hours)})}),a.updateMinutes=function(){var a=i(),b=h();t.$setDirty(),angular.isDefined(a)&&angular.isDefined(b)?(r.setHours(b),r.setMinutes(a),x>r||r>y?e(void 0,!0):l("m")):e(void 0,!0)},c.bind("blur",function(b){t.$setTouched(),null===a.minutes?e(void 0,!0):!a.invalidMinutes&&a.minutes<10&&a.$apply(function(){a.minutes=k(a.minutes)})}),a.updateSeconds=function(){var a=j();t.$setDirty(),angular.isDefined(a)?(r.setSeconds(a),l("s")):e(void 0,void 0,!0)},d.bind("blur",function(b){!a.invalidSeconds&&a.seconds<10&&a.$apply(function(){a.seconds=k(a.seconds)})})},this.render=function(){var b=t.$viewValue;isNaN(b)?(t.$setValidity("time",!1),e.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):(b&&(r=b),x>r||r>y?(t.$setValidity("time",!1),a.invalidHours=!0,a.invalidMinutes=!0):m(),n())},a.showSpinners=angular.isDefined(c.showSpinners)?a.$parent.$eval(c.showSpinners):g.showSpinners,a.incrementHours=function(){a.noIncrementHours()||o(60*v*60)},a.decrementHours=function(){a.noDecrementHours()||o(60*-v*60)},a.incrementMinutes=function(){a.noIncrementMinutes()||o(60*w)},a.decrementMinutes=function(){a.noDecrementMinutes()||o(60*-w)},a.incrementSeconds=function(){a.noIncrementSeconds()||o(A)},a.decrementSeconds=function(){a.noDecrementSeconds()||o(-A)},a.toggleMeridian=function(){var b=i(),c=h();a.noToggleMeridian()||(angular.isDefined(b)&&angular.isDefined(c)?o(720*(r.getHours()<12?60:-60)):a.meridian=a.meridian===u[0]?u[1]:u[0])},a.blur=function(){t.$setTouched()},a.$on("$destroy",function(){for(;s.length;)s.shift()()})}]).directive("uibTimepicker",["uibTimepickerConfig",function(a){return{require:["uibTimepicker","?^ngModel"],controller:"UibTimepickerController",controllerAs:"timepicker",replace:!0,scope:{},templateUrl:function(b,c){return c.templateUrl||a.templateUrl},link:function(a,b,c,d){var e=d[0],f=d[1];f&&e.init(f,b.find("input"))}}}]),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.debounce","ui.bootstrap.position"]).factory("uibTypeaheadParser",["$parse",function(a){var b=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;return{parse:function(c){var d=c.match(b);if(!d)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+c+'".');return{itemName:d[3],source:a(d[4]),viewMapper:a(d[2]||d[1]),modelMapper:a(d[1])}}}}]).controller("UibTypeaheadController",["$scope","$element","$attrs","$compile","$parse","$q","$timeout","$document","$window","$rootScope","$$debounce","$uibPosition","uibTypeaheadParser",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){N.moveInProgress||(N.moveInProgress=!0,N.$digest()),Y()}function o(){N.position=D?l.offset(b):l.position(b),N.position.top+=b.prop("offsetHeight")}var p,q,r=[9,13,27,38,40],s=200,t=a.$eval(c.typeaheadMinLength);t||0===t||(t=1);var u=a.$eval(c.typeaheadWaitMs)||0,v=!1!==a.$eval(c.typeaheadEditable);a.$watch(c.typeaheadEditable,function(a){v=!1!==a});var w,x,y=e(c.typeaheadLoading).assign||angular.noop,z=e(c.typeaheadOnSelect),A=!!angular.isDefined(c.typeaheadSelectOnBlur)&&a.$eval(c.typeaheadSelectOnBlur),B=e(c.typeaheadNoResults).assign||angular.noop,C=c.typeaheadInputFormatter?e(c.typeaheadInputFormatter):void 0,D=!!c.typeaheadAppendToBody&&a.$eval(c.typeaheadAppendToBody),E=c.typeaheadAppendTo?a.$eval(c.typeaheadAppendTo):null,F=!1!==a.$eval(c.typeaheadFocusFirst),G=!!c.typeaheadSelectOnExact&&a.$eval(c.typeaheadSelectOnExact),H=e(c.typeaheadIsOpen).assign||angular.noop,I=a.$eval(c.typeaheadShowHint)||!1,J=e(c.ngModel),K=e(c.ngModel+"($$$p)"),L=function(b,c){return angular.isFunction(J(a))&&q&&q.$options&&q.$options.getterSetter?K(b,{$$$p:c}):J.assign(b,c)},M=m.parse(c.uibTypeahead),N=a.$new(),O=a.$on("$destroy",function(){N.$destroy()});N.$on("$destroy",O);var P="typeahead-"+N.$id+"-"+Math.floor(1e4*Math.random());b.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":P});var Q,R;I&&(Q=angular.element("<div></div>"),Q.css("position","relative"),b.after(Q),R=b.clone(),R.attr("placeholder",""),R.val(""),R.css({position:"absolute",top:"0px",left:"0px","border-color":"transparent","box-shadow":"none",opacity:1,background:"none 0% 0% / auto repeat scroll padding-box border-box rgb(255, 255, 255)",color:"#999"}),b.css({position:"relative","vertical-align":"top","background-color":"transparent"}),Q.append(R),R.after(b));var S=angular.element("<div uib-typeahead-popup></div>");S.attr({id:P,matches:"matches",active:"activeIdx",select:"select(activeIdx, evt)","move-in-progress":"moveInProgress",query:"query",position:"position","assign-is-open":"assignIsOpen(isOpen)",debounce:"debounceUpdate"}),angular.isDefined(c.typeaheadTemplateUrl)&&S.attr("template-url",c.typeaheadTemplateUrl),angular.isDefined(c.typeaheadPopupTemplateUrl)&&S.attr("popup-template-url",c.typeaheadPopupTemplateUrl);var T=function(){I&&R.val("")},U=function(){N.matches=[],N.activeIdx=-1,b.attr("aria-expanded",!1),T()},V=function(a){return P+"-option-"+a};N.$watch("activeIdx",function(a){0>a?b.removeAttr("aria-activedescendant"):b.attr("aria-activedescendant",V(a))});var W=function(a,b){return!!(N.matches.length>b&&a)&&a.toUpperCase()===N.matches[b].label.toUpperCase()},X=function(c,d){var e={$viewValue:c};y(a,!0),B(a,!1),f.when(M.source(a,e)).then(function(f){var g=c===p.$viewValue;if(g&&w)if(f&&f.length>0){N.activeIdx=F?0:-1,B(a,!1),N.matches.length=0;for(var h=0;h<f.length;h++)e[M.itemName]=f[h],N.matches.push({id:V(h),label:M.viewMapper(N,e),model:f[h]});if(N.query=c,o(),b.attr("aria-expanded",!0),G&&1===N.matches.length&&W(c,0)&&(angular.isNumber(N.debounceUpdate)||angular.isObject(N.debounceUpdate)?k(function(){N.select(0,d)},angular.isNumber(N.debounceUpdate)?N.debounceUpdate:N.debounceUpdate.default):N.select(0,d)),I){var i=N.matches[0].label;angular.isString(c)&&c.length>0&&i.slice(0,c.length).toUpperCase()===c.toUpperCase()?R.val(c+i.slice(c.length)):R.val("")}}else U(),B(a,!0);g&&y(a,!1)},function(){U(),y(a,!1),B(a,!0)})};D&&(angular.element(i).on("resize",n),h.find("body").on("scroll",n));var Y=k(function(){N.matches.length&&o(),N.moveInProgress=!1},s);N.moveInProgress=!1,N.query=void 0;var Z,$=function(a){Z=g(function(){X(a)},u)},_=function(){Z&&g.cancel(Z)};U(),N.assignIsOpen=function(b){H(a,b)},N.select=function(d,e){var f,h,i={};x=!0,i[M.itemName]=h=N.matches[d].model,f=M.modelMapper(a,i),L(a,f),p.$setValidity("editable",!0),p.$setValidity("parse",!0),z(a,{$item:h,$model:f,$label:M.viewMapper(a,i),$event:e}),U(),!1!==N.$eval(c.typeaheadFocusOnSelect)&&g(function(){b[0].focus()},0,!1)},b.on("keydown",function(a){if(0!==N.matches.length&&-1!==r.indexOf(a.which)){if(-1===N.activeIdx&&(9===a.which||13===a.which))return U(),void N.$digest();a.preventDefault();var b;switch(a.which){case 9:case 13:N.$apply(function(){angular.isNumber(N.debounceUpdate)||angular.isObject(N.debounceUpdate)?k(function(){N.select(N.activeIdx,a)},angular.isNumber(N.debounceUpdate)?N.debounceUpdate:N.debounceUpdate.default):N.select(N.activeIdx,a)});break;case 27:a.stopPropagation(),U(),N.$digest();break;case 38:N.activeIdx=(N.activeIdx>0?N.activeIdx:N.matches.length)-1,N.$digest(),b=S.find("li")[N.activeIdx],b.parentNode.scrollTop=b.offsetTop;break;case 40:N.activeIdx=(N.activeIdx+1)%N.matches.length,N.$digest(),b=S.find("li")[N.activeIdx],b.parentNode.scrollTop=b.offsetTop}}}),b.bind("focus",function(a){w=!0,0!==t||p.$viewValue||g(function(){X(p.$viewValue,a)},0)}),b.bind("blur",function(a){A&&N.matches.length&&-1!==N.activeIdx&&!x&&(x=!0,N.$apply(function(){angular.isObject(N.debounceUpdate)&&angular.isNumber(N.debounceUpdate.blur)?k(function(){N.select(N.activeIdx,a)},N.debounceUpdate.blur):N.select(N.activeIdx,a)})),!v&&p.$error.editable&&(p.$viewValue="",b.val("")),w=!1,x=!1});var aa=function(a){b[0]!==a.target&&3!==a.which&&0!==N.matches.length&&(U(),j.$$phase||N.$digest())};h.on("click",aa),a.$on("$destroy",function(){h.off("click",aa),(D||E)&&ba.remove(),D&&(angular.element(i).off("resize",n),h.find("body").off("scroll",n)),S.remove(),I&&Q.remove()});var ba=d(S)(N);D?h.find("body").append(ba):E?angular.element(E).eq(0).append(ba):b.after(ba),this.init=function(b,c){p=b,q=c,N.debounceUpdate=p.$options&&e(p.$options.debounce)(a),p.$parsers.unshift(function(b){return w=!0,0===t||b&&b.length>=t?u>0?(_(),$(b)):X(b):(y(a,!1),_(),U()),v?b:b?void p.$setValidity("editable",!1):(p.$setValidity("editable",!0),null)}),p.$formatters.push(function(b){var c,d,e={};return v||p.$setValidity("editable",!0),C?(e.$model=b,C(a,e)):(e[M.itemName]=b,c=M.viewMapper(a,e),e[M.itemName]=void 0,d=M.viewMapper(a,e),c!==d?c:b)})}}]).directive("uibTypeahead",function(){return{controller:"UibTypeaheadController",require:["ngModel","^?ngModelOptions","uibTypeahead"],link:function(a,b,c,d){d[2].init(d[0],d[1])}}}).directive("uibTypeaheadPopup",["$$debounce",function(a){return{scope:{matches:"=",query:"=",active:"=",position:"&",moveInProgress:"=",select:"&",assignIsOpen:"&",debounce:"&"},replace:!0,templateUrl:function(a,b){return b.popupTemplateUrl||"uib/template/typeahead/typeahead-popup.html"},link:function(b,c,d){b.templateUrl=d.templateUrl,b.isOpen=function(){var a=b.matches.length>0;return b.assignIsOpen({isOpen:a}),a},b.isActive=function(a){return b.active===a},b.selectActive=function(a){b.active=a},b.selectMatch=function(c,d){var e=b.debounce();angular.isNumber(e)||angular.isObject(e)?a(function(){b.select({activeIdx:c,evt:d})},angular.isNumber(e)?e:e.default):b.select({activeIdx:c,evt:d})}}}}]).directive("uibTypeaheadMatch",["$templateRequest","$compile","$parse",function(a,b,c){return{scope:{index:"=",match:"=",query:"="},link:function(d,e,f){var g=c(f.templateUrl)(d.$parent)||"uib/template/typeahead/typeahead-match.html";a(g).then(function(a){var c=angular.element(a.trim());e.replaceWith(c),b(c)(d)})}}}]).filter("uibTypeaheadHighlight",["$sce","$injector","$log",function(a,b,c){function d(a){return a.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}function e(a){return/<.*>/g.test(a)}var f;return f=b.has("$sanitize"),function(b,g){return!f&&e(b)&&c.warn("Unsafe use of typeahead please use ngSanitize"),b=g?(""+b).replace(new RegExp(d(g),"gi"),"<strong>$&</strong>"):b,f||(b=a.trustAsHtml(b)),b}}]),angular.module("uib/template/accordion/accordion-group.html",[]).run(["$templateCache",function(a){a.put("uib/template/accordion/accordion-group.html",'<div class="panel" ng-class="panelClass || \'panel-default\'">\n  <div role="tab" id="{{::headingId}}" aria-selected="{{isOpen}}" class="panel-heading" ng-keypress="toggleOpen($event)">\n    <h4 class="panel-title">\n      <a role="button" data-toggle="collapse" href aria-expanded="{{isOpen}}" aria-controls="{{::panelId}}" tabindex="0" class="accordion-toggle" ng-click="toggleOpen()" uib-accordion-transclude="heading"><span ng-class="{\'text-muted\': isDisabled}">{{heading}}</span></a>\n    </h4>\n  </div>\n  <div id="{{::panelId}}" aria-labelledby="{{::headingId}}" aria-hidden="{{!isOpen}}" role="tabpanel" class="panel-collapse collapse" uib-collapse="!isOpen">\n    <div class="panel-body" ng-transclude></div>\n  </div>\n</div>\n')}]),angular.module("uib/template/accordion/accordion.html",[]).run(["$templateCache",function(a){a.put("uib/template/accordion/accordion.html",'<div role="tablist" class="panel-group" ng-transclude></div>')}]),angular.module("uib/template/alert/alert.html",[]).run(["$templateCache",function(a){a.put("uib/template/alert/alert.html",'<div class="alert" ng-class="[\'alert-\' + (type || \'warning\'), closeable ? \'alert-dismissible\' : null]" role="alert">\n    <button ng-show="closeable" type="button" class="close" ng-click="close({$event: $event})">\n        <span aria-hidden="true">&times;</span>\n        <span class="sr-only">Close</span>\n    </button>\n    <div ng-transclude></div>\n</div>\n')}]),angular.module("uib/template/carousel/carousel.html",[]).run(["$templateCache",function(a){a.put("uib/template/carousel/carousel.html",'<div ng-mouseenter="pause()" ng-mouseleave="play()" class="carousel" ng-swipe-right="prev()" ng-swipe-left="next()">\n  <div class="carousel-inner" ng-transclude></div>\n  <a role="button" href class="left carousel-control" ng-click="prev()" ng-show="slides.length > 1">\n    <span aria-hidden="true" class="glyphicon glyphicon-chevron-left"></span>\n    <span class="sr-only">previous</span>\n  </a>\n  <a role="button" href class="right carousel-control" ng-click="next()" ng-show="slides.length > 1">\n    <span aria-hidden="true" class="glyphicon glyphicon-chevron-right"></span>\n    <span class="sr-only">next</span>\n  </a>\n  <ol class="carousel-indicators" ng-show="slides.length > 1">\n    <li ng-repeat="slide in slides | orderBy:indexOfSlide track by $index" ng-class="{ active: isActive(slide) }" ng-click="select(slide)">\n      <span class="sr-only">slide {{ $index + 1 }} of {{ slides.length }}<span ng-if="isActive(slide)">, currently active</span></span>\n    </li>\n  </ol>\n</div>')}]),angular.module("uib/template/carousel/slide.html",[]).run(["$templateCache",function(a){a.put("uib/template/carousel/slide.html",'<div ng-class="{\n    \'active\': active\n  }" class="item text-center" ng-transclude></div>\n')}]),angular.module("uib/template/datepicker/datepicker.html",[]).run(["$templateCache",function(a){a.put("uib/template/datepicker/datepicker.html",'<div class="uib-datepicker" ng-switch="datepickerMode" role="application" ng-keydown="keydown($event)">\n  <uib-daypicker ng-switch-when="day" tabindex="0"></uib-daypicker>\n  <uib-monthpicker ng-switch-when="month" tabindex="0"></uib-monthpicker>\n  <uib-yearpicker ng-switch-when="year" tabindex="0"></uib-yearpicker>\n</div>')}]),angular.module("uib/template/datepicker/day.html",[]).run(["$templateCache",function(a){a.put("uib/template/datepicker/day.html",'<table class="uib-daypicker" role="grid" aria-labelledby="{{::uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left uib-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="{{::5 + showWeeks}}"><button id="{{::uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm uib-title" ng-click="toggleMode()" ng-disabled="datepickerMode === maxMode" tabindex="-1"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right uib-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n    <tr>\n      <th ng-if="showWeeks" class="text-center"></th>\n      <th ng-repeat="label in ::labels track by $index" class="text-center"><small aria-label="{{::label.full}}">{{::label.abbr}}</small></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr class="uib-weeks" ng-repeat="row in rows track by $index">\n      <td ng-if="showWeeks" class="text-center h6"><em>{{ weekNumbers[$index] }}</em></td>\n      <td ng-repeat="dt in row" class="uib-day text-center" role="gridcell"\n        id="{{::dt.uid}}"\n        ng-class="::dt.customClass">\n        <button type="button" class="btn btn-default btn-sm"\n          uib-is-class="\n            \'btn-info\' for selectedDt,\n            \'active\' for activeDt\n            on dt"\n          ng-click="select(dt.date)"\n          ng-disabled="::dt.disabled"\n          tabindex="-1"><span ng-class="::{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{::dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("uib/template/datepicker/month.html",[]).run(["$templateCache",function(a){a.put("uib/template/datepicker/month.html",'<table class="uib-monthpicker" role="grid" aria-labelledby="{{::uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left uib-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th><button id="{{::uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm uib-title" ng-click="toggleMode()" ng-disabled="datepickerMode === maxMode" tabindex="-1"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right uib-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr class="uib-months" ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row" class="uib-month text-center" role="gridcell"\n        id="{{::dt.uid}}"\n        ng-class="::dt.customClass">\n        <button type="button" class="btn btn-default"\n          uib-is-class="\n            \'btn-info\' for selectedDt,\n            \'active\' for activeDt\n            on dt"\n          ng-click="select(dt.date)"\n          ng-disabled="::dt.disabled"\n          tabindex="-1"><span ng-class="::{\'text-info\': dt.current}">{{::dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("uib/template/datepicker/popup.html",[]).run(["$templateCache",function(a){a.put("uib/template/datepicker/popup.html",'<div>\n  <ul class="uib-datepicker-popup dropdown-menu" dropdown-nested ng-if="isOpen" ng-style="{top: position.top+\'px\', left: position.left+\'px\'}" ng-keydown="keydown($event)" ng-click="$event.stopPropagation()">\n    <li ng-transclude></li>\n    <li ng-if="showButtonBar" class="uib-button-bar">\n    <span class="btn-group pull-left">\n      <button type="button" class="btn btn-sm btn-info uib-datepicker-current" ng-click="select(\'today\')" ng-disabled="isDisabled(\'today\')">{{ getText(\'current\') }}</button>\n      <button type="button" class="btn btn-sm btn-danger uib-clear" ng-click="select(null)">{{ getText(\'clear\') }}</button>\n    </span>\n      <button type="button" class="btn btn-sm btn-success pull-right uib-close" ng-click="close()">{{ getText(\'close\') }}</button>\n    </li>\n  </ul>\n</div>\n')}]),angular.module("uib/template/datepicker/year.html",[]).run(["$templateCache",function(a){a.put("uib/template/datepicker/year.html",'<table class="uib-yearpicker" role="grid" aria-labelledby="{{::uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left uib-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="{{::columns - 2}}"><button id="{{::uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm uib-title" ng-click="toggleMode()" ng-disabled="datepickerMode === maxMode" tabindex="-1"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right uib-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr class="uib-years" ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row" class="uib-year text-center" role="gridcell"\n        id="{{::dt.uid}}"\n        ng-class="::dt.customClass">\n        <button type="button" class="btn btn-default"\n          uib-is-class="\n            \'btn-info\' for selectedDt,\n            \'active\' for activeDt\n            on dt"\n          ng-click="select(dt.date)"\n          ng-disabled="::dt.disabled"\n          tabindex="-1"><span ng-class="::{\'text-info\': dt.current}">{{::dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("uib/template/modal/backdrop.html",[]).run(["$templateCache",function(a){a.put("uib/template/modal/backdrop.html",'<div class="modal-backdrop"\n     uib-modal-animation-class="fade"\n     modal-in-class="in"\n     ng-style="{\'z-index\': 1040 + (index && 1 || 0) + index*10}"\n></div>\n')}]),angular.module("uib/template/modal/window.html",[]).run(["$templateCache",function(a){a.put("uib/template/modal/window.html",'<div modal-render="{{$isRendered}}" tabindex="-1" role="dialog" class="modal"\n    uib-modal-animation-class="fade"\n    modal-in-class="in"\n    ng-style="{\'z-index\': 1050 + index*10, display: \'block\'}">\n    <div class="modal-dialog {{size ? \'modal-\' + size : \'\'}}"><div class="modal-content" uib-modal-transclude></div></div>\n</div>\n')}]),angular.module("uib/template/pager/pager.html",[]).run(["$templateCache",function(a){a.put("uib/template/pager/pager.html",'<ul class="pager">\n  <li ng-class="{disabled: noPrevious()||ngDisabled, previous: align}"><a href ng-click="selectPage(page - 1, $event)">{{::getText(\'previous\')}}</a></li>\n  <li ng-class="{disabled: noNext()||ngDisabled, next: align}"><a href ng-click="selectPage(page + 1, $event)">{{::getText(\'next\')}}</a></li>\n</ul>\n')}]),angular.module("uib/template/pagination/pagination.html",[]).run(["$templateCache",function(a){a.put("uib/template/pagination/pagination.html",'<ul class="pagination">\n  <li ng-if="::boundaryLinks" ng-class="{disabled: noPrevious()||ngDisabled}" class="pagination-first"><a href ng-click="selectPage(1, $event)">{{::getText(\'first\')}}</a></li>\n  <li ng-if="::directionLinks" ng-class="{disabled: noPrevious()||ngDisabled}" class="pagination-prev"><a href ng-click="selectPage(page - 1, $event)">{{::getText(\'previous\')}}</a></li>\n  <li ng-repeat="page in pages track by $index" ng-class="{active: page.active,disabled: ngDisabled&&!page.active}" class="pagination-page"><a href ng-click="selectPage(page.number, $event)">{{page.text}}</a></li>\n  <li ng-if="::directionLinks" ng-class="{disabled: noNext()||ngDisabled}" class="pagination-next"><a href ng-click="selectPage(page + 1, $event)">{{::getText(\'next\')}}</a></li>\n  <li ng-if="::boundaryLinks" ng-class="{disabled: noNext()||ngDisabled}" class="pagination-last"><a href ng-click="selectPage(totalPages, $event)">{{::getText(\'last\')}}</a></li>\n</ul>\n')}]),angular.module("uib/template/tooltip/tooltip-html-popup.html",[]).run(["$templateCache",function(a){a.put("uib/template/tooltip/tooltip-html-popup.html",'<div class="tooltip"\n  tooltip-animation-class="fade"\n  uib-tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind-html="contentExp()"></div>\n</div>\n')}]),angular.module("uib/template/tooltip/tooltip-popup.html",[]).run(["$templateCache",function(a){a.put("uib/template/tooltip/tooltip-popup.html",'<div class="tooltip"\n  tooltip-animation-class="fade"\n  uib-tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind="content"></div>\n</div>\n')}]),angular.module("uib/template/tooltip/tooltip-template-popup.html",[]).run(["$templateCache",function(a){a.put("uib/template/tooltip/tooltip-template-popup.html",'<div class="tooltip"\n  tooltip-animation-class="fade"\n  uib-tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner"\n    uib-tooltip-template-transclude="contentExp()"\n    tooltip-template-transclude-scope="originScope()"></div>\n</div>\n')}]),angular.module("uib/template/popover/popover-html.html",[]).run(["$templateCache",function(a){a.put("uib/template/popover/popover-html.html",'<div class="popover"\n  tooltip-animation-class="fade"\n  uib-tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="title" ng-if="title"></h3>\n      <div class="popover-content" ng-bind-html="contentExp()"></div>\n  </div>\n</div>\n')}]),angular.module("uib/template/popover/popover-template.html",[]).run(["$templateCache",function(a){a.put("uib/template/popover/popover-template.html",'<div class="popover"\n  tooltip-animation-class="fade"\n  uib-tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="title" ng-if="title"></h3>\n      <div class="popover-content"\n        uib-tooltip-template-transclude="contentExp()"\n        tooltip-template-transclude-scope="originScope()"></div>\n  </div>\n</div>\n')}]),angular.module("uib/template/popover/popover.html",[]).run(["$templateCache",function(a){a.put("uib/template/popover/popover.html",'<div class="popover"\n  tooltip-animation-class="fade"\n  uib-tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="title" ng-if="title"></h3>\n      <div class="popover-content" ng-bind="content"></div>\n  </div>\n</div>\n')}]),angular.module("uib/template/progressbar/bar.html",[]).run(["$templateCache",function(a){a.put("uib/template/progressbar/bar.html",'<div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: (percent < 100 ? percent : 100) + \'%\'}" aria-valuetext="{{percent | number:0}}%" aria-labelledby="{{::title}}" ng-transclude></div>\n')}]),angular.module("uib/template/progressbar/progress.html",[]).run(["$templateCache",function(a){a.put("uib/template/progressbar/progress.html",'<div class="progress" ng-transclude aria-labelledby="{{::title}}"></div>')}]),angular.module("uib/template/progressbar/progressbar.html",[]).run(["$templateCache",function(a){a.put("uib/template/progressbar/progressbar.html",'<div class="progress">\n  <div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: (percent < 100 ? percent : 100) + \'%\'}" aria-valuetext="{{percent | number:0}}%" aria-labelledby="{{::title}}" ng-transclude></div>\n</div>\n')}]),angular.module("uib/template/rating/rating.html",[]).run(["$templateCache",function(a){a.put("uib/template/rating/rating.html",'<span ng-mouseleave="reset()" ng-keydown="onKeydown($event)" tabindex="0" role="slider" aria-valuemin="0" aria-valuemax="{{range.length}}" aria-valuenow="{{value}}">\n    <span ng-repeat-start="r in range track by $index" class="sr-only">({{ $index < value ? \'*\' : \' \' }})</span>\n    <i ng-repeat-end ng-mouseenter="enter($index + 1)" ng-click="rate($index + 1)" class="glyphicon" ng-class="$index < value && (r.stateOn || \'glyphicon-star\') || (r.stateOff || \'glyphicon-star-empty\')" ng-attr-title="{{r.title}}" aria-valuetext="{{r.title}}"></i>\n</span>\n')}]),angular.module("uib/template/tabs/tab.html",[]).run(["$templateCache",function(a){a.put("uib/template/tabs/tab.html",'<li ng-class="{active: active, disabled: disabled}" class="uib-tab">\n  <a href ng-click="select()" uib-tab-heading-transclude>{{heading}}</a>\n</li>\n')}]),angular.module("uib/template/tabs/tabset.html",[]).run(["$templateCache",function(a){a.put("uib/template/tabs/tabset.html",'<div>\n  <ul class="nav nav-{{type || \'tabs\'}}" ng-class="{\'nav-stacked\': vertical, \'nav-justified\': justified}" ng-transclude></ul>\n  <div class="tab-content">\n    <div class="tab-pane" \n         ng-repeat="tab in tabs" \n         ng-class="{active: tab.active}"\n         uib-tab-content-transclude="tab">\n    </div>\n  </div>\n</div>\n')}]),angular.module("uib/template/timepicker/timepicker.html",[]).run(["$templateCache",function(a){
a.put("uib/template/timepicker/timepicker.html",'<table class="uib-timepicker">\n  <tbody>\n    <tr class="text-center" ng-show="::showSpinners">\n      <td class="uib-increment hours"><a ng-click="incrementHours()" ng-class="{disabled: noIncrementHours()}" class="btn btn-link" ng-disabled="noIncrementHours()" tabindex="{{::tabindex}}"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n      <td>&nbsp;</td>\n      <td class="uib-increment minutes"><a ng-click="incrementMinutes()" ng-class="{disabled: noIncrementMinutes()}" class="btn btn-link" ng-disabled="noIncrementMinutes()" tabindex="{{::tabindex}}"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n      <td ng-show="showSeconds">&nbsp;</td>\n      <td ng-show="showSeconds" class="uib-increment seconds"><a ng-click="incrementSeconds()" ng-class="{disabled: noIncrementSeconds()}" class="btn btn-link" ng-disabled="noIncrementSeconds()" tabindex="{{::tabindex}}"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n      <td ng-show="showMeridian"></td>\n    </tr>\n    <tr>\n      <td class="form-group uib-time hours" ng-class="{\'has-error\': invalidHours}">\n        <input style="width:50px;" type="text" placeholder="HH" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-readonly="::readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementHours()" ng-blur="blur()">\n      </td>\n      <td class="uib-separator">:</td>\n      <td class="form-group uib-time minutes" ng-class="{\'has-error\': invalidMinutes}">\n        <input style="width:50px;" type="text" placeholder="MM" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="::readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementMinutes()" ng-blur="blur()">\n      </td>\n      <td ng-show="showSeconds" class="uib-separator">:</td>\n      <td class="form-group uib-time seconds" ng-class="{\'has-error\': invalidSeconds}" ng-show="showSeconds">\n        <input style="width:50px;" type="text" placeholder="SS" ng-model="seconds" ng-change="updateSeconds()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementSeconds()" ng-blur="blur()">\n      </td>\n      <td ng-show="showMeridian" class="uib-time am-pm"><button type="button" ng-class="{disabled: noToggleMeridian()}" class="btn btn-default text-center" ng-click="toggleMeridian()" ng-disabled="noToggleMeridian()" tabindex="{{::tabindex}}">{{meridian}}</button></td>\n    </tr>\n    <tr class="text-center" ng-show="::showSpinners">\n      <td class="uib-decrement hours"><a ng-click="decrementHours()" ng-class="{disabled: noDecrementHours()}" class="btn btn-link" ng-disabled="noDecrementHours()" tabindex="{{::tabindex}}"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n      <td>&nbsp;</td>\n      <td class="uib-decrement minutes"><a ng-click="decrementMinutes()" ng-class="{disabled: noDecrementMinutes()}" class="btn btn-link" ng-disabled="noDecrementMinutes()" tabindex="{{::tabindex}}"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n      <td ng-show="showSeconds">&nbsp;</td>\n      <td ng-show="showSeconds" class="uib-decrement seconds"><a ng-click="decrementSeconds()" ng-class="{disabled: noDecrementSeconds()}" class="btn btn-link" ng-disabled="noDecrementSeconds()" tabindex="{{::tabindex}}"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n      <td ng-show="showMeridian"></td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("uib/template/typeahead/typeahead-match.html",[]).run(["$templateCache",function(a){a.put("uib/template/typeahead/typeahead-match.html",'<a href\n   tabindex="-1"\n   ng-bind-html="match.label | uibTypeaheadHighlight:query"\n   ng-attr-title="{{match.label}}"></a>\n')}]),angular.module("uib/template/typeahead/typeahead-popup.html",[]).run(["$templateCache",function(a){a.put("uib/template/typeahead/typeahead-popup.html",'<ul class="dropdown-menu" ng-show="isOpen() && !moveInProgress" ng-style="{top: position().top+\'px\', left: position().left+\'px\'}" role="listbox" aria-hidden="{{!isOpen()}}">\n    <li ng-repeat="match in matches track by $index" ng-class="{active: isActive($index) }" ng-mouseenter="selectActive($index)" ng-click="selectMatch($index, $event)" role="option" id="{{::match.id}}">\n        <div uib-typeahead-match index="$index" match="match" query="query" template-url="templateUrl"></div>\n    </li>\n</ul>\n')}]),angular.module("ui.bootstrap.carousel").run(function(){!angular.$$csp().noInlineStyle&&angular.element(document).find("head").prepend('<style type="text/css">.ng-animate.item:not(.left):not(.right){-webkit-transition:0s ease-in-out left;transition:0s ease-in-out left}</style>')}),angular.module("ui.bootstrap.datepicker").run(function(){!angular.$$csp().noInlineStyle&&angular.element(document).find("head").prepend('<style type="text/css">.uib-datepicker .uib-title{width:100%;}.uib-day button,.uib-month button,.uib-year button{min-width:100%;}.uib-datepicker-popup.dropdown-menu{display:block;}.uib-button-bar{padding:10px 9px 2px;}</style>')}),angular.module("ui.bootstrap.timepicker").run(function(){!angular.$$csp().noInlineStyle&&angular.element(document).find("head").prepend('<style type="text/css">.uib-time input{width:50px;}</style>')}),angular.module("ui.bootstrap.typeahead").run(function(){!angular.$$csp().noInlineStyle&&angular.element(document).find("head").prepend('<style type="text/css">[uib-typeahead-popup].dropdown-menu{display:block;}</style>')}),function(a,b){"use strict";b.module("ngIdle",["ngIdle.keepalive","ngIdle.idle","ngIdle.countdown","ngIdle.title","ngIdle.localStorage"]),b.module("ngIdle.keepalive",[]).provider("Keepalive",function(){var a={http:null,interval:600};this.http=function(c){if(!c)throw new Error("Argument must be a string containing a URL, or an object containing the HTTP request configuration.");b.isString(c)&&(c={url:c,method:"GET"}),c.cache=!1,a.http=c};var c=this.interval=function(b){if(b=parseInt(b),isNaN(b)||0>=b)throw new Error("Interval must be expressed in seconds and be greater than 0.");a.interval=b};this.$get=["$rootScope","$log","$interval","$http",function(d,e,f,g){function h(a,b){d.$broadcast("KeepaliveResponse",a,b)}function i(){d.$broadcast("Keepalive"),b.isObject(a.http)&&g(a.http).success(h).error(h)}var j={ping:null};return{_options:function(){return a},setInterval:c,start:function(){return f.cancel(j.ping),j.ping=f(i,1e3*a.interval),j.ping},stop:function(){f.cancel(j.ping)},ping:function(){i()}}}]}),b.module("ngIdle.idle",["ngIdle.keepalive","ngIdle.localStorage"]).provider("Idle",function(){var a={idle:1200,timeout:30,autoResume:"idle",interrupt:"mousemove keydown DOMMouseScroll mousewheel mousedown touchstart touchmove scroll",keepalive:!0},c=this.timeout=function(c){if(!1===c)a.timeout=0;else{if(!(b.isNumber(c)&&c>=0))throw new Error("Timeout must be zero or false to disable the feature, or a positive integer (in seconds) to enable it.");a.timeout=c}};this.interrupt=function(b){a.interrupt=b};var d=this.idle=function(b){if(0>=b)throw new Error("Idle must be a value in seconds, greater than 0.");a.idle=b};this.autoResume=function(b){a.autoResume=!0===b?"idle":!1===b?"off":b},this.keepalive=function(b){a.keepalive=!0===b},this.$get=["$interval","$log","$rootScope","$document","Keepalive","IdleLocalStorage","$window",function(b,e,f,g,h,i,j){function k(){a.keepalive&&(s.running&&h.ping(),h.start())}function l(){a.keepalive&&h.stop()}function m(){s.idling=!s.idling;var c=s.idling?"Start":"End";f.$broadcast("Idle"+c),s.idling?(l(),a.timeout&&(s.countdown=a.timeout,n(),s.timeout=b(n,1e3,a.timeout,!1))):k(),b.cancel(s.idle)}function n(){return s.countdown<=0?void o():(f.$broadcast("IdleWarn",s.countdown),void s.countdown--)}function o(){l(),b.cancel(s.idle),b.cancel(s.timeout),s.idling=!0,s.running=!1,s.countdown=0,f.$broadcast("IdleTimeout")}function p(a,b,c){var d=a.running();a.unwatch(),b(c),d&&a.watch()}function q(){return i.get("expiry").time}function r(a){a?i.set("expiry",{id:t,time:a}):i.remove("expiry")}var s={idle:null,timeout:null,idling:!1,running:!1,countdown:null},t=(new Date).getTime(),u={_options:function(){return a},_getNow:function(){return new Date},setIdle:function(a){p(this,d,a)},setTimeout:function(a){p(this,c,a)},isExpired:function(){var a=q();return a&&a<=this._getNow()},running:function(){return s.running},idling:function(){return s.idling},watch:function(c){b.cancel(s.idle),b.cancel(s.timeout);var d=a.timeout?a.timeout:0;c||r(new Date((new Date).getTime()+1e3*(a.idle+d))),s.idling?m():s.running||k(),s.running=!0,s.idle=b(m,1e3*a.idle,0,!1)},unwatch:function(){b.cancel(s.idle),b.cancel(s.timeout),s.idling=!1,s.running=!1,r(null),l()},interrupt:function(b){return s.running?a.timeout&&this.isExpired()?void o():void(("idle"===a.autoResume||"notIdle"===a.autoResume&&!s.idling)&&this.watch(b)):void 0}};g.find("body").on(a.interrupt,function(){u.interrupt()});var v=function(a){if("ngIdle.expiry"===a.key&&a.newValue!==a.oldValue){if(i.parseJson(a.newValue).id===t)return;u.interrupt(!0)}};return j.addEventListener?j.addEventListener("storage",v,!1):j.attachEvent("onstorage",v),u}]}),b.module("ngIdle.countdown",[]).directive("idleCountdown",function(){return{restrict:"A",scope:{value:"=idleCountdown"},link:function(a){a.$on("IdleWarn",function(b,c){a.$apply(function(){a.value=c})}),a.$on("IdleTimeout",function(){a.$apply(function(){a.value=0})})}}}),b.module("ngIdle.title",[]).factory("Title",["$document","$interpolate",function(a,c){function d(a,b,c){return Array(b-String(a).length+1).join(c||"0")+a}var e={original:null,idle:"{{minutes}}:{{seconds}} until your session times out!",timedout:"Your session has expired."};return{original:function(a){return b.isUndefined(a)?e.original:void(e.original=a)},store:function(a){(a||!e.original)&&(e.original=this.value())},value:function(c){return b.isUndefined(c)?a[0].title:void(a[0].title=c)},idleMessage:function(a){return b.isUndefined(a)?e.idle:void(e.idle=a)},timedOutMessage:function(a){return b.isUndefined(a)?e.timedout:void(e.timedout=a)},setAsIdle:function(a){this.store();var b={totalSeconds:a};b.minutes=Math.floor(a/60),b.seconds=d(a-60*b.minutes,2),this.value(c(this.idleMessage())(b))},setAsTimedOut:function(){this.store(),this.value(this.timedOutMessage())},restore:function(){this.original()&&this.value(this.original())}}}]).directive("title",["Title",function(a){return{restrict:"E",link:function(b,c,d){d.idleDisabled||(a.store(!0),b.$on("IdleWarn",function(b,c){a.setAsIdle(c)}),b.$on("IdleEnd",function(){a.restore()}),b.$on("IdleTimeout",function(){a.setAsTimedOut()}))}}}]),b.module("ngIdle.localStorage",[]).factory("IdleLocalStorage",["$window",function(a){function b(a){try{return JSON.parse(a,function(a,b){return/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(b)?new Date(b):b})}catch(b){return a}}var c=a.localStorage;return{set:function(a,b){c.setItem("ngIdle."+a,JSON.stringify(b))},get:function(a){return b(c.getItem("ngIdle."+a))},remove:function(a){c.removeItem("ngIdle."+a)},parseJson:function(a){return b(a)}}}])}(window,window.angular),angular.module("ui.bootstrap.datetimepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("uiDatetimePickerConfig",{dateFormat:"yyyy-MM-dd HH:mm",defaultTime:"00:00:00",html5Types:{date:"yyyy-MM-dd","datetime-local":"yyyy-MM-ddTHH:mm:ss.sss",month:"yyyy-MM"},initialPicker:"date",reOpenDefault:!1,enableDate:!0,enableTime:!0,buttonBar:{show:!0,now:{show:!0,text:"Now",cls:"btn-sm btn-default"},today:{show:!0,text:"Today",cls:"btn-sm btn-default"},clear:{show:!0,text:"Clear",cls:"btn-sm btn-default"},date:{show:!0,text:"Date",cls:"btn-sm btn-default"},time:{show:!0,text:"Time",cls:"btn-sm btn-default"},close:{show:!0,text:"Close",cls:"btn-sm btn-default"}},closeOnDateSelection:!0,closeOnTimeNow:!0,appendToBody:!1,altInputFormats:[],ngModelOptions:{timezone:null},saveAs:!1,readAs:!1}).controller("DateTimePickerController",["$scope","$element","$attrs","$compile","$parse","$document","$timeout","$uibPosition","dateFilter","uibDateParser","uiDatetimePickerConfig","$rootScope",function($scope,$element,$attrs,$compile,$parse,$document,$timeout,$uibPosition,dateFilter,uibDateParser,uiDatetimePickerConfig,$rootScope){function documentClickBind(evt){var popup=$popup[0],dpContainsTarget=$element[0].contains(evt.target),popupContainsTarget=void 0!==popup.contains&&popup.contains(evt.target);!$scope.isOpen||dpContainsTarget||popupContainsTarget||$scope.$apply(function(){$scope.close(!1)})}function inputKeydownBind(evt){27===evt.which&&$scope.isOpen?(evt.preventDefault(),evt.stopPropagation(),$scope.$apply(function(){$scope.close(!1)}),$element[0].focus()):40!==evt.which||$scope.isOpen||(evt.preventDefault(),evt.stopPropagation(),$scope.$apply(function(){$scope.isOpen=!0}))}function cameltoDash(string){return string.replace(/([A-Z])/g,function($1){return"-"+$1.toLowerCase()})}function parseDateString(viewValue){var date=uibDateParser.parse(viewValue,dateFormat,$scope.date);if(isNaN(date))for(var i=0;i<altInputFormats.length;i++)if(date=uibDateParser.parse(viewValue,altInputFormats[i],$scope.date),!isNaN(date))return date;return date}function parseDate(viewValue){if(angular.isNumber(viewValue)&&!isNaN(viewValue)&&(viewValue=new Date(viewValue)),!viewValue)return null;if(angular.isDate(viewValue)&&!isNaN(viewValue))return viewValue;if(angular.isString(viewValue)){var date=parseDateString(viewValue);if(!isNaN(date))return uibDateParser.toTimezone(date,ngModelOptions.timezone)}else;}function validateMinMax(value){return!($scope.datepickerOptions.minDate&&value<$scope.datepickerOptions.minDate)&&!($scope.datepickerOptions.maxDate&&value>$scope.datepickerOptions.maxDate)}function validator(modelValue,viewValue){var value=modelValue||viewValue;return!($attrs.ngRequired||$attrs.required||value)||(angular.isNumber(value)&&(value=new Date(value)),!value||(angular.isDate(value)&&!isNaN(value)?validateMinMax(value):angular.isDate(new Date(value))&&!isNaN(new Date(value).valueOf())?validateMinMax(new Date(value)):!!angular.isString(value)&&(!isNaN(parseDateString(viewValue))&&validateMinMax(parseDateString(viewValue)))))}var ngModel,ngModelOptions,$popup,dateFormat=uiDatetimePickerConfig.dateFormat,cache={},watchListeners=[],closeOnDateSelection=angular.isDefined($attrs.closeOnDateSelection)?$scope.$parent.$eval($attrs.closeOnDateSelection):uiDatetimePickerConfig.closeOnDateSelection,closeOnTimeNow=angular.isDefined($attrs.closeOnTimeNow)?$scope.$parent.$eval($attrs.closeOnTimeNow):uiDatetimePickerConfig.closeOnTimeNow,appendToBody=angular.isDefined($attrs.datepickerAppendToBody)?$scope.$parent.$eval($attrs.datepickerAppendToBody):uiDatetimePickerConfig.appendToBody,altInputFormats=angular.isDefined($attrs.altInputFormats)?$scope.$parent.$eval($attrs.altInputFormats):uiDatetimePickerConfig.altInputFormats,saveAs=angular.isDefined($attrs.saveAs)?$scope.$parent.$eval($attrs.saveAs)||$attrs.saveAs:uiDatetimePickerConfig.saveAs,readAs=angular.isDefined($attrs.readAs)?$scope.$parent.$eval($attrs.readAs):uiDatetimePickerConfig.readAs;this.init=function(_ngModel){function readAsFormatter(value){if(ngModel.$isEmpty(value))return value;var d=new Date(value);return angular.isDate(d)&&!isNaN(d)?d:value}function saveAsParser(value){return!value||angular.isString(value)||!angular.isDate(value)||isNaN(value)?value:"ISO"===saveAs?value.toISOString():"json"===saveAs?value.toJSON():"number"===saveAs?value.valueOf():isHtml5DateInput?uibDateParser.fromTimezone(value,ngModelOptions.timezone).toLocaleString():(dateFormat=dateFormat.replace(/M!/,"MM").replace(/d!/,"dd"),uibDateParser.filter(uibDateParser.fromTimezone(value,ngModelOptions.timezone),dateFormat))}if(ngModel=_ngModel,ngModelOptions=ngModel.$options||uiDatetimePickerConfig.ngModelOptions,$scope.buttonBar=angular.isDefined($attrs.buttonBar)?$scope.$parent.$eval($attrs.buttonBar):uiDatetimePickerConfig.buttonBar,$scope.enableDate=angular.isDefined($scope.enableDate)?$scope.enableDate:uiDatetimePickerConfig.enableDate,$scope.enableTime=angular.isDefined($scope.enableTime)?$scope.enableTime:uiDatetimePickerConfig.enableTime,$scope.initialPicker=angular.isDefined($attrs.initialPicker)?$attrs.initialPicker:$scope.enableDate?uiDatetimePickerConfig.initialPicker:"time",$scope.reOpenDefault=angular.isDefined($attrs.reOpenDefault)?$attrs.reOpenDefault:uiDatetimePickerConfig.reOpenDefault,"date"==$scope.initialPicker&&!$scope.enableDate)throw new Error("datetimePicker can't have initialPicker set to date and have enableDate set to false.");$scope.showPicker=$scope.enableDate?$scope.initialPicker:"time";var isHtml5DateInput=!1;if(uiDatetimePickerConfig.html5Types[$attrs.type]?(dateFormat=uiDatetimePickerConfig.html5Types[$attrs.type],isHtml5DateInput=!0):(dateFormat=$attrs.datetimePicker||uiDatetimePickerConfig.dateFormat,$attrs.$observe("datetimePicker",function(value){var newDateFormat=value||uiDatetimePickerConfig.dateFormat;if(newDateFormat!==dateFormat&&(dateFormat=newDateFormat,ngModel.$modelValue=null,!dateFormat))throw new Error("datetimePicker must have a date format specified.")})),!dateFormat)throw new Error("datetimePicker must have a date format specified.");var popupEl=angular.element('<div date-picker-wrap><div uib-datepicker></div></div><div time-picker-wrap><div uib-timepicker style="margin:0 auto"></div></div>');$scope.ngModelOptions=angular.copy(ngModelOptions),!0===$scope.ngModelOptions.updateOnDefault&&($scope.ngModelOptions.updateOn=$scope.ngModelOptions.updateOn?$scope.ngModelOptions.updateOn+" default":"default"),popupEl.attr({"ng-model":"date","ng-model-options":"ngModelOptions","ng-change":"dateSelection(date)"});var datepickerEl=angular.element(popupEl.children()[0]);$scope.datepickerOptions||($scope.datepickerOptions={}),isHtml5DateInput&&"month"===$attrs.type&&($scope.datepickerOptions.datepickerMode="month",$scope.datepickerOptions.minMode="month"),datepickerEl.attr("datepicker-options","datepickerOptions"),angular.isDefined($scope.datepickerOptions.datepickerMode)||($scope.datepickerOptions.datepickerMode="day");var timepickerEl=angular.element(popupEl.children()[1]);$scope.timepickerOptions||($scope.timepickerOptions={showMeridian:!0});for(var key in $scope.timepickerOptions)timepickerEl.attr(cameltoDash(key),"timepickerOptions."+key);angular.forEach(["minDate","maxDate","initDate"],function(key){$scope.datepickerOptions[key]&&("minDate"==key?timepickerEl.attr("min","datepickerOptions.minDate"):"maxDate"==key&&timepickerEl.attr("max","datepickerOptions.maxDate"))}),isHtml5DateInput?ngModel.$formatters.push(function(value){return $scope.date=uibDateParser.fromTimezone(value,ngModelOptions.timezone),value}):(ngModel.$$parserName="datetime",ngModel.$validators.datetime=validator,ngModel.$parsers.unshift(parseDate),ngModel.$formatters.push(function(value){return ngModel.$isEmpty(value)?($scope.date=value,value):($scope.date=uibDateParser.fromTimezone(value,ngModelOptions.timezone),dateFormat=dateFormat.replace(/M!/,"MM").replace(/d!/,"dd"),uibDateParser.filter($scope.date,dateFormat))})),saveAs&&(angular.isFunction(saveAs)?ngModel.$parsers.push(saveAs):ngModel.$parsers.push(saveAsParser),angular.isFunction(readAs)?ngModel.$formatters.push(readAs):ngModel.$formatters.push(readAsFormatter)),ngModel.$viewChangeListeners.push(function(){$scope.date=parseDateString(ngModel.$viewValue)}),$element.bind("keydown",inputKeydownBind),$popup=$compile(popupEl)($scope),popupEl.remove(),appendToBody?$document.find("body").append($popup):$element.after($popup)},$scope.getText=function(key){return $scope.buttonBar[key].text||uiDatetimePickerConfig.buttonBar[key].text},$scope.getClass=function(key){return $scope.buttonBar[key].cls||uiDatetimePickerConfig.buttonBar[key].cls},$scope.keydown=function(evt){27===evt.which&&(evt.preventDefault(),evt.stopPropagation(),$scope.close(!1),$timeout(function(){$element[0].focus()},0))},$scope.doShow=function(key){return angular.isDefined($scope.buttonBar[key].show)?$scope.buttonBar[key].show:uiDatetimePickerConfig.buttonBar[key].show},$scope.dateSelection=function(dt,opt){if($scope.enableTime&&"time"===$scope.showPicker)if(dt||null!=dt){if(angular.isDefined($scope.date)&&null!=$scope.date||($scope.date=new Date),dt&&null!=dt){var date=new Date($scope.date);date.setHours(dt.getHours()),date.setMinutes(dt.getMinutes()),date.setSeconds(dt.getSeconds()),date.setMilliseconds(dt.getMilliseconds()),dt=date}}else $scope.oldDate=$scope.date;if(angular.isDefined(dt)){if(!$scope.date){var defaultTime=angular.isDefined($attrs.defaultTime)?$attrs.defaultTime:uiDatetimePickerConfig.defaultTime,t=new Date("2001-01-01 "+defaultTime);isNaN(t)||null==dt||(dt.setHours(t.getHours()),dt.setMinutes(t.getMinutes()),dt.setSeconds(t.getSeconds()),dt.setMilliseconds(t.getMilliseconds()))}$scope.date=dt,dt&&$scope.oldDate&&(dt.setDate($scope.oldDate.getDate()),dt.setMonth($scope.oldDate.getMonth()),dt.setFullYear($scope.oldDate.getFullYear()),delete $scope.oldDate)}var date=$scope.date?dateFilter($scope.date,dateFormat):null;$element.val(date),ngModel.$setViewValue(date),closeOnDateSelection&&("time"!=$scope.showPicker&&null!=date?$scope.enableTime?$scope.open("time"):$scope.close(!1):closeOnTimeNow&&"time"===$scope.showPicker&&null!=date&&"now"===opt&&$scope.close(!1))},$scope.$watch("isOpen",function(value){if($scope.dropdownStyle={display:value?"block":"none"},value){cache.openDate=$scope.date;var position=appendToBody?$uibPosition.offset($element):$uibPosition.position($element);$scope.dropdownStyle.top=appendToBody?position.top+$element.prop("offsetHeight")+"px":void 0,$scope.dropdownStyle.left=position.left+"px",$timeout(function(){$scope.$broadcast("uib:datepicker.focus"),$document.bind("click",documentClickBind)},0,!1),$scope.open($scope.showPicker)}else $document.unbind("click",documentClickBind)}),$scope.isDisabled=function(date){"today"!==date&&"now"!==date||(date=uibDateParser.fromTimezone(new Date,ngModelOptions.timezone));var dates={};return angular.forEach(["minDate","maxDate"],function(key){$scope.datepickerOptions[key]?angular.isDate($scope.datepickerOptions[key])?dates[key]=uibDateParser.fromTimezone(new Date($scope.datepickerOptions[key]),ngModelOptions.timezone):dates[key]=new Date(dateFilter($scope.datepickerOptions[key],"medium")):dates[key]=null}),$scope.datepickerOptions&&dates.minDate&&$scope.compare(date,dates.minDate)<0||dates.maxDate&&$scope.compare(date,dates.maxDate)>0},$scope.compare=function(date1,date2){return new Date(date1.getFullYear(),date1.getMonth(),date1.getDate())-new Date(date2.getFullYear(),date2.getMonth(),date2.getDate())},$scope.select=function(opt,evt){angular.isDefined(evt)&&(evt.preventDefault(),evt.stopPropagation());var date=null;if("today"===opt||"now"==opt){var now=new Date;angular.isDate($scope.date)?(date=new Date($scope.date),date.setFullYear(now.getFullYear(),now.getMonth(),now.getDate()),date.setHours(now.getHours(),now.getMinutes(),now.getSeconds(),now.getMilliseconds())):date=now}$scope.dateSelection(date,opt)},$scope.open=function(picker,evt){angular.isDefined(evt)&&(evt.preventDefault(),evt.stopPropagation()),$timeout(function(){$scope.showPicker=picker},0),"time"==picker&&$timeout(function(){$scope.date=parseDateString(ngModel.$viewValue)},50)},$scope.close=function(closePressed,evt){angular.isDefined(evt)&&(evt.preventDefault(),evt.stopPropagation()),$scope.isOpen=!1,$scope.enableDate&&$scope.enableTime&&($scope.showPicker=!1===$scope.reOpenDefault?"date":$scope.reOpenDefault),angular.isDefined(closePressed)?$scope.whenClosed({args:{closePressed:closePressed,openDate:cache.openDate||null,closeDate:$scope.date}}):$element[0].focus()},$scope.$on("$destroy",function(){!0===$scope.isOpen&&($rootScope.$$phase||$scope.$apply(function(){$scope.close()})),watchListeners.forEach(function(a){a()}),$popup.remove(),$element.unbind("keydown",inputKeydownBind),$document.unbind("click",documentClickBind)})}]).directive("datetimePicker",function(){return{restrict:"A",require:["ngModel","datetimePicker"],controller:"DateTimePickerController",scope:{isOpen:"=?",datepickerOptions:"=?",timepickerOptions:"=?",enableDate:"=?",enableTime:"=?",initialPicker:"=?",reOpenDefault:"=?",whenClosed:"&"},link:function(scope,element,attrs,ctrls){var ngModel=ctrls[0];ctrls[1].init(ngModel)}}}).directive("datePickerWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/date-picker.html"}}).directive("timePickerWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/time-picker.html"}}),angular.module("ui.bootstrap.datetimepicker").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/date-picker.html","<ul class=\"dropdown-menu dropdown-menu-left datetime-picker-dropdown\" ng-if=\"isOpen && showPicker == 'date'\" ng-style=dropdownStyle style=left:inherit ng-keydown=keydown($event) ng-click=\"$event.preventDefault(); $event.stopPropagation()\"><li style=\"padding:0 5px 5px 5px\" class=date-picker-menu><div ng-transclude></div></li><li style=padding:5px ng-if=buttonBar.show><span class=\"btn-group pull-left\" style=margin-right:10px ng-if=\"doShow('today') || doShow('clear')\"><button type=button class=btn ng-class=\"getClass('today')\" ng-if=\"doShow('today')\" ng-click=\"select('today', $event)\" ng-disabled=\"isDisabled('today')\">{{ getText('today') }}</button> <button type=button class=btn ng-class=\"getClass('clear')\" ng-if=\"doShow('clear')\" ng-click=\"select('clear', $event)\">{{ getText('clear') }}</button></span> <span class=\"btn-group pull-right\" ng-if=\"(doShow('time') && enableTime) || doShow('close')\"><button type=button class=btn ng-class=\"getClass('time')\" ng-if=\"doShow('time') && enableTime\" ng-click=\"open('time', $event)\">{{ getText('time')}}</button> <button type=button class=btn ng-class=\"getClass('close')\" ng-if=\"doShow('close')\" ng-click=\"close(true, $event)\">{{ getText('close') }}</button></span> <span class=clearfix></span></li></ul>"),$templateCache.put("template/time-picker.html","<ul class=\"dropdown-menu dropdown-menu-left datetime-picker-dropdown\" ng-if=\"isOpen && showPicker == 'time'\" ng-style=dropdownStyle style=left:inherit ng-keydown=keydown($event) ng-click=\"$event.preventDefault(); $event.stopPropagation()\"><li style=\"padding:0 5px 5px 5px\" class=time-picker-menu><div ng-transclude></div></li><li style=padding:5px ng-if=buttonBar.show><span class=\"btn-group pull-left\" style=margin-right:10px ng-if=\"doShow('now') || doShow('clear')\"><button type=button class=btn ng-class=\"getClass('now')\" ng-if=\"doShow('now')\" ng-click=\"select('now', $event)\" ng-disabled=\"isDisabled('now')\">{{ getText('now') }}</button> <button type=button class=btn ng-class=\"getClass('clear')\" ng-if=\"doShow('clear')\" ng-click=\"select('clear', $event)\">{{ getText('clear') }}</button></span> <span class=\"btn-group pull-right\" ng-if=\"(doShow('date') && enableDate) || doShow('close')\"><button type=button class=btn ng-class=\"getClass('date')\" ng-if=\"doShow('date') && enableDate\" ng-click=\"open('date', $event)\">{{ getText('date')}}</button> <button type=button class=btn ng-class=\"getClass('close')\" ng-if=\"doShow('close')\" ng-click=\"close(true, $event)\">{{ getText('close') }}</button></span> <span class=clearfix></span></li></ul>")}]),"object"==typeof exports&&"object"==typeof module&&(module.exports="ui.bootstrap.datetimepicker"),function(a,b){var c=b.isDefined,d=b.isUndefined,e=b.isNumber,f=b.isObject,g=b.isArray,h=b.extend,i=b.toJson;b.module("LocalStorageModule",[]).provider("localStorageService",function(){this.prefix="ls",this.storageType="localStorage",this.cookie={expiry:30,path:"/"},this.notify={setItem:!0,removeItem:!1},this.setPrefix=function(a){return this.prefix=a,this},this.setStorageType=function(a){return this.storageType=a,this},this.setStorageCookie=function(a,b){return this.cookie.expiry=a,this.cookie.path=b,this},this.setStorageCookieDomain=function(a){return this.cookie.domain=a,this},this.setNotify=function(a,b){return this.notify={setItem:a,removeItem:b},this},this.$get=["$rootScope","$window","$document","$parse",function(a,b,j,k){var l,m=this,n=m.prefix,o=m.cookie,p=m.notify,q=m.storageType;j?j[0]&&(j=j[0]):j=document,"."!==n.substr(-1)&&(n=n?n+".":"");var r=function(a){return n+a},s=function(){try{var c=q in b&&null!==b[q],d=r("__"+Math.round(1e7*Math.random()));return c&&(l=b[q],l.setItem(d,""),l.removeItem(d)),c}catch(e){return q="cookie",a.$broadcast("LocalStorageModule.notification.error",e.message),!1}}(),t=function(b,c){if(c=d(c)?null:i(c),!s||"cookie"===m.storageType)return s||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),p.setItem&&a.$broadcast("LocalStorageModule.notification.setitem",{key:b,newvalue:c,storageType:"cookie"}),z(b,c);try{l&&l.setItem(r(b),c),p.setItem&&a.$broadcast("LocalStorageModule.notification.setitem",{key:b,newvalue:c,storageType:m.storageType})}catch(e){return a.$broadcast("LocalStorageModule.notification.error",e.message),z(b,c)}return!0},u=function(b){if(!s||"cookie"===m.storageType)return s||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),A(b);var c=l?l.getItem(r(b)):null;if(!c||"null"===c)return null;try{return JSON.parse(c)}catch(d){return c}},v=function(){var b,c;for(b=0;b<arguments.length;b++)if(c=arguments[b],s&&"cookie"!==m.storageType)try{l.removeItem(r(c)),p.removeItem&&a.$broadcast("LocalStorageModule.notification.removeitem",{key:c,storageType:m.storageType})}catch(d){a.$broadcast("LocalStorageModule.notification.error",d.message),B(c)}else s||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),p.removeItem&&a.$broadcast("LocalStorageModule.notification.removeitem",{key:c,storageType:"cookie"}),B(c)},w=function(){if(!s)return a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),[];var b=n.length,c=[];for(var d in l)if(d.substr(0,b)===n)try{c.push(d.substr(b))}catch(e){return a.$broadcast("LocalStorageModule.notification.error",e.Description),[]}return c},x=function(b){var c=n?new RegExp("^"+n):new RegExp,d=b?new RegExp(b):new RegExp;if(!s||"cookie"===m.storageType)return s||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),C();var e=n.length;for(var f in l)if(c.test(f)&&d.test(f.substr(e)))try{v(f.substr(e))}catch(g){return a.$broadcast("LocalStorageModule.notification.error",g.message),C()}return!0},y=function(){try{return b.navigator.cookieEnabled||"cookie"in j&&(j.cookie.length>0||(j.cookie="test").indexOf.call(j.cookie,"test")>-1)}catch(c){return a.$broadcast("LocalStorageModule.notification.error",c.message),!1}}(),z=function(b,c,h){if(d(c))return!1;if((g(c)||f(c))&&(c=i(c)),!y)return a.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var k="",l=new Date,m="";if(null===c?(l.setTime(l.getTime()+-864e5),k="; expires="+l.toGMTString(),c=""):e(h)&&0!==h?(l.setTime(l.getTime()+24*h*60*60*1e3),k="; expires="+l.toGMTString()):0!==o.expiry&&(l.setTime(l.getTime()+24*o.expiry*60*60*1e3),k="; expires="+l.toGMTString()),b){var n="; path="+o.path;o.domain&&(m="; domain="+o.domain),j.cookie=r(b)+"="+encodeURIComponent(c)+k+n+m}}catch(p){return a.$broadcast("LocalStorageModule.notification.error",p.message),!1}return!0},A=function(b){if(!y)return a.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(var c=j.cookie&&j.cookie.split(";")||[],d=0;d<c.length;d++){for(var e=c[d];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(r(b)+"=")){var f=decodeURIComponent(e.substring(n.length+b.length+1,e.length));try{return JSON.parse(f)}catch(g){return f}}}return null},B=function(a){z(a,null)},C=function(){
for(var a=null,b=n.length,c=j.cookie.split(";"),d=0;d<c.length;d++){for(a=c[d];" "===a.charAt(0);)a=a.substring(1,a.length);var e=a.substring(b,a.indexOf("="));B(e)}};return{isSupported:s,getStorageType:function(){return q},set:t,add:t,get:u,keys:w,remove:v,clearAll:x,bind:function(a,b,d,e){e=e||b;var g=u(e);return null===g&&c(d)?g=d:f(g)&&f(d)&&(g=h(g,d)),k(b).assign(a,g),a.$watch(b,function(a){t(e,a)},f(a[b]))},deriveKey:r,length:function(){for(var a=0,c=b[q],d=0;d<c.length;d++)0===c.key(d).indexOf(n)&&a++;return a},cookie:{isSupported:y,set:z,add:z,get:A,remove:B,clearAll:C}}}]})}(window,window.angular),function(e,t,n){"use strict";!function o(e,t,n){function a(s,l){if(!t[s]){if(!e[s]){var i="function"==typeof require&&require;if(!l&&i)return i(s,!0);if(r)return r(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=t[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return a(n||t)},c,c.exports,o,e,t,n)}return t[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)a(n[s]);return a}({1:[function(o){var a,r,s,l,i=function(e){return e&&e.__esModule?e:{default:e}},u=o("./modules/handle-dom"),c=o("./modules/utils"),d=o("./modules/handle-swal-dom"),f=o("./modules/handle-click"),p=o("./modules/handle-key"),m=i(p),v=o("./modules/default-params"),y=i(v),h=o("./modules/set-params"),g=i(h);s=l=function(){function o(e){var t=s;return t[e]===n?y.default[e]:t[e]}var s=arguments[0];if(u.addClass(t.body,"stop-scrolling"),d.resetInput(),s===n)return c.logStr("SweetAlert expects at least 1 attribute!"),!1;var l=c.extend({},y.default);switch(typeof s){case"string":l.title=s,l.text=arguments[1]||"",l.type=arguments[2]||"";break;case"object":if(s.title===n)return c.logStr('Missing "title" argument!'),!1;l.title=s.title;for(var i in y.default)l[i]=o(i);l.confirmButtonText=l.showCancelButton?"Confirm":y.default.confirmButtonText,l.confirmButtonText=o("confirmButtonText"),l.doneFunction=arguments[1]||null;break;default:return c.logStr('Unexpected type of argument! Expected "string" or "object", got '+typeof s),!1}g.default(l),d.fixVerticalPosition(),d.openModal(arguments[1]);for(var p=d.getModal(),v=p.querySelectorAll("button"),h=["onclick","onmouseover","onmouseout","onmousedown","onmouseup","onfocus"],b=function(e){return f.handleButton(e,l,p)},w=0;w<v.length;w++)for(var C=0;C<h.length;C++){var S=h[C];v[w][S]=b}d.getOverlay().onclick=b,a=e.onkeydown;var x=function(e){return m.default(e,l,p)};e.onkeydown=x,e.onfocus=function(){setTimeout(function(){r!==n&&(r.focus(),r=n)},0)}},s.setDefaults=l.setDefaults=function(e){if(!e)throw new Error("userParams is required");if("object"!=typeof e)throw new Error("userParams has to be a object");c.extend(y.default,e)},s.close=l.close=function(){var o=d.getModal();u.fadeOut(d.getOverlay(),5),u.fadeOut(o,5),u.removeClass(o,"showSweetAlert"),u.addClass(o,"hideSweetAlert"),u.removeClass(o,"visible");var s=o.querySelector(".sa-icon.sa-success");u.removeClass(s,"animate"),u.removeClass(s.querySelector(".sa-tip"),"animateSuccessTip"),u.removeClass(s.querySelector(".sa-long"),"animateSuccessLong");var l=o.querySelector(".sa-icon.sa-error");u.removeClass(l,"animateErrorIcon"),u.removeClass(l.querySelector(".sa-x-mark"),"animateXMark");var i=o.querySelector(".sa-icon.sa-warning");return u.removeClass(i,"pulseWarning"),u.removeClass(i.querySelector(".sa-body"),"pulseWarningIns"),u.removeClass(i.querySelector(".sa-dot"),"pulseWarningIns"),setTimeout(function(){var e=o.getAttribute("data-custom-class");u.removeClass(o,e)},300),u.removeClass(t.body,"stop-scrolling"),e.onkeydown=a,e.previousActiveElement&&e.previousActiveElement.focus(),r=n,clearTimeout(o.timeout),!0},s.showInputError=l.showInputError=function(e){var t=d.getModal(),n=t.querySelector(".sa-input-error");u.addClass(n,"show");var o=t.querySelector(".sa-error-container");u.addClass(o,"show"),o.querySelector("p").innerHTML=e,t.querySelector("input").focus()},s.resetInputError=l.resetInputError=function(e){if(e&&13===e.keyCode)return!1;var t=d.getModal(),n=t.querySelector(".sa-input-error");u.removeClass(n,"show");var o=t.querySelector(".sa-error-container");u.removeClass(o,"show")},void 0!==e?e.sweetAlert=e.swal=s:c.logStr("SweetAlert is a frontend module!")},{"./modules/default-params":2,"./modules/handle-click":3,"./modules/handle-dom":4,"./modules/handle-key":5,"./modules/handle-swal-dom":6,"./modules/set-params":8,"./modules/utils":9}],2:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o={title:"",text:"",type:null,allowOutsideClick:!1,showConfirmButton:!0,showCancelButton:!1,closeOnConfirm:!0,closeOnCancel:!0,confirmButtonText:"OK",confirmButtonColor:"#AEDEF4",cancelButtonText:"Cancel",imageUrl:null,imageSize:null,timer:null,customClass:"",html:!1,animation:!0,allowEscapeKey:!0,inputType:"text",inputPlaceholder:"",inputValue:""};n.default=o,t.exports=n.default},{}],3:[function(t,n,o){Object.defineProperty(o,"__esModule",{value:!0});var a=t("./utils"),r=(t("./handle-swal-dom"),t("./handle-dom")),s=function(t,n,o){function s(e){m&&n.confirmButtonColor&&(p.style.backgroundColor=e)}var u,c,d,f=t||e.event,p=f.target||f.srcElement,m=-1!==p.className.indexOf("confirm"),v=-1!==p.className.indexOf("sweet-overlay"),y=r.hasClass(o,"visible"),h=n.doneFunction&&"true"===o.getAttribute("data-has-done-function");switch(m&&n.confirmButtonColor&&(u=n.confirmButtonColor,c=a.colorLuminance(u,-.04),d=a.colorLuminance(u,-.14)),f.type){case"mouseover":s(c);break;case"mouseout":s(u);break;case"mousedown":s(d);break;case"mouseup":s(c);break;case"focus":var g=o.querySelector("button.confirm"),b=o.querySelector("button.cancel");m?b.style.boxShadow="none":g.style.boxShadow="none";break;case"click":var w=o===p,C=r.isDescendant(o,p);if(!w&&!C&&y&&!n.allowOutsideClick)break;m&&h&&y?l(o,n):h&&y||v?i(o,n):r.isDescendant(o,p)&&"BUTTON"===p.tagName&&sweetAlert.close()}},l=function(e,t){var n=!0;r.hasClass(e,"show-input")&&((n=e.querySelector("input").value)||(n="")),t.doneFunction(n),t.closeOnConfirm&&sweetAlert.close()},i=function(e,t){var n=String(t.doneFunction).replace(/\s/g,"");"function("===n.substring(0,9)&&")"!==n.substring(9,10)&&t.doneFunction(!1),t.closeOnCancel&&sweetAlert.close()};o.default={handleButton:s,handleConfirm:l,handleCancel:i},n.exports=o.default},{"./handle-dom":4,"./handle-swal-dom":6,"./utils":9}],4:[function(n,o,a){Object.defineProperty(a,"__esModule",{value:!0});var r=function(e,t){return new RegExp(" "+t+" ").test(" "+e.className+" ")},s=function(e,t){r(e,t)||(e.className+=" "+t)},l=function(e,t){var n=" "+e.className.replace(/[\t\r\n]/g," ")+" ";if(r(e,t)){for(;n.indexOf(" "+t+" ")>=0;)n=n.replace(" "+t+" "," ");e.className=n.replace(/^\s+|\s+$/g,"")}},i=function(e){var n=t.createElement("div");return n.appendChild(t.createTextNode(e)),n.innerHTML},u=function(e){e.style.opacity="",e.style.display="block"},c=function(e){if(e&&!e.length)return u(e);for(var t=0;t<e.length;++t)u(e[t])},d=function(e){e.style.opacity="",e.style.display="none"},f=function(e){if(e&&!e.length)return d(e);for(var t=0;t<e.length;++t)d(e[t])},p=function(e,t){for(var n=t.parentNode;null!==n;){if(n===e)return!0;n=n.parentNode}return!1},m=function(e){e.style.left="-9999px",e.style.display="block";var t,n=e.clientHeight;return t="undefined"!=typeof getComputedStyle?parseInt(getComputedStyle(e).getPropertyValue("padding-top"),10):parseInt(e.currentStyle.padding),e.style.left="",e.style.display="none","-"+parseInt((n+t)/2)+"px"},v=function(e,t){if(+e.style.opacity<1){t=t||16,e.style.opacity=0,e.style.display="block";var n=+new Date,o=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){e.style.opacity=+e.style.opacity+(new Date-n)/100,n=+new Date,+e.style.opacity<1&&setTimeout(o,t)});o()}e.style.display="block"},y=function(e,t){t=t||16,e.style.opacity=1;var n=+new Date,o=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){e.style.opacity=+e.style.opacity-(new Date-n)/100,n=+new Date,+e.style.opacity>0?setTimeout(o,t):e.style.display="none"});o()},h=function(n){if("function"==typeof MouseEvent){var o=new MouseEvent("click",{view:e,bubbles:!1,cancelable:!0});n.dispatchEvent(o)}else if(t.createEvent){var a=t.createEvent("MouseEvents");a.initEvent("click",!1,!1),n.dispatchEvent(a)}else t.createEventObject?n.fireEvent("onclick"):"function"==typeof n.onclick&&n.onclick()},g=function(t){"function"==typeof t.stopPropagation?(t.stopPropagation(),t.preventDefault()):e.event&&e.event.hasOwnProperty("cancelBubble")&&(e.event.cancelBubble=!0)};a.hasClass=r,a.addClass=s,a.removeClass=l,a.escapeHtml=i,a._show=u,a.show=c,a._hide=d,a.hide=f,a.isDescendant=p,a.getTopMargin=m,a.fadeIn=v,a.fadeOut=y,a.fireClick=h,a.stopEventPropagation=g},{}],5:[function(t,o,a){Object.defineProperty(a,"__esModule",{value:!0});var r=t("./handle-dom"),s=t("./handle-swal-dom"),l=function(t,o,a){var l=t||e.event,i=l.keyCode||l.which,u=a.querySelector("button.confirm"),c=a.querySelector("button.cancel"),d=a.querySelectorAll("button[tabindex]");if(-1!==[9,13,32,27].indexOf(i)){for(var f=l.target||l.srcElement,p=-1,m=0;m<d.length;m++)if(f===d[m]){p=m;break}9===i?(f=-1===p?u:p===d.length-1?d[0]:d[p+1],r.stopEventPropagation(l),f.focus(),o.confirmButtonColor&&s.setFocusStyle(f,o.confirmButtonColor)):13===i?("INPUT"===f.tagName&&(f=u,u.focus()),f=-1===p?u:n):27===i&&!0===o.allowEscapeKey?(f=c,r.fireClick(f,l)):f=n}};a.default=l,o.exports=a.default},{"./handle-dom":4,"./handle-swal-dom":6}],6:[function(n,o,a){var r=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(a,"__esModule",{value:!0});var s=n("./utils"),l=n("./handle-dom"),i=n("./default-params"),u=r(i),c=n("./injected-html"),d=r(c),f=".sweet-alert",p=".sweet-overlay",m=function(){var e=t.createElement("div");for(e.innerHTML=d.default;e.firstChild;)t.body.appendChild(e.firstChild)},v=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=t.querySelector(f);return e||(m(),e=v()),e}),y=function(){var e=v();return e?e.querySelector("input"):void 0},h=function(){return t.querySelector(p)},g=function(e,t){var n=s.hexToRgb(t);e.style.boxShadow="0 0 2px rgba("+n+", 0.8), inset 0 0 0 1px rgba(0, 0, 0, 0.05)"},b=function(n){var o=v();l.fadeIn(h(),10),l.show(o),l.addClass(o,"showSweetAlert"),l.removeClass(o,"hideSweetAlert"),e.previousActiveElement=t.activeElement,o.querySelector("button.confirm").focus(),setTimeout(function(){l.addClass(o,"visible")},500);var r=o.getAttribute("data-timer");if("null"!==r&&""!==r){var s=n;o.timeout=setTimeout(function(){(s||null)&&"true"===o.getAttribute("data-has-done-function")?s(null):sweetAlert.close()},r)}},w=function(){var e=v(),t=y();l.removeClass(e,"show-input"),t.value=u.default.inputValue,t.setAttribute("type",u.default.inputType),t.setAttribute("placeholder",u.default.inputPlaceholder),C()},C=function(e){if(e&&13===e.keyCode)return!1;var t=v(),n=t.querySelector(".sa-input-error");l.removeClass(n,"show");var o=t.querySelector(".sa-error-container");l.removeClass(o,"show")},S=function(){v().style.marginTop=l.getTopMargin(v())};a.sweetAlertInitialize=m,a.getModal=v,a.getOverlay=h,a.getInput=y,a.setFocusStyle=g,a.openModal=b,a.resetInput=w,a.resetInputError=C,a.fixVerticalPosition=S},{"./default-params":2,"./handle-dom":4,"./injected-html":7,"./utils":9}],7:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default='<div class="sweet-overlay" tabIndex="-1"></div><div class="sweet-alert"><div class="sa-icon sa-error">\n      <span class="sa-x-mark">\n        <span class="sa-line sa-left"></span>\n        <span class="sa-line sa-right"></span>\n      </span>\n    </div><div class="sa-icon sa-warning">\n      <span class="sa-body"></span>\n      <span class="sa-dot"></span>\n    </div><div class="sa-icon sa-info"></div><div class="sa-icon sa-success">\n      <span class="sa-line sa-tip"></span>\n      <span class="sa-line sa-long"></span>\n\n      <div class="sa-placeholder"></div>\n      <div class="sa-fix"></div>\n    </div><div class="sa-icon sa-custom"></div><h2>Title</h2>\n    <p>Text</p>\n    <fieldset>\n      <input type="text" tabIndex="3" />\n      <div class="sa-input-error"></div>\n    </fieldset><div class="sa-error-container">\n      <div class="icon">!</div>\n      <p>Not valid!</p>\n    </div><div class="sa-button-container">\n      <button class="cancel" tabIndex="2">Cancel</button>\n      <button class="confirm" tabIndex="1">OK</button>\n    </div></div>',t.exports=n.default},{}],8:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var a=e("./utils"),r=e("./handle-swal-dom"),s=e("./handle-dom"),l=["error","warning","info","success","input","prompt"],i=function(e){var t=r.getModal(),o=t.querySelector("h2"),i=t.querySelector("p"),u=t.querySelector("button.cancel"),c=t.querySelector("button.confirm");if(o.innerHTML=e.html?e.title:s.escapeHtml(e.title).split("\n").join("<br>"),i.innerHTML=e.html?e.text:s.escapeHtml(e.text||"").split("\n").join("<br>"),e.text&&s.show(i),e.customClass)s.addClass(t,e.customClass),t.setAttribute("data-custom-class",e.customClass);else{var d=t.getAttribute("data-custom-class");s.removeClass(t,d),t.setAttribute("data-custom-class","")}if(s.hide(t.querySelectorAll(".sa-icon")),e.type&&!a.isIE8()){var f=function(){for(var o=!1,a=0;a<l.length;a++)if(e.type===l[a]){o=!0;break}if(!o)return logStr("Unknown alert type: "+e.type),{v:!1};var i=["success","error","warning","info"],u=n;-1!==i.indexOf(e.type)&&(u=t.querySelector(".sa-icon.sa-"+e.type),s.show(u));var c=r.getInput();switch(e.type){case"success":s.addClass(u,"animate"),s.addClass(u.querySelector(".sa-tip"),"animateSuccessTip"),s.addClass(u.querySelector(".sa-long"),"animateSuccessLong");break;case"error":s.addClass(u,"animateErrorIcon"),s.addClass(u.querySelector(".sa-x-mark"),"animateXMark");break;case"warning":s.addClass(u,"pulseWarning"),s.addClass(u.querySelector(".sa-body"),"pulseWarningIns"),s.addClass(u.querySelector(".sa-dot"),"pulseWarningIns");break;case"input":case"prompt":c.setAttribute("type",e.inputType),c.value=e.inputValue,c.setAttribute("placeholder",e.inputPlaceholder),s.addClass(t,"show-input"),setTimeout(function(){c.focus(),c.addEventListener("keyup",swal.resetInputError)},400)}}();if("object"==typeof f)return f.v}if(e.imageUrl){var p=t.querySelector(".sa-icon.sa-custom");p.style.backgroundImage="url("+e.imageUrl+")",s.show(p);var m=80,v=80;if(e.imageSize){var y=e.imageSize.toString().split("x"),h=y[0],g=y[1];h&&g?(m=h,v=g):logStr("Parameter imageSize expects value with format WIDTHxHEIGHT, got "+e.imageSize)}p.setAttribute("style",p.getAttribute("style")+"width:"+m+"px; height:"+v+"px")}t.setAttribute("data-has-cancel-button",e.showCancelButton),e.showCancelButton?u.style.display="inline-block":s.hide(u),t.setAttribute("data-has-confirm-button",e.showConfirmButton),e.showConfirmButton?c.style.display="inline-block":s.hide(c),e.cancelButtonText&&(u.innerHTML=s.escapeHtml(e.cancelButtonText)),e.confirmButtonText&&(c.innerHTML=s.escapeHtml(e.confirmButtonText)),e.confirmButtonColor&&(c.style.backgroundColor=e.confirmButtonColor,r.setFocusStyle(c,e.confirmButtonColor)),t.setAttribute("data-allow-outside-click",e.allowOutsideClick);var b=!!e.doneFunction;t.setAttribute("data-has-done-function",b),e.animation?"string"==typeof e.animation?t.setAttribute("data-animation",e.animation):t.setAttribute("data-animation","pop"):t.setAttribute("data-animation","none"),t.setAttribute("data-timer",e.timer)};o.default=i,t.exports=o.default},{"./handle-dom":4,"./handle-swal-dom":6,"./utils":9}],9:[function(t,n,o){Object.defineProperty(o,"__esModule",{value:!0});var a=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},r=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?parseInt(t[1],16)+", "+parseInt(t[2],16)+", "+parseInt(t[3],16):null},s=function(){return e.attachEvent&&!e.addEventListener},l=function(t){e.console&&e.console.log("SweetAlert: "+t)},i=function(e,t){e=String(e).replace(/[^0-9a-f]/gi,""),e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),t=t||0;var n,o,a="#";for(o=0;3>o;o++)n=parseInt(e.substr(2*o,2),16),n=Math.round(Math.min(Math.max(0,n+n*t),255)).toString(16),a+=("00"+n).substr(n.length);return a};o.extend=a,o.hexToRgb=r,o.isIE8=s,o.logStr=l,o.colorLuminance=i},{}]},{},[1]),"function"==typeof define&&define.amd?define(function(){return sweetAlert}):"undefined"!=typeof module&&module.exports&&(module.exports=sweetAlert)}(window,document),angular.module("oitozero.ngSweetAlert",[]).factory("SweetAlert",["$rootScope",function($rootScope){var swal=window.swal;return{swal:function(arg1,arg2,arg3){$rootScope.$evalAsync(function(){"function"==typeof arg2?swal(arg1,function(isConfirm){$rootScope.$evalAsync(function(){arg2(isConfirm)})},arg3):swal(arg1,arg2,arg3)})},success:function(title,message){$rootScope.$evalAsync(function(){swal(title,message,"success")})},error:function(title,message){$rootScope.$evalAsync(function(){swal(title,message,"error")})},warning:function(title,message){$rootScope.$evalAsync(function(){swal(title,message,"warning")})},info:function(title,message){$rootScope.$evalAsync(function(){swal(title,message,"info")})}}}]),function(){"use strict";var homeMenuController=function($state,$scope,auth,$filter,api,$rootScope,localStorageService,restaurant){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;that.api=api,that.is_su=1==auth.authentication.user.id;var swalCount=1;const SWAL_LIMIT=4;that.restaurant_id=localStorageService.get("restaurant_id"),that.Summary_category={id:-1,category:"--All Items--",inventory_type_id:2},that.np_start_date=new Date,that.np_start_date.setDate(that.np_start_date.getDate()-((that.np_start_date.getDay()||7)+7)+1),that.np_end_date=new Date,that.np_end_date.setDate(that.np_end_date.getDate()-((that.np_end_date.getDay()||7)+1)+1),that.np_obj={},$scope.loadNetProfit=function(){if(void 0!==that.np_start_date&&void 0!==that.np_end_date&&null!=that.np_start_date&&null!=that.np_end_date){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1});var npfd=new Date(that.np_start_date),dayfd=npfd.getDate(),monthfd=npfd.getMonth()+1;npfd=npfd.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd;var nptd=new Date(that.np_end_date),daytd=nptd.getDate(),monthtd=nptd.getMonth()+1;nptd=nptd.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd,that.api.get_net_profit({start_date:npfd,end_date:nptd}).then(function(res){void 0!==res.data.data.net_profit_data&&(that.np_obj=res.data.data.net_profit_data,that.np_obj.labor_percent=0==that.np_obj.sales?0:Math.round(that.np_obj.labor/that.np_obj.sales*100),that.np_obj.inv_percent=0==that.np_obj.sales?0:Math.round(that.np_obj.inv/that.np_obj.sales*100)),swalCount>=SWAL_LIMIT?swal.close():swalCount++})}};var from_date=new Date,days=20;from_date.setDate(from_date.getDate()-days),$scope.start_date=from_date;var to_date=new Date;to_date.setDate(to_date.getDate()+days),$scope.end_date=to_date;var yest_d=new Date,tdayfd=yest_d.getDate()-1,tmonthfd=yest_d.getMonth()+1;yest_d=yest_d.getFullYear()+"-"+((""+tmonthfd).length<2?"0":"")+tmonthfd+"-"+((""+tdayfd).length<2?"0":"")+tdayfd,$scope.loadLineGraph=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),null==$scope.start_date&&($scope.start_date=from_date),null==$scope.end_date&&($scope.end_date=to_date),that.api.sales_data({start_date:$scope.start_date,end_date:$scope.end_date,restaurant_id:that.restaurant_id.restaurant_id}).then(function(res){swalCount>=SWAL_LIMIT?swal.close():swalCount++;var total_sales=res.data.data.total_sales,chartData=[],v_arr=[];if(0!=total_sales.length){var d=new Set;for(var i in total_sales)d.add(null==total_sales[i].Pre_Date_l?total_sales[i].Act_Date_l.substring(0,10):total_sales[i].Pre_Date_l.substring(0,10));1==$scope.subscription_type_id||5==$scope.subscription_type_id?v_arr=["Alcohol Sales"]:2==$scope.subscription_type_id||6==$scope.subscription_type_id?v_arr=["Food Sales"]:3!=$scope.subscription_type_id&&7!=$scope.subscription_type_id||(v_arr=["Food Sales","Alcohol Sales"]),d.forEach(function(value){var fs=0,as=0,vtoday_d=new Date(value),vdayfd=vtoday_d.getDate(),vmonthfd=vtoday_d.getMonth()+1;vtoday_d=vtoday_d.getFullYear()+"-"+((""+vmonthfd).length<2?"0":"")+vmonthfd+"-"+((""+vdayfd).length<2?"0":"")+vdayfd;var is_future=vtoday_d>=yest_d;for(var i in total_sales)total_sales[i].Act_Date_l.substring(0,10)!=value&&total_sales[i].Pre_Date_l.substring(0,10)!=value||"Food"!=total_sales[i].category||(is_future||(total_sales[i].actual_total_sales=null==total_sales[i].actual_total_sales?0:total_sales[i].actual_total_sales,total_sales[i].predicted_total_sales=null==total_sales[i].predicted_total_sales?0:total_sales[i].predicted_total_sales),fs=total_sales[i].actual_total_sales,total_sales[i].predicted_total_sales),total_sales[i].Act_Date_l.substring(0,10)!=value&&total_sales[i].Pre_Date_l.substring(0,10)!=value||"Alcohol"!=total_sales[i].category||(is_future||(total_sales[i].actual_total_sales=null==total_sales[i].actual_total_sales?0:total_sales[i].actual_total_sales,total_sales[i].predicted_total_sales=null==total_sales[i].predicted_total_sales?0:total_sales[i].predicted_total_sales),as=total_sales[i].actual_total_sales,total_sales[i].predicted_total_sales);1==$scope.subscription_type_id||5==$scope.subscription_type_id?chartData.push({_id:value,"Alcohol Sales":as}):2==$scope.subscription_type_id||6==$scope.subscription_type_id?chartData.push({_id:value,"Food Sales":fs}):3!=$scope.subscription_type_id&&7!=$scope.subscription_type_id||chartData.push({_id:value,"Food Sales":fs,"Alcohol Sales":as})})}c3.generate({bindto:"#chart",data:{json:chartData,keys:{x:"_id",value:v_arr},empty:{label:{text:"No data found"}},type:"spline"},axis:{x:{type:"category",tick:{rotate:75,multiline:!1,culling:{max:10}}},y:{tick:{format:d3.format("$,")}}},point:{show:!1}})})},$scope.Bar_From_date=new Date((new Date).getFullYear(),0,1),$scope.Bar_To_date=new Date,$scope.loadBarGraph=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1});var dayfd=$scope.Bar_From_date.getDate(),monthfd=$scope.Bar_From_date.getMonth()+1,fd=$scope.Bar_From_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=$scope.Bar_To_date.getDate(),monthtd=$scope.Bar_To_date.getMonth()+1,td=$scope.Bar_To_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd;that.api.bar_chart_api({From:fd,To:td,RestaurantId:that.restaurant_id.restaurant_id}).then(function(res){swalCount>=SWAL_LIMIT?swal.close():swalCount++;var BarChart=res.data.data.MyJson,months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],groups=[],categories=[];for(var i in BarChart)groups=groups.concat(BarChart[i][0]);for(var i=0;i<BarChart[0].length-1;i++)categories=categories.concat(months[i]);c3.generate({bindto:"#bar",data:{columns:BarChart,type:"bar",groups:[groups],empty:{label:{text:"No data found."}}},axis:{x:{type:"category",categories:categories},y:{tick:{format:d3.format("$,")}}}})})};var from_date1=new Date;$scope.Monthly_From_date=new Date(from_date1.getFullYear(),0,1),$scope.Monthly_To_date=new Date,$scope.Summary_From_date=new Date,$scope.Summary_From_date.setMonth($scope.Summary_From_date.getMonth()-1),$scope.Summary_To_date=new Date,$scope.MonthlySalesPriorYearComparison=function(fd,td){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),$scope.Monthly_prior_From_date=new Date(fd),$scope.Monthly_prior_From_date.setYear($scope.Monthly_prior_From_date.getFullYear()-1),$scope.Monthly_prior_To_date=new Date(td),$scope.Monthly_prior_To_date.setYear($scope.Monthly_prior_To_date.getFullYear()-1);var prior_fd=$filter("date")($scope.Monthly_prior_From_date,"yyyy-MM-dd"),prior_td=$filter("date")($scope.Monthly_prior_To_date,"yyyy-MM-dd"),curr_fd=$filter("date")(fd,"yyyy-MM-dd"),curr_td=$filter("date")(td,"yyyy-MM-dd");that.api.MonthlySales({prior_from:prior_fd,prior_to:prior_td,curr_from:curr_fd,curr_to:curr_td,RestaurantId:that.restaurant_id.restaurant_id,Category:-1==that.Monthly_category.id?"%":-2==that.Monthly_category.id?"Food":that.Monthly_category.category,inventory_type_id:that.Monthly_category.inventory_type_id}).then(function(res){if(swalCount>=SWAL_LIMIT?swal.close():swalCount++,res){var month=[],columns=[],mode=-1;$scope.Monthly_From_date.getFullYear()==$scope.Monthly_To_date.getFullYear()?(columns.push([$scope.Monthly_From_date.getFullYear()-1],[$scope.Monthly_From_date.getFullYear()]),mode=2):$scope.Monthly_To_date.getFullYear()-1==$scope.Monthly_From_date.getFullYear()&&(columns.push([$scope.Monthly_From_date.getFullYear()-1],[$scope.Monthly_From_date.getFullYear()],[$scope.Monthly_To_date.getFullYear()]),mode=3);for(var ix=0;ix<res.data.data.MonthlySales.length;ix++)month.push(res.data.data.MonthlySales[ix].current_month),2==mode&&(columns[0].push(res.data.data.MonthlySales[ix].prev_sales),columns[1].push(res.data.data.MonthlySales[ix].current_sales)),3==mode&&(res.data.data.MonthlySales[ix].prev_yr==columns[0][0]?(columns[0].push(res.data.data.MonthlySales[ix].prev_sales),columns[1].push(res.data.data.MonthlySales[ix].current_sales),columns[2].push(0)):res.data.data.MonthlySales[ix].prev_yr==columns[1][0]&&(columns[0].push(0),columns[1].push(res.data.data.MonthlySales[ix].prev_sales),columns[2].push(res.data.data.MonthlySales[ix].current_sales)));c3.generate({bindto:"#monthly",data:{columns:columns,type:"bar",empty:{label:{text:"No data found"}}},bar:{width:{ratio:.5}},axis:{x:{type:"category",categories:month}}})}})},$scope.Summary=function(fd,td){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1});var curr_fd=$filter("date")(fd,"yyyy-MM-dd"),curr_td=$filter("date")(td,"yyyy-MM-dd");that.api.summary_api({From:curr_fd,To:curr_td,RestaurantId:that.restaurant_id.restaurant_id,Category:"--All Items--"==that.Summary_category.category?"%":that.Summary_category.category,inventory_type_id:2}).then(function(res){if(swalCount>=SWAL_LIMIT?swal.close():swalCount++,res){var categories=[],columns=[];columns.push(["Sales"],["Cost"],["Purchases"]);for(var ix=0;ix<res.data.data.summary_api.length;ix++)null!=res.data.data.summary_api[ix].date&&(categories.push(res.data.data.summary_api[ix].date.substring(0,10)),columns[0].push(res.data.data.summary_api[ix].sales),columns[1].push(res.data.data.summary_api[ix].cost),columns[2].push(res.data.data.summary_api[ix].purchases));c3.generate({bindto:"#summaryGraph",data:{columns:columns,types:{Sales:"bar",Cost:"line",Purchases:"line"},empty:{label:{text:"No data found"}},colors:{Purchases:"#1b4332"}},bar:{width:{ratio:.5}},axis:{x:{type:"category",categories:categories}}})}})},$scope.Summary_food_From_date=new Date,$scope.Summary_food_From_date.setMonth($scope.Summary_food_From_date.getMonth()-1),$scope.Summary_food_To_date=new Date,$scope.SummaryFood=function(fd,td){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1});var curr_fd1=$filter("date")(fd,"yyyy-MM-dd"),curr_td1=$filter("date")(td,"yyyy-MM-dd");that.api.summary_api({From:curr_fd1,To:curr_td1,RestaurantId:that.restaurant_id.restaurant_id,Category:"Food",inventory_type_id:1}).then(function(res){if(swalCount>=SWAL_LIMIT?swal.close():swalCount++,res){var categories=[],columns=[];columns.push(["Sales"],["Cost"],["Purchases"]);for(var ix=0;ix<res.data.data.summary_api.length;ix++)null!=res.data.data.summary_api[ix].date&&(categories.push(res.data.data.summary_api[ix].date.substring(0,10)),columns[0].push(res.data.data.summary_api[ix].sales),columns[1].push(res.data.data.summary_api[ix].cost),columns[2].push(res.data.data.summary_api[ix].purchases));c3.generate({bindto:"#summaryGraphFood",data:{columns:columns,types:{Sales:"bar",Cost:"line",Purchases:"line"},empty:{label:{text:"No data found"}},colors:{Sales:"#335C67",Purchases:"#9E2A2B",Cost:"#FF9E00"}},bar:{width:{ratio:.5}},axis:{x:{type:"category",categories:categories}}})}})},Promise.all([api.get_vendors_categories({is_restaurant_used_only:1,inventory_type_id:2})]).then(function(response){$scope.subscription_type_id=restaurant.data.info.subscription_type_id,that.get_refbooks=response[1],$scope.loadNetProfit(),that.categories=response[0].data.data.categories.filter(function(x){return"Non Alcoholic"!=x.category}),that.mspy_categories=JSON.parse(JSON.stringify(that.categories)),that.categories.unshift({id:-1,category:"--All Items--",inventory_type_id:2}),$scope.loadLineGraph(),1!=$scope.subscription_type_id&&5!=$scope.subscription_type_id||that.mspy_categories.unshift({id:-1,category:"--All Alcohol--",inventory_type_id:2}),2!=$scope.subscription_type_id&&6!=$scope.subscription_type_id||(that.mspy_categories=[],that.mspy_categories.push({id:-2,category:"--All Food--",inventory_type_id:1})),3!=$scope.subscription_type_id&&7!=$scope.subscription_type_id||(that.mspy_categories.unshift({id:-2,category:"--All Food--",inventory_type_id:1}),that.mspy_categories.unshift({id:-1,category:"--All Alcohol--",inventory_type_id:2})),that.Monthly_category=that.mspy_categories[0],$scope.MonthlySalesPriorYearComparison($scope.Monthly_From_date,$scope.Monthly_To_date),3!=$scope.subscription_type_id&&7!=$scope.subscription_type_id&&$scope.loadBarGraph(),that.Summary_category=that.categories[0],1!=$scope.subscription_type_id&&3!=$scope.subscription_type_id&&5!=$scope.subscription_type_id&&7!=$scope.subscription_type_id||$scope.Summary($scope.Summary_From_date,$scope.Summary_To_date),2!=$scope.subscription_type_id&&3!=$scope.subscription_type_id&&6!=$scope.subscription_type_id&&7!=$scope.subscription_type_id||$scope.SummaryFood($scope.Summary_food_From_date,$scope.Summary_food_To_date)})};homeMenuController.$inject=["$state","$scope","auth","$filter","api","$rootScope","localStorageService","restaurant"],angular.module("inspinia").controller("homeMenuController",homeMenuController)}(),function(){"use strict";function fixedHeader($timeout){function link($scope,$elem,$attrs,$ctrl){function tableDataLoaded(){var firstCell=elem.querySelector("tbody tr:first-child td:first-child");return firstCell&&!firstCell.style.width}function transformTable(){angular.element(elem.querySelectorAll("thead, tbody, tfoot")).css("display",""),$timeout(function(){angular.forEach(elem.querySelectorAll("tr:first-child th"),function(thElem,i){var tdElems=elem.querySelector("tbody tr:first-child td:nth-child("+(i+1)+")"),tfElems=elem.querySelector("tfoot tr:first-child td:nth-child("+(i+1)+")"),columnWidth=tdElems?tdElems.offsetWidth:thElem.offsetWidth;tdElems&&(tdElems.style.width=columnWidth+"px"),thElem&&(thElem.style.width=columnWidth+"px"),tfElems&&(tfElems.style.width=columnWidth+"px")}),angular.element(elem.querySelectorAll("thead, tfoot")).css("display","block"),angular.element(elem.querySelectorAll("tbody")).css({display:"block",height:$attrs.tableHeight||"inherit",overflow:"auto"});var tbody=elem.querySelector("tbody"),scrollBarWidth=tbody.offsetWidth-tbody.clientWidth;if(scrollBarWidth>0){scrollBarWidth-=2;var lastColumn=elem.querySelector("tbody tr:first-child td:last-child");lastColumn.style.width=lastColumn.offsetWidth-scrollBarWidth+17+"px";var lastColumn2=elem.querySelector("tbody.foodBody tr:first-child td:last-child");lastColumn2.style.width=lastColumn2.offsetWidth-scrollBarWidth-2+"px"}})}var elem=$elem[0];$scope.$watch(tableDataLoaded,function(isTableDataLoaded){isTableDataLoaded&&transformTable()})}return{restrict:"A",link:link}}angular.module("anguFixedHeaderTable",[]).directive("fixedHeader",fixedHeader),fixedHeader.$inject=["$timeout"]}(),function(){"use strict"
;var alcoholDetailController=function($scope,$state,$filter,auth,api,$rootScope,localStorageService,restaurant){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;that.api=api,that.restaurant_id=localStorageService.get("restaurant_id"),$scope.spa=1,$scope.seoption=[{id:1,name:"Last Week"},{id:2,name:"This Week"},{id:3,name:"Next Week"}],$scope.sns_data={},$scope.loadTable=function(){that.api.sales_and_spendings({RestaurantId:that.restaurant_id.restaurant_id}).then(function(res){var qres=res.data.data.MyJson;$scope.sns_data={Alcohol:{Last_week:{actual_sales:0,actual_purchases:0,predicted_sales:0,suggested:0},This_week:{actual_sales:0,actual_purchases:0,predicted_sales:0,suggested:0},Next_week:{predicted_sales:0,suggested:0}}};for(var i=0;i<qres.length;i++)$scope.sns_data.Alcohol[qres[i].week_label].actual_sales=Math.round(qres[i].actual_sales),$scope.sns_data.Alcohol[qres[i].week_label].actual_purchases=Math.round(qres[i].actual_purchases),$scope.sns_data.Alcohol[qres[i].week_label].predicted_sales=Math.round(qres[i].predicted_sales),$scope.sns_data.Alcohol[qres[i].week_label].suggested=Math.round(qres[i].suggested)})},$scope.loadTable(),$scope.more_loading=!0,$scope.loadSummaryItemsTable=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),$scope.show_alco_more=!0,$scope.summary_items_data=[],that.api.dashboard_summary_items({inventory_type_id:2}).then(function(res){$scope.subscription_type_id=restaurant.data.info.subscription_type_id;for(var i=0;i<5;i++)$scope.summary_items_data.push({suggested:res.data.data.dashboardSummaryItems.suggested[i],missing_recipes:res.data.data.dashboardSummaryItems.missing_recipes[i]});swal.close(),$scope.more_loading=!1})},$scope.loadSummaryItemsTable(),$scope.more_navigation=function(go_to){"missing_recipes"==go_to?$state.go("alcoholSetup.menu"):"high_risk"==go_to?$state.go("reports.alcoholCostOfSummary"):"suggested"==go_to&&$state.go("alcohol.newAlcoholOrder")}};alcoholDetailController.$inject=["$scope","$state","$filter","auth","api","$rootScope","localStorageService","restaurant"],angular.module("inspinia").controller("alcoholDetailController",alcoholDetailController)}(),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.Chart=t()}}(function(){return function t(e,a,i){function n(r,l){if(!a[r]){if(!e[r]){var s="function"==typeof require&&require;if(!l&&s)return s(r,!0);if(o)return o(r,!0);var d=new Error("Cannot find module '"+r+"'");throw d.code="MODULE_NOT_FOUND",d}var u=a[r]={exports:{}};e[r][0].call(u.exports,function(t){var a=e[r][1][t];return n(a||t)},u,u.exports,t,e,a,i)}return a[r].exports}for(var o="function"==typeof require&&require,r=0;r<i.length;r++)n(i[r]);return n}({1:[function(t,e,a){},{}],2:[function(t,e,a){function i(t){if(t){var e=/^#([a-fA-F0-9]{3})$/,a=/^#([a-fA-F0-9]{6})$/,i=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,n=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,o=/(\w+)/,r=[0,0,0],l=1,s=t.match(e);if(s){s=s[1];for(var d=0;d<r.length;d++)r[d]=parseInt(s[d]+s[d],16)}else if(s=t.match(a)){s=s[1];for(var d=0;d<r.length;d++)r[d]=parseInt(s.slice(2*d,2*d+2),16)}else if(s=t.match(i)){for(var d=0;d<r.length;d++)r[d]=parseInt(s[d+1]);l=parseFloat(s[4])}else if(s=t.match(n)){for(var d=0;d<r.length;d++)r[d]=Math.round(2.55*parseFloat(s[d+1]));l=parseFloat(s[4])}else if(s=t.match(o)){if("transparent"==s[1])return[0,0,0,0];if(!(r=y[s[1]]))return}for(var d=0;d<r.length;d++)r[d]=v(r[d],0,255);return l=l||0==l?v(l,0,1):1,r[3]=l,r}}function n(t){if(t){var e=/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/,a=t.match(e);if(a){var i=parseFloat(a[4]);return[v(parseInt(a[1]),0,360),v(parseFloat(a[2]),0,100),v(parseFloat(a[3]),0,100),v(isNaN(i)?1:i,0,1)]}}}function o(t){if(t){var e=/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/,a=t.match(e);if(a){var i=parseFloat(a[4]);return[v(parseInt(a[1]),0,360),v(parseFloat(a[2]),0,100),v(parseFloat(a[3]),0,100),v(isNaN(i)?1:i,0,1)]}}}function r(t){var e=i(t);return e&&e.slice(0,3)}function l(t){var e=n(t);return e&&e.slice(0,3)}function s(t){var e=i(t);return e?e[3]:(e=n(t))?e[3]:(e=o(t))?e[3]:void 0}function d(t){return"#"+x(t[0])+x(t[1])+x(t[2])}function u(t,e){return 1>e||t[3]&&t[3]<1?c(t,e):"rgb("+t[0]+", "+t[1]+", "+t[2]+")"}function c(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"rgba("+t[0]+", "+t[1]+", "+t[2]+", "+e+")"}function h(t,e){return 1>e||t[3]&&t[3]<1?f(t,e):"rgb("+Math.round(t[0]/255*100)+"%, "+Math.round(t[1]/255*100)+"%, "+Math.round(t[2]/255*100)+"%)"}function f(t,e){return"rgba("+Math.round(t[0]/255*100)+"%, "+Math.round(t[1]/255*100)+"%, "+Math.round(t[2]/255*100)+"%, "+(e||t[3]||1)+")"}function g(t,e){return 1>e||t[3]&&t[3]<1?p(t,e):"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)"}function p(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+e+")"}function m(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+(void 0!==e&&1!==e?", "+e:"")+")"}function b(t){return k[t.slice(0,3)]}function v(t,e,a){return Math.min(Math.max(e,t),a)}function x(t){var e=t.toString(16).toUpperCase();return e.length<2?"0"+e:e}var y=t(6);e.exports={getRgba:i,getHsla:n,getRgb:r,getHsl:l,getHwb:o,getAlpha:s,hexString:d,rgbString:u,rgbaString:c,percentString:h,percentaString:f,hslString:g,hslaString:p,hwbString:m,keyword:b};var k={};for(var S in y)k[y[S]]=S},{6:6}],3:[function(t,e,a){var i=t(5),n=t(2),o=function(t){if(t instanceof o)return t;if(!(this instanceof o))return new o(t);this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1};var e;if("string"==typeof t)if(e=n.getRgba(t))this.setValues("rgb",e);else if(e=n.getHsla(t))this.setValues("hsl",e);else{if(!(e=n.getHwb(t)))throw new Error('Unable to parse color from string "'+t+'"');this.setValues("hwb",e)}else if("object"==typeof t)if(e=t,void 0!==e.r||void 0!==e.red)this.setValues("rgb",e);else if(void 0!==e.l||void 0!==e.lightness)this.setValues("hsl",e);else if(void 0!==e.v||void 0!==e.value)this.setValues("hsv",e);else if(void 0!==e.w||void 0!==e.whiteness)this.setValues("hwb",e);else{if(void 0===e.c&&void 0===e.cyan)throw new Error("Unable to parse color from object "+JSON.stringify(t));this.setValues("cmyk",e)}};o.prototype={rgb:function(){return this.setSpace("rgb",arguments)},hsl:function(){return this.setSpace("hsl",arguments)},hsv:function(){return this.setSpace("hsv",arguments)},hwb:function(){return this.setSpace("hwb",arguments)},cmyk:function(){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){var t=this.values;return 1!==t.alpha?t.hwb.concat([t.alpha]):t.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var t=this.values;return t.rgb.concat([t.alpha])},hslaArray:function(){var t=this.values;return t.hsl.concat([t.alpha])},alpha:function(t){return void 0===t?this.values.alpha:(this.setValues("alpha",t),this)},red:function(t){return this.setChannel("rgb",0,t)},green:function(t){return this.setChannel("rgb",1,t)},blue:function(t){return this.setChannel("rgb",2,t)},hue:function(t){return t&&(t%=360,t=0>t?360+t:t),this.setChannel("hsl",0,t)},saturation:function(t){return this.setChannel("hsl",1,t)},lightness:function(t){return this.setChannel("hsl",2,t)},saturationv:function(t){return this.setChannel("hsv",1,t)},whiteness:function(t){return this.setChannel("hwb",1,t)},blackness:function(t){return this.setChannel("hwb",2,t)},value:function(t){return this.setChannel("hsv",2,t)},cyan:function(t){return this.setChannel("cmyk",0,t)},magenta:function(t){return this.setChannel("cmyk",1,t)},yellow:function(t){return this.setChannel("cmyk",2,t)},black:function(t){return this.setChannel("cmyk",3,t)},hexString:function(){return n.hexString(this.values.rgb)},rgbString:function(){return n.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return n.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return n.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return n.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return n.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return n.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return n.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){var t=this.values.rgb;return t[0]<<16|t[1]<<8|t[2]},luminosity:function(){for(var t=this.values.rgb,e=[],a=0;a<t.length;a++){var i=t[a]/255;e[a]=.03928>=i?i/12.92:Math.pow((i+.055)/1.055,2.4)}return.2126*e[0]+.7152*e[1]+.0722*e[2]},contrast:function(t){var e=this.luminosity(),a=t.luminosity();return e>a?(e+.05)/(a+.05):(a+.05)/(e+.05)},level:function(t){var e=this.contrast(t);return e>=7.1?"AAA":e>=4.5?"AA":""},dark:function(){var t=this.values.rgb;return 128>(299*t[0]+587*t[1]+114*t[2])/1e3},light:function(){return!this.dark()},negate:function(){for(var t=[],e=0;3>e;e++)t[e]=255-this.values.rgb[e];return this.setValues("rgb",t),this},lighten:function(t){var e=this.values.hsl;return e[2]+=e[2]*t,this.setValues("hsl",e),this},darken:function(t){var e=this.values.hsl;return e[2]-=e[2]*t,this.setValues("hsl",e),this},saturate:function(t){var e=this.values.hsl;return e[1]+=e[1]*t,this.setValues("hsl",e),this},desaturate:function(t){var e=this.values.hsl;return e[1]-=e[1]*t,this.setValues("hsl",e),this},whiten:function(t){var e=this.values.hwb;return e[1]+=e[1]*t,this.setValues("hwb",e),this},blacken:function(t){var e=this.values.hwb;return e[2]+=e[2]*t,this.setValues("hwb",e),this},greyscale:function(){var t=this.values.rgb,e=.3*t[0]+.59*t[1]+.11*t[2];return this.setValues("rgb",[e,e,e]),this},clearer:function(t){var e=this.values.alpha;return this.setValues("alpha",e-e*t),this},opaquer:function(t){var e=this.values.alpha;return this.setValues("alpha",e+e*t),this},rotate:function(t){var e=this.values.hsl,a=(e[0]+t)%360;return e[0]=0>a?360+a:a,this.setValues("hsl",e),this},mix:function(t,e){var a=this,i=t,n=void 0===e?.5:e,o=2*n-1,r=a.alpha()-i.alpha(),l=((o*r==-1?o:(o+r)/(1+o*r))+1)/2,s=1-l;return this.rgb(l*a.red()+s*i.red(),l*a.green()+s*i.green(),l*a.blue()+s*i.blue()).alpha(a.alpha()*n+i.alpha()*(1-n))},toJSON:function(){return this.rgb()},clone:function(){var t,e,a=new o,i=this.values,n=a.values;for(var r in i)i.hasOwnProperty(r)&&(t=i[r],e={}.toString.call(t),"[object Array]"===e?n[r]=t.slice(0):"[object Number]"===e?n[r]=t:console.error("unexpected color value:",t));return a}},o.prototype.spaces={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]},o.prototype.maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]},o.prototype.getValues=function(t){for(var e=this.values,a={},i=0;i<t.length;i++)a[t.charAt(i)]=e[t][i];return 1!==e.alpha&&(a.a=e.alpha),a},o.prototype.setValues=function(t,e){var a,n=this.values,o=this.spaces,r=this.maxes,l=1;if("alpha"===t)l=e;else if(e.length)n[t]=e.slice(0,t.length),l=e[t.length];else if(void 0!==e[t.charAt(0)]){for(a=0;a<t.length;a++)n[t][a]=e[t.charAt(a)];l=e.a}else if(void 0!==e[o[t][0]]){var s=o[t];for(a=0;a<t.length;a++)n[t][a]=e[s[a]];l=e.alpha}if(n.alpha=Math.max(0,Math.min(1,void 0===l?n.alpha:l)),"alpha"===t)return!1;var d;for(a=0;a<t.length;a++)d=Math.max(0,Math.min(r[t][a],n[t][a])),n[t][a]=Math.round(d);for(var u in o)u!==t&&(n[u]=i[t][u](n[t]));return!0},o.prototype.setSpace=function(t,e){var a=e[0];return void 0===a?this.getValues(t):("number"==typeof a&&(a=Array.prototype.slice.call(e)),this.setValues(t,a),this)},o.prototype.setChannel=function(t,e,a){var i=this.values[t];return void 0===a?i[e]:a===i[e]?this:(i[e]=a,this.setValues(t,i),this)},"undefined"!=typeof window&&(window.Color=o),e.exports=o},{2:2,5:5}],4:[function(t,e,a){function i(t){var e,a,i,n=t[0]/255,o=t[1]/255,r=t[2]/255,l=Math.min(n,o,r),s=Math.max(n,o,r),d=s-l;return s==l?e=0:n==s?e=(o-r)/d:o==s?e=2+(r-n)/d:r==s&&(e=4+(n-o)/d),e=Math.min(60*e,360),0>e&&(e+=360),i=(l+s)/2,a=s==l?0:.5>=i?d/(s+l):d/(2-s-l),[e,100*a,100*i]}function n(t){var e,a,i,n=t[0],o=t[1],r=t[2],l=Math.min(n,o,r),s=Math.max(n,o,r),d=s-l;return a=0==s?0:d/s*1e3/10,s==l?e=0:n==s?e=(o-r)/d:o==s?e=2+(r-n)/d:r==s&&(e=4+(n-o)/d),e=Math.min(60*e,360),0>e&&(e+=360),i=s/255*1e3/10,[e,a,i]}function o(t){var e=t[0],a=t[1],n=t[2],o=i(t)[0],r=1/255*Math.min(e,Math.min(a,n)),n=1-1/255*Math.max(e,Math.max(a,n));return[o,100*r,100*n]}function l(t){var e,a,i,n,o=t[0]/255,r=t[1]/255,l=t[2]/255;return n=Math.min(1-o,1-r,1-l),e=(1-o-n)/(1-n)||0,a=(1-r-n)/(1-n)||0,i=(1-l-n)/(1-n)||0,[100*e,100*a,100*i,100*n]}function s(t){return G[JSON.stringify(t)]}function d(t){var e=t[0]/255,a=t[1]/255,i=t[2]/255;return e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,a=a>.04045?Math.pow((a+.055)/1.055,2.4):a/12.92,i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92,[100*(.4124*e+.3576*a+.1805*i),100*(.2126*e+.7152*a+.0722*i),100*(.0193*e+.1192*a+.9505*i)]}function u(t){var e,a,i,n=d(t),o=n[0],r=n[1],l=n[2];return o/=95.047,r/=100,l/=108.883,o=o>.008856?Math.pow(o,1/3):7.787*o+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,l=l>.008856?Math.pow(l,1/3):7.787*l+16/116,e=116*r-16,a=500*(o-r),i=200*(r-l),[e,a,i]}function c(t){return W(u(t))}function h(t){var e,a,i,n,o,r=t[0]/360,l=t[1]/100,s=t[2]/100;if(0==l)return o=255*s,[o,o,o];a=.5>s?s*(1+l):s+l-s*l,e=2*s-a,n=[0,0,0];for(var d=0;3>d;d++)i=r+1/3*-(d-1),0>i&&i++,i>1&&i--,o=1>6*i?e+6*(a-e)*i:1>2*i?a:2>3*i?e+(a-e)*(2/3-i)*6:e,n[d]=255*o;return n}function f(t){var e,a,i=t[0],n=t[1]/100,o=t[2]/100;return 0===o?[0,0,0]:(o*=2,n*=1>=o?o:2-o,a=(o+n)/2,e=2*n/(o+n),[i,100*e,100*a])}function p(t){return o(h(t))}function m(t){return l(h(t))}function v(t){return s(h(t))}function x(t){var e=t[0]/60,a=t[1]/100,i=t[2]/100,n=Math.floor(e)%6,o=e-Math.floor(e),r=255*i*(1-a),l=255*i*(1-a*o),s=255*i*(1-a*(1-o)),i=255*i;switch(n){case 0:return[i,s,r];case 1:return[l,i,r];case 2:return[r,i,s];case 3:return[r,l,i];case 4:return[s,r,i];case 5:return[i,r,l]}}function y(t){var e,a,i=t[0],n=t[1]/100,o=t[2]/100;return a=(2-n)*o,e=n*o,e/=1>=a?a:2-a,e=e||0,a/=2,[i,100*e,100*a]}function k(t){return o(x(t))}function S(t){return l(x(t))}function w(t){return s(x(t))}function C(t){var e,a,i,n,o=t[0]/360,l=t[1]/100,s=t[2]/100,d=l+s;switch(d>1&&(l/=d,s/=d),e=Math.floor(6*o),a=1-s,i=6*o-e,0!=(1&e)&&(i=1-i),n=l+i*(a-l),e){default:case 6:case 0:r=a,g=n,b=l;break;case 1:r=n,g=a,b=l;break;case 2:r=l,g=a,b=n;break;case 3:r=l,g=n,b=a;break;case 4:r=n,g=l,b=a;break;case 5:r=a,g=l,b=n}return[255*r,255*g,255*b]}function M(t){return i(C(t))}function D(t){return n(C(t))}function I(t){return l(C(t))}function A(t){return s(C(t))}function T(t){var e,a,i,n=t[0]/100,o=t[1]/100,r=t[2]/100,l=t[3]/100;return e=1-Math.min(1,n*(1-l)+l),a=1-Math.min(1,o*(1-l)+l),i=1-Math.min(1,r*(1-l)+l),[255*e,255*a,255*i]}function P(t){return i(T(t))}function F(t){return n(T(t))}function R(t){return o(T(t))}function _(t){return s(T(t))}function V(t){var e,a,i,n=t[0]/100,o=t[1]/100,r=t[2]/100;return e=3.2406*n+-1.5372*o+-.4986*r,a=-.9689*n+1.8758*o+.0415*r,i=.0557*n+-.204*o+1.057*r,e=e>.0031308?1.055*Math.pow(e,1/2.4)-.055:e*=12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a*=12.92,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*=12.92,e=Math.min(Math.max(0,e),1),a=Math.min(Math.max(0,a),1),i=Math.min(Math.max(0,i),1),[255*e,255*a,255*i]}function L(t){var e,a,i,n=t[0],o=t[1],r=t[2];return n/=95.047,o/=100,r/=108.883,n=n>.008856?Math.pow(n,1/3):7.787*n+16/116,o=o>.008856?Math.pow(o,1/3):7.787*o+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,e=116*o-16,a=500*(n-o),i=200*(o-r),[e,a,i]}function O(t){return W(L(t))}function B(t){var e,a,i,n,o=t[0],r=t[1],l=t[2];return 8>=o?(a=100*o/903.3,n=a/100*7.787+16/116):(a=100*Math.pow((o+16)/116,3),n=Math.pow(a/100,1/3)),e=.008856>=e/95.047?e=95.047*(r/500+n-16/116)/7.787:95.047*Math.pow(r/500+n,3),i=.008859>=i/108.883?i=108.883*(n-l/200-16/116)/7.787:108.883*Math.pow(n-l/200,3),[e,a,i]}function W(t){var e,a,i,n=t[0],o=t[1],r=t[2];return e=Math.atan2(r,o),a=360*e/2/Math.PI,0>a&&(a+=360),i=Math.sqrt(o*o+r*r),[n,i,a]}function z(t){return V(B(t))}function N(t){var e,a,i,n=t[0],o=t[1];return i=t[2]/360*2*Math.PI,e=o*Math.cos(i),a=o*Math.sin(i),[n,e,a]}function H(t){return B(N(t))}function E(t){return z(N(t))}function U(t){return Z[t]}function q(t){return i(U(t))}function j(t){return n(U(t))}function Y(t){return o(U(t))}function K(t){return l(U(t))}function X(t){return u(U(t))}function J(t){return d(U(t))}e.exports={rgb2hsl:i,rgb2hsv:n,rgb2hwb:o,rgb2cmyk:l,rgb2keyword:s,rgb2xyz:d,rgb2lab:u,rgb2lch:c,hsl2rgb:h,hsl2hsv:f,hsl2hwb:p,hsl2cmyk:m,hsl2keyword:v,hsv2rgb:x,hsv2hsl:y,hsv2hwb:k,hsv2cmyk:S,hsv2keyword:w,hwb2rgb:C,hwb2hsl:M,hwb2hsv:D,hwb2cmyk:I,hwb2keyword:A,cmyk2rgb:T,cmyk2hsl:P,cmyk2hsv:F,cmyk2hwb:R,cmyk2keyword:_,keyword2rgb:U,keyword2hsl:q,keyword2hsv:j,keyword2hwb:Y,keyword2cmyk:K,keyword2lab:X,keyword2xyz:J,xyz2rgb:V,xyz2lab:L,xyz2lch:O,lab2xyz:B,lab2rgb:z,lab2lch:W,lch2lab:N,lch2xyz:H,lch2rgb:E};var Z={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},G={};for(var Q in Z)G[JSON.stringify(Z[Q])]=Q},{}],5:[function(t,e,a){var i=t(4),n=function(){return new d};for(var o in i){n[o+"Raw"]=function(t){return function(e){return"number"==typeof e&&(e=Array.prototype.slice.call(arguments)),i[t](e)}}(o);var r=/(\w+)2(\w+)/.exec(o),l=r[1],s=r[2];n[l]=n[l]||{},n[l][s]=n[o]=function(t){return function(e){"number"==typeof e&&(e=Array.prototype.slice.call(arguments));var a=i[t](e);if("string"==typeof a||void 0===a)return a;for(var n=0;n<a.length;n++)a[n]=Math.round(a[n]);return a}}(o)}var d=function(){this.convs={}};d.prototype.routeSpace=function(t,e){var a=e[0];return void 0===a?this.getValues(t):("number"==typeof a&&(a=Array.prototype.slice.call(e)),this.setValues(t,a))},d.prototype.setValues=function(t,e){return this.space=t,this.convs={},this.convs[t]=e,this},d.prototype.getValues=function(t){var e=this.convs[t];if(!e){var a=this.space,i=this.convs[a];e=n[a][t](i),this.convs[t]=e}return e},["rgb","hsl","hsv","cmyk","keyword"].forEach(function(t){d.prototype[t]=function(e){return this.routeSpace(t,arguments)}}),e.exports=n},{4:4}],6:[function(t,e,a){e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],7:[function(t,e,a){var i=t(27)();t(26)(i),t(22)(i),t(25)(i),t(21)(i),t(23)(i),t(24)(i),t(28)(i),t(32)(i),t(30)(i),t(31)(i),t(33)(i),t(29)(i),t(34)(i),t(35)(i),t(36)(i),t(37)(i),t(38)(i),t(41)(i),t(39)(i),t(40)(i),t(42)(i),t(43)(i),t(44)(i),t(15)(i),t(16)(i),t(17)(i),t(18)(i),t(19)(i),t(20)(i),t(8)(i),t(9)(i),t(10)(i),t(11)(i),t(12)(i),t(13)(i),t(14)(i),window.Chart=e.exports=i},{10:10,11:11,12:12,13:13,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:21,22:22,23:23,24:24,25:25,26:26,27:27,28:28,29:29,30:30,31:31,32:32,33:33,34:34,35:35,36:36,37:37,38:38,39:39,40:40,41:41,42:42,43:43,44:44,8:8,9:9}],8:[function(t,e,a){"use strict";e.exports=function(t){t.Bar=function(e,a){return a.type="bar",new t(e,a)}}},{}],9:[function(t,e,a){"use strict";e.exports=function(t){t.Bubble=function(e,a){return a.type="bubble",new t(e,a)}}},{}],10:[function(t,e,a){"use strict";e.exports=function(t){t.Doughnut=function(e,a){return a.type="doughnut",new t(e,a)}}},{}],11:[function(t,e,a){"use strict";e.exports=function(t){t.Line=function(e,a){return a.type="line",new t(e,a)}}},{}],12:[function(t,e,a){"use strict";e.exports=function(t){t.PolarArea=function(e,a){return a.type="polarArea",new t(e,a)}}},{}],13:[function(t,e,a){"use strict";e.exports=function(t){t.Radar=function(e,a){return a.options=t.helpers.configMerge({aspectRatio:1},a.options),a.type="radar",new t(e,a)}}},{}],14:[function(t,e,a){"use strict";e.exports=function(t){var e={hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-1"}],yAxes:[{type:"linear",position:"left",id:"y-axis-1"}]},tooltips:{callbacks:{title:function(){return""},label:function(t){return"("+t.xLabel+", "+t.yLabel+")"}}}};t.defaults.scatter=e,t.controllers.scatter=t.controllers.line,t.Scatter=function(e,a){return a.type="scatter",new t(e,a)}}},{}],15:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.defaults.bar={hover:{mode:"label"},scales:{xAxes:[{type:"category",categoryPercentage:.8,barPercentage:.9,gridLines:{offsetGridLines:!0}}],yAxes:[{type:"linear"}]}},t.controllers.bar=t.DatasetController.extend({dataElementType:t.elements.Rectangle,initialize:function(e,a){t.DatasetController.prototype.initialize.call(this,e,a),this.getMeta().bar=!0},getBarCount:function(){var t=this,a=0;return e.each(t.chart.data.datasets,function(e,i){t.chart.getDatasetMeta(i).bar&&t.chart.isDatasetVisible(i)&&++a},t),a},update:function(t){var a=this;e.each(a.getMeta().data,function(e,i){a.updateElement(e,i,t)},a)},updateElement:function(t,a,i){var n=this,o=n.getMeta(),r=n.getScaleForId(o.xAxisID),l=n.getScaleForId(o.yAxisID),s=l.getBasePixel(),d=n.chart.options.elements.rectangle,u=t.custom||{},c=n.getDataset();e.extend(t,{_xScale:r,_yScale:l,_datasetIndex:n.index,_index:a,_model:{x:n.calculateBarX(a,n.index),y:i?s:n.calculateBarY(a,n.index),label:n.chart.data.labels[a],datasetLabel:c.label,base:i?s:n.calculateBarBase(n.index,a),width:n.calculateBarWidth(a),backgroundColor:u.backgroundColor?u.backgroundColor:e.getValueAtIndexOrDefault(c.backgroundColor,a,d.backgroundColor),borderSkipped:u.borderSkipped?u.borderSkipped:d.borderSkipped,borderColor:u.borderColor?u.borderColor:e.getValueAtIndexOrDefault(c.borderColor,a,d.borderColor),borderWidth:u.borderWidth?u.borderWidth:e.getValueAtIndexOrDefault(c.borderWidth,a,d.borderWidth)}}),t.pivot()},calculateBarBase:function(t,e){var a=this,i=a.getMeta(),n=a.getScaleForId(i.yAxisID),o=0;if(n.options.stacked){for(var r=a.chart,l=r.data.datasets,s=Number(l[t].data[e]),d=0;t>d;d++){var u=l[d],c=r.getDatasetMeta(d);if(c.bar&&c.yAxisID===n.id&&r.isDatasetVisible(d)){var h=Number(u.data[e]);o+=0>s?Math.min(h,0):Math.max(h,0)}}return n.getPixelForValue(o)}return n.getBasePixel()},getRuler:function(t){var e,a=this,i=a.getMeta(),n=a.getScaleForId(i.xAxisID),o=a.getBarCount();e="category"===n.options.type?n.getPixelForTick(t+1)-n.getPixelForTick(t):n.width/n.ticks.length;var r=e*n.options.categoryPercentage,l=(e-e*n.options.categoryPercentage)/2,s=r/o;if(n.ticks.length!==a.chart.data.labels.length){s*=n.ticks.length/a.chart.data.labels.length}return{datasetCount:o,tickWidth:e,categoryWidth:r,categorySpacing:l,fullBarWidth:s,barWidth:s*n.options.barPercentage,barSpacing:s-s*n.options.barPercentage}},calculateBarWidth:function(t){var e=this.getScaleForId(this.getMeta().xAxisID);if(e.options.barThickness)return e.options.barThickness;var a=this.getRuler(t);return e.options.stacked?a.categoryWidth:a.barWidth},getBarIndex:function(t){var e,a,i=0;for(a=0;t>a;++a)e=this.chart.getDatasetMeta(a),e.bar&&this.chart.isDatasetVisible(a)&&++i;return i},calculateBarX:function(t,e){var a=this,i=a.getMeta(),n=a.getScaleForId(i.xAxisID),o=a.getBarIndex(e),r=a.getRuler(t),l=n.getPixelForValue(null,t,e,a.chart.isCombo);return l-=a.chart.isCombo?r.tickWidth/2:0,n.options.stacked?l+r.categoryWidth/2+r.categorySpacing:l+r.barWidth/2+r.categorySpacing+r.barWidth*o+r.barSpacing/2+r.barSpacing*o},calculateBarY:function(t,e){var a=this,i=a.getMeta(),n=a.getScaleForId(i.yAxisID),o=Number(a.getDataset().data[t]);if(n.options.stacked){for(var r=0,l=0,s=0;e>s;s++){var d=a.chart.data.datasets[s],u=a.chart.getDatasetMeta(s);if(u.bar&&u.yAxisID===n.id&&a.chart.isDatasetVisible(s)){var c=Number(d.data[t]);0>c?l+=c||0:r+=c||0}}return 0>o?n.getPixelForValue(l+o):n.getPixelForValue(r+o)}return n.getPixelForValue(o)},draw:function(t){var a=this,i=t||1;e.each(a.getMeta().data,function(t,e){var n=a.getDataset().data[e];null===n||void 0===n||isNaN(n)||t.transition(i).draw()},a)},setHoverStyle:function(t){var a=this.chart.data.datasets[t._datasetIndex],i=t._index,n=t.custom||{},o=t._model;o.backgroundColor=n.hoverBackgroundColor?n.hoverBackgroundColor:e.getValueAtIndexOrDefault(a.hoverBackgroundColor,i,e.getHoverColor(o.backgroundColor)),o.borderColor=n.hoverBorderColor?n.hoverBorderColor:e.getValueAtIndexOrDefault(a.hoverBorderColor,i,e.getHoverColor(o.borderColor)),o.borderWidth=n.hoverBorderWidth?n.hoverBorderWidth:e.getValueAtIndexOrDefault(a.hoverBorderWidth,i,o.borderWidth)},removeHoverStyle:function(t){var a=this.chart.data.datasets[t._datasetIndex],i=t._index,n=t.custom||{},o=t._model,r=this.chart.options.elements.rectangle;o.backgroundColor=n.backgroundColor?n.backgroundColor:e.getValueAtIndexOrDefault(a.backgroundColor,i,r.backgroundColor),o.borderColor=n.borderColor?n.borderColor:e.getValueAtIndexOrDefault(a.borderColor,i,r.borderColor),o.borderWidth=n.borderWidth?n.borderWidth:e.getValueAtIndexOrDefault(a.borderWidth,i,r.borderWidth)}}),t.defaults.horizontalBar={hover:{mode:"label"},scales:{
xAxes:[{type:"linear",position:"bottom"}],yAxes:[{position:"left",type:"category",categoryPercentage:.8,barPercentage:.9,gridLines:{offsetGridLines:!0}}]},elements:{rectangle:{borderSkipped:"left"}},tooltips:{callbacks:{title:function(t,e){var a="";return t.length>0&&(t[0].yLabel?a=t[0].yLabel:e.labels.length>0&&t[0].index<e.labels.length&&(a=e.labels[t[0].index])),a},label:function(t,e){return(e.datasets[t.datasetIndex].label||"")+": "+t.xLabel}}}},t.controllers.horizontalBar=t.controllers.bar.extend({updateElement:function(t,a,i){var n=this,o=n.getMeta(),r=n.getScaleForId(o.xAxisID),l=n.getScaleForId(o.yAxisID),s=r.getBasePixel(),d=t.custom||{},u=n.getDataset(),c=n.chart.options.elements.rectangle;e.extend(t,{_xScale:r,_yScale:l,_datasetIndex:n.index,_index:a,_model:{x:i?s:n.calculateBarX(a,n.index),y:n.calculateBarY(a,n.index),label:n.chart.data.labels[a],datasetLabel:u.label,base:i?s:n.calculateBarBase(n.index,a),height:n.calculateBarHeight(a),backgroundColor:d.backgroundColor?d.backgroundColor:e.getValueAtIndexOrDefault(u.backgroundColor,a,c.backgroundColor),borderSkipped:d.borderSkipped?d.borderSkipped:c.borderSkipped,borderColor:d.borderColor?d.borderColor:e.getValueAtIndexOrDefault(u.borderColor,a,c.borderColor),borderWidth:d.borderWidth?d.borderWidth:e.getValueAtIndexOrDefault(u.borderWidth,a,c.borderWidth)},draw:function(){function t(t){return s[(u+t)%4]}var e=this._chart.ctx,a=this._view,i=a.height/2,n=a.y-i,o=a.y+i,r=a.base-(a.base-a.x),l=a.borderWidth/2;a.borderWidth&&(n+=l,o-=l,r+=l),e.beginPath(),e.fillStyle=a.backgroundColor,e.strokeStyle=a.borderColor,e.lineWidth=a.borderWidth;var s=[[a.base,o],[a.base,n],[r,n],[r,o]],d=["bottom","left","top","right"],u=d.indexOf(a.borderSkipped,0);-1===u&&(u=0),e.moveTo.apply(e,t(0));for(var c=1;4>c;c++)e.lineTo.apply(e,t(c));e.fill(),a.borderWidth&&e.stroke()},inRange:function(t,e){var a=this._view,i=!1;return a&&(i=a.x<a.base?e>=a.y-a.height/2&&e<=a.y+a.height/2&&t>=a.x&&t<=a.base:e>=a.y-a.height/2&&e<=a.y+a.height/2&&t>=a.base&&t<=a.x),i}}),t.pivot()},calculateBarBase:function(t,e){var a=this,i=a.getMeta(),n=a.getScaleForId(i.xAxisID),o=0;if(n.options.stacked){for(var r=a.chart,l=r.data.datasets,s=Number(l[t].data[e]),d=0;t>d;d++){var u=l[d],c=r.getDatasetMeta(d);if(c.bar&&c.xAxisID===n.id&&r.isDatasetVisible(d)){var h=Number(u.data[e]);o+=0>s?Math.min(h,0):Math.max(h,0)}}return n.getPixelForValue(o)}return n.getBasePixel()},getRuler:function(t){var e,a=this,i=a.getMeta(),n=a.getScaleForId(i.yAxisID),o=a.getBarCount();e="category"===n.options.type?n.getPixelForTick(t+1)-n.getPixelForTick(t):n.width/n.ticks.length;var r=e*n.options.categoryPercentage,l=(e-e*n.options.categoryPercentage)/2,s=r/o;if(n.ticks.length!==a.chart.data.labels.length){s*=n.ticks.length/a.chart.data.labels.length}return{datasetCount:o,tickHeight:e,categoryHeight:r,categorySpacing:l,fullBarHeight:s,barHeight:s*n.options.barPercentage,barSpacing:s-s*n.options.barPercentage}},calculateBarHeight:function(t){var e=this,a=e.getScaleForId(e.getMeta().yAxisID);if(a.options.barThickness)return a.options.barThickness;var i=e.getRuler(t);return a.options.stacked?i.categoryHeight:i.barHeight},calculateBarX:function(t,e){var a=this,i=a.getMeta(),n=a.getScaleForId(i.xAxisID),o=Number(a.getDataset().data[t]);if(n.options.stacked){for(var r=0,l=0,s=0;e>s;s++){var d=a.chart.data.datasets[s],u=a.chart.getDatasetMeta(s);if(u.bar&&u.xAxisID===n.id&&a.chart.isDatasetVisible(s)){var c=Number(d.data[t]);0>c?l+=c||0:r+=c||0}}return 0>o?n.getPixelForValue(l+o):n.getPixelForValue(r+o)}return n.getPixelForValue(o)},calculateBarY:function(t,e){var a=this,i=a.getMeta(),n=a.getScaleForId(i.yAxisID),o=a.getBarIndex(e),r=a.getRuler(t),l=n.getPixelForValue(null,t,e,a.chart.isCombo);return l-=a.chart.isCombo?r.tickHeight/2:0,n.options.stacked?l+r.categoryHeight/2+r.categorySpacing:l+r.barHeight/2+r.categorySpacing+r.barHeight*o+r.barSpacing/2+r.barSpacing*o}})}},{}],16:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.defaults.bubble={hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-0"}],yAxes:[{type:"linear",position:"left",id:"y-axis-0"}]},tooltips:{callbacks:{title:function(){return""},label:function(t,e){var a=e.datasets[t.datasetIndex].label||"",i=e.datasets[t.datasetIndex].data[t.index];return a+": ("+i.x+", "+i.y+", "+i.r+")"}}}},t.controllers.bubble=t.DatasetController.extend({dataElementType:t.elements.Point,update:function(t){var a=this,i=a.getMeta(),n=i.data;e.each(n,function(e,i){a.updateElement(e,i,t)})},updateElement:function(a,i,n){var o=this,r=o.getMeta(),l=o.getScaleForId(r.xAxisID),s=o.getScaleForId(r.yAxisID),d=a.custom||{},u=o.getDataset(),c=u.data[i],h=o.chart.options.elements.point,f=o.index;e.extend(a,{_xScale:l,_yScale:s,_datasetIndex:f,_index:i,_model:{x:n?l.getPixelForDecimal(.5):l.getPixelForValue("object"==typeof c?c:NaN,i,f,o.chart.isCombo),y:n?s.getBasePixel():s.getPixelForValue(c,i,f),radius:n?0:d.radius?d.radius:o.getRadius(c),hitRadius:d.hitRadius?d.hitRadius:e.getValueAtIndexOrDefault(u.hitRadius,i,h.hitRadius)}}),t.DatasetController.prototype.removeHoverStyle.call(o,a,h);var g=a._model;g.skip=d.skip?d.skip:isNaN(g.x)||isNaN(g.y),a.pivot()},getRadius:function(t){return t.r||this.chart.options.elements.point.radius},setHoverStyle:function(a){var i=this;t.DatasetController.prototype.setHoverStyle.call(i,a);var n=i.chart.data.datasets[a._datasetIndex],o=a._index,r=a.custom||{};a._model.radius=r.hoverRadius?r.hoverRadius:e.getValueAtIndexOrDefault(n.hoverRadius,o,i.chart.options.elements.point.hoverRadius)+i.getRadius(n.data[o])},removeHoverStyle:function(e){var a=this;t.DatasetController.prototype.removeHoverStyle.call(a,e,a.chart.options.elements.point);var i=a.chart.data.datasets[e._datasetIndex].data[e._index],n=e.custom||{};e._model.radius=n.radius?n.radius:a.getRadius(i)}})}},{}],17:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a=t.defaults;a.doughnut={animation:{animateRotate:!0,animateScale:!1},aspectRatio:1,hover:{mode:"single"},legendCallback:function(t){var e=[];e.push('<ul class="'+t.id+'-legend">');var a=t.data,i=a.datasets,n=a.labels;if(i.length)for(var o=0;o<i[0].data.length;++o)e.push('<li><span style="background-color:'+i[0].backgroundColor[o]+'"></span>'),n[o]&&e.push(n[o]),e.push("</li>");return e.push("</ul>"),e.join("")},legend:{labels:{generateLabels:function(t){var a=t.data;return a.labels.length&&a.datasets.length?a.labels.map(function(i,n){var o=t.getDatasetMeta(0),r=a.datasets[0],l=o.data[n],s=l&&l.custom||{},d=e.getValueAtIndexOrDefault,u=t.options.elements.arc;return{text:i,fillStyle:s.backgroundColor?s.backgroundColor:d(r.backgroundColor,n,u.backgroundColor),strokeStyle:s.borderColor?s.borderColor:d(r.borderColor,n,u.borderColor),lineWidth:s.borderWidth?s.borderWidth:d(r.borderWidth,n,u.borderWidth),hidden:isNaN(r.data[n])||o.data[n].hidden,index:n}}):[]}},onClick:function(t,e){var a,i,n,o=e.index,r=this.chart;for(a=0,i=(r.data.datasets||[]).length;i>a;++a)n=r.getDatasetMeta(a),n.data[o]&&(n.data[o].hidden=!n.data[o].hidden);r.update()}},cutoutPercentage:50,rotation:-.5*Math.PI,circumference:2*Math.PI,tooltips:{callbacks:{title:function(){return""},label:function(t,e){return e.labels[t.index]+": "+e.datasets[t.datasetIndex].data[t.index]}}}},a.pie=e.clone(a.doughnut),e.extend(a.pie,{cutoutPercentage:0}),t.controllers.doughnut=t.controllers.pie=t.DatasetController.extend({dataElementType:t.elements.Arc,linkScales:e.noop,getRingIndex:function(t){for(var e=0,a=0;t>a;++a)this.chart.isDatasetVisible(a)&&++e;return e},update:function(t){var a=this,i=a.chart,n=i.chartArea,o=i.options,r=o.elements.arc,l=n.right-n.left-r.borderWidth,s=n.bottom-n.top-r.borderWidth,d=Math.min(l,s),u={x:0,y:0},c=a.getMeta(),h=o.cutoutPercentage,f=o.circumference;if(f<2*Math.PI){var g=o.rotation%(2*Math.PI);g+=2*Math.PI*(g>=Math.PI?-1:g<-Math.PI?1:0);var p=g+f,m={x:Math.cos(g),y:Math.sin(g)},b={x:Math.cos(p),y:Math.sin(p)},v=0>=g&&p>=0||g<=2*Math.PI&&2*Math.PI<=p,x=g<=.5*Math.PI&&.5*Math.PI<=p||g<=2.5*Math.PI&&2.5*Math.PI<=p,y=g<=-Math.PI&&-Math.PI<=p||g<=Math.PI&&Math.PI<=p,k=g<=.5*-Math.PI&&.5*-Math.PI<=p||g<=1.5*Math.PI&&1.5*Math.PI<=p,S=h/100,w={x:y?-1:Math.min(m.x*(m.x<0?1:S),b.x*(b.x<0?1:S)),y:k?-1:Math.min(m.y*(m.y<0?1:S),b.y*(b.y<0?1:S))},C={x:v?1:Math.max(m.x*(m.x>0?1:S),b.x*(b.x>0?1:S)),y:x?1:Math.max(m.y*(m.y>0?1:S),b.y*(b.y>0?1:S))},M={width:.5*(C.x-w.x),height:.5*(C.y-w.y)};d=Math.min(l/M.width,s/M.height),u={x:-.5*(C.x+w.x),y:-.5*(C.y+w.y)}}i.borderWidth=a.getMaxBorderWidth(c.data),i.outerRadius=Math.max((d-i.borderWidth)/2,0),i.innerRadius=Math.max(h?i.outerRadius/100*h:1,0),i.radiusLength=(i.outerRadius-i.innerRadius)/i.getVisibleDatasetCount(),i.offsetX=u.x*i.outerRadius,i.offsetY=u.y*i.outerRadius,c.total=a.calculateTotal(),a.outerRadius=i.outerRadius-i.radiusLength*a.getRingIndex(a.index),a.innerRadius=a.outerRadius-i.radiusLength,e.each(c.data,function(e,i){a.updateElement(e,i,t)})},updateElement:function(t,a,i){var n=this,o=n.chart,r=o.chartArea,l=o.options,s=l.animation,d=(r.left+r.right)/2,u=(r.top+r.bottom)/2,c=l.rotation,h=l.rotation,f=n.getDataset(),g=i&&s.animateRotate?0:t.hidden?0:n.calculateCircumference(f.data[a])*(l.circumference/(2*Math.PI)),p=i&&s.animateScale?0:n.innerRadius,m=i&&s.animateScale?0:n.outerRadius,b=e.getValueAtIndexOrDefault;e.extend(t,{_datasetIndex:n.index,_index:a,_model:{x:d+o.offsetX,y:u+o.offsetY,startAngle:c,endAngle:h,circumference:g,outerRadius:m,innerRadius:p,label:b(f.label,a,o.data.labels[a])}});var v=t._model;this.removeHoverStyle(t),i&&s.animateRotate||(v.startAngle=0===a?l.rotation:n.getMeta().data[a-1]._model.endAngle,v.endAngle=v.startAngle+v.circumference),t.pivot()},removeHoverStyle:function(e){t.DatasetController.prototype.removeHoverStyle.call(this,e,this.chart.options.elements.arc)},calculateTotal:function(){var t,a=this.getDataset(),i=this.getMeta(),n=0;return e.each(i.data,function(e,i){t=a.data[i],isNaN(t)||e.hidden||(n+=Math.abs(t))}),n},calculateCircumference:function(t){var e=this.getMeta().total;return e>0&&!isNaN(t)?2*Math.PI*(t/e):0},getMaxBorderWidth:function(t){for(var e,a,i=0,n=this.index,o=t.length,r=0;o>r;r++)e=t[r]._model?t[r]._model.borderWidth:0,a=t[r]._chart?t[r]._chart.config.data.datasets[n].hoverBorderWidth:0,i=e>i?e:i,i=a>i?a:i;return i}})}},{}],18:[function(t,e,a){"use strict";e.exports=function(t){function e(t,e){return a.getValueOrDefault(t.showLine,e.showLines)}var a=t.helpers;t.defaults.line={showLines:!0,spanGaps:!1,hover:{mode:"label"},scales:{xAxes:[{type:"category",id:"x-axis-0"}],yAxes:[{type:"linear",id:"y-axis-0"}]}},t.controllers.line=t.DatasetController.extend({datasetElementType:t.elements.Line,dataElementType:t.elements.Point,addElementAndReset:function(a){var i=this,n=i.chart.options,o=i.getMeta();t.DatasetController.prototype.addElementAndReset.call(i,a),e(i.getDataset(),n)&&0!==o.dataset._model.tension&&i.updateBezierControlPoints()},update:function(t){var i,n,o,r=this,l=r.getMeta(),s=l.dataset,d=l.data||[],u=r.chart.options,c=u.elements.line,h=r.getScaleForId(l.yAxisID),f=r.getDataset(),g=e(f,u);for(g&&(o=s.custom||{},void 0!==f.tension&&void 0===f.lineTension&&(f.lineTension=f.tension),s._scale=h,s._datasetIndex=r.index,s._children=d,s._model={spanGaps:f.spanGaps?f.spanGaps:u.spanGaps,tension:o.tension?o.tension:a.getValueOrDefault(f.lineTension,c.tension),backgroundColor:o.backgroundColor?o.backgroundColor:f.backgroundColor||c.backgroundColor,borderWidth:o.borderWidth?o.borderWidth:f.borderWidth||c.borderWidth,borderColor:o.borderColor?o.borderColor:f.borderColor||c.borderColor,borderCapStyle:o.borderCapStyle?o.borderCapStyle:f.borderCapStyle||c.borderCapStyle,borderDash:o.borderDash?o.borderDash:f.borderDash||c.borderDash,borderDashOffset:o.borderDashOffset?o.borderDashOffset:f.borderDashOffset||c.borderDashOffset,borderJoinStyle:o.borderJoinStyle?o.borderJoinStyle:f.borderJoinStyle||c.borderJoinStyle,fill:o.fill?o.fill:void 0!==f.fill?f.fill:c.fill,steppedLine:o.steppedLine?o.steppedLine:a.getValueOrDefault(f.steppedLine,c.stepped),cubicInterpolationMode:o.cubicInterpolationMode?o.cubicInterpolationMode:a.getValueOrDefault(f.cubicInterpolationMode,c.cubicInterpolationMode),scaleTop:h.top,scaleBottom:h.bottom,scaleZero:h.getBasePixel()},s.pivot()),i=0,n=d.length;n>i;++i)r.updateElement(d[i],i,t);for(g&&0!==s._model.tension&&r.updateBezierControlPoints(),i=0,n=d.length;n>i;++i)d[i].pivot()},getPointBackgroundColor:function(t,e){var i=this.chart.options.elements.point.backgroundColor,n=this.getDataset(),o=t.custom||{};return o.backgroundColor?i=o.backgroundColor:n.pointBackgroundColor?i=a.getValueAtIndexOrDefault(n.pointBackgroundColor,e,i):n.backgroundColor&&(i=n.backgroundColor),i},getPointBorderColor:function(t,e){var i=this.chart.options.elements.point.borderColor,n=this.getDataset(),o=t.custom||{};return o.borderColor?i=o.borderColor:n.pointBorderColor?i=a.getValueAtIndexOrDefault(n.pointBorderColor,e,i):n.borderColor&&(i=n.borderColor),i},getPointBorderWidth:function(t,e){var i=this.chart.options.elements.point.borderWidth,n=this.getDataset(),o=t.custom||{};return o.borderWidth?i=o.borderWidth:n.pointBorderWidth?i=a.getValueAtIndexOrDefault(n.pointBorderWidth,e,i):n.borderWidth&&(i=n.borderWidth),i},updateElement:function(t,e,i){var n,o,r=this,l=r.getMeta(),s=t.custom||{},d=r.getDataset(),u=r.index,c=d.data[e],h=r.getScaleForId(l.yAxisID),f=r.getScaleForId(l.xAxisID),g=r.chart.options.elements.point,p=r.chart.data.labels||[],m=1===p.length||1===d.data.length||r.chart.isCombo;void 0!==d.radius&&void 0===d.pointRadius&&(d.pointRadius=d.radius),void 0!==d.hitRadius&&void 0===d.pointHitRadius&&(d.pointHitRadius=d.hitRadius),n=f.getPixelForValue("object"==typeof c?c:NaN,e,u,m),o=i?h.getBasePixel():r.calculatePointY(c,e,u),t._xScale=f,t._yScale=h,t._datasetIndex=u,t._index=e,t._model={x:n,y:o,skip:s.skip||isNaN(n)||isNaN(o),radius:s.radius||a.getValueAtIndexOrDefault(d.pointRadius,e,g.radius),pointStyle:s.pointStyle||a.getValueAtIndexOrDefault(d.pointStyle,e,g.pointStyle),backgroundColor:r.getPointBackgroundColor(t,e),borderColor:r.getPointBorderColor(t,e),borderWidth:r.getPointBorderWidth(t,e),tension:l.dataset._model?l.dataset._model.tension:0,steppedLine:!!l.dataset._model&&l.dataset._model.steppedLine,hitRadius:s.hitRadius||a.getValueAtIndexOrDefault(d.pointHitRadius,e,g.hitRadius)}},calculatePointY:function(t,e,a){var i,n,o,r=this,l=r.chart,s=r.getMeta(),d=r.getScaleForId(s.yAxisID),u=0,c=0;if(d.options.stacked){for(i=0;a>i;i++)if(n=l.data.datasets[i],o=l.getDatasetMeta(i),"line"===o.type&&o.yAxisID===d.id&&l.isDatasetVisible(i)){var h=Number(d.getRightValue(n.data[e]));0>h?c+=h||0:u+=h||0}var f=Number(d.getRightValue(t));return 0>f?d.getPixelForValue(c+f):d.getPixelForValue(u+f)}return d.getPixelForValue(t)},updateBezierControlPoints:function(){function t(t,e,a){return Math.max(Math.min(t,a),e)}var e,i,n,o,r,l=this,s=l.getMeta(),d=l.chart.chartArea,u=s.data||[];if(s.dataset._model.spanGaps&&(u=u.filter(function(t){return!t._model.skip})),"monotone"===s.dataset._model.cubicInterpolationMode)a.splineCurveMonotone(u);else for(e=0,i=u.length;i>e;++e)n=u[e],o=n._model,r=a.splineCurve(a.previousItem(u,e)._model,o,a.nextItem(u,e)._model,s.dataset._model.tension),o.controlPointPreviousX=r.previous.x,o.controlPointPreviousY=r.previous.y,o.controlPointNextX=r.next.x,o.controlPointNextY=r.next.y;if(l.chart.options.elements.line.capBezierPoints)for(e=0,i=u.length;i>e;++e)o=u[e]._model,o.controlPointPreviousX=t(o.controlPointPreviousX,d.left,d.right),o.controlPointPreviousY=t(o.controlPointPreviousY,d.top,d.bottom),o.controlPointNextX=t(o.controlPointNextX,d.left,d.right),o.controlPointNextY=t(o.controlPointNextY,d.top,d.bottom)},draw:function(t){var a,i,n=this,o=n.getMeta(),r=o.data||[],l=t||1;for(a=0,i=r.length;i>a;++a)r[a].transition(l);for(e(n.getDataset(),n.chart.options)&&o.dataset.transition(l).draw(),a=0,i=r.length;i>a;++a)r[a].draw()},setHoverStyle:function(t){var e=this.chart.data.datasets[t._datasetIndex],i=t._index,n=t.custom||{},o=t._model;o.radius=n.hoverRadius||a.getValueAtIndexOrDefault(e.pointHoverRadius,i,this.chart.options.elements.point.hoverRadius),o.backgroundColor=n.hoverBackgroundColor||a.getValueAtIndexOrDefault(e.pointHoverBackgroundColor,i,a.getHoverColor(o.backgroundColor)),o.borderColor=n.hoverBorderColor||a.getValueAtIndexOrDefault(e.pointHoverBorderColor,i,a.getHoverColor(o.borderColor)),o.borderWidth=n.hoverBorderWidth||a.getValueAtIndexOrDefault(e.pointHoverBorderWidth,i,o.borderWidth)},removeHoverStyle:function(t){var e=this,i=e.chart.data.datasets[t._datasetIndex],n=t._index,o=t.custom||{},r=t._model;void 0!==i.radius&&void 0===i.pointRadius&&(i.pointRadius=i.radius),r.radius=o.radius||a.getValueAtIndexOrDefault(i.pointRadius,n,e.chart.options.elements.point.radius),r.backgroundColor=e.getPointBackgroundColor(t,n),r.borderColor=e.getPointBorderColor(t,n),r.borderWidth=e.getPointBorderWidth(t,n)}})}},{}],19:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.defaults.polarArea={scale:{type:"radialLinear",lineArc:!0,ticks:{beginAtZero:!0}},animation:{animateRotate:!0,animateScale:!0},startAngle:-.5*Math.PI,aspectRatio:1,legendCallback:function(t){var e=[];e.push('<ul class="'+t.id+'-legend">');var a=t.data,i=a.datasets,n=a.labels;if(i.length)for(var o=0;o<i[0].data.length;++o)e.push('<li><span style="background-color:'+i[0].backgroundColor[o]+'">'),n[o]&&e.push(n[o]),e.push("</span></li>");return e.push("</ul>"),e.join("")},legend:{labels:{generateLabels:function(t){var a=t.data;return a.labels.length&&a.datasets.length?a.labels.map(function(i,n){var o=t.getDatasetMeta(0),r=a.datasets[0],l=o.data[n],s=l.custom||{},d=e.getValueAtIndexOrDefault,u=t.options.elements.arc;return{text:i,fillStyle:s.backgroundColor?s.backgroundColor:d(r.backgroundColor,n,u.backgroundColor),strokeStyle:s.borderColor?s.borderColor:d(r.borderColor,n,u.borderColor),lineWidth:s.borderWidth?s.borderWidth:d(r.borderWidth,n,u.borderWidth),hidden:isNaN(r.data[n])||o.data[n].hidden,index:n}}):[]}},onClick:function(t,e){var a,i,n,o=e.index,r=this.chart;for(a=0,i=(r.data.datasets||[]).length;i>a;++a)n=r.getDatasetMeta(a),n.data[o].hidden=!n.data[o].hidden;r.update()}},tooltips:{callbacks:{title:function(){return""},label:function(t,e){return e.labels[t.index]+": "+t.yLabel}}}},t.controllers.polarArea=t.DatasetController.extend({dataElementType:t.elements.Arc,linkScales:e.noop,update:function(t){var a=this,i=a.chart,n=i.chartArea,o=a.getMeta(),r=i.options,l=r.elements.arc,s=Math.min(n.right-n.left,n.bottom-n.top);i.outerRadius=Math.max((s-l.borderWidth/2)/2,0),i.innerRadius=Math.max(r.cutoutPercentage?i.outerRadius/100*r.cutoutPercentage:1,0),i.radiusLength=(i.outerRadius-i.innerRadius)/i.getVisibleDatasetCount(),a.outerRadius=i.outerRadius-i.radiusLength*a.index,a.innerRadius=a.outerRadius-i.radiusLength,o.count=a.countVisibleElements(),e.each(o.data,function(e,i){a.updateElement(e,i,t)})},updateElement:function(t,a,i){for(var n=this,o=n.chart,r=n.getDataset(),l=o.options,s=l.animation,d=o.scale,u=e.getValueAtIndexOrDefault,c=o.data.labels,h=n.calculateCircumference(r.data[a]),f=d.xCenter,g=d.yCenter,p=0,m=n.getMeta(),b=0;a>b;++b)isNaN(r.data[b])||m.data[b].hidden||++p;var v=l.startAngle,x=t.hidden?0:d.getDistanceFromCenterForValue(r.data[a]),y=v+h*p,k=y+(t.hidden?0:h),S=s.animateScale?0:d.getDistanceFromCenterForValue(r.data[a]);e.extend(t,{_datasetIndex:n.index,_index:a,_scale:d,_model:{x:f,y:g,innerRadius:0,outerRadius:i?S:x,startAngle:i&&s.animateRotate?v:y,endAngle:i&&s.animateRotate?v:k,label:u(c,a,c[a])}}),n.removeHoverStyle(t),t.pivot()},removeHoverStyle:function(e){t.DatasetController.prototype.removeHoverStyle.call(this,e,this.chart.options.elements.arc)},countVisibleElements:function(){var t=this.getDataset(),a=this.getMeta(),i=0;return e.each(a.data,function(e,a){isNaN(t.data[a])||e.hidden||i++}),i},calculateCircumference:function(t){var e=this.getMeta().count;return e>0&&!isNaN(t)?2*Math.PI/e:0}})}},{}],20:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.defaults.radar={scale:{type:"radialLinear"},elements:{line:{tension:0}}},t.controllers.radar=t.DatasetController.extend({datasetElementType:t.elements.Line,dataElementType:t.elements.Point,linkScales:e.noop,addElementAndReset:function(e){t.DatasetController.prototype.addElementAndReset.call(this,e),this.updateBezierControlPoints()},update:function(t){var a=this,i=a.getMeta(),n=i.dataset,o=i.data,r=n.custom||{},l=a.getDataset(),s=a.chart.options.elements.line,d=a.chart.scale;void 0!==l.tension&&void 0===l.lineTension&&(l.lineTension=l.tension),e.extend(i.dataset,{_datasetIndex:a.index,_children:o,_loop:!0,_model:{tension:r.tension?r.tension:e.getValueOrDefault(l.lineTension,s.tension),backgroundColor:r.backgroundColor?r.backgroundColor:l.backgroundColor||s.backgroundColor,borderWidth:r.borderWidth?r.borderWidth:l.borderWidth||s.borderWidth,borderColor:r.borderColor?r.borderColor:l.borderColor||s.borderColor,fill:r.fill?r.fill:void 0!==l.fill?l.fill:s.fill,borderCapStyle:r.borderCapStyle?r.borderCapStyle:l.borderCapStyle||s.borderCapStyle,borderDash:r.borderDash?r.borderDash:l.borderDash||s.borderDash,borderDashOffset:r.borderDashOffset?r.borderDashOffset:l.borderDashOffset||s.borderDashOffset,borderJoinStyle:r.borderJoinStyle?r.borderJoinStyle:l.borderJoinStyle||s.borderJoinStyle,scaleTop:d.top,scaleBottom:d.bottom,scaleZero:d.getBasePosition()}}),i.dataset.pivot(),e.each(o,function(e,i){a.updateElement(e,i,t)},a),a.updateBezierControlPoints()},updateElement:function(t,a,i){var n=this,o=t.custom||{},r=n.getDataset(),l=n.chart.scale,s=n.chart.options.elements.point,d=l.getPointPositionForValue(a,r.data[a]);e.extend(t,{_datasetIndex:n.index,_index:a,_scale:l,_model:{x:i?l.xCenter:d.x,y:i?l.yCenter:d.y,tension:o.tension?o.tension:e.getValueOrDefault(r.tension,n.chart.options.elements.line.tension),radius:o.radius?o.radius:e.getValueAtIndexOrDefault(r.pointRadius,a,s.radius),backgroundColor:o.backgroundColor?o.backgroundColor:e.getValueAtIndexOrDefault(r.pointBackgroundColor,a,s.backgroundColor),borderColor:o.borderColor?o.borderColor:e.getValueAtIndexOrDefault(r.pointBorderColor,a,s.borderColor),borderWidth:o.borderWidth?o.borderWidth:e.getValueAtIndexOrDefault(r.pointBorderWidth,a,s.borderWidth),pointStyle:o.pointStyle?o.pointStyle:e.getValueAtIndexOrDefault(r.pointStyle,a,s.pointStyle),hitRadius:o.hitRadius?o.hitRadius:e.getValueAtIndexOrDefault(r.hitRadius,a,s.hitRadius)}}),t._model.skip=o.skip?o.skip:isNaN(t._model.x)||isNaN(t._model.y)},updateBezierControlPoints:function(){var t=this.chart.chartArea,a=this.getMeta();e.each(a.data,function(i,n){var o=i._model,r=e.splineCurve(e.previousItem(a.data,n,!0)._model,o,e.nextItem(a.data,n,!0)._model,o.tension);o.controlPointPreviousX=Math.max(Math.min(r.previous.x,t.right),t.left),o.controlPointPreviousY=Math.max(Math.min(r.previous.y,t.bottom),t.top),o.controlPointNextX=Math.max(Math.min(r.next.x,t.right),t.left),o.controlPointNextY=Math.max(Math.min(r.next.y,t.bottom),t.top),i.pivot()})},draw:function(t){var a=this.getMeta(),i=t||1;e.each(a.data,function(t){t.transition(i)}),a.dataset.transition(i).draw(),e.each(a.data,function(t){t.draw()})},setHoverStyle:function(t){var a=this.chart.data.datasets[t._datasetIndex],i=t.custom||{},n=t._index,o=t._model;o.radius=i.hoverRadius?i.hoverRadius:e.getValueAtIndexOrDefault(a.pointHoverRadius,n,this.chart.options.elements.point.hoverRadius),o.backgroundColor=i.hoverBackgroundColor?i.hoverBackgroundColor:e.getValueAtIndexOrDefault(a.pointHoverBackgroundColor,n,e.getHoverColor(o.backgroundColor)),o.borderColor=i.hoverBorderColor?i.hoverBorderColor:e.getValueAtIndexOrDefault(a.pointHoverBorderColor,n,e.getHoverColor(o.borderColor)),o.borderWidth=i.hoverBorderWidth?i.hoverBorderWidth:e.getValueAtIndexOrDefault(a.pointHoverBorderWidth,n,o.borderWidth)},removeHoverStyle:function(t){var a=this.chart.data.datasets[t._datasetIndex],i=t.custom||{},n=t._index,o=t._model,r=this.chart.options.elements.point;o.radius=i.radius?i.radius:e.getValueAtIndexOrDefault(a.radius,n,r.radius),o.backgroundColor=i.backgroundColor?i.backgroundColor:e.getValueAtIndexOrDefault(a.pointBackgroundColor,n,r.backgroundColor),o.borderColor=i.borderColor?i.borderColor:e.getValueAtIndexOrDefault(a.pointBorderColor,n,r.borderColor),o.borderWidth=i.borderWidth?i.borderWidth:e.getValueAtIndexOrDefault(a.pointBorderWidth,n,r.borderWidth)}})}},{}],21:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.defaults.global.animation={duration:1e3,easing:"easeOutQuart",onProgress:e.noop,onComplete:e.noop},t.Animation=t.Element.extend({currentStep:null,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null}),t.animationService={frameDuration:17,animations:[],dropFrames:0,request:null,addAnimation:function(t,e,a,i){var n=this;i||(t.animating=!0);for(var o=0;o<n.animations.length;++o)if(n.animations[o].chartInstance===t)return void(n.animations[o].animationObject=e);n.animations.push({chartInstance:t,animationObject:e}),1===n.animations.length&&n.requestAnimationFrame()},cancelAnimation:function(t){var a=e.findIndex(this.animations,function(e){return e.chartInstance===t});-1!==a&&(this.animations.splice(a,1),t.animating=!1)},requestAnimationFrame:function(){var t=this;null===t.request&&(t.request=e.requestAnimFrame.call(window,function(){t.request=null,t.startDigest()}))},startDigest:function(){var t=this,e=Date.now(),a=0;t.dropFrames>1&&(a=Math.floor(t.dropFrames),t.dropFrames=t.dropFrames%1);for(var i=0;i<t.animations.length;)null===t.animations[i].animationObject.currentStep&&(t.animations[i].animationObject.currentStep=0),t.animations[i].animationObject.currentStep+=1+a,t.animations[i].animationObject.currentStep>t.animations[i].animationObject.numSteps&&(t.animations[i].animationObject.currentStep=t.animations[i].animationObject.numSteps),t.animations[i].animationObject.render(t.animations[i].chartInstance,t.animations[i].animationObject),t.animations[i].animationObject.onAnimationProgress&&t.animations[i].animationObject.onAnimationProgress.call&&t.animations[i].animationObject.onAnimationProgress.call(t.animations[i].chartInstance,t.animations[i]),t.animations[i].animationObject.currentStep===t.animations[i].animationObject.numSteps?(t.animations[i].animationObject.onAnimationComplete&&t.animations[i].animationObject.onAnimationComplete.call&&t.animations[i].animationObject.onAnimationComplete.call(t.animations[i].chartInstance,t.animations[i]),t.animations[i].chartInstance.animating=!1,t.animations.splice(i,1)):++i;var n=Date.now(),o=(n-e)/t.frameDuration;t.dropFrames+=o,t.animations.length>0&&t.requestAnimationFrame()}}}},{}],22:[function(t,e,a){"use strict";e.exports=function(t){(t.canvasHelpers={}).drawPoint=function(t,e,a,i,n){var o,r,l,s,d,u;if("object"==typeof e&&("[object HTMLImageElement]"===(o=e.toString())||"[object HTMLCanvasElement]"===o))return void t.drawImage(e,i-e.width/2,n-e.height/2);if(!(isNaN(a)||0>=a)){switch(e){default:t.beginPath(),t.arc(i,n,a,0,2*Math.PI),t.closePath(),t.fill();break;case"triangle":t.beginPath(),r=3*a/Math.sqrt(3),d=r*Math.sqrt(3)/2,t.moveTo(i-r/2,n+d/3),t.lineTo(i+r/2,n+d/3),t.lineTo(i,n-2*d/3),t.closePath(),t.fill();break;case"rect":u=1/Math.SQRT2*a,t.beginPath(),t.fillRect(i-u,n-u,2*u,2*u),t.strokeRect(i-u,n-u,2*u,2*u);break;case"rectRot":u=1/Math.SQRT2*a,t.beginPath(),t.moveTo(i-u,n),t.lineTo(i,n+u),t.lineTo(i+u,n),t.lineTo(i,n-u),t.closePath(),t.fill();break;case"cross":t.beginPath(),t.moveTo(i,n+a),t.lineTo(i,n-a),t.moveTo(i-a,n),t.lineTo(i+a,n),t.closePath();break;case"crossRot":t.beginPath(),l=Math.cos(Math.PI/4)*a,s=Math.sin(Math.PI/4)*a,t.moveTo(i-l,n-s),t.lineTo(i+l,n+s),t.moveTo(i-l,n+s),t.lineTo(i+l,n-s),t.closePath();break;case"star":t.beginPath(),t.moveTo(i,n+a),t.lineTo(i,n-a),t.moveTo(i-a,n),t.lineTo(i+a,n),l=Math.cos(Math.PI/4)*a,s=Math.sin(Math.PI/4)*a,t.moveTo(i-l,n-s),t.lineTo(i+l,n+s),t.moveTo(i-l,n+s),t.lineTo(i+l,n-s),t.closePath();break;case"line":t.beginPath(),t.moveTo(i-a,n),t.lineTo(i+a,n),t.closePath();break;case"dash":t.beginPath(),t.moveTo(i,n),t.lineTo(i+a,n),t.closePath()}t.stroke()}}}},{}],23:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.types={},t.instances={},t.controllers={},t.Controller=function(a){return this.chart=a,this.config=a.config,this.options=this.config.options=e.configMerge(t.defaults.global,t.defaults[this.config.type],this.config.options||{}),this.id=e.uid(),Object.defineProperty(this,"data",{get:function(){return this.config.data}}),t.instances[this.id]=this,this.options.responsive&&this.resize(!0),this.initialize(),this},e.extend(t.Controller.prototype,{initialize:function(){var e=this;return t.plugins.notify("beforeInit",[e]),e.bindEvents(),e.ensureScalesHaveIDs(),e.buildOrUpdateControllers(),e.buildScales(),e.updateLayout(),e.resetElements(),e.initToolTip(),e.update(),t.plugins.notify("afterInit",[e]),e},clear:function(){return e.clear(this.chart),this},stop:function(){return t.animationService.cancelAnimation(this),this},resize:function(a){var i=this,n=i.chart,o=n.canvas,r=e.getMaximumWidth(o),l=n.aspectRatio,s=i.options.maintainAspectRatio&&!1===isNaN(l)&&isFinite(l)&&0!==l?r/l:e.getMaximumHeight(o);if(n.width===r&&n.height===s)return i;o.width=n.width=r,o.height=n.height=s,e.retinaScale(n);var u={width:r,height:s};return t.plugins.notify("resize",[i,u]),i.options.onResize&&i.options.onResize(i,u),a||(i.stop(),i.update(i.options.responsiveAnimationDuration)),i},ensureScalesHaveIDs:function(){var t=this.options,a=t.scales||{},i=t.scale;e.each(a.xAxes,function(t,e){t.id=t.id||"x-axis-"+e}),e.each(a.yAxes,function(t,e){t.id=t.id||"y-axis-"+e}),i&&(i.id=i.id||"scale")},buildScales:function(){var a=this,i=a.options,n=a.scales={},o=[];i.scales&&(o=o.concat((i.scales.xAxes||[]).map(function(t){return{options:t,dtype:"category"}}),(i.scales.yAxes||[]).map(function(t){return{options:t,dtype:"linear"}}))),i.scale&&o.push({options:i.scale,dtype:"radialLinear",isDefault:!0}),e.each(o,function(i){var o=i.options,r=e.getValueOrDefault(o.type,i.dtype),l=t.scaleService.getScaleConstructor(r);if(l){var s=new l({id:o.id,options:o,ctx:a.chart.ctx,chart:a});n[s.id]=s,i.isDefault&&(a.scale=s)}}),t.scaleService.addScalesToLayout(this)},updateLayout:function(){t.layoutService.update(this,this.chart.width,this.chart.height)},buildOrUpdateControllers:function(){var a=this,i=[],n=[];if(e.each(a.data.datasets,function(e,o){var r=a.getDatasetMeta(o);r.type||(r.type=e.type||a.config.type),i.push(r.type),r.controller?r.controller.updateIndex(o):(r.controller=new t.controllers[r.type](a,o),n.push(r.controller))},a),i.length>1)for(var o=1;o<i.length;o++)if(i[o]!==i[o-1]){a.isCombo=!0;break}return n},resetElements:function(){var t=this;e.each(t.data.datasets,function(e,a){t.getDatasetMeta(a).controller.reset()},t)},update:function(a,i){var n=this;t.plugins.notify("beforeUpdate",[n]),n.tooltip._data=n.data;var o=n.buildOrUpdateControllers();e.each(n.data.datasets,function(t,e){n.getDatasetMeta(e).controller.buildOrUpdateElements()},n),t.layoutService.update(n,n.chart.width,n.chart.height),t.plugins.notify("afterScaleUpdate",[n]),e.each(o,function(t){t.reset()}),n.updateDatasets(),t.plugins.notify("afterUpdate",[n]),n.render(a,i)},updateDatasets:function(){var e,a,i=this;if(t.plugins.notify("beforeDatasetsUpdate",[i])){for(e=0,a=i.data.datasets.length;a>e;++e)i.getDatasetMeta(e).controller.update();t.plugins.notify("afterDatasetsUpdate",[i])}},render:function(a,i){var n=this;t.plugins.notify("beforeRender",[n]);var o=n.options.animation;if(o&&(void 0!==a&&0!==a||void 0===a&&0!==o.duration)){var r=new t.Animation;r.numSteps=(a||o.duration)/16.66,r.easing=o.easing,r.render=function(t,a){var i=e.easingEffects[a.easing],n=a.currentStep/a.numSteps,o=i(n);t.draw(o,n,a.currentStep)},r.onAnimationProgress=o.onProgress,r.onAnimationComplete=o.onComplete,t.animationService.addAnimation(n,r,a,i)}else n.draw(),
o&&o.onComplete&&o.onComplete.call&&o.onComplete.call(n);return n},draw:function(a){var i=this,n=a||1;i.clear(),t.plugins.notify("beforeDraw",[i,n]),e.each(i.boxes,function(t){t.draw(i.chartArea)},i),i.scale&&i.scale.draw(),t.plugins.notify("beforeDatasetsDraw",[i,n]),e.each(i.data.datasets,function(t,e){i.isDatasetVisible(e)&&i.getDatasetMeta(e).controller.draw(a)},i,!0),t.plugins.notify("afterDatasetsDraw",[i,n]),i.tooltip.transition(n).draw(),t.plugins.notify("afterDraw",[i,n])},getElementAtEvent:function(t){var a=this,i=e.getRelativePosition(t,a.chart),n=[];return e.each(a.data.datasets,function(t,o){if(a.isDatasetVisible(o)){var r=a.getDatasetMeta(o);e.each(r.data,function(t){return t.inRange(i.x,i.y)?(n.push(t),n):void 0})}}),n.slice(0,1)},getElementsAtEvent:function(t){var a=this,i=e.getRelativePosition(t,a.chart),n=[],o=function(){if(a.data.datasets)for(var t=0;t<a.data.datasets.length;t++){var e=a.getDatasetMeta(t);if(a.isDatasetVisible(t))for(var n=0;n<e.data.length;n++)if(e.data[n].inRange(i.x,i.y))return e.data[n]}}.call(a);return o?(e.each(a.data.datasets,function(t,e){if(a.isDatasetVisible(e)){var i=a.getDatasetMeta(e),r=i.data[o._index];r&&!r._view.skip&&n.push(r)}},a),n):n},getElementsAtXAxis:function(t){var a=this,i=e.getRelativePosition(t,a.chart),n=[],o=function(){if(a.data.datasets)for(var t=0;t<a.data.datasets.length;t++){var e=a.getDatasetMeta(t);if(a.isDatasetVisible(t))for(var n=0;n<e.data.length;n++)if(e.data[n].inLabelRange(i.x,i.y))return e.data[n]}}.call(a);return o?(e.each(a.data.datasets,function(t,i){if(a.isDatasetVisible(i)){var r=a.getDatasetMeta(i),l=e.findIndex(r.data,function(t){return o._model.x===t._model.x});-1===l||r.data[l]._view.skip||n.push(r.data[l])}},a),n):n},getElementsAtEventForMode:function(t,e){var a=this;switch(e){case"single":return a.getElementAtEvent(t);case"label":return a.getElementsAtEvent(t);case"dataset":return a.getDatasetAtEvent(t);case"x-axis":return a.getElementsAtXAxis(t);default:return t}},getDatasetAtEvent:function(t){var e=this.getElementAtEvent(t);return e.length>0&&(e=this.getDatasetMeta(e[0]._datasetIndex).data),e},getDatasetMeta:function(t){var e=this,a=e.data.datasets[t];a._meta||(a._meta={});var i=a._meta[e.id];return i||(i=a._meta[e.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null}),i},getVisibleDatasetCount:function(){for(var t=0,e=0,a=this.data.datasets.length;a>e;++e)this.isDatasetVisible(e)&&t++;return t},isDatasetVisible:function(t){var e=this.getDatasetMeta(t);return"boolean"==typeof e.hidden?!e.hidden:!this.data.datasets[t].hidden},generateLegend:function(){return this.options.legendCallback(this)},destroy:function(){var a=this;a.stop(),a.clear(),e.unbindEvents(a,a.events),e.removeResizeListener(a.chart.canvas.parentNode);var i=a.chart.canvas;i.width=a.chart.width,i.height=a.chart.height,void 0!==a.chart.originalDevicePixelRatio&&a.chart.ctx.scale(1/a.chart.originalDevicePixelRatio,1/a.chart.originalDevicePixelRatio),i.style.width=a.chart.originalCanvasStyleWidth,i.style.height=a.chart.originalCanvasStyleHeight,t.plugins.notify("destroy",[a]),delete t.instances[a.id]},toBase64Image:function(){return this.chart.canvas.toDataURL.apply(this.chart.canvas,arguments)},initToolTip:function(){var e=this;e.tooltip=new t.Tooltip({_chart:e.chart,_chartInstance:e,_data:e.data,_options:e.options.tooltips},e)},bindEvents:function(){var t=this;e.bindEvents(t,t.options.events,function(e){t.eventHandler(e)})},updateHoverStyle:function(t,e,a){var i,n,o,r=a?"setHoverStyle":"removeHoverStyle";switch(e){case"single":t=[t[0]];break;case"label":case"dataset":case"x-axis":break;default:return}for(n=0,o=t.length;o>n;++n)(i=t[n])&&this.getDatasetMeta(i._datasetIndex).controller[r](i)},eventHandler:function(t){var a=this,i=a.tooltip,n=a.options||{},o=n.hover,r=n.tooltips;return a.lastActive=a.lastActive||[],a.lastTooltipActive=a.lastTooltipActive||[],"mouseout"===t.type?(a.active=[],a.tooltipActive=[]):(a.active=a.getElementsAtEventForMode(t,o.mode),a.tooltipActive=a.getElementsAtEventForMode(t,r.mode)),o.onHover&&o.onHover.call(a,a.active),a.legend&&a.legend.handleEvent&&a.legend.handleEvent(t),("mouseup"===t.type||"click"===t.type)&&n.onClick&&n.onClick.call(a,t,a.active),a.lastActive.length&&a.updateHoverStyle(a.lastActive,o.mode,!1),a.active.length&&o.mode&&a.updateHoverStyle(a.active,o.mode,!0),(r.enabled||r.custom)&&(i.initialize(),i._active=a.tooltipActive,i.update(!0)),i.pivot(),a.animating||e.arrayEquals(a.active,a.lastActive)&&e.arrayEquals(a.tooltipActive,a.lastTooltipActive)||(a.stop(),(r.enabled||r.custom)&&i.update(!0),a.render(o.animationDuration,!0)),a.lastActive=a.active,a.lastTooltipActive=a.tooltipActive,a}})}},{}],24:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a=e.noop;t.DatasetController=function(t,e){this.initialize(t,e)},e.extend(t.DatasetController.prototype,{datasetElementType:null,dataElementType:null,initialize:function(t,e){var a=this;a.chart=t,a.index=e,a.linkScales(),a.addElements()},updateIndex:function(t){this.index=t},linkScales:function(){var t=this,e=t.getMeta(),a=t.getDataset();null===e.xAxisID&&(e.xAxisID=a.xAxisID||t.chart.options.scales.xAxes[0].id),null===e.yAxisID&&(e.yAxisID=a.yAxisID||t.chart.options.scales.yAxes[0].id)},getDataset:function(){return this.chart.data.datasets[this.index]},getMeta:function(){return this.chart.getDatasetMeta(this.index)},getScaleForId:function(t){return this.chart.scales[t]},reset:function(){this.update(!0)},createMetaDataset:function(){var t=this,e=t.datasetElementType;return e&&new e({_chart:t.chart.chart,_datasetIndex:t.index})},createMetaData:function(t){var e=this,a=e.dataElementType;return a&&new a({_chart:e.chart.chart,_datasetIndex:e.index,_index:t})},addElements:function(){var t,e,a=this,i=a.getMeta(),n=a.getDataset().data||[],o=i.data;for(t=0,e=n.length;e>t;++t)o[t]=o[t]||a.createMetaData(i,t);i.dataset=i.dataset||a.createMetaDataset()},addElementAndReset:function(t){var e=this,a=e.createMetaData(t);e.getMeta().data.splice(t,0,a),e.updateElement(a,t,!0)},buildOrUpdateElements:function(){var t=this.getMeta(),e=t.data,a=this.getDataset().data.length,i=e.length;if(i>a)e.splice(a,i-a);else if(a>i)for(var n=i;a>n;++n)this.addElementAndReset(n)},update:a,draw:function(t){var a=t||1;e.each(this.getMeta().data,function(t){t.transition(a).draw()})},removeHoverStyle:function(t,a){var i=this.chart.data.datasets[t._datasetIndex],n=t._index,o=t.custom||{},r=e.getValueAtIndexOrDefault,l=t._model;l.backgroundColor=o.backgroundColor?o.backgroundColor:r(i.backgroundColor,n,a.backgroundColor),l.borderColor=o.borderColor?o.borderColor:r(i.borderColor,n,a.borderColor),l.borderWidth=o.borderWidth?o.borderWidth:r(i.borderWidth,n,a.borderWidth)},setHoverStyle:function(t){var a=this.chart.data.datasets[t._datasetIndex],i=t._index,n=t.custom||{},o=e.getValueAtIndexOrDefault,r=e.getHoverColor,l=t._model;l.backgroundColor=n.hoverBackgroundColor?n.hoverBackgroundColor:o(a.hoverBackgroundColor,i,r(l.backgroundColor)),l.borderColor=n.hoverBorderColor?n.hoverBorderColor:o(a.hoverBorderColor,i,r(l.borderColor)),l.borderWidth=n.hoverBorderWidth?n.hoverBorderWidth:o(a.hoverBorderWidth,i,l.borderWidth)}}),t.DatasetController.extend=e.inherits}},{}],25:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.elements={},t.Element=function(t){e.extend(this,t),this.initialize.apply(this,arguments)},e.extend(t.Element.prototype,{initialize:function(){this.hidden=!1},pivot:function(){var t=this;return t._view||(t._view=e.clone(t._model)),t._start=e.clone(t._view),t},transition:function(t){var a=this;return a._view||(a._view=e.clone(a._model)),1===t?(a._view=a._model,a._start=null,a):(a._start||a.pivot(),e.each(a._model,function(i,n){if("_"===n[0]);else if(a._view.hasOwnProperty(n))if(i===a._view[n]);else if("string"==typeof i)try{var o=e.color(a._model[n]).mix(e.color(a._start[n]),t);a._view[n]=o.rgbString()}catch(r){a._view[n]=i}else if("number"==typeof i){var l=void 0!==a._start[n]&&!1===isNaN(a._start[n])?a._start[n]:0;a._view[n]=(a._model[n]-l)*t+l}else a._view[n]=i;else"number"!=typeof i||isNaN(a._view[n])?a._view[n]=i:a._view[n]=i*t},a),a)},tooltipPosition:function(){return{x:this._model.x,y:this._model.y}},hasValue:function(){return e.isNumber(this._model.x)&&e.isNumber(this._model.y)}}),t.Element.extend=e.inherits}},{}],26:[function(t,e,a){"use strict";var i=t(3);e.exports=function(t){function e(t,e,a){var i;return"string"==typeof t?(i=parseInt(t,10),-1!==t.indexOf("%")&&(i=i/100*e.parentNode[a])):i=t,i}function a(t){return void 0!==t&&null!==t&&"none"!==t}function n(t,i,n){var o=document.defaultView,r=t.parentNode,l=o.getComputedStyle(t)[i],s=o.getComputedStyle(r)[i],d=a(l),u=a(s),c=Number.POSITIVE_INFINITY;return d||u?Math.min(d?e(l,t,n):c,u?e(s,r,n):c):"none"}var o=t.helpers={};o.each=function(t,e,a,i){var n,r;if(o.isArray(t))if(r=t.length,i)for(n=r-1;n>=0;n--)e.call(a,t[n],n);else for(n=0;r>n;n++)e.call(a,t[n],n);else if("object"==typeof t){var l=Object.keys(t);for(r=l.length,n=0;r>n;n++)e.call(a,t[l[n]],l[n])}},o.clone=function(t){var e={};return o.each(t,function(t,a){o.isArray(t)?e[a]=t.slice(0):e[a]="object"==typeof t&&null!==t?o.clone(t):t}),e},o.extend=function(t){for(var e=function(e,a){t[a]=e},a=1,i=arguments.length;i>a;a++)o.each(arguments[a],e);return t},o.configMerge=function(e){var a=o.clone(e);return o.each(Array.prototype.slice.call(arguments,1),function(e){o.each(e,function(e,i){if("scales"===i)a[i]=o.scaleMerge(a.hasOwnProperty(i)?a[i]:{},e);else if("scale"===i)a[i]=o.configMerge(a.hasOwnProperty(i)?a[i]:{},t.scaleService.getScaleDefaults(e.type),e);else if(a.hasOwnProperty(i)&&o.isArray(a[i])&&o.isArray(e)){var n=a[i];o.each(e,function(t,e){e<n.length?"object"==typeof n[e]&&null!==n[e]&&"object"==typeof t&&null!==t?n[e]=o.configMerge(n[e],t):n[e]=t:n.push(t)})}else a.hasOwnProperty(i)&&"object"==typeof a[i]&&null!==a[i]&&"object"==typeof e?a[i]=o.configMerge(a[i],e):a[i]=e})}),a},o.scaleMerge=function(e,a){var i=o.clone(e);return o.each(a,function(e,a){"xAxes"===a||"yAxes"===a?i.hasOwnProperty(a)?o.each(e,function(e,n){var r=o.getValueOrDefault(e.type,"xAxes"===a?"category":"linear"),l=t.scaleService.getScaleDefaults(r);n>=i[a].length||!i[a][n].type?i[a].push(o.configMerge(l,e)):e.type&&e.type!==i[a][n].type?i[a][n]=o.configMerge(i[a][n],l,e):i[a][n]=o.configMerge(i[a][n],e)}):(i[a]=[],o.each(e,function(e){var n=o.getValueOrDefault(e.type,"xAxes"===a?"category":"linear");i[a].push(o.configMerge(t.scaleService.getScaleDefaults(n),e))})):i.hasOwnProperty(a)&&"object"==typeof i[a]&&null!==i[a]&&"object"==typeof e?i[a]=o.configMerge(i[a],e):i[a]=e}),i},o.getValueAtIndexOrDefault=function(t,e,a){return void 0===t||null===t?a:o.isArray(t)?e<t.length?t[e]:a:t},o.getValueOrDefault=function(t,e){return void 0===t?e:t},o.indexOf=Array.prototype.indexOf?function(t,e){return t.indexOf(e)}:function(t,e){for(var a=0,i=t.length;i>a;++a)if(t[a]===e)return a;return-1},o.where=function(t,e){if(o.isArray(t)&&Array.prototype.filter)return t.filter(e);var a=[];return o.each(t,function(t){e(t)&&a.push(t)}),a},o.findIndex=Array.prototype.findIndex?function(t,e,a){return t.findIndex(e,a)}:function(t,e,a){a=void 0===a?t:a;for(var i=0,n=t.length;n>i;++i)if(e.call(a,t[i],i,t))return i;return-1},o.findNextWhere=function(t,e,a){(void 0===a||null===a)&&(a=-1);for(var i=a+1;i<t.length;i++){var n=t[i];if(e(n))return n}},o.findPreviousWhere=function(t,e,a){(void 0===a||null===a)&&(a=t.length);for(var i=a-1;i>=0;i--){var n=t[i];if(e(n))return n}},o.inherits=function(t){var e=this,a=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return e.apply(this,arguments)},i=function(){this.constructor=a};return i.prototype=e.prototype,a.prototype=new i,a.extend=o.inherits,t&&o.extend(a.prototype,t),a.__super__=e.prototype,a},o.noop=function(){},o.uid=function(){var t=0;return function(){return t++}}(),o.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},o.almostEquals=function(t,e,a){return Math.abs(t-e)<a},o.max=function(t){return t.reduce(function(t,e){return isNaN(e)?t:Math.max(t,e)},Number.NEGATIVE_INFINITY)},o.min=function(t){return t.reduce(function(t,e){return isNaN(e)?t:Math.min(t,e)},Number.POSITIVE_INFINITY)},o.sign=Math.sign?function(t){return Math.sign(t)}:function(t){return t=+t,0===t||isNaN(t)?t:t>0?1:-1},o.log10=Math.log10?function(t){return Math.log10(t)}:function(t){return Math.log(t)/Math.LN10},o.toRadians=function(t){return t*(Math.PI/180)},o.toDegrees=function(t){return t*(180/Math.PI)},o.getAngleFromPoint=function(t,e){var a=e.x-t.x,i=e.y-t.y,n=Math.sqrt(a*a+i*i),o=Math.atan2(i,a);return o<-.5*Math.PI&&(o+=2*Math.PI),{angle:o,distance:n}},o.aliasPixel=function(t){return t%2==0?0:.5},o.splineCurve=function(t,e,a,i){var n=t.skip?e:t,o=e,r=a.skip?e:a,l=Math.sqrt(Math.pow(o.x-n.x,2)+Math.pow(o.y-n.y,2)),s=Math.sqrt(Math.pow(r.x-o.x,2)+Math.pow(r.y-o.y,2)),d=l/(l+s),u=s/(l+s);d=isNaN(d)?0:d,u=isNaN(u)?0:u;var c=i*d,h=i*u;return{previous:{x:o.x-c*(r.x-n.x),y:o.y-c*(r.y-n.y)},next:{x:o.x+h*(r.x-n.x),y:o.y+h*(r.y-n.y)}}},o.EPSILON=Number.EPSILON||1e-14,o.splineCurveMonotone=function(t){var e,a,i,n,r=(t||[]).map(function(t){return{model:t._model,deltaK:0,mK:0}}),l=r.length;for(e=0;l>e;++e)i=r[e],i.model.skip||(a=e>0?r[e-1]:null,n=l-1>e?r[e+1]:null,n&&!n.model.skip&&(i.deltaK=(n.model.y-i.model.y)/(n.model.x-i.model.x)),!a||a.model.skip?i.mK=i.deltaK:!n||n.model.skip?i.mK=a.deltaK:this.sign(a.deltaK)!==this.sign(i.deltaK)?i.mK=0:i.mK=(a.deltaK+i.deltaK)/2);var s,d,u,c;for(e=0;l-1>e;++e)i=r[e],n=r[e+1],i.model.skip||n.model.skip||(o.almostEquals(i.deltaK,0,this.EPSILON)?i.mK=n.mK=0:(s=i.mK/i.deltaK,d=n.mK/i.deltaK,9>=(c=Math.pow(s,2)+Math.pow(d,2))||(u=3/Math.sqrt(c),i.mK=s*u*i.deltaK,n.mK=d*u*i.deltaK)));var h;for(e=0;l>e;++e)i=r[e],i.model.skip||(a=e>0?r[e-1]:null,n=l-1>e?r[e+1]:null,a&&!a.model.skip&&(h=(i.model.x-a.model.x)/3,i.model.controlPointPreviousX=i.model.x-h,i.model.controlPointPreviousY=i.model.y-h*i.mK),n&&!n.model.skip&&(h=(n.model.x-i.model.x)/3,i.model.controlPointNextX=i.model.x+h,i.model.controlPointNextY=i.model.y+h*i.mK))},o.nextItem=function(t,e,a){return a?e>=t.length-1?t[0]:t[e+1]:e>=t.length-1?t[t.length-1]:t[e+1]},o.previousItem=function(t,e,a){return a?0>=e?t[t.length-1]:t[e-1]:0>=e?t[0]:t[e-1]},o.niceNum=function(t,e){var i=Math.floor(o.log10(t)),n=t/Math.pow(10,i);return(e?1.5>n?1:3>n?2:7>n?5:10:1>=n?1:2>=n?2:5>=n?5:10)*Math.pow(10,i)};var r=o.easingEffects={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-1*t*(t-2)},easeInOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return 1*((t=t/1-1)*t*t+1)},easeInOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-1*((t=t/1-1)*t*t*t-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},easeInQuint:function(t){return 1*(t/=1)*t*t*t*t},easeOutQuint:function(t){return 1*((t=t/1-1)*t*t*t*t+1)},easeInOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return-1*Math.cos(t/1*(Math.PI/2))+1},easeOutSine:function(t){return 1*Math.sin(t/1*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t/1)-1)},easeInExpo:function(t){return 0===t?1:1*Math.pow(2,10*(t/1-1))},easeOutExpo:function(t){return 1===t?1:1*(1-Math.pow(2,-10*t/1))},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInCirc:function(t){return t>=1?t:-1*(Math.sqrt(1-(t/=1)*t)-1)},easeOutCirc:function(t){return 1*Math.sqrt(1-(t=t/1-1)*t)},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var e=1.70158,a=0,i=1;return 0===t?0:1==(t/=1)?1:(a||(a=.3),i<Math.abs(1)?(i=1,e=a/4):e=a/(2*Math.PI)*Math.asin(1/i),-i*Math.pow(2,10*(t-=1))*Math.sin((1*t-e)*(2*Math.PI)/a))},easeOutElastic:function(t){var e=1.70158,a=0,i=1;return 0===t?0:1==(t/=1)?1:(a||(a=.3),i<Math.abs(1)?(i=1,e=a/4):e=a/(2*Math.PI)*Math.asin(1/i),i*Math.pow(2,-10*t)*Math.sin((1*t-e)*(2*Math.PI)/a)+1)},easeInOutElastic:function(t){var e=1.70158,a=0,i=1;return 0===t?0:2==(t/=.5)?1:(a||(a=.3*1.5*1),i<Math.abs(1)?(i=1,e=a/4):e=a/(2*Math.PI)*Math.asin(1/i),1>t?i*Math.pow(2,10*(t-=1))*Math.sin((1*t-e)*(2*Math.PI)/a)*-.5:i*Math.pow(2,-10*(t-=1))*Math.sin((1*t-e)*(2*Math.PI)/a)*.5+1)},easeInBack:function(t){var e=1.70158;return 1*(t/=1)*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return 1*((t=t/1-1)*t*((e+1)*t+e)+1)},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},easeInBounce:function(t){return 1-r.easeOutBounce(1-t)},easeOutBounce:function(t){return(t/=1)<1/2.75?7.5625*t*t*1:2/2.75>t?1*(7.5625*(t-=1.5/2.75)*t+.75):2.5/2.75>t?1*(7.5625*(t-=2.25/2.75)*t+.9375):1*(7.5625*(t-=2.625/2.75)*t+.984375)},easeInOutBounce:function(t){return.5>t?.5*r.easeInBounce(2*t):.5*r.easeOutBounce(2*t-1)+.5}};o.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}}(),o.cancelAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return window.clearTimeout(t,1e3/60)}}(),o.getRelativePosition=function(t,e){var a,i,n=t.originalEvent||t,r=t.currentTarget||t.srcElement,l=r.getBoundingClientRect(),s=n.touches;s&&s.length>0?(a=s[0].clientX,i=s[0].clientY):(a=n.clientX,i=n.clientY);var d=parseFloat(o.getStyle(r,"padding-left")),u=parseFloat(o.getStyle(r,"padding-top")),c=parseFloat(o.getStyle(r,"padding-right")),h=parseFloat(o.getStyle(r,"padding-bottom")),f=l.right-l.left-d-c,g=l.bottom-l.top-u-h;return a=Math.round((a-l.left-d)/f*r.width/e.currentDevicePixelRatio),i=Math.round((i-l.top-u)/g*r.height/e.currentDevicePixelRatio),{x:a,y:i}},o.addEvent=function(t,e,a){t.addEventListener?t.addEventListener(e,a):t.attachEvent?t.attachEvent("on"+e,a):t["on"+e]=a},o.removeEvent=function(t,e,a){t.removeEventListener?t.removeEventListener(e,a,!1):t.detachEvent?t.detachEvent("on"+e,a):t["on"+e]=o.noop},o.bindEvents=function(t,e,a){var i=t.events=t.events||{};o.each(e,function(e){i[e]=function(){a.apply(t,arguments)},o.addEvent(t.chart.canvas,e,i[e])})},o.unbindEvents=function(t,e){var a=t.chart.canvas;o.each(e,function(t,e){o.removeEvent(a,e,t)})},o.getConstraintWidth=function(t){return n(t,"max-width","clientWidth")},o.getConstraintHeight=function(t){return n(t,"max-height","clientHeight")},o.getMaximumWidth=function(t){var e=t.parentNode,a=parseInt(o.getStyle(e,"padding-left"),10),i=parseInt(o.getStyle(e,"padding-right"),10),n=e.clientWidth-a-i,r=o.getConstraintWidth(t);return isNaN(r)?n:Math.min(n,r)},o.getMaximumHeight=function(t){var e=t.parentNode,a=parseInt(o.getStyle(e,"padding-top"),10),i=parseInt(o.getStyle(e,"padding-bottom"),10),n=e.clientHeight-a-i,r=o.getConstraintHeight(t);return isNaN(r)?n:Math.min(n,r)},o.getStyle=function(t,e){return t.currentStyle?t.currentStyle[e]:document.defaultView.getComputedStyle(t,null).getPropertyValue(e)},o.retinaScale=function(t){var e=t.ctx,a=t.canvas,i=a.width,n=a.height,o=t.currentDevicePixelRatio=window.devicePixelRatio||1;1!==o&&(a.height=n*o,a.width=i*o,e.scale(o,o),t.originalDevicePixelRatio=t.originalDevicePixelRatio||o),a.style.width=i+"px",a.style.height=n+"px"},o.clear=function(t){t.ctx.clearRect(0,0,t.width,t.height)},o.fontString=function(t,e,a){return e+" "+t+"px "+a},o.longestText=function(t,e,a,i){i=i||{};var n=i.data=i.data||{},r=i.garbageCollect=i.garbageCollect||[];i.font!==e&&(n=i.data={},r=i.garbageCollect=[],i.font=e),t.font=e;var l=0;o.each(a,function(e){void 0!==e&&null!==e&&!0!==o.isArray(e)?l=o.measureText(t,n,r,l,e):o.isArray(e)&&o.each(e,function(e){void 0===e||null===e||o.isArray(e)||(l=o.measureText(t,n,r,l,e))})});var s=r.length/2;if(s>a.length){for(var d=0;s>d;d++)delete n[r[d]];r.splice(0,s)}return l},o.measureText=function(t,e,a,i,n){var o=e[n];return o||(o=e[n]=t.measureText(n).width,a.push(n)),o>i&&(i=o),i},o.numberOfLabelLines=function(t){var e=1;return o.each(t,function(t){o.isArray(t)&&t.length>e&&(e=t.length)}),e},o.drawRoundedRectangle=function(t,e,a,i,n,o){t.beginPath(),t.moveTo(e+o,a),t.lineTo(e+i-o,a),t.quadraticCurveTo(e+i,a,e+i,a+o),t.lineTo(e+i,a+n-o),t.quadraticCurveTo(e+i,a+n,e+i-o,a+n),t.lineTo(e+o,a+n),t.quadraticCurveTo(e,a+n,e,a+n-o),t.lineTo(e,a+o),t.quadraticCurveTo(e,a,e+o,a),t.closePath()},o.color=function(e){return i?i(e instanceof CanvasGradient?t.defaults.global.defaultColor:e):(console.error("Color.js not found!"),e)},o.addResizeListener=function(t,e){var a=document.createElement("iframe"),i="chartjs-hidden-iframe";a.classlist?a.classlist.add(i):a.setAttribute("class",i),a.tabIndex=-1;var n=a.style;n.width="100%",n.display="block",n.border=0,n.height=0,n.margin=0,n.position="absolute",n.left=0,n.right=0,n.top=0,n.bottom=0,t.insertBefore(a,t.firstChild),(a.contentWindow||a).onresize=function(){return e?e():void 0}},o.removeResizeListener=function(t){var e=t.querySelector(".chartjs-hidden-iframe");e&&e.parentNode.removeChild(e)},o.isArray=Array.isArray?function(t){return Array.isArray(t)}:function(t){return"[object Array]"===Object.prototype.toString.call(t)},o.arrayEquals=function(t,e){var a,i,n,r;if(!t||!e||t.length!==e.length)return!1;for(a=0,i=t.length;i>a;++a)if(n=t[a],r=e[a],n instanceof Array&&r instanceof Array){if(!o.arrayEquals(n,r))return!1}else if(n!==r)return!1;return!0},o.callCallback=function(t,e,a){t&&"function"==typeof t.call&&t.apply(a,e)},o.getHoverColor=function(t){return t instanceof CanvasPattern?t:o.color(t).saturate(.5).darken(.1).rgbString()}}},{3:3}],27:[function(t,e,a){"use strict";e.exports=function(){var t=function(e,a){var i=this,n=t.helpers;return i.config=a||{data:{datasets:[]}},e.length&&e[0].getContext&&(e=e[0]),e.getContext&&(e=e.getContext("2d")),i.ctx=e,i.canvas=e.canvas,e.canvas.style.display=e.canvas.style.display||"block",i.width=e.canvas.width||parseInt(n.getStyle(e.canvas,"width"),10)||n.getMaximumWidth(e.canvas),i.height=e.canvas.height||parseInt(n.getStyle(e.canvas,"height"),10)||n.getMaximumHeight(e.canvas),i.aspectRatio=i.width/i.height,(isNaN(i.aspectRatio)||!1===isFinite(i.aspectRatio))&&(i.aspectRatio=void 0!==a.aspectRatio?a.aspectRatio:2),i.originalCanvasStyleWidth=e.canvas.style.width,i.originalCanvasStyleHeight=e.canvas.style.height,n.retinaScale(i),i.controller=new t.Controller(i),n.addResizeListener(e.canvas.parentNode,function(){i.controller&&i.controller.config.options.responsive&&i.controller.resize()}),i.controller?i.controller:i};return t.defaults={global:{responsive:!0,responsiveAnimationDuration:0,maintainAspectRatio:!0,events:["mousemove","mouseout","click","touchstart","touchmove"],hover:{onHover:null,mode:"single",animationDuration:400},onClick:null,defaultColor:"rgba(0,0,0,0.1)",defaultFontColor:"#666",defaultFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",defaultFontSize:12,defaultFontStyle:"normal",showLines:!0,elements:{},legendCallback:function(t){var e=[];e.push('<ul class="'+t.id+'-legend">');for(var a=0;a<t.data.datasets.length;a++)e.push('<li><span style="background-color:'+t.data.datasets[a].backgroundColor+'"></span>'),t.data.datasets[a].label&&e.push(t.data.datasets[a].label),e.push("</li>");return e.push("</ul>"),e.join("")}}},t.Chart=t,t}},{}],28:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.layoutService={defaults:{},addBox:function(t,e){t.boxes||(t.boxes=[]),t.boxes.push(e)},removeBox:function(t,e){t.boxes&&t.boxes.splice(t.boxes.indexOf(e),1)},update:function(t,a,i){function n(t){var e,a=t.isHorizontal();a?(e=t.update(t.options.fullWidth?p:k,y),S-=e.height):(e=t.update(x,v),k-=e.width),w.push({horizontal:a,minSize:e,box:t})}function o(t){var a=e.findNextWhere(w,function(e){return e.box===t});if(a)if(t.isHorizontal()){var i={left:C,right:M,top:0,bottom:0};t.update(t.options.fullWidth?p:k,m/2,i)}else t.update(a.minSize.width,S)}function r(t){var a=e.findNextWhere(w,function(e){return e.box===t}),i={left:0,right:0,top:D,bottom:I};a&&t.update(a.minSize.width,S,i)}function l(t){t.isHorizontal()?(t.left=t.options.fullWidth?s:C,t.right=t.options.fullWidth?a-s:C+k,t.top=F,t.bottom=F+t.height,F=t.bottom):(t.left=P,t.right=P+t.width,t.top=D,t.bottom=D+S,P=t.right)}if(t){var s=0,d=0,u=e.where(t.boxes,function(t){return"left"===t.options.position}),c=e.where(t.boxes,function(t){return"right"===t.options.position}),h=e.where(t.boxes,function(t){return"top"===t.options.position}),f=e.where(t.boxes,function(t){return"bottom"===t.options.position}),g=e.where(t.boxes,function(t){return"chartArea"===t.options.position});h.sort(function(t,e){return(e.options.fullWidth?1:0)-(t.options.fullWidth?1:0)}),f.sort(function(t,e){return(t.options.fullWidth?1:0)-(e.options.fullWidth?1:0)});var p=a-2*s,m=i-2*d,b=p/2,v=m/2,x=(a-b)/(u.length+c.length),y=(i-v)/(h.length+f.length),k=p,S=m,w=[];e.each(u.concat(c,h,f),n);var C=s,M=s,D=d,I=d;e.each(u.concat(c),o),e.each(u,function(t){C+=t.width}),e.each(c,function(t){M+=t.width}),e.each(h.concat(f),o),e.each(h,function(t){D+=t.height}),e.each(f,function(t){I+=t.height}),e.each(u.concat(c),r),C=s,M=s,D=d,I=d,e.each(u,function(t){C+=t.width}),e.each(c,function(t){M+=t.width}),e.each(h,function(t){D+=t.height}),e.each(f,function(t){I+=t.height});var A=i-D-I,T=a-C-M;(T!==k||A!==S)&&(e.each(u,function(t){t.height=A}),e.each(c,function(t){t.height=A}),e.each(h,function(t){t.options.fullWidth||(t.width=T)}),e.each(f,function(t){t.options.fullWidth||(t.width=T)}),S=A,k=T);var P=s,F=d;e.each(u.concat(h),l),P+=k,F+=S,e.each(c,l),e.each(f,l),t.chartArea={left:C,top:D,right:C+k,bottom:D+S},e.each(g,function(e){e.left=t.chartArea.left,e.top=t.chartArea.top,e.right=t.chartArea.right,e.bottom=t.chartArea.bottom,e.update(k,S)})}}}}},{}],29:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a=e.noop;t.defaults.global.legend={display:!0,position:"top",fullWidth:!0,reverse:!1,onClick:function(t,e){var a=e.datasetIndex,i=this.chart,n=i.getDatasetMeta(a);n.hidden=null===n.hidden?!i.data.datasets[a].hidden:null,i.update()},onHover:null,labels:{boxWidth:40,padding:10,generateLabels:function(t){var a=t.data;return e.isArray(a.datasets)?a.datasets.map(function(a,i){return{text:a.label,fillStyle:e.isArray(a.backgroundColor)?a.backgroundColor[0]:a.backgroundColor,hidden:!t.isDatasetVisible(i),lineCap:a.borderCapStyle,lineDash:a.borderDash,lineDashOffset:a.borderDashOffset,lineJoin:a.borderJoinStyle,lineWidth:a.borderWidth,strokeStyle:a.borderColor,pointStyle:a.pointStyle,datasetIndex:i}},this):[]}}},t.Legend=t.Element.extend({initialize:function(t){e.extend(this,t),this.legendHitBoxes=[],this.doughnutMode=!1},beforeUpdate:a,update:function(t,e,a){var i=this;return i.beforeUpdate(),i.maxWidth=t,i.maxHeight=e,i.margins=a,i.beforeSetDimensions(),i.setDimensions(),i.afterSetDimensions(),i.beforeBuildLabels(),i.buildLabels(),i.afterBuildLabels(),i.beforeFit(),i.fit(),i.afterFit(),i.afterUpdate(),i.minSize},afterUpdate:a,beforeSetDimensions:a,setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0,t.minSize={width:0,height:0}},afterSetDimensions:a,beforeBuildLabels:a,buildLabels:function(){var t=this;t.legendItems=t.options.labels.generateLabels.call(t,t.chart),t.options.reverse&&t.legendItems.reverse()},afterBuildLabels:a,beforeFit:a,fit:function(){var a=this,i=a.options,n=i.labels,o=i.display,r=a.ctx,l=t.defaults.global,s=e.getValueOrDefault,d=s(n.fontSize,l.defaultFontSize),u=s(n.fontStyle,l.defaultFontStyle),c=s(n.fontFamily,l.defaultFontFamily),h=e.fontString(d,u,c),f=a.legendHitBoxes=[],g=a.minSize,p=a.isHorizontal();if(p?(g.width=a.maxWidth,g.height=o?10:0):(g.width=o?10:0,g.height=a.maxHeight),o)if(r.font=h,p){var m=a.lineWidths=[0],b=a.legendItems.length?d+n.padding:0;r.textAlign="left",r.textBaseline="top",e.each(a.legendItems,function(t,e){var i=n.usePointStyle?d*Math.sqrt(2):n.boxWidth,o=i+d/2+r.measureText(t.text).width;m[m.length-1]+o+n.padding>=a.width&&(b+=d+n.padding,m[m.length]=a.left),f[e]={left:0,top:0,width:o,height:d},m[m.length-1]+=o+n.padding}),g.height+=b}else{var v=n.padding,x=a.columnWidths=[],y=n.padding,k=0,S=0,w=d+v;e.each(a.legendItems,function(t,e){var a=n.usePointStyle?2*n.boxWidth:n.boxWidth,i=a+d/2+r.measureText(t.text).width;S+w>g.height&&(y+=k+n.padding,x.push(k),k=0,S=0),k=Math.max(k,i),S+=w,f[e]={left:0,top:0,width:i,height:d}}),y+=k,x.push(k),g.width+=y}a.width=g.width,a.height=g.height},afterFit:a,isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},draw:function(){var a=this,i=a.options,n=i.labels,o=t.defaults.global,r=o.elements.line,l=a.width,s=a.lineWidths;if(i.display){var d,u=a.ctx,c=e.getValueOrDefault,h=c(n.fontColor,o.defaultFontColor),f=c(n.fontSize,o.defaultFontSize),g=c(n.fontStyle,o.defaultFontStyle),p=c(n.fontFamily,o.defaultFontFamily),m=e.fontString(f,g,p);u.textAlign="left",u.textBaseline="top",u.lineWidth=.5,u.strokeStyle=h,u.fillStyle=h,u.font=m;var b=n.boxWidth,v=a.legendHitBoxes,x=function(e,a,n){if(!(isNaN(b)||0>=b)){u.save(),u.fillStyle=c(n.fillStyle,o.defaultColor),u.lineCap=c(n.lineCap,r.borderCapStyle),u.lineDashOffset=c(n.lineDashOffset,r.borderDashOffset),u.lineJoin=c(n.lineJoin,r.borderJoinStyle),u.lineWidth=c(n.lineWidth,r.borderWidth),u.strokeStyle=c(n.strokeStyle,o.defaultColor);var l=0===c(n.lineWidth,r.borderWidth);if(u.setLineDash&&u.setLineDash(c(n.lineDash,r.borderDash)),i.labels&&i.labels.usePointStyle){var s=f*Math.SQRT2/2,d=s/Math.SQRT2,h=e+d,g=a+d;t.canvasHelpers.drawPoint(u,n.pointStyle,s,h,g)}else l||u.strokeRect(e,a,b,f),u.fillRect(e,a,b,f);u.restore()}},y=function(t,e,a,i){u.fillText(a.text,b+f/2+t,e),a.hidden&&(u.beginPath(),u.lineWidth=2,u.moveTo(b+f/2+t,e+f/2),u.lineTo(b+f/2+t+i,e+f/2),u.stroke())},k=a.isHorizontal();d=k?{x:a.left+(l-s[0])/2,y:a.top+n.padding,line:0}:{x:a.left+n.padding,y:a.top+n.padding,line:0};var S=f+n.padding;e.each(a.legendItems,function(t,e){var i=u.measureText(t.text).width,o=n.usePointStyle?f+f/2+i:b+f/2+i,r=d.x,c=d.y;k?r+o>=l&&(c=d.y+=S,d.line++,r=d.x=a.left+(l-s[d.line])/2):c+S>a.bottom&&(r=d.x=r+a.columnWidths[d.line]+n.padding,c=d.y=a.top,d.line++),x(r,c,t),v[e].left=r,v[e].top=c,y(r,c,t,i),k?d.x+=o+n.padding:d.y+=S})}},handleEvent:function(t){var a=this,i=a.options,n="mouseup"===t.type?"click":t.type;if("mousemove"===n){if(!i.onHover)return}else{if("click"!==n)return;if(!i.onClick)return}var o=e.getRelativePosition(t,a.chart.chart),r=o.x,l=o.y;if(r>=a.left&&r<=a.right&&l>=a.top&&l<=a.bottom)for(var s=a.legendHitBoxes,d=0;d<s.length;++d){var u=s[d];if(r>=u.left&&r<=u.left+u.width&&l>=u.top&&l<=u.top+u.height){if("click"===n){i.onClick.call(a,t,a.legendItems[d]);break}if("mousemove"===n){i.onHover.call(a,t,a.legendItems[d]);break}}}}}),t.plugins.register({beforeInit:function(e){var a=e.options,i=a.legend;i&&(e.legend=new t.Legend({ctx:e.chart.ctx,options:i,chart:e}),t.layoutService.addBox(e,e.legend))}})}},{}],30:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers.noop;t.plugins={_plugins:[],register:function(t){var e=this._plugins;[].concat(t).forEach(function(t){-1===e.indexOf(t)&&e.push(t)})},unregister:function(t){var e=this._plugins;[].concat(t).forEach(function(t){var a=e.indexOf(t);-1!==a&&e.splice(a,1)})},clear:function(){this._plugins=[]},count:function(){return this._plugins.length},getAll:function(){return this._plugins},notify:function(t,e){var a,i,n=this._plugins,o=n.length;for(a=0;o>a;++a)if(i=n[a],"function"==typeof i[t]&&!1===i[t].apply(i,e||[]))return!1;return!0}},
t.PluginBase=t.Element.extend({beforeInit:e,afterInit:e,beforeUpdate:e,afterUpdate:e,beforeDraw:e,afterDraw:e,destroy:e}),t.pluginService=t.plugins}},{}],31:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.defaults.scale={display:!0,position:"left",gridLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:"rgba(0,0,0,0.25)",offsetGridLines:!1,borderDash:[],borderDashOffset:0},scaleLabel:{labelString:"",display:!1},ticks:{beginAtZero:!1,minRotation:0,maxRotation:50,mirror:!1,padding:10,reverse:!1,display:!0,autoSkip:!0,autoSkipPadding:0,labelOffset:0,callback:function(t){return e.isArray(t)?t:""+t}}},t.Scale=t.Element.extend({beforeUpdate:function(){e.callCallback(this.options.beforeUpdate,[this])},update:function(t,a,i){var n=this;return n.beforeUpdate(),n.maxWidth=t,n.maxHeight=a,n.margins=e.extend({left:0,right:0,top:0,bottom:0},i),n.beforeSetDimensions(),n.setDimensions(),n.afterSetDimensions(),n.beforeDataLimits(),n.determineDataLimits(),n.afterDataLimits(),n.beforeBuildTicks(),n.buildTicks(),n.afterBuildTicks(),n.beforeTickToLabelConversion(),n.convertTicksToLabels(),n.afterTickToLabelConversion(),n.beforeCalculateTickRotation(),n.calculateTickRotation(),n.afterCalculateTickRotation(),n.beforeFit(),n.fit(),n.afterFit(),n.afterUpdate(),n.minSize},afterUpdate:function(){e.callCallback(this.options.afterUpdate,[this])},beforeSetDimensions:function(){e.callCallback(this.options.beforeSetDimensions,[this])},setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0},afterSetDimensions:function(){e.callCallback(this.options.afterSetDimensions,[this])},beforeDataLimits:function(){e.callCallback(this.options.beforeDataLimits,[this])},determineDataLimits:e.noop,afterDataLimits:function(){e.callCallback(this.options.afterDataLimits,[this])},beforeBuildTicks:function(){e.callCallback(this.options.beforeBuildTicks,[this])},buildTicks:e.noop,afterBuildTicks:function(){e.callCallback(this.options.afterBuildTicks,[this])},beforeTickToLabelConversion:function(){e.callCallback(this.options.beforeTickToLabelConversion,[this])},convertTicksToLabels:function(){var t=this;t.ticks=t.ticks.map(function(e,a,i){return t.options.ticks.userCallback?t.options.ticks.userCallback(e,a,i):t.options.ticks.callback(e,a,i)},t)},afterTickToLabelConversion:function(){e.callCallback(this.options.afterTickToLabelConversion,[this])},beforeCalculateTickRotation:function(){e.callCallback(this.options.beforeCalculateTickRotation,[this])},calculateTickRotation:function(){var a=this,i=a.ctx,n=t.defaults.global,o=a.options.ticks,r=e.getValueOrDefault(o.fontSize,n.defaultFontSize),l=e.getValueOrDefault(o.fontStyle,n.defaultFontStyle),s=e.getValueOrDefault(o.fontFamily,n.defaultFontFamily),d=e.fontString(r,l,s);i.font=d;var u,c=i.measureText(a.ticks[0]).width,h=i.measureText(a.ticks[a.ticks.length-1]).width;if(a.labelRotation=o.minRotation||0,a.paddingRight=0,a.paddingLeft=0,a.options.display&&a.isHorizontal()){a.paddingRight=h/2+3,a.paddingLeft=c/2+3,a.longestTextCache||(a.longestTextCache={});for(var f,g,p=e.longestText(i,d,a.ticks,a.longestTextCache),m=p,b=a.getPixelForTick(1)-a.getPixelForTick(0)-6;m>b&&a.labelRotation<o.maxRotation;){if(f=Math.cos(e.toRadians(a.labelRotation)),g=Math.sin(e.toRadians(a.labelRotation)),u=f*c,u+r/2>a.yLabelWidth&&(a.paddingLeft=u+r/2),a.paddingRight=r/2,g*p>a.maxHeight){a.labelRotation--;break}a.labelRotation++,m=f*p}}a.margins&&(a.paddingLeft=Math.max(a.paddingLeft-a.margins.left,0),a.paddingRight=Math.max(a.paddingRight-a.margins.right,0))},afterCalculateTickRotation:function(){e.callCallback(this.options.afterCalculateTickRotation,[this])},beforeFit:function(){e.callCallback(this.options.beforeFit,[this])},fit:function(){var a=this,i=a.minSize={width:0,height:0},n=a.options,o=t.defaults.global,r=n.ticks,l=n.scaleLabel,s=n.gridLines,d=n.display,u=a.isHorizontal(),c=e.getValueOrDefault(r.fontSize,o.defaultFontSize),h=e.getValueOrDefault(r.fontStyle,o.defaultFontStyle),f=e.getValueOrDefault(r.fontFamily,o.defaultFontFamily),g=e.fontString(c,h,f),p=e.getValueOrDefault(l.fontSize,o.defaultFontSize),m=n.gridLines.tickMarkLength;if(i.width=u?a.isFullWidth()?a.maxWidth-a.margins.left-a.margins.right:a.maxWidth:d&&s.drawTicks?m:0,i.height=u?d&&s.drawTicks?m:0:a.maxHeight,l.display&&d&&(u?i.height+=1.5*p:i.width+=1.5*p),r.display&&d){a.longestTextCache||(a.longestTextCache={});var b=e.longestText(a.ctx,g,a.ticks,a.longestTextCache),v=e.numberOfLabelLines(a.ticks),x=.5*c;if(u){a.longestLabelWidth=b;var y=Math.sin(e.toRadians(a.labelRotation))*a.longestLabelWidth+c*v+x*v;i.height=Math.min(a.maxHeight,i.height+y),a.ctx.font=g;var k=a.ctx.measureText(a.ticks[0]).width,S=a.ctx.measureText(a.ticks[a.ticks.length-1]).width,w=Math.cos(e.toRadians(a.labelRotation)),C=Math.sin(e.toRadians(a.labelRotation));a.paddingLeft=0!==a.labelRotation?w*k+3:k/2+3,a.paddingRight=0!==a.labelRotation?C*(c/2)+3:S/2+3}else{var M=a.maxWidth-i.width;r.mirror?b=0:b+=a.options.ticks.padding,M>b?i.width+=b:i.width=a.maxWidth,a.paddingTop=c/2,a.paddingBottom=c/2}}a.margins&&(a.paddingLeft=Math.max(a.paddingLeft-a.margins.left,0),a.paddingTop=Math.max(a.paddingTop-a.margins.top,0),a.paddingRight=Math.max(a.paddingRight-a.margins.right,0),a.paddingBottom=Math.max(a.paddingBottom-a.margins.bottom,0)),a.width=i.width,a.height=i.height},afterFit:function(){e.callCallback(this.options.afterFit,[this])},isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},isFullWidth:function(){return this.options.fullWidth},getRightValue:function(t){return null===t||void 0===t?NaN:"number"==typeof t&&isNaN(t)?NaN:"object"==typeof t?t instanceof Date||t.isValid?t:this.getRightValue(this.isHorizontal()?t.x:t.y):t},getLabelForIndex:e.noop,getPixelForValue:e.noop,getValueForPixel:e.noop,getPixelForTick:function(t,e){var a=this;if(a.isHorizontal()){var i=a.width-(a.paddingLeft+a.paddingRight),n=i/Math.max(a.ticks.length-(a.options.gridLines.offsetGridLines?0:1),1),o=n*t+a.paddingLeft;e&&(o+=n/2);var r=a.left+Math.round(o);return r+=a.isFullWidth()?a.margins.left:0}var l=a.height-(a.paddingTop+a.paddingBottom);return a.top+t*(l/(a.ticks.length-1))},getPixelForDecimal:function(t){var e=this;if(e.isHorizontal()){var a=e.width-(e.paddingLeft+e.paddingRight),i=a*t+e.paddingLeft,n=e.left+Math.round(i);return n+=e.isFullWidth()?e.margins.left:0}return e.top+t*e.height},getBasePixel:function(){var t=this,e=t.min,a=t.max;return t.getPixelForValue(t.beginAtZero?0:0>e&&0>a?a:e>0&&a>0?e:0)},draw:function(a){var i=this,n=i.options;if(n.display){var o,r,l=i.ctx,s=t.defaults.global,d=n.ticks,u=n.gridLines,c=n.scaleLabel,h=0!==i.labelRotation,f=d.autoSkip,g=i.isHorizontal();d.maxTicksLimit&&(r=d.maxTicksLimit);var p=e.getValueOrDefault(d.fontColor,s.defaultFontColor),m=e.getValueOrDefault(d.fontSize,s.defaultFontSize),b=e.getValueOrDefault(d.fontStyle,s.defaultFontStyle),v=e.getValueOrDefault(d.fontFamily,s.defaultFontFamily),x=e.fontString(m,b,v),y=u.tickMarkLength,k=e.getValueOrDefault(u.borderDash,s.borderDash),S=e.getValueOrDefault(u.borderDashOffset,s.borderDashOffset),w=e.getValueOrDefault(c.fontColor,s.defaultFontColor),C=e.getValueOrDefault(c.fontSize,s.defaultFontSize),M=e.getValueOrDefault(c.fontStyle,s.defaultFontStyle),D=e.getValueOrDefault(c.fontFamily,s.defaultFontFamily),I=e.fontString(C,M,D),A=e.toRadians(i.labelRotation),T=Math.cos(A),P=i.longestLabelWidth*T;l.fillStyle=p;var F=[];if(g){if(o=!1,h&&(P/=2),(P+d.autoSkipPadding)*i.ticks.length>i.width-(i.paddingLeft+i.paddingRight)&&(o=1+Math.floor((P+d.autoSkipPadding)*i.ticks.length/(i.width-(i.paddingLeft+i.paddingRight)))),r&&i.ticks.length>r)for(;!o||i.ticks.length/(o||1)>r;)o||(o=1),o+=1;f||(o=!1)}var R="right"===n.position?i.left:i.right-y,_="right"===n.position?i.left+y:i.right,V="bottom"===n.position?i.top:i.bottom-y,L="bottom"===n.position?i.top+y:i.bottom;if(e.each(i.ticks,function(t,r){if(void 0!==t&&null!==t){var l=i.ticks.length===r+1;if((!(o>1&&r%o>0||r%o==0&&r+o>=i.ticks.length)||l)&&void 0!==t&&null!==t){var c,f;r===(void 0!==i.zeroLineIndex?i.zeroLineIndex:0)?(c=u.zeroLineWidth,f=u.zeroLineColor):(c=e.getValueAtIndexOrDefault(u.lineWidth,r),f=e.getValueAtIndexOrDefault(u.color,r));var p,m,b,v,x,w,C,M,D,I,T="middle",P="middle";if(g){h||(P="top"===n.position?"bottom":"top"),T=h?"right":"center";var O=i.getPixelForTick(r)+e.aliasPixel(c);D=i.getPixelForTick(r,u.offsetGridLines)+d.labelOffset,I=h?i.top+12:"top"===n.position?i.bottom-y:i.top+y,p=b=x=C=O,m=V,v=L,w=a.top,M=a.bottom}else{"left"===n.position?d.mirror?(D=i.right+d.padding,T="left"):(D=i.right-d.padding,T="right"):d.mirror?(D=i.left-d.padding,T="right"):(D=i.left+d.padding,T="left");var B=i.getPixelForTick(r);B+=e.aliasPixel(c),I=i.getPixelForTick(r,u.offsetGridLines),p=R,b=_,x=a.left,C=a.right,m=v=w=M=B}F.push({tx1:p,ty1:m,tx2:b,ty2:v,x1:x,y1:w,x2:C,y2:M,labelX:D,labelY:I,glWidth:c,glColor:f,glBorderDash:k,glBorderDashOffset:S,rotation:-1*A,label:t,textBaseline:P,textAlign:T})}}}),e.each(F,function(t){if(u.display&&(l.save(),l.lineWidth=t.glWidth,l.strokeStyle=t.glColor,l.setLineDash&&(l.setLineDash(t.glBorderDash),l.lineDashOffset=t.glBorderDashOffset),l.beginPath(),u.drawTicks&&(l.moveTo(t.tx1,t.ty1),l.lineTo(t.tx2,t.ty2)),u.drawOnChartArea&&(l.moveTo(t.x1,t.y1),l.lineTo(t.x2,t.y2)),l.stroke(),l.restore()),d.display){l.save(),l.translate(t.labelX,t.labelY),l.rotate(t.rotation),l.font=x,l.textBaseline=t.textBaseline,l.textAlign=t.textAlign;var a=t.label;if(e.isArray(a))for(var i=0,n=-(a.length-1)*m*.75;i<a.length;++i)l.fillText(""+a[i],0,n),n+=1.5*m;else l.fillText(a,0,0);l.restore()}}),c.display){var O,B,W=0;if(g)O=i.left+(i.right-i.left)/2,B="bottom"===n.position?i.bottom-C/2:i.top+C/2;else{var z="left"===n.position;O=z?i.left+C/2:i.right-C/2,B=i.top+(i.bottom-i.top)/2,W=z?-.5*Math.PI:.5*Math.PI}l.save(),l.translate(O,B),l.rotate(W),l.textAlign="center",l.textBaseline="middle",l.fillStyle=w,l.font=I,l.fillText(c.labelString,0,0),l.restore()}if(u.drawBorder){l.lineWidth=e.getValueAtIndexOrDefault(u.lineWidth,0),l.strokeStyle=e.getValueAtIndexOrDefault(u.color,0);var N=i.left,H=i.right,E=i.top,U=i.bottom,q=e.aliasPixel(l.lineWidth);g?(E=U="top"===n.position?i.bottom:i.top,E+=q,U+=q):(N=H="left"===n.position?i.right:i.left,N+=q,H+=q),l.beginPath(),l.moveTo(N,E),l.lineTo(H,U),l.stroke()}}}})}},{}],32:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.scaleService={constructors:{},defaults:{},registerScaleType:function(t,a,i){this.constructors[t]=a,this.defaults[t]=e.clone(i)},getScaleConstructor:function(t){return this.constructors.hasOwnProperty(t)?this.constructors[t]:void 0},getScaleDefaults:function(a){return this.defaults.hasOwnProperty(a)?e.scaleMerge(t.defaults.scale,this.defaults[a]):{}},updateScaleDefaults:function(t,a){var i=this.defaults;i.hasOwnProperty(t)&&(i[t]=e.extend(i[t],a))},addScalesToLayout:function(a){e.each(a.scales,function(e){t.layoutService.addBox(a,e)})}}}},{}],33:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.defaults.global.title={display:!1,position:"top",fullWidth:!0,fontStyle:"bold",padding:10,text:""};var a=e.noop;t.Title=t.Element.extend({initialize:function(a){var i=this;e.extend(i,a),i.options=e.configMerge(t.defaults.global.title,a.options),i.legendHitBoxes=[]},beforeUpdate:function(){var a=this.chart.options;a&&a.title&&(this.options=e.configMerge(t.defaults.global.title,a.title))},update:function(t,e,a){var i=this;return i.beforeUpdate(),i.maxWidth=t,i.maxHeight=e,i.margins=a,i.beforeSetDimensions(),i.setDimensions(),i.afterSetDimensions(),i.beforeBuildLabels(),i.buildLabels(),i.afterBuildLabels(),i.beforeFit(),i.fit(),i.afterFit(),i.afterUpdate(),i.minSize},afterUpdate:a,beforeSetDimensions:a,setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0,t.minSize={width:0,height:0}},afterSetDimensions:a,beforeBuildLabels:a,buildLabels:a,afterBuildLabels:a,beforeFit:a,fit:function(){var a=this,i=e.getValueOrDefault,n=a.options,o=t.defaults.global,r=n.display,l=i(n.fontSize,o.defaultFontSize),s=a.minSize;a.isHorizontal()?(s.width=a.maxWidth,s.height=r?l+2*n.padding:0):(s.width=r?l+2*n.padding:0,s.height=a.maxHeight),a.width=s.width,a.height=s.height},afterFit:a,isHorizontal:function(){var t=this.options.position;return"top"===t||"bottom"===t},draw:function(){var a=this,i=a.ctx,n=e.getValueOrDefault,o=a.options,r=t.defaults.global;if(o.display){var l,s,d=n(o.fontSize,r.defaultFontSize),u=n(o.fontStyle,r.defaultFontStyle),c=n(o.fontFamily,r.defaultFontFamily),h=e.fontString(d,u,c),f=0,g=a.top,p=a.left,m=a.bottom,b=a.right;i.fillStyle=n(o.fontColor,r.defaultFontColor),i.font=h,a.isHorizontal()?(l=p+(b-p)/2,s=g+(m-g)/2):(l="left"===o.position?p+d/2:b-d/2,s=g+(m-g)/2,f=Math.PI*("left"===o.position?-.5:.5)),i.save(),i.translate(l,s),i.rotate(f),i.textAlign="center",i.textBaseline="middle",i.fillText(o.text,0,0),i.restore()}}}),t.plugins.register({beforeInit:function(e){var a=e.options,i=a.title;i&&(e.titleBlock=new t.Title({ctx:e.chart.ctx,options:i,chart:e}),t.layoutService.addBox(e,e.titleBlock))}})}},{}],34:[function(t,e,a){"use strict";e.exports=function(t){function e(t,e){return e&&(n.isArray(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function a(t){if(!t.length)return!1;var e,a,i=[],n=[];for(e=0,a=t.length;a>e;++e){var o=t[e];if(o&&o.hasValue()){var r=o.tooltipPosition();i.push(r.x),n.push(r.y)}}var l=0,s=0;for(e=0;e<i.length;++e)i[e]&&(l+=i[e],s+=n[e]);return{x:Math.round(l/i.length),y:Math.round(s/i.length)}}function i(t){var e=t._xScale,a=t._yScale||t._scale,i=t._index,n=t._datasetIndex;return{xLabel:e?e.getLabelForIndex(i,n):"",yLabel:a?a.getLabelForIndex(i,n):"",index:i,datasetIndex:n}}var n=t.helpers;t.defaults.global.tooltips={enabled:!0,custom:null,mode:"single",backgroundColor:"rgba(0,0,0,0.8)",titleFontStyle:"bold",titleSpacing:2,titleMarginBottom:6,titleFontColor:"#fff",titleAlign:"left",bodySpacing:2,bodyFontColor:"#fff",bodyAlign:"left",footerFontStyle:"bold",footerSpacing:2,footerMarginTop:6,footerFontColor:"#fff",footerAlign:"left",yPadding:6,xPadding:6,yAlign:"center",xAlign:"center",caretSize:5,cornerRadius:6,multiKeyBackground:"#fff",callbacks:{beforeTitle:n.noop,title:function(t,e){var a="",i=e.labels,n=i?i.length:0;if(t.length>0){var o=t[0];o.xLabel?a=o.xLabel:n>0&&o.index<n&&(a=i[o.index])}return a},afterTitle:n.noop,beforeBody:n.noop,beforeLabel:n.noop,label:function(t,e){return(e.datasets[t.datasetIndex].label||"")+": "+t.yLabel},labelColor:function(t,e){var a=e.getDatasetMeta(t.datasetIndex),i=a.data[t.index],n=i._view;return{borderColor:n.borderColor,backgroundColor:n.backgroundColor}},afterLabel:n.noop,afterBody:n.noop,beforeFooter:n.noop,footer:n.noop,afterFooter:n.noop}},t.Tooltip=t.Element.extend({initialize:function(){var e=this,a=t.defaults.global,i=e._options,o=n.getValueOrDefault;n.extend(e,{_model:{xPadding:i.xPadding,yPadding:i.yPadding,xAlign:i.xAlign,yAlign:i.yAlign,bodyFontColor:i.bodyFontColor,_bodyFontFamily:o(i.bodyFontFamily,a.defaultFontFamily),_bodyFontStyle:o(i.bodyFontStyle,a.defaultFontStyle),_bodyAlign:i.bodyAlign,bodyFontSize:o(i.bodyFontSize,a.defaultFontSize),bodySpacing:i.bodySpacing,titleFontColor:i.titleFontColor,_titleFontFamily:o(i.titleFontFamily,a.defaultFontFamily),_titleFontStyle:o(i.titleFontStyle,a.defaultFontStyle),titleFontSize:o(i.titleFontSize,a.defaultFontSize),_titleAlign:i.titleAlign,titleSpacing:i.titleSpacing,titleMarginBottom:i.titleMarginBottom,footerFontColor:i.footerFontColor,_footerFontFamily:o(i.footerFontFamily,a.defaultFontFamily),_footerFontStyle:o(i.footerFontStyle,a.defaultFontStyle),footerFontSize:o(i.footerFontSize,a.defaultFontSize),_footerAlign:i.footerAlign,footerSpacing:i.footerSpacing,footerMarginTop:i.footerMarginTop,caretSize:i.caretSize,cornerRadius:i.cornerRadius,backgroundColor:i.backgroundColor,opacity:0,legendColorBackground:i.multiKeyBackground}})},getTitle:function(){var t=this,a=t._options,i=a.callbacks,n=i.beforeTitle.apply(t,arguments),o=i.title.apply(t,arguments),r=i.afterTitle.apply(t,arguments),l=[];return l=e(l,n),l=e(l,o),l=e(l,r)},getBeforeBody:function(){var t=this._options.callbacks.beforeBody.apply(this,arguments);return n.isArray(t)?t:void 0!==t?[t]:[]},getBody:function(t,a){var i=this,o=i._options.callbacks,r=[];return n.each(t,function(t){var n={before:[],lines:[],after:[]};e(n.before,o.beforeLabel.call(i,t,a)),e(n.lines,o.label.call(i,t,a)),e(n.after,o.afterLabel.call(i,t,a)),r.push(n)}),r},getAfterBody:function(){var t=this._options.callbacks.afterBody.apply(this,arguments);return n.isArray(t)?t:void 0!==t?[t]:[]},getFooter:function(){var t=this,a=t._options.callbacks,i=a.beforeFooter.apply(t,arguments),n=a.footer.apply(t,arguments),o=a.afterFooter.apply(t,arguments),r=[];return r=e(r,i),r=e(r,n),r=e(r,o)},update:function(t){var e,o,r=this,l=r._options,s=r._model,d=r._active,u=r._data,c=r._chartInstance;if(d.length){s.opacity=1;var h=[],f=a(d),g=[];for(e=0,o=d.length;o>e;++e)g.push(i(d[e]));l.itemSort&&(g=g.sort(function(t,e){return l.itemSort(t,e,u)})),d.length>1&&n.each(g,function(t){h.push(l.callbacks.labelColor.call(r,t,c))}),n.extend(s,{title:r.getTitle(g,u),beforeBody:r.getBeforeBody(g,u),body:r.getBody(g,u),afterBody:r.getAfterBody(g,u),footer:r.getFooter(g,u),x:Math.round(f.x),y:Math.round(f.y),caretPadding:n.getValueOrDefault(f.padding,2),labelColors:h});var p=r.getTooltipSize(s);r.determineAlignment(p),n.extend(s,r.getBackgroundPoint(s,p))}else r._model.opacity=0;return t&&l.custom&&l.custom.call(r,s),r},getTooltipSize:function(t){var e=this._chart.ctx,a={height:2*t.yPadding,width:0},i=t.body,o=i.reduce(function(t,e){return t+e.before.length+e.lines.length+e.after.length},0);o+=t.beforeBody.length+t.afterBody.length;var r=t.title.length,l=t.footer.length,s=t.titleFontSize,d=t.bodyFontSize,u=t.footerFontSize;a.height+=r*s,a.height+=(r-1)*t.titleSpacing,a.height+=r?t.titleMarginBottom:0,a.height+=o*d,a.height+=o?(o-1)*t.bodySpacing:0,a.height+=l?t.footerMarginTop:0,a.height+=l*u,a.height+=l?(l-1)*t.footerSpacing:0;var c=0,h=function(t){a.width=Math.max(a.width,e.measureText(t).width+c)};return e.font=n.fontString(s,t._titleFontStyle,t._titleFontFamily),n.each(t.title,h),e.font=n.fontString(d,t._bodyFontStyle,t._bodyFontFamily),n.each(t.beforeBody.concat(t.afterBody),h),c=i.length>1?d+2:0,n.each(i,function(t){n.each(t.before,h),n.each(t.lines,h),n.each(t.after,h)}),c=0,e.font=n.fontString(u,t._footerFontStyle,t._footerFontFamily),n.each(t.footer,h),a.width+=2*t.xPadding,a},determineAlignment:function(t){var e=this,a=e._model,i=e._chart,n=e._chartInstance.chartArea;a.y<t.height?a.yAlign="top":a.y>i.height-t.height&&(a.yAlign="bottom");var o,r,l,s,d,u=(n.left+n.right)/2,c=(n.top+n.bottom)/2;"center"===a.yAlign?(o=function(t){return u>=t},r=function(t){return t>u}):(o=function(e){return e<=t.width/2},r=function(e){return e>=i.width-t.width/2}),l=function(e){return e+t.width>i.width},s=function(e){return e-t.width<0},d=function(t){return c>=t?"top":"bottom"},o(a.x)?(a.xAlign="left",l(a.x)&&(a.xAlign="center",a.yAlign=d(a.y))):r(a.x)&&(a.xAlign="right",s(a.x)&&(a.xAlign="center",a.yAlign=d(a.y)))},getBackgroundPoint:function(t,e){var a={x:t.x,y:t.y},i=t.caretSize,n=t.caretPadding,o=t.cornerRadius,r=t.xAlign,l=t.yAlign,s=i+n,d=o+n;return"right"===r?a.x-=e.width:"center"===r&&(a.x-=e.width/2),"top"===l?a.y+=s:a.y-="bottom"===l?e.height+s:e.height/2,"center"===l?"left"===r?a.x+=s:"right"===r&&(a.x-=s):"left"===r?a.x-=d:"right"===r&&(a.x+=d),a},drawCaret:function(t,e,a){var i,o,r,l,s,d,u=this._view,c=this._chart.ctx,h=u.caretSize,f=u.cornerRadius,g=u.xAlign,p=u.yAlign,m=t.x,b=t.y,v=e.width,x=e.height;"center"===p?("left"===g?(i=m,o=i-h,r=i):(i=m+v,o=i+h,r=i),s=b+x/2,l=s-h,d=s+h):("left"===g?(i=m+f,o=i+h,r=o+h):"right"===g?(i=m+v-f,o=i-h,r=o-h):(o=m+v/2,i=o-h,r=o+h),"top"===p?(l=b,s=l-h,d=l):(l=b+x,s=l+h,d=l));var y=n.color(u.backgroundColor);c.fillStyle=y.alpha(a*y.alpha()).rgbString(),c.beginPath(),c.moveTo(i,l),c.lineTo(o,s),c.lineTo(r,d),c.closePath(),c.fill()},drawTitle:function(t,e,a,i){var o=e.title;if(o.length){a.textAlign=e._titleAlign,a.textBaseline="top";var r=e.titleFontSize,l=e.titleSpacing,s=n.color(e.titleFontColor);a.fillStyle=s.alpha(i*s.alpha()).rgbString(),a.font=n.fontString(r,e._titleFontStyle,e._titleFontFamily);var d,u;for(d=0,u=o.length;u>d;++d)a.fillText(o[d],t.x,t.y),t.y+=r+l,d+1===o.length&&(t.y+=e.titleMarginBottom-l)}},drawBody:function(t,e,a,i){var o=e.bodyFontSize,r=e.bodySpacing,l=e.body;a.textAlign=e._bodyAlign,a.textBaseline="top";var s=n.color(e.bodyFontColor),d=s.alpha(i*s.alpha()).rgbString();a.fillStyle=d,a.font=n.fontString(o,e._bodyFontStyle,e._bodyFontFamily);var u=0,c=function(e){a.fillText(e,t.x+u,t.y),t.y+=o+r};n.each(e.beforeBody,c);var h=l.length>1;u=h?o+2:0,n.each(l,function(r,l){n.each(r.before,c),n.each(r.lines,function(r){h&&(a.fillStyle=n.color(e.legendColorBackground).alpha(i).rgbaString(),a.fillRect(t.x,t.y,o,o),a.strokeStyle=n.color(e.labelColors[l].borderColor).alpha(i).rgbaString(),a.strokeRect(t.x,t.y,o,o),a.fillStyle=n.color(e.labelColors[l].backgroundColor).alpha(i).rgbaString(),a.fillRect(t.x+1,t.y+1,o-2,o-2),a.fillStyle=d),c(r)}),n.each(r.after,c)}),u=0,n.each(e.afterBody,c),t.y-=r},drawFooter:function(t,e,a,i){var o=e.footer;if(o.length){t.y+=e.footerMarginTop,a.textAlign=e._footerAlign,a.textBaseline="top";var r=n.color(e.footerFontColor);a.fillStyle=r.alpha(i*r.alpha()).rgbString(),a.font=n.fontString(e.footerFontSize,e._footerFontStyle,e._footerFontFamily),n.each(o,function(i){a.fillText(i,t.x,t.y),t.y+=e.footerFontSize+e.footerSpacing})}},draw:function(){var t=this._chart.ctx,e=this._view;if(0!==e.opacity){var a=this.getTooltipSize(e),i={x:e.x,y:e.y},o=Math.abs(e.opacity<.001)?0:e.opacity;if(this._options.enabled){var r=n.color(e.backgroundColor);t.fillStyle=r.alpha(o*r.alpha()).rgbString(),n.drawRoundedRectangle(t,i.x,i.y,a.width,a.height,e.cornerRadius),t.fill(),this.drawCaret(i,a,o),i.x+=e.xPadding,i.y+=e.yPadding,this.drawTitle(i,e,t,o),this.drawBody(i,e,t,o),this.drawFooter(i,e,t,o)}}}})}},{}],35:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a=t.defaults.global;a.elements.arc={backgroundColor:a.defaultColor,borderColor:"#fff",borderWidth:2},t.elements.Arc=t.Element.extend({inLabelRange:function(t){var e=this._view;return!!e&&Math.pow(t-e.x,2)<Math.pow(e.radius+e.hoverRadius,2)},inRange:function(t,a){var i=this._view;if(i){for(var n=e.getAngleFromPoint(i,{x:t,y:a}),o=n.angle,r=n.distance,l=i.startAngle,s=i.endAngle;l>s;)s+=2*Math.PI;for(;o>s;)o-=2*Math.PI;for(;l>o;)o+=2*Math.PI;var d=o>=l&&s>=o,u=r>=i.innerRadius&&r<=i.outerRadius;return d&&u}return!1},tooltipPosition:function(){var t=this._view,e=t.startAngle+(t.endAngle-t.startAngle)/2,a=(t.outerRadius-t.innerRadius)/2+t.innerRadius;return{x:t.x+Math.cos(e)*a,y:t.y+Math.sin(e)*a}},draw:function(){var t=this._chart.ctx,e=this._view,a=e.startAngle,i=e.endAngle;t.beginPath(),t.arc(e.x,e.y,e.outerRadius,a,i),t.arc(e.x,e.y,e.innerRadius,i,a,!0),t.closePath(),t.strokeStyle=e.borderColor,t.lineWidth=e.borderWidth,t.fillStyle=e.backgroundColor,t.fill(),t.lineJoin="bevel",e.borderWidth&&t.stroke()}})}},{}],36:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a=t.defaults.global;t.defaults.global.elements.line={tension:.4,backgroundColor:a.defaultColor,borderWidth:3,borderColor:a.defaultColor,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",capBezierPoints:!0,fill:!0},t.elements.Line=t.Element.extend({draw:function(){function t(t,e){var a=e._view;!0===e._view.steppedLine?(s.lineTo(a.x,t._view.y),s.lineTo(a.x,a.y)):0===e._view.tension?s.lineTo(a.x,a.y):s.bezierCurveTo(t._view.controlPointNextX,t._view.controlPointNextY,a.controlPointPreviousX,a.controlPointPreviousY,a.x,a.y)}var i=this,n=i._view,o=n.spanGaps,r=n.scaleZero,l=i._loop,s=i._chart.ctx;s.save();var d=i._children.slice(),u=-1;l&&d.length&&d.push(d[0]);var c,h,f,g;if(d.length&&n.fill){for(s.beginPath(),c=0;c<d.length;++c)h=d[c],f=e.previousItem(d,c),g=h._view,0===c?(l?s.moveTo(r.x,r.y):s.moveTo(g.x,r),g.skip||(u=c,s.lineTo(g.x,g.y))):(f=-1===u?f:d[u],g.skip?o||u!==c-1||(l?s.lineTo(r.x,r.y):s.lineTo(f._view.x,r)):(u!==c-1?o&&-1!==u?t(f,h):l?s.lineTo(g.x,g.y):(s.lineTo(g.x,r),s.lineTo(g.x,g.y)):t(f,h),u=c));l||-1===u||s.lineTo(d[u]._view.x,r),s.fillStyle=n.backgroundColor||a.defaultColor,s.closePath(),s.fill()}var p=a.elements.line;for(s.lineCap=n.borderCapStyle||p.borderCapStyle,s.setLineDash&&s.setLineDash(n.borderDash||p.borderDash),s.lineDashOffset=n.borderDashOffset||p.borderDashOffset,s.lineJoin=n.borderJoinStyle||p.borderJoinStyle,s.lineWidth=n.borderWidth||p.borderWidth,s.strokeStyle=n.borderColor||a.defaultColor,s.beginPath(),u=-1,c=0;c<d.length;++c)h=d[c],f=e.previousItem(d,c),g=h._view,0===c?g.skip||(s.moveTo(g.x,g.y),u=c):(f=-1===u?f:d[u],g.skip||(u!==c-1&&!o||-1===u?s.moveTo(g.x,g.y):t(f,h),u=c));s.stroke(),s.restore()}})}},{}],37:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a=t.defaults.global,i=a.defaultColor;a.elements.point={radius:3,pointStyle:"circle",backgroundColor:i,borderWidth:1,borderColor:i,hitRadius:1,hoverRadius:4,hoverBorderWidth:1},t.elements.Point=t.Element.extend({inRange:function(t,e){var a=this._view;return!!a&&Math.pow(t-a.x,2)+Math.pow(e-a.y,2)<Math.pow(a.hitRadius+a.radius,2)},inLabelRange:function(t){var e=this._view;return!!e&&Math.pow(t-e.x,2)<Math.pow(e.radius+e.hitRadius,2)},tooltipPosition:function(){var t=this._view;return{x:t.x,y:t.y,padding:t.radius+t.borderWidth}},draw:function(){var n=this._view,o=this._chart.ctx,r=n.pointStyle,l=n.radius,s=n.x,d=n.y;n.skip||(o.strokeStyle=n.borderColor||i,o.lineWidth=e.getValueOrDefault(n.borderWidth,a.elements.point.borderWidth),o.fillStyle=n.backgroundColor||i,t.canvasHelpers.drawPoint(o,r,l,s,d))}})}},{}],38:[function(t,e,a){"use strict";e.exports=function(t){var e=t.defaults.global;e.elements.rectangle={backgroundColor:e.defaultColor,borderWidth:0,borderColor:e.defaultColor,borderSkipped:"bottom"},t.elements.Rectangle=t.Element.extend({draw:function(){function t(t){return s[(u+t)%4]}var e=this._chart.ctx,a=this._view,i=a.width/2,n=a.x-i,o=a.x+i,r=a.base-(a.base-a.y),l=a.borderWidth/2;a.borderWidth&&(n+=l,o-=l,r+=l),e.beginPath(),e.fillStyle=a.backgroundColor,e.strokeStyle=a.borderColor,e.lineWidth=a.borderWidth;var s=[[n,a.base],[n,r],[o,r],[o,a.base]],d=["bottom","left","top","right"],u=d.indexOf(a.borderSkipped,0);-1===u&&(u=0),e.moveTo.apply(e,t(0));for(var c=1;4>c;c++)e.lineTo.apply(e,t(c));e.fill(),a.borderWidth&&e.stroke()},height:function(){var t=this._view;return t.base-t.y},inRange:function(t,e){var a=this._view;return!!a&&(a.y<a.base?t>=a.x-a.width/2&&t<=a.x+a.width/2&&e>=a.y&&e<=a.base:t>=a.x-a.width/2&&t<=a.x+a.width/2&&e>=a.base&&e<=a.y)},inLabelRange:function(t){var e=this._view;return!!e&&(t>=e.x-e.width/2&&t<=e.x+e.width/2)},tooltipPosition:function(){var t=this._view;return{x:t.x,y:t.y}}})}},{}],39:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a={position:"bottom"},i=t.Scale.extend({getLabels:function(){var t=this.chart.data;return(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels},determineDataLimits:function(){var t=this,a=t.getLabels();t.minIndex=0,t.maxIndex=a.length-1;var i;void 0!==t.options.ticks.min&&(i=e.indexOf(a,t.options.ticks.min),t.minIndex=-1!==i?i:t.minIndex),void 0!==t.options.ticks.max&&(i=e.indexOf(a,t.options.ticks.max),t.maxIndex=-1!==i?i:t.maxIndex),t.min=a[t.minIndex],t.max=a[t.maxIndex]},buildTicks:function(){var t=this,e=t.getLabels();t.ticks=0===t.minIndex&&t.maxIndex===e.length-1?e:e.slice(t.minIndex,t.maxIndex+1)},getLabelForIndex:function(t,e){var a=this,i=a.chart.data,n=a.isHorizontal();return i.xLabels&&n||i.yLabels&&!n?a.getRightValue(i.datasets[e].data[t]):a.ticks[t]},getPixelForValue:function(t,e,a,i){var n=this,o=Math.max(n.maxIndex+1-n.minIndex-(n.options.gridLines.offsetGridLines?0:1),1);if(void 0!==t&&isNaN(e)){var r=n.getLabels(),l=r.indexOf(t);e=-1!==l?l:e}if(n.isHorizontal()){var s=n.width-(n.paddingLeft+n.paddingRight),d=s/o,u=d*(e-n.minIndex)+n.paddingLeft;return(n.options.gridLines.offsetGridLines&&i||n.maxIndex===n.minIndex&&i)&&(u+=d/2),n.left+Math.round(u)}var c=n.height-(n.paddingTop+n.paddingBottom),h=c/o,f=h*(e-n.minIndex)+n.paddingTop;return n.options.gridLines.offsetGridLines&&i&&(f+=h/2),n.top+Math.round(f)},getPixelForTick:function(t,e){return this.getPixelForValue(this.ticks[t],t+this.minIndex,null,e)},getValueForPixel:function(t){var a=this,i=Math.max(a.ticks.length-(a.options.gridLines.offsetGridLines?0:1),1),n=a.isHorizontal(),o=n?a.width-(a.paddingLeft+a.paddingRight):a.height-(a.paddingTop+a.paddingBottom),r=o/i;return t-=n?a.left:a.top,a.options.gridLines.offsetGridLines&&(t-=r/2),t-=n?a.paddingLeft:a.paddingTop,0>=t?0:Math.round(t/r)},getBasePixel:function(){return this.bottom}});t.scaleService.registerScaleType("category",i,a)}},{}],40:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a={position:"left",ticks:{callback:function(t,a,i){var n=i.length>3?i[2]-i[1]:i[1]-i[0];Math.abs(n)>1&&t!==Math.floor(t)&&(n=t-Math.floor(t));var o=e.log10(Math.abs(n)),r="";if(0!==t){var l=-1*Math.floor(o);l=Math.max(Math.min(l,20),0),r=t.toFixed(l)}else r="0";return r}}},i=t.LinearScaleBase.extend({determineDataLimits:function(){function t(t){return l?t.xAxisID===a.id:t.yAxisID===a.id}var a=this,i=a.options,n=a.chart,o=n.data,r=o.datasets,l=a.isHorizontal();if(a.min=null,a.max=null,i.stacked){var s={};e.each(r,function(o,r){var l=n.getDatasetMeta(r);void 0===s[l.type]&&(s[l.type]={positiveValues:[],negativeValues:[]});var d=s[l.type].positiveValues,u=s[l.type].negativeValues;n.isDatasetVisible(r)&&t(l)&&e.each(o.data,function(t,e){var n=+a.getRightValue(t);isNaN(n)||l.data[e].hidden||(d[e]=d[e]||0,u[e]=u[e]||0,i.relativePoints?d[e]=100:0>n?u[e]+=n:d[e]+=n)})}),e.each(s,function(t){var i=t.positiveValues.concat(t.negativeValues),n=e.min(i),o=e.max(i);a.min=null===a.min?n:Math.min(a.min,n),a.max=null===a.max?o:Math.max(a.max,o)})}else e.each(r,function(i,o){var r=n.getDatasetMeta(o);n.isDatasetVisible(o)&&t(r)&&e.each(i.data,function(t,e){var i=+a.getRightValue(t);isNaN(i)||r.data[e].hidden||(null===a.min?a.min=i:i<a.min&&(a.min=i),null===a.max?a.max=i:i>a.max&&(a.max=i))})});this.handleTickRangeOptions()},getTickLimit:function(){var a,i=this,n=i.options.ticks;if(i.isHorizontal())a=Math.min(n.maxTicksLimit?n.maxTicksLimit:11,Math.ceil(i.width/50));else{var o=e.getValueOrDefault(n.fontSize,t.defaults.global.defaultFontSize);a=Math.min(n.maxTicksLimit?n.maxTicksLimit:11,Math.ceil(i.height/(2*o)))}return a},handleDirectionalChanges:function(){this.isHorizontal()||this.ticks.reverse()},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},getPixelForValue:function(t){var e,a,i=this,n=i.paddingLeft,o=i.paddingBottom,r=i.start,l=+i.getRightValue(t),s=i.end-r;return i.isHorizontal()?(a=i.width-(n+i.paddingRight),e=i.left+a/s*(l-r),Math.round(e+n)):(a=i.height-(i.paddingTop+o),e=i.bottom-o-a/s*(l-r),Math.round(e))},getValueForPixel:function(t){var e=this,a=e.isHorizontal(),i=e.paddingLeft,n=e.paddingBottom,o=a?e.width-(i+e.paddingRight):e.height-(e.paddingTop+n),r=(a?t-e.left-i:e.bottom-n-t)/o;return e.start+(e.end-e.start)*r},getPixelForTick:function(t){return this.getPixelForValue(this.ticksAsNumbers[t])}});t.scaleService.registerScaleType("linear",i,a)}},{}],41:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a=e.noop;t.LinearScaleBase=t.Scale.extend({handleTickRangeOptions:function(){var t=this,a=t.options,i=a.ticks;if(i.beginAtZero){var n=e.sign(t.min),o=e.sign(t.max)
;0>n&&0>o?t.max=0:n>0&&o>0&&(t.min=0)}void 0!==i.min?t.min=i.min:void 0!==i.suggestedMin&&(t.min=Math.min(t.min,i.suggestedMin)),void 0!==i.max?t.max=i.max:void 0!==i.suggestedMax&&(t.max=Math.max(t.max,i.suggestedMax)),t.min===t.max&&(t.max++,i.beginAtZero||t.min--)},getTickLimit:a,handleDirectionalChanges:a,buildTicks:function(){var t=this,a=t.options,i=t.ticks=[],n=a.ticks,o=e.getValueOrDefault,r=t.getTickLimit();r=Math.max(2,r);var l;if(n.fixedStepSize&&n.fixedStepSize>0||n.stepSize&&n.stepSize>0)l=o(n.fixedStepSize,n.stepSize);else{var d=e.niceNum(t.max-t.min,!1);l=e.niceNum(d/(r-1),!0)}var u=Math.floor(t.min/l)*l,c=Math.ceil(t.max/l)*l,h=(c-u)/l;h=e.almostEquals(h,Math.round(h),l/1e3)?Math.round(h):Math.ceil(h),i.push(void 0!==n.min?n.min:u);for(var f=1;h>f;++f)i.push(u+f*l);i.push(void 0!==n.max?n.max:c),t.handleDirectionalChanges(),t.max=e.max(i),t.min=e.min(i),n.reverse?(i.reverse(),t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max)},convertTicksToLabels:function(){var e=this;e.ticksAsNumbers=e.ticks.slice(),e.zeroLineIndex=e.ticks.indexOf(0),t.Scale.prototype.convertTicksToLabels.call(e)}})}},{}],42:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a={position:"left",ticks:{callback:function(t,a,i){var n=t/Math.pow(10,Math.floor(e.log10(t)));return 0===t?"0":1===n||2===n||5===n||0===a||a===i.length-1?t.toExponential():""}}},i=t.Scale.extend({determineDataLimits:function(){function t(t){return d?t.xAxisID===a.id:t.yAxisID===a.id}var a=this,i=a.options,n=i.ticks,o=a.chart,r=o.data,l=r.datasets,s=e.getValueOrDefault,d=a.isHorizontal();if(a.min=null,a.max=null,a.minNotZero=null,i.stacked){var u={};e.each(l,function(n,r){var l=o.getDatasetMeta(r);o.isDatasetVisible(r)&&t(l)&&(void 0===u[l.type]&&(u[l.type]=[]),e.each(n.data,function(t,e){var n=u[l.type],o=+a.getRightValue(t);isNaN(o)||l.data[e].hidden||(n[e]=n[e]||0,i.relativePoints?n[e]=100:n[e]+=o)}))}),e.each(u,function(t){var i=e.min(t),n=e.max(t);a.min=null===a.min?i:Math.min(a.min,i),a.max=null===a.max?n:Math.max(a.max,n)})}else e.each(l,function(i,n){var r=o.getDatasetMeta(n);o.isDatasetVisible(n)&&t(r)&&e.each(i.data,function(t,e){var i=+a.getRightValue(t);isNaN(i)||r.data[e].hidden||(null===a.min?a.min=i:i<a.min&&(a.min=i),null===a.max?a.max=i:i>a.max&&(a.max=i),0!==i&&(null===a.minNotZero||i<a.minNotZero)&&(a.minNotZero=i))})});a.min=s(n.min,a.min),a.max=s(n.max,a.max),a.min===a.max&&(0!==a.min&&null!==a.min?(a.min=Math.pow(10,Math.floor(e.log10(a.min))-1),a.max=Math.pow(10,Math.floor(e.log10(a.max))+1)):(a.min=1,a.max=10))},buildTicks:function(){for(var t=this,a=t.options,i=a.ticks,n=e.getValueOrDefault,o=t.ticks=[],r=n(i.min,Math.pow(10,Math.floor(e.log10(t.min))));r<t.max;){o.push(r);var l,s;0===r?(l=Math.floor(e.log10(t.minNotZero)),s=Math.round(t.minNotZero/Math.pow(10,l))):(l=Math.floor(e.log10(r)),s=Math.floor(r/Math.pow(10,l))+1),10===s&&(s=1,++l),r=s*Math.pow(10,l)}var d=n(i.max,r);o.push(d),t.isHorizontal()||o.reverse(),t.max=e.max(o),t.min=e.min(o),i.reverse?(o.reverse(),t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max)},convertTicksToLabels:function(){this.tickValues=this.ticks.slice(),t.Scale.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},getPixelForTick:function(t){return this.getPixelForValue(this.tickValues[t])},getPixelForValue:function(t){var a,i,n,o=this,r=o.start,l=+o.getRightValue(t),s=o.paddingTop,d=o.paddingBottom,u=o.paddingLeft,c=o.options,h=c.ticks;return o.isHorizontal()?(n=e.log10(o.end)-e.log10(r),0===l?i=o.left+u:(a=o.width-(u+o.paddingRight),i=o.left+a/n*(e.log10(l)-e.log10(r)),i+=u)):(a=o.height-(s+d),0!==r||h.reverse?0===o.end&&h.reverse?(n=e.log10(o.start)-e.log10(o.minNotZero),i=l===o.end?o.top+s:l===o.minNotZero?o.top+s+.02*a:o.top+s+.02*a+.98*a/n*(e.log10(l)-e.log10(o.minNotZero))):(n=e.log10(o.end)-e.log10(r),a=o.height-(s+d),i=o.bottom-d-a/n*(e.log10(l)-e.log10(r))):(n=e.log10(o.end)-e.log10(o.minNotZero),i=l===r?o.bottom-d:l===o.minNotZero?o.bottom-d-.02*a:o.bottom-d-.02*a-.98*a/n*(e.log10(l)-e.log10(o.minNotZero)))),i},getValueForPixel:function(t){var a,i,n=this,o=e.log10(n.end)-e.log10(n.start);return n.isHorizontal()?(i=n.width-(n.paddingLeft+n.paddingRight),a=n.start*Math.pow(10,(t-n.left-n.paddingLeft)*o/i)):(i=n.height-(n.paddingTop+n.paddingBottom),a=Math.pow(10,(n.bottom-n.paddingBottom-t)*o/i)/n.start),a}});t.scaleService.registerScaleType("logarithmic",i,a)}},{}],43:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a=t.defaults.global,i={display:!0,animate:!0,lineArc:!1,position:"chartArea",angleLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1},ticks:{showLabelBackdrop:!0,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2},pointLabels:{fontSize:10,callback:function(t){return t}}},n=t.LinearScaleBase.extend({getValueCount:function(){return this.chart.data.labels.length},setDimensions:function(){var t=this,i=t.options,n=i.ticks;t.width=t.maxWidth,t.height=t.maxHeight,t.xCenter=Math.round(t.width/2),t.yCenter=Math.round(t.height/2);var o=e.min([t.height,t.width]),r=e.getValueOrDefault(n.fontSize,a.defaultFontSize);t.drawingArea=i.display?o/2-(r/2+n.backdropPaddingY):o/2},determineDataLimits:function(){var t=this,a=t.chart;t.min=null,t.max=null,e.each(a.data.datasets,function(i,n){if(a.isDatasetVisible(n)){var o=a.getDatasetMeta(n);e.each(i.data,function(e,a){var i=+t.getRightValue(e);isNaN(i)||o.data[a].hidden||(null===t.min?t.min=i:i<t.min&&(t.min=i),null===t.max?t.max=i:i>t.max&&(t.max=i))})}}),t.handleTickRangeOptions()},getTickLimit:function(){var t=this.options.ticks,i=e.getValueOrDefault(t.fontSize,a.defaultFontSize);return Math.min(t.maxTicksLimit?t.maxTicksLimit:11,Math.ceil(this.drawingArea/(1.5*i)))},convertTicksToLabels:function(){var e=this;t.LinearScaleBase.prototype.convertTicksToLabels.call(e),e.pointLabels=e.chart.data.labels.map(e.options.pointLabels.callback,e)},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},fit:function(){var t,i,n,o,r,l,s,d,u,c,h,f,g=this.options.pointLabels,p=e.getValueOrDefault(g.fontSize,a.defaultFontSize),m=e.getValueOrDefault(g.fontStyle,a.defaultFontStyle),b=e.getValueOrDefault(g.fontFamily,a.defaultFontFamily),v=e.fontString(p,m,b),x=e.min([this.height/2-p-5,this.width/2]),y=this.width,k=0;for(this.ctx.font=v,i=0;i<this.getValueCount();i++){t=this.getPointPosition(i,x),n=this.ctx.measureText(this.pointLabels[i]?this.pointLabels[i]:"").width+5;var S=this.getIndexAngle(i)+Math.PI/2,w=360*S/(2*Math.PI)%360;0===w||180===w?(o=n/2,t.x+o>y&&(y=t.x+o,r=i),t.x-o<k&&(k=t.x-o,s=i)):180>w?t.x+n>y&&(y=t.x+n,r=i):t.x-n<k&&(k=t.x-n,s=i)}u=k,c=Math.ceil(y-this.width),l=this.getIndexAngle(r),d=this.getIndexAngle(s),h=c/Math.sin(l+Math.PI/2),f=u/Math.sin(d+Math.PI/2),h=e.isNumber(h)?h:0,f=e.isNumber(f)?f:0,this.drawingArea=Math.round(x-(f+h)/2),this.setCenterPoint(f,h)},setCenterPoint:function(t,e){var a=this,i=a.width-e-a.drawingArea,n=t+a.drawingArea;a.xCenter=Math.round((n+i)/2+a.left),a.yCenter=Math.round(a.height/2+a.top)},getIndexAngle:function(t){var e=2*Math.PI/this.getValueCount(),a=this.chart.options&&this.chart.options.startAngle?this.chart.options.startAngle:0,i=a*Math.PI*2/360;return t*e-Math.PI/2+i},getDistanceFromCenterForValue:function(t){var e=this;if(null===t)return 0;var a=e.drawingArea/(e.max-e.min);return e.options.reverse?(e.max-t)*a:(t-e.min)*a},getPointPosition:function(t,e){var a=this,i=a.getIndexAngle(t);return{x:Math.round(Math.cos(i)*e)+a.xCenter,y:Math.round(Math.sin(i)*e)+a.yCenter}},getPointPositionForValue:function(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))},getBasePosition:function(){var t=this,e=t.min,a=t.max;return t.getPointPositionForValue(0,t.beginAtZero?0:0>e&&0>a?a:e>0&&a>0?e:0)},draw:function(){var t=this,i=t.options,n=i.gridLines,o=i.ticks,r=i.angleLines,l=i.pointLabels,s=e.getValueOrDefault;if(i.display){var d=t.ctx,u=s(o.fontSize,a.defaultFontSize),c=s(o.fontStyle,a.defaultFontStyle),h=s(o.fontFamily,a.defaultFontFamily),f=e.fontString(u,c,h);if(e.each(t.ticks,function(r,l){if(l>0||i.reverse){var c=t.getDistanceFromCenterForValue(t.ticksAsNumbers[l]),h=t.yCenter-c;if(n.display&&0!==l)if(d.strokeStyle=e.getValueAtIndexOrDefault(n.color,l-1),d.lineWidth=e.getValueAtIndexOrDefault(n.lineWidth,l-1),i.lineArc)d.beginPath(),d.arc(t.xCenter,t.yCenter,c,0,2*Math.PI),d.closePath(),d.stroke();else{d.beginPath();for(var g=0;g<t.getValueCount();g++){var p=t.getPointPosition(g,c);0===g?d.moveTo(p.x,p.y):d.lineTo(p.x,p.y)}d.closePath(),d.stroke()}if(o.display){var m=s(o.fontColor,a.defaultFontColor);if(d.font=f,o.showLabelBackdrop){var b=d.measureText(r).width;d.fillStyle=o.backdropColor,d.fillRect(t.xCenter-b/2-o.backdropPaddingX,h-u/2-o.backdropPaddingY,b+2*o.backdropPaddingX,u+2*o.backdropPaddingY)}d.textAlign="center",d.textBaseline="middle",d.fillStyle=m,d.fillText(r,t.xCenter,h)}}}),!i.lineArc){d.lineWidth=r.lineWidth,d.strokeStyle=r.color;for(var g=t.getDistanceFromCenterForValue(i.reverse?t.min:t.max),p=s(l.fontSize,a.defaultFontSize),m=s(l.fontStyle,a.defaultFontStyle),b=s(l.fontFamily,a.defaultFontFamily),v=e.fontString(p,m,b),x=t.getValueCount()-1;x>=0;x--){if(r.display){var y=t.getPointPosition(x,g);d.beginPath(),d.moveTo(t.xCenter,t.yCenter),d.lineTo(y.x,y.y),d.stroke(),d.closePath()}var k=t.getPointPosition(x,g+5),S=s(l.fontColor,a.defaultFontColor);d.font=v,d.fillStyle=S;var w=t.pointLabels,C=this.getIndexAngle(x)+Math.PI/2,M=360*C/(2*Math.PI)%360;d.textAlign=0===M||180===M?"center":180>M?"left":"right",d.textBaseline=90===M||270===M?"middle":M>270||90>M?"bottom":"top",d.fillText(w[x]?w[x]:"",k.x,k.y)}}}}});t.scaleService.registerScaleType("radialLinear",n,i)}},{}],44:[function(t,e,a){"use strict";var i=t(1);i="function"==typeof i?i:window.moment,e.exports=function(t){var e=t.helpers,a={units:[{name:"millisecond",steps:[1,2,5,10,20,50,100,250,500]},{name:"second",steps:[1,2,5,10,30]},{name:"minute",steps:[1,2,5,10,30]},{name:"hour",steps:[1,2,3,6,12]},{name:"day",steps:[1,2,5]},{name:"week",maxStep:4},{name:"month",maxStep:3},{name:"quarter",maxStep:4},{name:"year",maxStep:!1}]},n={position:"bottom",time:{parser:!1,format:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm:ss a",hour:"MMM D, hA",day:"ll",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"}},ticks:{autoSkip:!1}},o=t.Scale.extend({initialize:function(){if(!i)throw new Error("Chart.js - Moment.js could not be found! You must include it before Chart.js to use the time scale. Download at https://momentjs.com");t.Scale.prototype.initialize.call(this)},getLabelMoment:function(t,e){return null===t||null===e?null:void 0!==this.labelMoments[t]?this.labelMoments[t][e]:null},getLabelDiff:function(t,e){var a=this;return null===t||null===e?null:(void 0===a.labelDiffs&&a.buildLabelDiffs(),void 0!==a.labelDiffs[t]?a.labelDiffs[t][e]:null)},getMomentStartOf:function(t){var e=this;return"week"===e.options.time.unit&&!1!==e.options.time.isoWeekday?t.clone().startOf("isoWeek").isoWeekday(e.options.time.isoWeekday):t.clone().startOf(e.tickUnit)},determineDataLimits:function(){var t=this;t.labelMoments=[];var a=[];t.chart.data.labels&&t.chart.data.labels.length>0?(e.each(t.chart.data.labels,function(e){var i=t.parseTime(e);i.isValid()&&(t.options.time.round&&i.startOf(t.options.time.round),a.push(i))},t),t.firstTick=i.min.call(t,a),t.lastTick=i.max.call(t,a)):(t.firstTick=null,t.lastTick=null),e.each(t.chart.data.datasets,function(n,o){var r=[],l=t.chart.isDatasetVisible(o);"object"==typeof n.data[0]&&null!==n.data[0]?e.each(n.data,function(e){var a=t.parseTime(t.getRightValue(e));a.isValid()&&(t.options.time.round&&a.startOf(t.options.time.round),r.push(a),l&&(t.firstTick=null!==t.firstTick?i.min(t.firstTick,a):a,t.lastTick=null!==t.lastTick?i.max(t.lastTick,a):a))},t):r=a,t.labelMoments.push(r)},t),t.options.time.min&&(t.firstTick=t.parseTime(t.options.time.min)),t.options.time.max&&(t.lastTick=t.parseTime(t.options.time.max)),t.firstTick=(t.firstTick||i()).clone(),t.lastTick=(t.lastTick||i()).clone()},buildLabelDiffs:function(){var t=this;t.labelDiffs=[];var a=[];t.chart.data.labels&&t.chart.data.labels.length>0&&e.each(t.chart.data.labels,function(e){var i=t.parseTime(e);i.isValid()&&(t.options.time.round&&i.startOf(t.options.time.round),a.push(i.diff(t.firstTick,t.tickUnit,!0)))},t),e.each(t.chart.data.datasets,function(i){var n=[];"object"==typeof i.data[0]&&null!==i.data[0]?e.each(i.data,function(e){var a=t.parseTime(t.getRightValue(e));a.isValid()&&(t.options.time.round&&a.startOf(t.options.time.round),n.push(a.diff(t.firstTick,t.tickUnit,!0)))},t):n=a,t.labelDiffs.push(n)},t)},buildTicks:function(){var i=this;i.ctx.save();var n=e.getValueOrDefault(i.options.ticks.fontSize,t.defaults.global.defaultFontSize),o=e.getValueOrDefault(i.options.ticks.fontStyle,t.defaults.global.defaultFontStyle),r=e.getValueOrDefault(i.options.ticks.fontFamily,t.defaults.global.defaultFontFamily),l=e.fontString(n,o,r);if(i.ctx.font=l,i.ticks=[],i.unitScale=1,i.scaleSizeInUnits=0,i.options.time.unit)i.tickUnit=i.options.time.unit||"day",i.displayFormat=i.options.time.displayFormats[i.tickUnit],i.scaleSizeInUnits=i.lastTick.diff(i.firstTick,i.tickUnit,!0),i.unitScale=e.getValueOrDefault(i.options.time.unitStepSize,1);else{var s=i.isHorizontal()?i.width-(i.paddingLeft+i.paddingRight):i.height-(i.paddingTop+i.paddingBottom),d=i.tickFormatFunction(i.firstTick,0,[]),u=i.ctx.measureText(d).width;u=u*Math.cos(e.toRadians(i.options.ticks.maxRotation))+n*Math.sin(e.toRadians(i.options.ticks.maxRotation));var f=s/u;i.tickUnit=i.options.time.minUnit,i.scaleSizeInUnits=i.lastTick.diff(i.firstTick,i.tickUnit,!0),i.displayFormat=i.options.time.displayFormats[i.tickUnit];for(var g=0,p=a.units[g];g<a.units.length;){if(i.unitScale=1,e.isArray(p.steps)&&Math.ceil(i.scaleSizeInUnits/f)<e.max(p.steps)){for(var m=0;m<p.steps.length;++m)if(p.steps[m]>=Math.ceil(i.scaleSizeInUnits/f)){i.unitScale=e.getValueOrDefault(i.options.time.unitStepSize,p.steps[m]);break}break}if(!1===p.maxStep||Math.ceil(i.scaleSizeInUnits/f)<p.maxStep){i.unitScale=e.getValueOrDefault(i.options.time.unitStepSize,Math.ceil(i.scaleSizeInUnits/f));break}++g,p=a.units[g],i.tickUnit=p.name;var b=i.firstTick.diff(i.getMomentStartOf(i.firstTick),i.tickUnit,!0),v=i.getMomentStartOf(i.lastTick.clone().add(1,i.tickUnit)).diff(i.lastTick,i.tickUnit,!0);i.scaleSizeInUnits=i.lastTick.diff(i.firstTick,i.tickUnit,!0)+b+v,i.displayFormat=i.options.time.displayFormats[p.name]}}var x;if(i.options.time.min?x=i.getMomentStartOf(i.firstTick):(i.firstTick=i.getMomentStartOf(i.firstTick),x=i.firstTick),!i.options.time.max){var y=i.getMomentStartOf(i.lastTick),k=y.diff(i.lastTick,i.tickUnit,!0);0>k?i.lastTick=i.getMomentStartOf(i.lastTick.add(1,i.tickUnit)):k>=0&&(i.lastTick=y),i.scaleSizeInUnits=i.lastTick.diff(i.firstTick,i.tickUnit,!0)}i.options.time.displayFormat&&(i.displayFormat=i.options.time.displayFormat),i.ticks.push(i.firstTick.clone());for(var S=1;S<=i.scaleSizeInUnits;++S){var w=x.clone().add(S,i.tickUnit);if(i.options.time.max&&w.diff(i.lastTick,i.tickUnit,!0)>=0)break;S%i.unitScale==0&&i.ticks.push(w)}(0!==i.ticks[i.ticks.length-1].diff(i.lastTick,i.tickUnit)||0===i.scaleSizeInUnits)&&(i.options.time.max?(i.ticks.push(i.lastTick.clone()),i.scaleSizeInUnits=i.lastTick.diff(i.ticks[0],i.tickUnit,!0)):(i.ticks.push(i.lastTick.clone()),i.scaleSizeInUnits=i.lastTick.diff(i.firstTick,i.tickUnit,!0))),i.ctx.restore(),i.labelDiffs=void 0},getLabelForIndex:function(t,e){var a=this,i=a.chart.data.labels&&t<a.chart.data.labels.length?a.chart.data.labels[t]:"";return"object"==typeof a.chart.data.datasets[e].data[0]&&(i=a.getRightValue(a.chart.data.datasets[e].data[t])),a.options.time.tooltipFormat&&(i=a.parseTime(i).format(a.options.time.tooltipFormat)),i},tickFormatFunction:function(t,a,i){var n=t.format(this.displayFormat),o=this.options.ticks,r=e.getValueOrDefault(o.callback,o.userCallback);return r?r(n,a,i):n},convertTicksToLabels:function(){var t=this;t.tickMoments=t.ticks,t.ticks=t.ticks.map(t.tickFormatFunction,t)},getPixelForValue:function(t,e,a){var i=this,n=null;if(void 0!==e&&void 0!==a&&(n=i.getLabelDiff(a,e)),null===n&&(t&&t.isValid||(t=i.parseTime(i.getRightValue(t))),t&&t.isValid&&t.isValid()&&(n=t.diff(i.firstTick,i.tickUnit,!0))),null!==n){var o=0!==n?n/i.scaleSizeInUnits:n;if(i.isHorizontal()){var r=i.width-(i.paddingLeft+i.paddingRight),l=r*o+i.paddingLeft;return i.left+Math.round(l)}var s=i.height-(i.paddingTop+i.paddingBottom),d=s*o+i.paddingTop;return i.top+Math.round(d)}},getPixelForTick:function(t){return this.getPixelForValue(this.tickMoments[t],null,null)},getValueForPixel:function(t){var e=this,a=e.isHorizontal()?e.width-(e.paddingLeft+e.paddingRight):e.height-(e.paddingTop+e.paddingBottom),n=(t-(e.isHorizontal()?e.left+e.paddingLeft:e.top+e.paddingTop))/a;return n*=e.scaleSizeInUnits,e.firstTick.clone().add(i.duration(n,e.tickUnit).asSeconds(),"seconds")},parseTime:function(t){var e=this;return"string"==typeof e.options.time.parser?i(t,e.options.time.parser):"function"==typeof e.options.time.parser?e.options.time.parser(t):"function"==typeof t.getMonth||"number"==typeof t?i(t):t.isValid&&t.isValid()?t:"string"!=typeof e.options.time.format&&e.options.time.format.call?(console.warn("options.time.format is deprecated and replaced by options.time.parser. See http://nnnick.github.io/Chart.js/docs-v2/#scales-time-scale"),e.options.time.format(t)):i(t,e.options.time.format)}});t.scaleService.registerScaleType("time",o,n)}},{1:1}]},{},[7])(7)}),function(t){"use strict";if("object"==typeof exports)module.exports=t("undefined"!=typeof angular?angular:require("angular"),"undefined"!=typeof Chart?Chart:require("chart.js"));else if("function"==typeof define&&define.amd)define(["angular","chart"],t);else{if("undefined"==typeof angular)throw new Error("AngularJS framework needs to be included, see https://angularjs.org/");if("undefined"==typeof Chart)throw new Error("Chart.js library needs to be included, see http://jtblin.github.io/angular-chart.js/");t(angular,Chart)}}(function(t,r){"use strict";function e(){var e={responsive:!0},a={Chart:r,getOptions:function(r){var a=r&&e[r]||{};return t.extend({},e,a)}};this.setOptions=function(r,n){n?e[r]=t.merge(e[r]||{},n):(n=r,e=t.merge(e,n)),t.merge(a.Chart.defaults,e)},this.$get=function(){return a}}function a(e,a){function o(t,r,a){var n=D(t,r);if(C(r)&&k(t,r,a,n)){var o=a[0],c=o.getContext("2d");r.chartGetColor=y(r);var i=b(t,r);F(r),r.chart=new e.Chart(c,{type:t,data:i,options:n}),r.$emit("chart-create",r.chart),A(o,r)}}function c(t,r){return!!(t&&r&&t.length&&r.length)&&(Array.isArray(t[0])?t.length===r.length&&t.every(function(t,e){return t.length===r[e].length}):r.reduce(i,0)>0&&t.length===r.length)}function i(t,r){return t+r}function u(r,e,a){var n={point:void 0,points:void 0};return function(o){var c=r.chart.getElementAtEvent||r.chart.getPointAtEvent,i=r.chart.getElementsAtEvent||r.chart.getPointsAtEvent;if(i){var u=i.call(r.chart,o),l=c?c.call(r.chart,o)[0]:void 0;!1!==a&&(t.equals(n.points,u)||t.equals(n.point,l))||(n.point=l,n.points=u,r[e](u,o,l))}}}function l(a,n){for(var o=t.copy(n.chartColors||e.getOptions(a).chartColors||r.defaults.global.colors),c=o.length<n.chartData.length;o.length<n.chartData.length;)o.push(n.chartGetColor());return c&&(n.chartColors=o),o.map(h)}function h(t){return"string"==typeof t&&"r"===t[0]?f(v(t)):"string"==typeof t&&"#"===t[0]?f(p(t.substr(1))):"object"==typeof t&&null!==t?t:s()}function s(){return f([d(0,255),d(0,255),d(0,255)])}function f(t){var r=t[3]||1;return t=t.slice(0,3),{backgroundColor:g(t,.2),pointBackgroundColor:g(t,r),pointHoverBackgroundColor:g(t,.8),borderColor:g(t,r),pointBorderColor:"#fff",pointHoverBorderColor:g(t,r)}}function d(t,r){return Math.floor(Math.random()*(r-t+1))+t}function g(t,r){return n?"rgb("+t.join(",")+")":"rgba("+t.concat(r).join(",")+")"}function p(t){var r=parseInt(t,16);return[r>>16&255,r>>8&255,255&r]}function v(t){var r=t.match(/^rgba?\(([\d,.]+)\)$/);if(!r)throw new Error("Cannot parse rgb value");return t=r[1].split(","),t.map(Number)}function C(t){return t.chartData&&t.chartData.length}function y(t){return"function"==typeof t.chartGetColor?t.chartGetColor:s}function b(t,r){var e=l(t,r);return Array.isArray(r.chartData[0])?m(r.chartLabels,r.chartData,r.chartSeries||[],e,r.chartDatasetOverride):w(r.chartLabels,r.chartData,e,r.chartDatasetOverride)}function m(r,e,a,n,o){return{labels:r,datasets:e.map(function(r,e){var c=t.extend({},n[e],{label:a[e],data:r});return o&&o.length>=e&&t.merge(c,o[e]),c})}}function w(r,e,a,n){var o={labels:r,datasets:[{data:e,backgroundColor:a.map(function(t){return t.pointBackgroundColor}),hoverBackgroundColor:a.map(function(t){return t.backgroundColor})}]};return n&&t.merge(o.datasets[0],n),o}function D(r,a){return t.extend({},e.getOptions(r),a.chartOptions)}function A(r,e){r.onclick=e.chartClick?u(e,"chartClick",!1):t.noop,r.onmousemove=e.chartHover?u(e,"chartHover",!0):t.noop}function B(t,r){Array.isArray(r.chartData[0])?r.chart.data.datasets.forEach(function(r,e){r.data=t[e]}):r.chart.data.datasets[0].data=t,r.chart.update(),r.$emit("chart-update",r.chart)}function $(t){return!t||Array.isArray(t)&&!t.length||"object"==typeof t&&!Object.keys(t).length}function k(t,r,e,n){return!n.responsive||0!==e[0].clientHeight||(a(function(){o(t,r,e)},50,!1),!1)}function F(t){t.chart&&(t.chart.destroy(),t.$emit("chart-destroy",t.chart))}return function(r){return{restrict:"CA",scope:{chartGetColor:"=?",chartType:"=",chartData:"=?",chartLabels:"=?",chartOptions:"=?",chartSeries:"=?",chartColors:"=?",chartClick:"=?",chartHover:"=?",chartDatasetOverride:"=?"},link:function(e,a){function i(t,n){if(!t||!t.length||Array.isArray(t[0])&&!t[0].length)return void F(e);var i=r||e.chartType;return i?e.chart&&c(t,n)?B(t,e):void o(i,e,a):void 0}function u(n,c){if(!$(n)&&!t.equals(n,c)){var i=r||e.chartType;i&&o(i,e,a)}}function l(r,n){$(r)||t.equals(r,n)||o(r,e,a)}n&&window.G_vmlCanvasManager.initElement(a[0]),e.$watch("chartData",i,!0),e.$watch("chartSeries",u,!0),e.$watch("chartLabels",u,!0),e.$watch("chartOptions",u,!0),e.$watch("chartColors",u,!0),e.$watch("chartDatasetOverride",u,!0),e.$watch("chartType",l,!1),e.$on("$destroy",function(){F(e)}),e.$on("$resize",function(){e.chart&&e.chart.resize()})}}}}r.defaults.global.multiTooltipTemplate="<%if (datasetLabel){%><%=datasetLabel%>: <%}%><%= value %>",r.defaults.global.tooltips.mode="label",r.defaults.global.elements.line.borderWidth=2,r.defaults.global.elements.rectangle.borderWidth=2,r.defaults.global.legend.display=!1,r.defaults.global.colors=["#97BBCD","#DCDCDC","#F7464A","#46BFBD","#FDB45C","#949FB1","#4D5360"];var n="object"==typeof window.G_vmlCanvasManager&&null!==window.G_vmlCanvasManager&&"function"==typeof window.G_vmlCanvasManager.initElement;return n&&(r.defaults.global.animation=!1),t.module("chart.js",[]).provider("ChartJs",e).factory("ChartJsFactory",["ChartJs","$timeout",a]).directive("chartBase",["ChartJsFactory",function(t){return new t}]).directive("chartLine",["ChartJsFactory",function(t){return new t("line")}]).directive("chartBar",["ChartJsFactory",function(t){return new t("bar")}]).directive("chartHorizontalBar",["ChartJsFactory",function(t){return new t("horizontalBar")}]).directive("chartRadar",["ChartJsFactory",function(t){return new t("radar")}]).directive("chartDoughnut",["ChartJsFactory",function(t){return new t("doughnut")}]).directive("chartPie",["ChartJsFactory",function(t){return new t("pie")}]).directive("chartPolarArea",["ChartJsFactory",function(t){return new t("polarArea")}]).directive("chartBubble",["ChartJsFactory",function(t){return new t("bubble")}]).name}),angular.module("angularPayments",[]),angular.module("angularPayments").factory("Common",[function(){var a={};return a.parseExpiry=function(a){var b,c,d,e;return a=a||"",a=a.replace(/\s/g,""),e=a.split("/",2),b=e[0],d=e[1],2===(null!=d?d.length:void 0)&&/^\d+$/.test(d)&&(c=(new Date).getFullYear(),c=c.toString().slice(0,2),d=c+d),b=parseInt(b,10),d=parseInt(d,10),{month:b,year:d}},a}]),angular.module("angularPayments").factory("Cards",[function(){var a=/(\d{1,4})/g,b=/(?:^|\s)(\d{4})$/,c=[{type:"maestro",pattern:/^(5018|5020|5038|6304|6759|676[1-3])/,format:a,inputFormat:b,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"dinersclub",pattern:/^(36|38|30[0-5])/,format:a,inputFormat:b,length:[14],cvcLength:[3],luhn:!0},{type:"laser",pattern:/^(6706|6771|6709)/,format:a,inputFormat:b,length:[16,17,18,19],cvcLength:[3],luhn:!0},{type:"jcb",pattern:/^35/,format:a,inputFormat:b,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^62/,format:a,inputFormat:b,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"discover",pattern:/^(6011|65|64[4-9]|622)/,format:a,inputFormat:b,length:[16],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^5[1-5]/,format:a,inputFormat:b,length:[16],cvcLength:[3],luhn:!0},{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,inputFormat:/^(\d{4}|\d{4}\s\d{6})$/,length:[15],cvcLength:[3,4],luhn:!0},{type:"visa",pattern:/^4/,format:a,inputFormat:b,length:[13,14,15,16],cvcLength:[3],luhn:!0}],d=function(a){var b,d,e;for(a=(a+"").replace(/\D/g,""),d=0,e=c.length;e>d;d++)if(b=c[d],b.pattern.test(a))return b},e=function(a){var b,d,e;for(d=0,e=c.length;e>d;d++)if(b=c[d],b.type===a)return b};return{fromNumber:function(a){return d(a)},fromType:function(a){return e(a)},defaultFormat:function(){return a},defaultInputFormat:function(){return b}}}]),angular.module("angularPayments").factory("_Format",["Cards","Common","$filter",function(a,b,c){var d={},e=function(a){var b;return null!=a.prop("selectionStart")&&a.prop("selectionStart")!==a.prop("selectionEnd")||!("undefined"==typeof document||null===document||null==(b=document.selection)||"function"!=typeof b.createRange||!b.createRange().text)},f=function(b){var c,d,e,f,g,h,i;if(e=String.fromCharCode(b.which),c=angular.element(b.currentTarget),i=c.val(),d=a.fromNumber(i+e),f=(i.replace(/\D/g,"")+e).length,h=16,d&&(h=d.length[d.length.length-1]),!(f>=h)){if(!/^\d+$/.test(e)&&!b.meta&&b.keyCode>=46)return void b.preventDefault();if(null==c.prop("selectionStart")||c.prop("selectionStart")===i.length)return g=a.defaultInputFormat(),d&&(g=d.inputFormat),g.test(i)?(b.preventDefault(),c.val(i+" "+e)):g.test(i+e)?(b.preventDefault(),c.val(i+e+" ")):void 0}},g=function(b){var c,d,f,g;c=angular.element(b.currentTarget),f=String.fromCharCode(b.which),/^\d+$/.test(f)&&(e(c)||(g=(c.val()+f).replace(/\D/g,""),d=a.fromNumber(g),d?g.length<=d.length[d.length.length-1]||b.preventDefault():g.length<=16||b.preventDefault()))},h=function(a){var b,c;return b=angular.element(a.currentTarget),c=b.val(),a.meta||8!==a.which||null!=b.prop("selectionStart")&&b.prop("selectionStart")!==c.length?void 0:/\d\s$/.test(c)&&!a.meta&&a.keyCode>=46?(a.preventDefault(),b.val(c.replace(/\d\s$/,""))):/\s\d?$/.test(c)?(a.preventDefault(),b.val(c.replace(/\s\d?$/,""))):void 0},i=function(b){var c,d,e,f;return(c=a.fromNumber(b))?(e=c.length[c.length.length-1],b=b.replace(/\D/g,""),b=b.slice(0,+e+1||9e9),c.format.global?null!=(f=b.match(c.format))?f.join(" "):void 0:(d=c.format.exec(b),null!=d&&d.shift(),null!=d?d.join(" "):void 0)):b},j=function(a){return setTimeout(function(){var b,c;return b=angular.element(a.target),c=b.val(),c=i(c),b.val(c)})},k=function(a){return null!=a?a.replace(/\s/g,""):a};d.card=function(a,b){a.bind("keypress",g),a.bind("keypress",f),a.bind("keydown",h),a.bind("paste",j),b.$parsers.push(k),b.$formatters.push(i)},_formatCVC=function(a){return $target=angular.element(a.currentTarget),digit=String.fromCharCode(a.which),!/^\d+$/.test(digit)&&!a.meta&&a.keyCode>=46?void a.preventDefault():(val=$target.val()+digit,val.length<=4?void 0:void a.preventDefault())},d.cvc=function(a){a.bind("keypress",_formatCVC)},_restrictExpiry=function(a){var b,c,d;return b=angular.element(a.currentTarget),c=String.fromCharCode(a.which),!/^\d+$/.test(c)&&!a.meta&&a.keyCode>=46?void a.preventDefault():e(b)?void 0:(d=b.val()+c,d=d.replace(/\D/g,""),d.length>6?void a.preventDefault():void 0)},_formatExpiry=function(a){var b,c,d;return c=String.fromCharCode(a.which),!/^\d+$/.test(c)&&!a.meta&&a.keyCode>=46?void a.preventDefault():(b=angular.element(a.currentTarget),d=b.val()+c,/^\d$/.test(d)&&"0"!==d&&"1"!==d?(a.preventDefault(),b.val("0"+d+" / ")):/^\d\d$/.test(d)?(a.preventDefault(),b.val(d+" / ")):void 0)},_formatForwardExpiry=function(a){var b,c,d;return c=String.fromCharCode(a.which),!/^\d+$/.test(c)&&!a.meta&&a.keyCode>=46?void 0:(b=angular.element(a.currentTarget),d=b.val(),/^\d\d$/.test(d)?b.val(d+" / "):void 0)},_formatForwardSlash=function(a){var b,c,d;return c=String.fromCharCode(a.which),"/"===c?(b=angular.element(a.currentTarget),d=b.val(),/^\d$/.test(d)&&"0"!==d?b.val("0"+d+" / "):void 0):void 0},_formatBackExpiry=function(a){var b,c;if(!a.meta&&(b=angular.element(a.currentTarget),c=b.val(),8===a.which&&(null==b.prop("selectionStart")||b.prop("selectionStart")===c.length)))return/\d(\s|\/)+$/.test(c)?(a.preventDefault(),b.val(c.replace(/\d(\s|\/)*$/,""))):/\s\/\s?\d?$/.test(c)?(a.preventDefault(),b.val(c.replace(/\s\/\s?\d?$/,""))):void 0};var l=function(a){if(null!=a){var d=b.parseExpiry(a),e=new Date(d.year,d.month-1);return c("date")(e,"MM/yyyy")}return null},m=function(a){if(null!=a){var d=b.parseExpiry(a),e=new Date(d.year,d.month-1);return c("date")(e,"MM / yyyy")}return null};return d.expiry=function(a,b){a.bind("keypress",_restrictExpiry),a.bind("keypress",_formatExpiry),a.bind("keypress",_formatForwardSlash),a.bind("keypress",_formatForwardExpiry),a.bind("keydown",_formatBackExpiry),b.$parsers.push(l),b.$formatters.push(m)},function(a,b,c){if(!d[a])throw types=Object.keys(d),errstr='Unknown type for formatting: "'+a+'". ',errstr+='Should be one of: "'+types.join('", "')+'"';return d[a](b,c)}}]).directive("paymentsFormat",["$window","_Format",function(a,b){return{restrict:"A",require:"ngModel",link:function(a,c,d,e){b(d.paymentsFormat,c,e)}}}]),angular.module("angularPayments").factory("_Validate",["Cards","Common","$parse",function(a,b,c){var d=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},e=function(a){var b,c,d,e,f,g;for(d=!0,e=0,c=(a+"").split("").reverse(),f=0,g=c.length;g>f;f++)b=c[f],b=parseInt(b,10),(d=!d)&&(b*=2),b>9&&(b-=9),e+=b;return e%10==0},f={};return f.cvc=function(b,e,f,g){var h,i;if(null==b||0==b.length)return!0;if(!/^\d+$/.test(b))return!1;var j;if(g.paymentsTypeModel){j=c(g.paymentsTypeModel)(f)}return j?(h=b.length,d.call(null!=(i=a.fromType(j))?i.cvcLength:void 0,h)>=0):b.length>=3&&b.length<=4},f.card=function(b,f,g,h){var i,j,k;h.paymentsTypeModel&&(k=c(h.paymentsTypeModel));var l=function(){k&&k.assign(g,null),f.$card=null};return null==b||0==b.length?(l(),!0):(b=(b+"").replace(/\s+|-/g,""),/^\d+$/.test(b)&&(i=a.fromNumber(b))?(f.$card=angular.copy(i),k&&k.assign(g,i.type),j=b.length,ret=d.call(i.length,j)>=0&&(!1===i.luhn||e(b)),ret):(l(),!1))},f.expiry=function(a){if(null==a||0==a.length)return!0;obj=b.parseExpiry(a),month=obj.month,year=obj.year;var c,d,e;return!!(month&&year&&/^\d+$/.test(month)&&/^\d+$/.test(year)&&parseInt(month,10)<=12)&&(2===year.length&&(e=(new Date).getFullYear(),e=e.toString().slice(0,2),year=e+year),d=new Date(year,month),c=new Date,d.setMonth(d.getMonth()-1),d.setMonth(d.getMonth()+1,1),d>c)},function(a,b,c,d,e){if(!f[a])throw types=Object.keys(f),errstr='Unknown type for validation: "'+a+'". ',errstr+='Should be one of: "'+types.join('", "')+'"';return f[a](b,c,d,e)}}]).factory("_ValidateWatch",["_Validate",function(a){var b={};return b.cvc=function(b,c,d,e){e.paymentsTypeModel&&d.$watch(e.paymentsTypeModel,function(f,g){if(f!=g){var h=a(b,c.$modelValue,c,d,e);c.$setValidity(b,h)}})},function(a,c,d,e){
return b[a]?b[a](a,c,d,e):void 0}}]).directive("paymentsValidate",["$window","_Validate","_ValidateWatch",function(a,b,c){return{restrict:"A",require:"ngModel",link:function(a,d,e,f){var g=e.paymentsValidate;c(g,f,a,e);var h=function(c){var d=b(g,c,f,a,e);return f.$setValidity(g,d),d?c:void 0};f.$formatters.push(h),f.$parsers.push(h)}}}]),angular.module("angularPayments").directive("stripeForm",["$window","$parse","Common",function(a,b,c){return _getDataToSend=function(a){var b=["number","expMonth","expYear","cvc","name","addressLine1","addressLine2","addressCity","addressState","addressZip","addressCountry"],c=function(a){return a.replace(/([A-Z])/g,function(a){return"_"+a.toLowerCase()})},d={};for(i in b)a.hasOwnProperty(b[i])&&(d[c(b[i])]=angular.copy(a[b[i]]));return d.number=(d.number||"").replace(/ /g,""),d},{restrict:"A",link:function(b,d,e){if(!a.Stripe)throw"stripeForm requires that you have stripe.js installed. Include https://js.stripe.com/v2/ into your html.";var f=angular.element(d);f.bind("submit",function(){expMonthUsed=!!b.expMonth,expYearUsed=!!b.expYear,expMonthUsed&&expYearUsed||(exp=c.parseExpiry(b.expiry),b.expMonth=exp.month,b.expYear=exp.year);var d=f.find("button");d.prop("disabled",!0),f.hasClass("ng-valid")?a.Stripe.createToken(_getDataToSend(b),function(){var a=arguments;b.$apply(function(){b[e.stripeForm].apply(b,a)}),d.prop("disabled",!1)}):(b.$apply(function(){b[e.stripeForm].apply(b,[400,{error:"Invalid form submitted."}])}),d.prop("disabled",!1)),b.expMonth=null,b.expYear=null})}}}]),!function(e){function t(l){if(n[l])return n[l].exports;var o=n[l]={exports:{},id:l,loaded:!1};return e[l].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var o=n(1),s=l(o);angular.module("angularjs-dropdown-multiselect",[]).directive("dmDropdownStaticInclude",["$compile",function(e){"ngInject";return function(t,n,l){var o=l.dmDropdownStaticInclude,s=n.html(o).contents();e(s)(t)}}]).directive("ngDropdownMultiselect",s.default)},function(e,t,n){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}function o(){return{restrict:"AE",scope:{selectedModel:"=",options:"=",extraSettings:"=",events:"=",searchFilter:"=?",translationTexts:"=",disabled:"="},transclude:{toggleDropdown:"?toggleDropdown"},controller:i.default,templateUrl:"app/component/angularjs-dropdown-multiselect.html"}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var s=n(2),i=l(s)},function(e,t){"use strict";function n(e,t){var n=!1;return e.some(function(e){return e===t&&(n=!0,!0)}),n}function l(e,t,n){var l=-1;return e.some(function(e,o){return e[n]===t[n]&&(l=o,!0)}),l}function o(e,t,o,s){"ngInject";function i(){setTimeout(function(){var e=angular.element(t)[0].querySelector(".option");angular.isDefined(e)&&null!=e&&e.focus()},0)}function r(){e.open?e.close():e.open=!0,e.settings.keyboardControls&&e.open&&(1===e.settings.selectionLimit&&e.settings.enableSearch?setTimeout(function(){angular.element(t)[0].querySelector(".searchField").focus()},0):i()),e.settings.enableSearch&&e.open&&setTimeout(function(){angular.element(t)[0].querySelector(".searchField").focus()},0)}function c(t,n){e.setSelectedItem(n,!1,!0),t.stopImmediatePropagation()}function a(){e.open=!1,e.input.searchFilter=e.settings.clearSearchOnClose?"":e.input.searchFilter,e.externalEvents.onClose()}function d(t){e.selectedModel.splice(0,e.selectedModel.length),e.options.forEach(function(n){n[e.settings.groupBy]===t&&e.setSelectedItem(n,!1,!1)}),e.externalEvents.onSelectionChanged()}function u(t){return null!==e.settings.groupByTextProvider?e.settings.groupByTextProvider(t):t}function g(e){var n=t.find("button"),l=document.createElement("canvas"),o=l.getContext("2d");return o.font=n.css("font-size")+n.css("font-family"),o.originalFont=n.css("font-size")+n.css("font-family"),o.fillStyle="#000000",o.measureText(e).width}function p(){if(e.settings.dynamicTitle&&e.selectedModel&&e.selectedModel.length>0){if(angular.isFunction(e.settings.smartButtonTextProvider))return e.settings.smartButtonTextProvider(e.selectedModel);if(e.settings.smartButtonMaxItems>0){var n=24,l=2,o=8,s=t[0].offsetWidth-n-l-o,i=[];angular.forEach(e.options,function(t){if(e.isChecked(t)){var n=e.getPropertyForObject(t,e.settings.displayProp),l=e.settings.smartButtonTextConverter(n,t);i.push(l||n)}}),e.selectedModel.length>e.settings.smartButtonMaxItems&&(i=i.slice(0,e.settings.smartButtonMaxItems),i.push("..."));var r=i.join(", "),c=r.length-4;if(0===t[0].offsetWidth)return r;if(s<=g("..."))return"...";for(;g(r)>s;)"..."!==i[i.length-1]&&(i.push("..."),r+="...",c=r.length-4),r=r.slice(0,c)+r.slice(c+1),c-=1;return r}var a=angular.isDefined(e.selectedModel)?e.selectedModel.length:0;return 0===a?e.texts.buttonDefaultText:e.settings.showAllSelectedText&&a===e.options.length?e.texts.allSelectedText:a+" "+e.texts.dynamicButtonTextSuffix}return e.texts.buttonDefaultText}function h(e,t){return angular.isDefined(e)&&Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function f(){e.deselectAll(!0),e.externalEvents.onSelectAll();var t=o("filter")(e.options,e.getFilter(e.input.searchFilter));angular.forEach(t,function(t){e.setSelectedItem(t,!0,!1)}),e.externalEvents.onSelectionChanged(),e.selectedGroup=null}function m(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t||e.externalEvents.onDeselectAll(),e.selectedModel.splice(0,e.selectedModel.length),t||e.externalEvents.onSelectionChanged(),e.selectedGroup=null}function y(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments[2],s=void 0,i=void 0;angular.isDefined(A.idProperty)?(s=-1!==l(e.selectedModel,t,A.idProperty),i=l(e.selectedModel,t,A.idProperty)):(s=-1!==e.selectedModel.indexOf(t),i=e.selectedModel.indexOf(t)),!n&&s?(e.selectedModel.splice(i,1),e.externalEvents.onItemDeselect(t),e.settings.closeOnDeselect&&e.close()):!s&&(0===e.settings.selectionLimit||e.selectedModel.length<e.settings.selectionLimit)?(e.selectedModel.push(t),o&&e.externalEvents.onItemSelect(t),e.settings.closeOnSelect&&e.close(),e.settings.selectionLimit>0&&e.selectedModel.length===e.settings.selectionLimit&&e.externalEvents.onMaxSelectionReached()):1!==e.settings.selectionLimit||s||e.selectedModel.length!==e.settings.selectionLimit||(e.selectedModel.splice(0,1),e.selectedModel.push(t),o&&e.externalEvents.onItemSelect(t),e.settings.closeOnSelect&&e.close()),o&&e.externalEvents.onSelectionChanged(),e.selectedGroup=null}function v(t){return angular.isDefined(A.idProperty)?-1!==l(e.selectedModel,t,A.idProperty):-1!==e.selectedModel.indexOf(t)}function k(t){var n=angular.element(t.target).scope(),l=void 0,o=t.target.parentNode;if(e.settings.keyboardControls)if(13===t.keyCode||32===t.keyCode)t.preventDefault(),n.option?e.setSelectedItem(n.option,!1,!0):"deselectAll"===t.target.id?e.deselectAll():"selectAll"===t.target.id&&e.selectAll();else if(38===t.keyCode){for(t.preventDefault(),o.previousElementSibling&&(l=o.previousElementSibling.querySelector("a")||o.previousElementSibling.querySelector("input"));!l&&o;)(o=o.previousElementSibling)&&(l=o.querySelector("a")||o.querySelector("input"));l&&l.focus()}else if(40===t.keyCode){for(t.preventDefault(),o.nextElementSibling&&(l=o.nextElementSibling.querySelector("a")||o.nextElementSibling.querySelector("input"));!l&&o;)(o=o.nextElementSibling)&&(l=o.querySelector("a")||o.querySelector("input"));l&&l.focus()}else 27===t.keyCode&&(t.preventDefault(),e.toggleDropdown())}function b(t){var n=t.target.parentNode.parentNode,l=void 0;if(e.settings.keyboardControls)if(9===t.keyCode||40===t.keyCode)t.preventDefault(),i();else if(38===t.keyCode){for(t.preventDefault(),n.previousElementSibling&&(l=n.previousElementSibling.querySelector("a")||n.previousElementSibling.querySelector("input"));!l&&n;)(n=n.previousElementSibling)&&(l=n.querySelector("a")||n.querySelector("input"));l&&l.focus()}else 27===t.keyCode&&(t.preventDefault(),e.toggleDropdown())}function x(t,n){var l=void 0;e.settings.keyboardControls&&13===t.keyCode&&(1===e.settings.selectionLimit&&e.settings.enableSearch?(l=o("filter")(e.options,e.getFilter(n)),1===l.length&&e.setSelectedItem(l[0],!1,!0)):e.settings.enableSearch&&e.selectAll())}function S(t){var n={};return n[e.settings.searchField]=t,n}function w(t){t&&t.stopPropagation(),e.settings.enableSearch=!e.settings.enableSearch,e.settings.enableSearch||(e.input.searchFilter="")}function C(){e.settings.keyboardControls&&13===event.keyCode&&(e.toggleSearch(),e.settings.enableSearch?setTimeout(function(){angular.element(t)[0].querySelector(".searchField").focus()},0):i())}function D(t,n){if(angular.isUndefined(n))return-1;if(angular.isUndefined(t))return 1;if("object"!==t.type||"object"!==n.type)return t.index<n.index?-1:1;var l=t.value,o=n.value;return e.settings.groupBy&&l[e.settings.groupBy]!==o[e.settings.groupBy]?l[e.settings.groupBy]<o[e.settings.groupBy]?1:-1:e.settings.selectedToTop?!e.isChecked(l)&&!e.isChecked(o)||e.isChecked(l)&&e.isChecked(o)?e.options.indexOf(l)<e.options.indexOf(o)?-1:1:e.isChecked(l)?-1:1:e.options.indexOf(l)<e.options.indexOf(o)?-1:1}var B=t.children()[0],E={onItemSelect:angular.noop,onItemDeselect:angular.noop,onSelectAll:angular.noop,onDeselectAll:angular.noop,onInitDone:angular.noop,onMaxSelectionReached:angular.noop,onSelectionChanged:angular.noop,onClose:angular.noop},A={dynamicTitle:!0,scrollable:!1,scrollableHeight:"300px",closeOnBlur:!0,displayProp:"label",enableSearch:!1,clearSearchOnClose:!1,selectionLimit:0,showCheckAll:!0,showUncheckAll:!0,showEnableSearchButton:!1,closeOnSelect:!1,buttonClasses:"btn btn-default",closeOnDeselect:!1,groupBy:void 0,checkBoxes:!1,groupByTextProvider:null,smartButtonMaxItems:0,smartButtonTextConverter:angular.noop,styleActive:!1,selectedToTop:!1,keyboardControls:!1,template:"{{getPropertyForObject(option, settings.displayProp)}}",searchField:"$",showAllSelectedText:!1},M={checkAll:"Check All",uncheckAll:"Uncheck All",selectionCount:"checked",selectionOf:"/",searchPlaceholder:"Search...",buttonDefaultText:"Select",dynamicButtonTextSuffix:"checked",disableSearch:"Disable search",enableSearch:"Enable search",selectGroup:"Select all:",allSelectedText:"All"},T={searchFilter:e.searchFilter||""};angular.extend(A,e.extraSettings||[]),angular.extend(E,e.events||[]),angular.extend(M,e.translationTexts),A.closeOnBlur&&s.on("click",function(t){if(e.open){for(var l=t.target.parentElement,o=!1;angular.isDefined(l)&&null!==l&&!o;)l.className.split&&n(l.className.split(" "),"multiselect-parent")&&!o&&l===B&&(o=!0),l=l.parentElement;o||e.$apply(function(){e.close()})}}),angular.extend(e,{toggleDropdown:r,checkboxClick:c,externalEvents:E,settings:A,texts:M,input:T,close:a,selectCurrentGroup:d,getGroupLabel:u,getButtonText:p,getPropertyForObject:h,selectAll:f,deselectAll:m,setSelectedItem:y,isChecked:v,keyDownLink:k,keyDownSearchDefault:b,keyDownSearch:x,getFilter:S,toggleSearch:w,keyDownToggleSearch:C,orderFunction:D}),e.externalEvents.onInitDone()}o.$inject=["$scope","$element","$filter","$document"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=o}]),angular.module("angularjs-dropdown-multiselect").run(["$templateCache",function(e){e.put("app/component/angularjs-dropdown-multiselect.html",'<div class="multiselect-parent btn-group dropdown-multiselect" ng-class="{open: open}"><div ng-transclude=toggleDropdown ng-click=toggleDropdown()><button ng-disabled=disabled type=button class=dropdown-toggle ng-class=settings.buttonClasses>{{getButtonText()}}&nbsp;<span class=caret></span></button></div><ul class="dropdown-menu dropdown-menu-form" ng-if=open ng-style="{display: open ? \'block\' : \'none\', height : settings.scrollable ? settings.scrollableHeight : \'auto\', overflow: \'auto\' }"><li ng-if="settings.showCheckAll && settings.selectionLimit === 0"><a ng-keydown=keyDownLink($event) data-ng-click=selectAll() tabindex=-1 id=selectAll><span class="glyphicon glyphicon-ok"></span> {{texts.checkAll}}</a></li><li ng-if=settings.showUncheckAll><a ng-keydown=keyDownLink($event) data-ng-click=deselectAll(); tabindex=-1 id=deselectAll><span class="glyphicon glyphicon-remove"></span> {{texts.uncheckAll}}</a></li><li ng-if="settings.selectByGroups && ((settings.showCheckAll && settings.selectionLimit > 0) || settings.showUncheckAll)" class=divider></li><li ng-repeat="currentGroup in settings.selectByGroups track by $index" ng-click=selectCurrentGroup(currentGroup)><a ng-class="{\'dropdown-selected-group\': selectedGroup === currentGroup}" tabindex=-1>{{::texts.selectGroup}} {{::getGroupLabel(currentGroup)}}</a></li><li ng-if="settings.selectByGroups && settings.showEnableSearchButton" class=divider></li><li ng-if="settings.showEnableSearchButton && settings.enableSearch"><a ng-keydown="keyDownLink($event); keyDownToggleSearch();" ng-click=toggleSearch($event); tabindex=-1>{{texts.disableSearch}}</a></li><li ng-if="settings.showEnableSearchButton && !settings.enableSearch"><a ng-keydown="keyDownLink($event); keyDownToggleSearch();" ng-click=toggleSearch($event); tabindex=-1>{{texts.enableSearch}}</a></li><li ng-if="(settings.showCheckAll && settings.selectionLimit > 0) || settings.showUncheckAll || settings.showEnableSearchButton" class=divider></li><li ng-if=settings.enableSearch><div class=dropdown-header><input type=text class="form-control searchField" ng-keydown="keyDownSearchDefault($event); keyDownSearch($event, input.searchFilter);" ng-style="{width: \'100%\'}" ng-model=input.searchFilter placeholder={{texts.searchPlaceholder}}></div></li><li ng-if=settings.enableSearch class=divider></li><li ng-if=settings.groupBy ng-repeat-start="option in orderedItems = ( options | filter:getFilter(input.searchFilter) | orderBy:\'\':false:orderFunction)" ng-show="getPropertyForObject(option, settings.groupBy) !== getPropertyForObject(orderedItems[$index - 1], settings.groupBy)" role=presentation class=dropdown-header>{{ getGroupLabel(getPropertyForObject(option, settings.groupBy)) }}</li><li ng-if=settings.groupBy ng-class="{\'active\': isChecked(option) && settings.styleActive}" ng-repeat-end role=presentation><a ng-keydown="option.disabled || keyDownLink($event)" role=menuitem class=option tabindex=-1 ng-click="option.disabled || setSelectedItem(option, false, true)" ng-disabled=option.disabled><div ng-if=settings.checkBoxes class=checkbox><label><input class=checkboxInput type=checkbox ng-click="checkboxClick($event, option)" ng-checked=isChecked(option)> <span dm-dropdown-static-include={{settings.template}}></span></label></div><span ng-if=!settings.checkBoxes data-ng-class="{\'glyphicon glyphicon-ok\': isChecked(option)}"></span> <span dm-dropdown-static-include={{settings.template}}></span></a></li><li ng-if=!settings.groupBy ng-class="{\'active\': isChecked(option) && settings.styleActive}" role=presentation ng-repeat="option in options | filter:getFilter(input.searchFilter) | orderBy:\'\':false:orderFunction"><a ng-keydown="option.disabled || keyDownLink($event)" role=menuitem class=option tabindex=-1 ng-click="option.disabled || setSelectedItem(option, false, true)" ng-disabled=option.disabled><div ng-if=settings.checkBoxes class=checkbox><label><input class=checkboxInput type=checkbox ng-click="checkboxClick($event, option)" ng-checked=isChecked(option)> <span dm-dropdown-static-include={{settings.template}}></span></label></div><span ng-if=!settings.checkBoxes data-ng-class="{\'glyphicon glyphicon-ok\': isChecked(option)}"></span> <span ng-if=!settings.checkBoxes dm-dropdown-static-include={{settings.template}}></span></a></li><li class=divider ng-show="settings.selectionLimit > 1"></li><li role=presentation ng-show="settings.selectionLimit > 1"><a role=menuitem>{{selectedModel.length}} {{texts.selectionOf}} {{settings.selectionLimit}} {{texts.selectionCount}}</a></li></ul></div>')}]),function(){"use strict";var alertService=function(SweetAlert){var appServiceFactory={};return appServiceFactory.showAlertTimeout=function(){SweetAlert.swal({title:"Session timeout",text:"Your session is expired."})},appServiceFactory.showSuccessText=function(title,text){SweetAlert.swal({title:title||"Successful",text:text,type:"success"})},appServiceFactory.successfullySent=function(title){SweetAlert.swal({title:title||"Successful",type:"success",showConfirmButton:!1,timer:1500})},appServiceFactory.showAlertSave=function(title,text){SweetAlert.swal({title:"Saved",type:"success",showConfirmButton:!1,timer:1e3})},appServiceFactory.showAlertExtendedDate=function(title,text){SweetAlert.swal({title:"Date extended",type:"success",showConfirmButton:!1,timer:1e3})},appServiceFactory.showAPIError=function(err,text){SweetAlert.swal({title:err.message,text:text||"",showConfirmButton:!1,type:"error",timer:3e3})},appServiceFactory.showError=function(title){SweetAlert.swal({title:title,showConfirmButton:!1,type:"error",timer:3e3})},appServiceFactory.showErrorInvitation=function(err,text){SweetAlert.swal({title:err||"",text:text||"",showConfirmButton:!1,type:"error",timer:4e3})},appServiceFactory};alertService.$inject=["SweetAlert"],angular.module("inspinia").factory("alertService",alertService)}(),function(){"use strict";var api=function(appConfig,$http,$injector){function getAuthConfig(){var config={};config.headers={};var auth=$injector.get("auth");return auth.authentication.isLogged?config.headers.Authorization="Bearer "+auth.authentication.token:config.headers.Authorization=appConfig.apiAuthorization,config}var serviceBase=appConfig.apiDomain,serviceFactory={};return serviceFactory.get_settings=function(model){return $http.post(serviceBase+"rb/get_public_settings",model,getAuthConfig())},serviceFactory.auth_login=function(model){return $http.post(serviceBase+"auth/login",model,getAuthConfig())},serviceFactory.get_pos_list=function(){return $http.get(serviceBase+"rb/get_pos_list",getAuthConfig())},serviceFactory.rb_subscriptions=function(){return $http.get(serviceBase+"rb/subscriptions",getAuthConfig())},serviceFactory.reset_password=function(model){return $http.post(serviceBase+"users/reset_password",model,getAuthConfig())},serviceFactory.get_restaurants=function(model){var auth=$injector.get("auth");return $http({method:"GET",url:serviceBase+"restaurants",headers:{Authorization:"Bearer "+auth.authentication.token},params:model})},serviceFactory.get_refbooks=function(model){return $http.post(serviceBase+"rb/get_refbooks",model,getAuthConfig())},serviceFactory.users_registration=function(model){return $http.post(serviceBase+"users/registration",model,getAuthConfig())},serviceFactory.create_restaurant=function(model){return $http.post(serviceBase+"restaurants",model,getAuthConfig())},serviceFactory.update_restaurant=function(model,id){return $http.put(serviceBase+"restaurants/"+id,model,getAuthConfig())},serviceFactory.get_restaurant=function(id){return $http.get(serviceBase+"restaurants/"+id,getAuthConfig())},serviceFactory.users_invite=function(model){return $http.post(serviceBase+"users/invite",model,getAuthConfig())},serviceFactory.locations_lookup=function(model){return $http.post(serviceBase+"rb/locations_lookup",model,getAuthConfig())},serviceFactory.contact_us=function(model){return $http.post(serviceBase+"users/contact_us",model,getAuthConfig())},serviceFactory.get_invite_info=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"users/get_invite_info",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.redeem_invitation=function(model){return $http.post(serviceBase+"users/redeem_invitation",model,getAuthConfig())},serviceFactory.check_if_employee_exists=function(id){return $http.get(serviceBase+"restaurants/"+id+"/employees",getAuthConfig())},serviceFactory.change_restaurant_employee_status=function(id,model){return $http.put(serviceBase+"restaurants/"+id+"/employees",model,getAuthConfig())},serviceFactory.delete_invite=function(id,model){return $injector.get("auth"),$http({method:"DELETE",url:serviceBase+"restaurants/"+id+"/invited",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.set_active_restaurant=function(model){return $http.post(serviceBase+"users/set_active_restaurant",model,getAuthConfig())},serviceFactory.get_vendors=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"vendors",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.get_credit_card_checker=function(model){return $injector.get("auth"),$http({method:"GET",url:appConfig.apiBincodesDomain+"cc/",params:model})},serviceFactory.get_chosen_vendors=function(id,model){return $injector.get("auth"),$http({method:"GET",headers:{Authorization:appConfig.apiAuthorization},url:serviceBase+"restaurants/"+id+"/vendors",params:model})},serviceFactory.add_new_vendor=function(id,model){return $http.post(serviceBase+"restaurants/"+id+"/addVendor",model,getAuthConfig())},serviceFactory.add_vendor=function(id,model){return $http.put(serviceBase+"restaurants/"+id+"/vendors",model,getAuthConfig())},serviceFactory.add_inventory=function(id,model){return $http.put(serviceBase+"restaurants/"+id+"/vendors_sku",model,getAuthConfig())},serviceFactory.get_inventory_by_vendor=function(model,id){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"vendors/"+id+"/inventory",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.get_active_inventory_by_vendor=function(model,id){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"restaurants/"+id+"/vendors_sku",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.update_user_info=function(id,model){return $http.put(serviceBase+"users/"+id,model,getAuthConfig())},serviceFactory.get_user_info=function(id){return $http.get(serviceBase+"users/"+id,getAuthConfig())},serviceFactory.save_recipe=function(model){return $http.post(serviceBase+"recipes",model,getAuthConfig())},serviceFactory.get_recipes=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"recipes",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.get_recipes_setup_process=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"recipes",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.get_recipe=function(id){return $http.get(serviceBase+"recipes/"+id,getAuthConfig())},serviceFactory.delete_recipe=function(id){return $http.delete(serviceBase+"recipes/"+id,getAuthConfig())},serviceFactory.update_recipe=function(id,model){return $http.put(serviceBase+"recipes/"+id,model,getAuthConfig())},serviceFactory.get_menus=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"menus",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.save_menu=function(model){return $http.post(serviceBase+"menus",model,getAuthConfig())},serviceFactory.update_mapping=function(model){return $http.get(serviceBase+"system/update_Mapping",getAuthConfig())},serviceFactory.update_menu=function(id,model){return $http.put(serviceBase+"menus/"+id,model,getAuthConfig())},serviceFactory.update_PLs=function(oldname_and_newname){return $http.put(serviceBase+"menus/"+oldname_and_newname,getAuthConfig())},serviceFactory.get_menu_by_id=function(id){return $http.get(serviceBase+"menus/"+id,getAuthConfig())},serviceFactory.get_menu_by_name_and_pricing_level=function(name_and_pricing_level){return $http.get(serviceBase+"menus/"+name_and_pricing_level,getAuthConfig())},serviceFactory.delete_menu=function(id){return $http.delete(serviceBase+"menus/"+id,getAuthConfig())},serviceFactory.checkIfSold=function(id){return $http.get(serviceBase+"menus/"+id+"/checkIfSold",getAuthConfig())},serviceFactory.delivery_schedules=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"delivery_schedules",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.save_delivery=function(model){return $http.post(serviceBase+"delivery_schedules",model,getAuthConfig())},serviceFactory.update_delivery=function(id,model){return $http.put(serviceBase+"delivery_schedules/"+id,model,getAuthConfig())},serviceFactory.delete_delivery=function(id){return $http.delete(serviceBase+"delivery_schedules/"+id,getAuthConfig())},serviceFactory.get_vendors_categories=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"vendors/get_vendors_categories",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.get_omnivore_location=function(id){return $http.get(serviceBase+"pos/omnivore/locations/"+id,getAuthConfig())},serviceFactory.get_inventory_audit=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"inventory",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.update_inventory_audit=function(model){return $http.put(serviceBase+"inventory",model,getAuthConfig())},serviceFactory.brand_lookup=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"rb/brand_lookup",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.vendors_sku=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"vendors/sku",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.add_update_own_inventory=function(id,model){return $http.post(serviceBase+"vendors/"+id+"/inventory",model,getAuthConfig())},serviceFactory.delete_my_sku=function(vendor_id,sku_id){return $http.delete(serviceBase+"vendors/"+vendor_id+"/inventory/"+sku_id,getAuthConfig())},serviceFactory.get_modules=function(model){return $http.post(serviceBase+"rb/get_modules",model,getAuthConfig())},serviceFactory.get_measure_units=function(model){return $http.post(serviceBase+"rb/uom_conformity",model,getAuthConfig())},serviceFactory.getItemsForMap=function(id,model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"restaurants/"+id+"/report",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.setItemsForMap=function(id,model){return $http.post(serviceBase+"restaurants/"+id+"/report_items_match",model,getAuthConfig())},serviceFactory.report_items_match=function(id){return $http.get(serviceBase+"restaurants/"+id+"/report_items_match",getAuthConfig())},serviceFactory.update_csv_path=function(id,model){return $http.put(serviceBase+"restaurants/"+id+"/updateCsvPath",model,getAuthConfig())},serviceFactory.bar_serving_details=function(id){return $http.get(serviceBase+"restaurants/"+id+"/bar_serving_details",getAuthConfig())},serviceFactory.save_bar_serving_details=function(model){return $http.post(serviceBase+"restaurants/bar_serving_details",model,getAuthConfig())},serviceFactory.get_analytics_answers=function(id){return $http.get(serviceBase+"restaurants/"+id+"/analytics_answers",getAuthConfig())},serviceFactory.set_analytics_answers=function(model){return $http.post(serviceBase+"restaurants/analytics_answers",model,getAuthConfig())},serviceFactory.get_feedback_stack=function(id){return $http.get(serviceBase+"restaurants/"+id+"/feedback_stack",getAuthConfig())},serviceFactory.set_feedback=function(model){return $http.post(serviceBase+"restaurants/feedback_stack",model,getAuthConfig())},serviceFactory.get_restaurant_location_details=function(id){return $http.get(serviceBase+"restaurants/"+id+"/locn_details",getAuthConfig())},serviceFactory.get_event_categories=function(id){return $http.get(serviceBase+"restaurants/"+id+"/event_categories",getAuthConfig())},serviceFactory.get_events=function(id_category){return $http.get(serviceBase+"restaurants/"+id_category+"/events",getAuthConfig())},serviceFactory.set_events=function(model){return $http.post(serviceBase+"restaurants/events",model,getAuthConfig())},serviceFactory.get_scores=function(id){return $http.get(serviceBase+"restaurants/"+id+"/performance_score",getAuthConfig())},serviceFactory.calc_scores=function(id){return $http.get(serviceBase+"restaurants/"+id+"/performance_score_calc",getAuthConfig())},serviceFactory.get_order=function(id,model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"orders/"+id,headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.get_orders=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"orders",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.create_order=function(model){return $http.post(serviceBase+"orders",model,getAuthConfig())},serviceFactory.add_extra_order_items=function(model){return $http.post(serviceBase+"orders/add_extra_order_items",model,getAuthConfig())},serviceFactory.update_order=function(model,id){return $http.put(serviceBase+"orders/"+id,model,getAuthConfig())},serviceFactory.update_orders=function(model){return $http.put(serviceBase+"orders",model,getAuthConfig())},serviceFactory.delete_order=function(id){return $http.delete(serviceBase+"orders/"+id,getAuthConfig())},serviceFactory.inventory_usage_report=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"inventory/usage_report",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.sales_data=function(model){return $http.post(serviceBase+"restaurants/sales_data",model,getAuthConfig())},serviceFactory.bar_chart_api=function(model){return $http.post(serviceBase+"restaurants/bar_chart_api",model,getAuthConfig())},serviceFactory.lateral_chart_api=function(model){return $http.post(serviceBase+"restaurants/lateral_chart_api",model,getAuthConfig())},serviceFactory.salesVsCost=function(model){return $http.post(serviceBase+"restaurants/salesVsCost",model,getAuthConfig())},serviceFactory.PieChart=function(model){return $http.post(serviceBase+"restaurants/PieChart",model,getAuthConfig())},serviceFactory.alcohol=function(model){return $http.post(serviceBase+"restaurants/Alcohol",model,getAuthConfig())},serviceFactory.get_suggested_orders=function(model){return $http.post(serviceBase+"restaurants/get_suggested_orders",model,getAuthConfig())},serviceFactory.get_full_audit_variance=function(model){return $http.post(serviceBase+"restaurants/get_full_audit_variance",model,getAuthConfig())},serviceFactory.get_adjustment_variance=function(model){return $http.post(serviceBase+"restaurants/get_adjustment_variance",model,getAuthConfig())},serviceFactory.payment_call=function(model){return $http.post(serviceBase+"restaurants/payment_call",model,getAuthConfig())},serviceFactory.process_suggested_order_item=function(model){return $http.post(serviceBase+"restaurants/process_suggested_order_item",model,getAuthConfig())},serviceFactory};api.$inject=["appConfig","$http","$injector"],angular.module("inspinia").factory("api",api)}(),function(){"use strict";var api=function(appConfig,$http,$injector){function getAuthConfig(){var config={};config.headers={};var auth=$injector.get("auth");return auth.authentication.isLogged?config.headers.Authorization="Bearer "+auth.authentication.token:config.headers.Authorization=appConfig.apiAuthorization,config}var serviceBase=appConfig.apiDomain,serviceFactory={};return serviceFactory.get_settings=function(model){return $http.post(serviceBase+"rb/get_public_settings",model,getAuthConfig())},serviceFactory.auth_login=function(model){return $http.post(serviceBase+"auth/login",model,getAuthConfig())},serviceFactory.get_pos_list=function(){return $http.get(serviceBase+"rb/get_pos_list",getAuthConfig())},serviceFactory.get_promo_ref=function(){return $http.get(serviceBase+"rb/get_promo_ref",getAuthConfig())},serviceFactory.rb_subscriptions=function(){return $http.get(serviceBase+"rb/subscriptions",getAuthConfig())},serviceFactory.reset_password=function(model){return $http.post(serviceBase+"users/reset_password",model,getAuthConfig())},serviceFactory.get_restaurants=function(model){
var auth=$injector.get("auth");return $http({method:"GET",url:serviceBase+"restaurants",headers:{Authorization:"Bearer "+auth.authentication.token},params:model})},serviceFactory.get_refbooks=function(model){return $http.post(serviceBase+"rb/get_refbooks",model,getAuthConfig())},serviceFactory.users_registration=function(model){return $http.post(serviceBase+"users/registration",model,getAuthConfig())},serviceFactory.create_restaurant=function(model){return $http.post(serviceBase+"restaurants",model,getAuthConfig())},serviceFactory.update_restaurant=function(model,id){return $http.put(serviceBase+"restaurants/"+id,model,getAuthConfig())},serviceFactory.get_restaurant=function(id){return $http.get(serviceBase+"restaurants/"+id,getAuthConfig())},serviceFactory.users_invite=function(model){return $http.post(serviceBase+"users/invite",model,getAuthConfig())},serviceFactory.locations_lookup=function(model){return $http.post(serviceBase+"rb/locations_lookup",model,getAuthConfig())},serviceFactory.contact_us=function(model){return $http.post(serviceBase+"users/contact_us",model,getAuthConfig())},serviceFactory.get_invite_info=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"users/get_invite_info",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.redeem_invitation=function(model){return $http.post(serviceBase+"users/redeem_invitation",model,getAuthConfig())},serviceFactory.check_if_employee_exists=function(id){return $http.get(serviceBase+"restaurants/"+id+"/employees",getAuthConfig())},serviceFactory.change_restaurant_employee_status=function(id,model){return $http.put(serviceBase+"restaurants/"+id+"/employees",model,getAuthConfig())},serviceFactory.delete_invite=function(id,model){return $injector.get("auth"),$http({method:"DELETE",url:serviceBase+"restaurants/"+id+"/invited",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.set_active_restaurant=function(model){return $http.post(serviceBase+"users/set_active_restaurant",model,getAuthConfig())},serviceFactory.get_vendors=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"vendors",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.get_credit_card_checker=function(model){return $injector.get("auth"),$http({method:"GET",url:appConfig.apiBincodesDomain+"cc/",params:model})},serviceFactory.get_chosen_vendors=function(id,model){return $injector.get("auth"),$http({method:"GET",headers:{Authorization:appConfig.apiAuthorization},url:serviceBase+"restaurants/"+id+"/vendors",params:model})},serviceFactory.get_global_vendors=function(model){return $http.post(serviceBase+"restaurants/global_vendors",model,getAuthConfig())},serviceFactory.add_new_vendor=function(id,model){return $http.post(serviceBase+"restaurants/"+id+"/addVendor",model,getAuthConfig())},serviceFactory.get_vendor_by_id=function(id){return $http.get(serviceBase+"restaurants/getVendorDetails/"+id,getAuthConfig())},serviceFactory.update_vendor_details=function(id,model){return $http.post(serviceBase+"restaurants/updateVendorDetails/"+id,model,getAuthConfig())},serviceFactory.add_vendor=function(id,model){return $http.put(serviceBase+"restaurants/"+id+"/vendors",model,getAuthConfig())},serviceFactory.add_inventory=function(id,model){return $http.put(serviceBase+"restaurants/"+id+"/vendors_sku",model,getAuthConfig())},serviceFactory.get_inventory_by_vendor=function(model,id){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"vendors/"+id+"/inventory",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.get_active_inventory_by_vendor=function(model,id){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"restaurants/"+id+"/vendors_sku",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.update_user_info=function(id,model){return $http.put(serviceBase+"users/"+id,model,getAuthConfig())},serviceFactory.get_user_info=function(id){return $http.get(serviceBase+"users/"+id,getAuthConfig())},serviceFactory.save_recipe=function(model){return $http.post(serviceBase+"recipes",model,getAuthConfig())},serviceFactory.get_recipes=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"recipes",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.upload_recipe_image=function(model){return $http.post(serviceBase+"recipes/upload_recipe_image",model,getAuthConfig())},serviceFactory.get_recipes_setup_process=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"recipes",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.get_recipe=function(id){return $http.get(serviceBase+"recipes/"+id,getAuthConfig())},serviceFactory.get_menus_using_this_recipe=function(id){return $http.get(serviceBase+"recipes/getMenusUsingRecipe/"+id,getAuthConfig())},serviceFactory.get_recipes_using_this_sub_recipe=function(id){return $http.get(serviceBase+"recipes/getRecipesUsingSubRecipe/"+id,getAuthConfig())},serviceFactory.act_deact_recipe=function(model){return $http.post(serviceBase+"recipes/act_deact_recipe/",model,getAuthConfig())},serviceFactory.delete_recipe=function(id){return $http.delete(serviceBase+"recipes/"+id,getAuthConfig())},serviceFactory.update_recipe=function(id,model){return $http.put(serviceBase+"recipes/"+id,model,getAuthConfig())},serviceFactory.get_menus=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"menus",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.save_menu=function(model){return $http.post(serviceBase+"menus",model,getAuthConfig())},serviceFactory.update_mapping=function(model){return $http.get(serviceBase+"system/update_Mapping",getAuthConfig())},serviceFactory.update_menu=function(id,model){return $http.put(serviceBase+"menus/"+id,model,getAuthConfig())},serviceFactory.update_PLs=function(oldname_and_newname){return $http.put(serviceBase+"menus/"+oldname_and_newname,getAuthConfig())},serviceFactory.get_menu_category=function(id){return $http.get(serviceBase+"menus/category"+id,getAuthConfig())},serviceFactory.get_menu_by_id=function(id){return $http.get(serviceBase+"menus/"+id,getAuthConfig())},serviceFactory.get_menu_by_name_and_pricing_level=function(name_and_pricing_level){return $http.get(serviceBase+"menus/"+name_and_pricing_level,getAuthConfig())},serviceFactory.delete_menu=function(id){return $http.delete(serviceBase+"menus/"+id,getAuthConfig())},serviceFactory.checkIfSold=function(id){return $http.get(serviceBase+"menus/"+id+"/checkIfSold",getAuthConfig())},serviceFactory.delivery_schedules=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"delivery_schedules",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.save_delivery=function(model){return $http.post(serviceBase+"delivery_schedules",model,getAuthConfig())},serviceFactory.update_delivery=function(id,model){return $http.put(serviceBase+"delivery_schedules/"+id,model,getAuthConfig())},serviceFactory.delete_delivery=function(id){return $http.delete(serviceBase+"delivery_schedules/"+id,getAuthConfig())},serviceFactory.get_vendors_categories=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"vendors/get_vendors_categories",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.get_omnivore_location=function(id){return $http.get(serviceBase+"pos/omnivore/locations/"+id,getAuthConfig())},serviceFactory.get_inventory_audit=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"inventory",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.get_recipe_audit=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"inventory/recipe_audit",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.update_inventory_audit=function(model){return $http.put(serviceBase+"inventory",model,getAuthConfig())},serviceFactory.get_suggested_audit=function(model){return $http.post(serviceBase+"inventory/get_suggested_audit",model,getAuthConfig())},serviceFactory.delete_suggested_audit=function(model){return $http.post(serviceBase+"inventory/delete_suggested_audit/",model,getAuthConfig())},serviceFactory.send_audit_COS_email=function(model){return $http.post(serviceBase+"system/audit_final_save",model,getAuthConfig())},serviceFactory.delete_inventory_audit=function(inv_type_id,is_suggested){return $http.delete(serviceBase+"inventory/"+inv_type_id+"/"+is_suggested,getAuthConfig())},serviceFactory.update_recipe_audit=function(model){return $http.put(serviceBase+"inventory/update_recipe_audit",model,getAuthConfig())},serviceFactory.delete_recipe_audit_item=function(model){return $http.post(serviceBase+"inventory/delete_recipe_audit_item",model,getAuthConfig())},serviceFactory.get_next_full_audit_type=function(model){return $http.post(serviceBase+"inventory/get_next_full_audit_type",model,getAuthConfig())},serviceFactory.get_restaurant_audit_locations=function(model){return $http.post(serviceBase+"inventory/get_restaurant_audit_locations",model,getAuthConfig())},serviceFactory.add_edit_locations=function(model){return $http.post(serviceBase+"inventory/add_edit_locations",model,getAuthConfig())},serviceFactory.get_audit_dates=function(model){return $http.post(serviceBase+"inventory/get_audit_dates",model,getAuthConfig())},serviceFactory.set_audit_date=function(model){return $http.post(serviceBase+"inventory/set_audit_date",model,getAuthConfig())},serviceFactory.get_restaurant_audit_profile=function(model){return $http.post(serviceBase+"inventory/get_restaurant_audit_profile",model,getAuthConfig())},serviceFactory.update_restaurant_audit_profile=function(model){return $http.post(serviceBase+"inventory/update_restaurant_audit_profile",model,getAuthConfig())},serviceFactory.get_restaurant_audit_schedule=function(model){return $http.post(serviceBase+"inventory/get_restaurant_audit_schedule",model,getAuthConfig())},serviceFactory.get_audit_details=function(model){return $http.post(serviceBase+"inventory/get_audit_details",model,getAuthConfig())},serviceFactory.get_auditors=function(model){return $http.post(serviceBase+"inventory/get_auditors",model,getAuthConfig())},serviceFactory.update_audit_details=function(model){return $http.post(serviceBase+"inventory/update_audit_details",model,getAuthConfig())},serviceFactory.get_auditor_transaction_summary=function(model){return $http.post(serviceBase+"inventory/get_auditor_transaction_summary",model,getAuthConfig())},serviceFactory.get_auditor_schedule=function(model){return $http.post(serviceBase+"inventory/get_auditor_schedule",model,getAuthConfig())},serviceFactory.accept_deny_audit=function(model){return $http.post(serviceBase+"inventory/accept_deny_audit",model,getAuthConfig())},serviceFactory.brand_lookup=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"rb/brand_lookup",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.sku_lookup=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"rb/sku_lookup",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.item_name_lookup=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"rb/item_name_lookup",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.validateSKU=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"rb/validateSKU",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.vendors_sku=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"vendors/sku",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.add_update_own_inventory=function(id,model){return $http.post(serviceBase+"vendors/"+id+"/inventory",model,getAuthConfig())},serviceFactory.delete_my_sku=function(vendor_id,sku_id){return $http.delete(serviceBase+"vendors/"+vendor_id+"/inventory/"+sku_id,getAuthConfig())},serviceFactory.update_sku=function(vendor_sku_id,model){return $http.put(serviceBase+"vendors/"+vendor_sku_id+"/updateSKU",model,getAuthConfig())},serviceFactory.get_modules=function(model){return $http.post(serviceBase+"rb/get_modules",model,getAuthConfig())},serviceFactory.get_measure_units=function(model){return $http.post(serviceBase+"rb/uom_conformity",model,getAuthConfig())},serviceFactory.getItemsForMap=function(id,model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"restaurants/"+id+"/report",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.setItemsForMap=function(id,model){return $http.post(serviceBase+"restaurants/"+id+"/report_items_match",model,getAuthConfig())},serviceFactory.change_mapping_category=function(id,model){return $http.post(serviceBase+"restaurants/"+id+"/change_mapping_category",model,getAuthConfig())},serviceFactory.report_items_match=function(id){return $http.get(serviceBase+"restaurants/"+id+"/report_items_match",getAuthConfig())},serviceFactory.update_csv_path=function(id,model){return $http.put(serviceBase+"restaurants/"+id+"/updateCsvPath",model,getAuthConfig())},serviceFactory.bar_serving_details=function(id){return $http.get(serviceBase+"restaurants/"+id+"/bar_serving_details",getAuthConfig())},serviceFactory.save_bar_serving_details=function(model){return $http.post(serviceBase+"restaurants/bar_serving_details",model,getAuthConfig())},serviceFactory.get_analytics_answers=function(model){return $http.post(serviceBase+"restaurants/get_analytics_answers",model,getAuthConfig())},serviceFactory.set_analytics_answers=function(model){return $http.post(serviceBase+"restaurants/analytics_answers",model,getAuthConfig())},serviceFactory.get_feedback_stack=function(id){return $http.get(serviceBase+"restaurants/"+id+"/feedback_stack",getAuthConfig())},serviceFactory.set_feedback=function(model){return $http.post(serviceBase+"restaurants/feedback_stack",model,getAuthConfig())},serviceFactory.get_restaurant_location_details=function(id){return $http.get(serviceBase+"restaurants/"+id+"/locn_details",getAuthConfig())},serviceFactory.get_event_categories=function(id){return $http.get(serviceBase+"restaurants/"+id+"/event_categories",getAuthConfig())},serviceFactory.get_events=function(id_category){return $http.get(serviceBase+"restaurants/"+id_category+"/events",getAuthConfig())},serviceFactory.set_events=function(model){return $http.post(serviceBase+"restaurants/events",model,getAuthConfig())},serviceFactory.get_scores=function(id){return $http.get(serviceBase+"restaurants/"+id+"/performance_score",getAuthConfig())},serviceFactory.calc_scores=function(id){return $http.get(serviceBase+"restaurants/"+id+"/performance_score_calc",getAuthConfig())},serviceFactory.get_order=function(id,model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"orders/"+id,headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.get_orders=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"orders",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.create_order=function(model){return $http.post(serviceBase+"orders",model,getAuthConfig())},serviceFactory.get_last_order=function(model){return $http.post(serviceBase+"orders/get_last_order",model,getAuthConfig())},serviceFactory.add_extra_order_items=function(model,id){return $http.post(serviceBase+"orders/add_extra_order_items/"+id,model,getAuthConfig())},serviceFactory.update_SKU_item_cost=function(model){return $http.post(serviceBase+"orders/update_SKU_item_cost",model,getAuthConfig())},serviceFactory.process_draft_order_item=function(model){return $http.post(serviceBase+"orders/process_draft_order_item/",model,getAuthConfig())},serviceFactory.get_draft_order_items=function(model){return $http.post(serviceBase+"orders/get_draft_order_items",model,getAuthConfig())},serviceFactory.check_if_invoice_exists=function(id){return $http.get(serviceBase+"orders/"+id+"/invoice",getAuthConfig())},serviceFactory.update_order=function(model,id){return $http.put(serviceBase+"orders/"+id,model,getAuthConfig())},serviceFactory.update_orders=function(model){return $http.put(serviceBase+"orders",model,getAuthConfig())},serviceFactory.delete_order=function(id){return $http.delete(serviceBase+"orders/"+id,getAuthConfig())},serviceFactory.get_added_invoices=function(model){return $http.post(serviceBase+"orders/get_added_invoices",model,getAuthConfig())},serviceFactory.get_par=function(model){return $http.post(serviceBase+"orders/get_par",model,getAuthConfig())},serviceFactory.update_par=function(model){return $http.post(serviceBase+"orders/update_par",model,getAuthConfig())},serviceFactory.inventory_usage_report=function(model){return $injector.get("auth"),$http({method:"GET",url:serviceBase+"inventory/usage_report",headers:{Authorization:appConfig.apiAuthorization},params:model})},serviceFactory.sales_data=function(model){return $http.post(serviceBase+"restaurants/sales_data",model,getAuthConfig())},serviceFactory.bar_chart_api=function(model){return $http.post(serviceBase+"restaurants/bar_chart_api",model,getAuthConfig())},serviceFactory.dashboard_summary_items=function(model){return $http.post(serviceBase+"restaurants/dashboardSummaryItems",model,getAuthConfig())},serviceFactory.sales_and_spendings=function(model){return $http.post(serviceBase+"restaurants/sales_and_spendings",model,getAuthConfig())},serviceFactory.lateral_chart_api=function(model){return $http.post(serviceBase+"restaurants/lateral_chart_api",model,getAuthConfig())},serviceFactory.costChangeCostCompare=function(model){return $http.post(serviceBase+"restaurants/costChangeCostCompare",model,getAuthConfig())},serviceFactory.costChangeDetails=function(model){return $http.post(serviceBase+"restaurants/costChangeDetails",model,getAuthConfig())},serviceFactory.pmix=function(model){return $http.post(serviceBase+"restaurants/pmix",model,getAuthConfig())},serviceFactory.sales_current_to_last_period_report=function(model){return $http.post(serviceBase+"restaurants/sales_current_to_last_period_report",model,getAuthConfig())},serviceFactory.salesVsCost=function(model){return $http.post(serviceBase+"restaurants/salesVsCost",model,getAuthConfig())},serviceFactory.PieChart=function(model){return $http.post(serviceBase+"restaurants/PieChart",model,getAuthConfig())},serviceFactory.alcohol=function(model){return $http.post(serviceBase+"restaurants/Alcohol",model,getAuthConfig())},serviceFactory.get_suggested_orders=function(model){return $http.post(serviceBase+"restaurants/get_suggested_orders",model,getAuthConfig())},serviceFactory.get_full_audit_variance=function(model){return $http.post(serviceBase+"restaurants/get_full_audit_variance",model,getAuthConfig())},serviceFactory.get_adjustment_variance=function(model){return $http.post(serviceBase+"restaurants/get_adjustment_variance",model,getAuthConfig())},serviceFactory.payment_call=function(model){return $http.post(serviceBase+"restaurants/payment_call",model,getAuthConfig())},serviceFactory.process_suggested_order_item=function(model){return $http.post(serviceBase+"restaurants/process_suggested_order_item",model,getAuthConfig())},serviceFactory.alcoholCostSummary=function(model){return $http.post(serviceBase+"restaurants/alcoholCostSummary",model,getAuthConfig())},serviceFactory.MonthlySales=function(model){return $http.post(serviceBase+"restaurants/MonthlySales",model,getAuthConfig())},serviceFactory.summary_api=function(model){return $http.post(serviceBase+"restaurants/summary_api",model,getAuthConfig())},serviceFactory.PurchaseVsUsage=function(model){return $http.post(serviceBase+"restaurants/PurchaseVsUsage",model,getAuthConfig())},serviceFactory.VendorDetail=function(model){return $http.post(serviceBase+"restaurants/VendorDetail",model,getAuthConfig())},serviceFactory.salesInventory=function(model){return $http.post(serviceBase+"restaurants/salesInventory",model,getAuthConfig())},serviceFactory.Item=function(model){return $http.post(serviceBase+"restaurants/Item",model,getAuthConfig())},serviceFactory.salesSummary=function(model){return $http.post(serviceBase+"restaurants/salesSummary",model,getAuthConfig())},serviceFactory.sku_table=function(model){return $http.post(serviceBase+"restaurants/sku_table",model,getAuthConfig())},serviceFactory.locations_report=function(model){return $http.post(serviceBase+"restaurants/locations_report",model,getAuthConfig())},serviceFactory.audit_trend_report=function(model){return $http.post(serviceBase+"restaurants/audit_trend_report",model,getAuthConfig())},serviceFactory.performance_score_detail=function(model){return $http.post(serviceBase+"restaurants/performance_score_detail",model,getAuthConfig())},serviceFactory.food_performance_score_detail=function(model){return $http.post(serviceBase+"restaurants/food_performance_score_detail",model,getAuthConfig())},serviceFactory.create_missing_menus=function(model){return $http.post(serviceBase+"system/create_missing_menus/",model,getAuthConfig())},serviceFactory.act_deact_menu_item=function(model){return $http.post(serviceBase+"menus/act_deact_menu_item/",model,getAuthConfig())},serviceFactory.food_OH=function(model){return $http.post(serviceBase+"restaurants/Food_OH",model,getAuthConfig())},serviceFactory.batch_OH=function(model){return $http.post(serviceBase+"restaurants/batch_OH",model,getAuthConfig())},serviceFactory.waste_report=function(model){return $http.post(serviceBase+"restaurants/waste_report",model,getAuthConfig())},serviceFactory.get_active_SKU_categories=function(model){return $http.post(serviceBase+"restaurants/active_SKU_categories",model,getAuthConfig())},serviceFactory.checkForSummarizedSales=function(model){return $http.post(serviceBase+"restaurants/checkForSummarizedSales",model,getAuthConfig())},serviceFactory.compsetReport_avg_sales=function(model){return $http.post(serviceBase+"restaurants/compsetReport_avg_sales",model,getAuthConfig())},serviceFactory.compsetReport_daily_sales=function(model){return $http.post(serviceBase+"restaurants/compsetReport_daily_sales",model,getAuthConfig())},serviceFactory.compsetReport_day_of_week_avg_sales=function(model){return $http.post(serviceBase+"restaurants/compsetReport_day_of_week_avg_sales",model,getAuthConfig())},serviceFactory.compsetReport_holiday=function(model){return $http.post(serviceBase+"restaurants/compsetReport_holiday",model,getAuthConfig())},serviceFactory.compsetReport_projected_summary=function(model){return $http.post(serviceBase+"restaurants/compsetReport_projected_summary",model,getAuthConfig())},serviceFactory.compsetReport_shared_budget=function(model){return $http.post(serviceBase+"restaurants/compsetReport_shared_budget",model,getAuthConfig())},serviceFactory.save_Other_POS_details=function(model){return $http.post(serviceBase+"restaurants/save_Other_POS_details",model,getAuthConfig())},serviceFactory.compareRestaurants_lineSales=function(model){return $http.post(serviceBase+"restaurants/compareRestaurants_lineSales",model,getAuthConfig())},serviceFactory.compareRestaurants_tableSnS=function(model){return $http.post(serviceBase+"restaurants/compareRestaurants_tableSnS",model,getAuthConfig())},serviceFactory.compareRestaurants_donutScores=function(model){return $http.post(serviceBase+"restaurants/compareRestaurants_donutScores",model,getAuthConfig())},serviceFactory.compareRestaurants_unitCost=function(model){return $http.post(serviceBase+"restaurants/compareRestaurants_unitCost",model,getAuthConfig())},serviceFactory.compareRestaurants_unitPurchased=function(model){return $http.post(serviceBase+"restaurants/compareRestaurants_unitPurchased",model,getAuthConfig())},serviceFactory.compareRestaurants_totalPurchase=function(model){return $http.post(serviceBase+"restaurants/compareRestaurants_totalPurchase",model,getAuthConfig())},serviceFactory.compareRestaurants_unitSales=function(model){return $http.post(serviceBase+"restaurants/compareRestaurants_unitSales",model,getAuthConfig())},serviceFactory.compareRestaurants_retailPrice=function(model){return $http.post(serviceBase+"restaurants/compareRestaurants_retailPrice",model,getAuthConfig())},serviceFactory.compareRestaurants_getMapping=function(model){return $http.post(serviceBase+"restaurants/compareRestaurants_getMapping",model,getAuthConfig())},serviceFactory.compareRestaurants_saveMapping=function(model){return $http.post(serviceBase+"restaurants/compareRestaurants_saveMapping",model,getAuthConfig())},serviceFactory.getExpenses=function(model){return $http.post(serviceBase+"accounting/getExpenses",model,getAuthConfig())},serviceFactory.update_expenses=function(model){return $http.put(serviceBase+"accounting/expenses",model,getAuthConfig())},serviceFactory.get_net_profit=function(model){return $http.post(serviceBase+"accounting/get_net_profit",model,getAuthConfig())},serviceFactory.on_hand_email=function(model){return $http.post(serviceBase+"system/on_hand_email/",model,getAuthConfig())},serviceFactory.food_on_hand_email=function(model){return $http.post(serviceBase+"system/food_on_hand_email/",model,getAuthConfig())},serviceFactory.send_free_calc_email=function(model){return $http.post(serviceBase+"system/food_calc_email/",model,getAuthConfig())},serviceFactory};api.$inject=["appConfig","$http","$injector"],angular.module("inspinia").factory("api",api)}(),function(){"use strict";var authService=function(api,$q,localStorageService,$rootScope,appConfig,$injector,$state,$timeout){var that=this;that.userData={showPopup:!1,isLogged:!1,user:null},$rootScope.userData=that.userData;var setUser=function(user){return that.userData.isLogged=!0,that.userData.user=user,appConfig.token="Bearer "+that.userData.user.access_token,$rootScope.userData=that.userData,$timeout(function(){that.userData.showPopup=!0},1e4),that.userData},updateMyInfo=function(user){that.userData.user=user,localStorageService.set("adminAuthorizationData",{authenticationInfo:setUser(user)})},clearUserData=function(){that.userData={isLogged:!1,user:null,showPopup:!1},appConfig.token=null,$rootScope.userData=that.userData,localStorageService.clearAll();var auth=$injector.get("auth");$injector.get("restaurant").set_restaurant(0),auth.authentication=that.userData};return{login:function(model){var deferred=$q.defer();return api.auth_login(model).then(function(success){success.data.data?("OK"===success.data.data.message&&localStorageService.set("adminAuthorizationData",{authenticationInfo:setUser(success.data.data.user)}),deferred.resolve(success)):deferred.reject(success)},function(error){deferred.reject(error)}),deferred.promise},logOut:function(){clearUserData(),$state.go("login")},fillAuthData:function(){var authData=localStorageService.get("adminAuthorizationData");authData&&authData.authenticationInfo&&setUser(authData.authenticationInfo.user)},setUser:setUser,updateMyInfo:updateMyInfo,authentication:that.userData}};authService.$inject=["api","$q","localStorageService","$rootScope","appConfig","$injector","$state","$timeout"],angular.module("inspinia").factory("auth",authService)}(),function(){"use strict";var common=function($uibModal,$interval){var that={};return that.full_Audit=function(){return $uibModal.open({templateUrl:"views/modal/full_Audit.html",controller:function($uibModalInstance,$scope){$scope.cancel=function(){$uibModalInstance.dismiss("cancel")}},windowClass:"animated fadeIn",size:"lg",controllerAs:"$ctr"})},that.adjustment_Audit=function(){return $uibModal.open({templateUrl:"views/modal/adjustment_Audit.html",controller:function($uibModalInstance,$scope){$scope.cancel=function(){$uibModalInstance.dismiss("cancel")}},windowClass:"animated fadeIn",size:"lg",controllerAs:"$ctr"})},that.beginFoodFullCount=function(){return $uibModal.open({templateUrl:"views/modal/begin_food_full_count.html",controller:function($uibModalInstance,$scope){$scope.cancel=function(){$uibModalInstance.dismiss("cancel")}},windowClass:"animated fadeIn",size:"lg",controllerAs:"$ctr"})},that.beginFoodAdjustmentCount=function(){return $uibModal.open({templateUrl:"views/modal/begin_food_adjustment_count.html",controller:function($uibModalInstance,$scope){$scope.cancel=function(){$uibModalInstance.dismiss("cancel")}},windowClass:"animated fadeIn",size:"lg",controllerAs:"$ctr"})},that.beginAlcoholInventoryCount=function(){return $uibModal.open({templateUrl:"views/modal/begin_alcohol_inventory_count.html",controller:function($uibModalInstance,$scope){$scope.cancel=function(){$uibModalInstance.dismiss("cancel")}},windowClass:"animated fadeIn",size:"lg",controllerAs:"$ctr"})},that};common.$inject=["$uibModal","$interval"],angular.module("inspinia").factory("common",common)}(),function(){"use strict";var core=function(api,auth,$q,restaurant,localStorageService,$rootScope){function get_settings(){var deferred=$q.defer();if(data.settings)deferred.resolve(data.settings);else{var keys={keys:["email_body_template","email_invite_on_submission"]};api.get_settings(keys).then(function(res){data.settings=res.data.data.settings,deferred.resolve(data.settings)})}return deferred.promise}function get_refbooks(){var deferred=$q.defer();if(data.refbooks)deferred.resolve(data.refbooks);else{var keys={refbooks:["tare_types","analytics_questionare","bar_serving_details_types","bar_serving_types","default_weights","bar_recipe_measurement_types","inventory_types","liquid_dry_conversion","measurement_types","measurement_categories","measurement_likes","measurement_units","recipe_types","recipe_cooking_methods","country_states","user_types","entity_types","content_types","invite_status","menu_items","vendor_sub_cat","vendor_cat","measurement_units_of_delivery","accounting_subcategories","accounting_units"]};api.get_refbooks(keys).then(function(res){data.refbooks=res.data.data.refbooks,deferred.resolve(data.refbooks)})}return deferred.promise}var data={settings:null,refbooks:null,new_restaurant:null};return{data:data,getSettings:get_settings,getRefbooks:get_refbooks,init:function(){var restaurantID=localStorageService.get("restaurant_id");restaurantID&&restaurant.set_restaurant(restaurantID.restaurant_id).then(function(){})}}};core.$inject=["api","auth","$q","restaurant","localStorageService","$rootScope"],angular.module("inspinia").factory("core",core)}(),function(){"use strict";var interceptorService=function(appConfig,$injector,$q,$location,$rootScope){var serviceBase=appConfig.apiDomain,request=function(config){return 0===config.url.indexOf(serviceBase)&&(config.headers=config.headers||{},$rootScope.userData.isLogged&&(config.headers.Authorization=appConfig.token)),config},responseError=function(rejection){return rejection.status,$q.reject(rejection)};return{response:function(response){if("object"==typeof response.data&&"object"==typeof response.data.error){var alertService=$injector.get("alertService");if(2043===response.data.error.code)return void alert(response.data.error.message);if(2001!=response.data.error.code&&1e3!=response.data.error.code&&alertService.showAPIError(response.data.error,response.data.validation_Error),2001==response.data.error.code){var authService=$injector.get("auth");authService.authentication.showPopup&&alertService.showAlertTimeout(),authService.logOut()}else 2017!=response.data.error.code&&alertService.showAPIError(response.data.error,response.data.validation_Error)}return response},request:request,responseError:responseError}};interceptorService.$inject=["appConfig","$injector","$q","$location","$rootScope"],angular.module("inspinia").factory("interceptorService",interceptorService)}(),function(){"use strict";var restaurant=function(api,auth,$q,$injector,$rootScope,localStorageService){var data={info:null,permissions:null
},set_restaurant=function(id){var deferred=$q.defer();return id?(api.get_restaurant(id).then(function(res1){api.set_active_restaurant({restaurant_id:id}).then(function(res){try{data.info=res1.data.data.restaurants_list[0],data.permissions=res.data.data.permissions,deferred.resolve(data.info),$rootScope.$emit("restaurantSelected"),localStorageService.set("restaurant_id",{restaurant_id:id})}catch(e){console.log(e),deferred.reject()}},function(error){deferred.reject()})},function(error){deferred.reject()}),deferred.promise):(data.info=null,data.permissions=null,deferred.resolve(),$rootScope.restaurant_id=null,deferred.promise)};return{data:data,set_to_edit:function(id){var deferred=$q.defer(),core=$injector.get("core");return api.get_restaurant(id).then(function(res){var restaurant_to_edit=res.data.data.restaurants_list[0];restaurant_to_edit?(core.data.new_restaurant={user_id:auth.authentication.user.id,subscription_type_id:restaurant_to_edit.subscription_type_id,pos_id:restaurant_to_edit.pos_id,user:{first_name:null,last_name:null,email:null,phone_number:null,password:null,password_confirm:null},restaurant:{restaurant_name:restaurant_to_edit.restaurant_name,entity_type_id:restaurant_to_edit.entity_type_id,address:restaurant_to_edit.address,city:null,state:null,zip:restaurant_to_edit.zip,city_geoname_id:restaurant_to_edit.city_geoname_id,state_geoname_id:restaurant_to_edit.state_geoname_id,pos_report_url:restaurant_to_edit.pos_report_url,phone_number:restaurant_to_edit.phone_number},payment:{card_number:restaurant_to_edit.service_payment?restaurant_to_edit.service_payment.card_number:"12345678912345",expiration_month:restaurant_to_edit.service_payment?restaurant_to_edit.service_payment.expiration_month:12,expiration_year:restaurant_to_edit.service_payment?restaurant_to_edit.service_payment.expiration_year:19,coupon_code:restaurant_to_edit.service_payment?restaurant_to_edit.service_payment.coupon_code:"12345",first_name:restaurant_to_edit.service_payment?restaurant_to_edit.service_payment.first_name:"first name",last_name:restaurant_to_edit.service_payment?restaurant_to_edit.service_payment.last_name:"last name",zip:restaurant_to_edit.service_payment?restaurant_to_edit.service_payment.zip:10001,billing_address:restaurant_to_edit.service_payment?restaurant_to_edit.service_payment.billing_address:"billing address",cv_code:restaurant_to_edit.service_payment?restaurant_to_edit.service_payment.cv_code:405}},deferred.resolve(data.info)):deferred.reject(data.info)},function(error){deferred.reject(error)}),deferred.promise},set_restaurant:set_restaurant}};restaurant.$inject=["api","auth","$q","$injector","$rootScope","localStorageService"],angular.module("inspinia").factory("restaurant",restaurant)}(),function(){"use strict";var utils=function(){return{tackDictionary:function(input,dictionary,key,value){if(void 0===input)return null;if(null===input)return null;if(""===input)return null;var d=dictionary;if(d)for(var i=0;i<d.length;i++)if(d[i][key]==input)return d[i][value];return input}}};utils.$inject=[],angular.module("inspinia").factory("utils",utils)}(),angular.module("inspinia").directive("acPassword",acPassword),angular.module("inspinia").directive("acPhone",acPhone),angular.module("inspinia").directive("compareTo",compareTo),angular.module("inspinia").directive("numbersOnly",numbersOnly),angular.module("inspinia").directive("onlyDigits",onlyDigits),angular.module("inspinia").directive("partialWeightValidator",["SweetAlert",partialWeightValidator]),angular.module("inspinia").directive("scrollTop",scrollTop),angular.module("inspinia").directive("uniqueSku",["api",uniqueSku]),angular.module("inspinia").directive("unitWeightValid",["SweetAlert",unitWeightValid]),function(){"use strict";function controller(api,$state,$window,auth,localStorageService,$rootScope,SweetAlert,restaurant,core){var that=this;that.form={},that.state=$state,that.core=core,that.api=api,that.auth=auth,that.printDiv=function(){var printWindow=window.open("","_blank","top=0,left=0"),htmlContent="<html><head><title>Print</title></head><body>"+document.getElementById("divToPrint").innerHTML+"</body></html>";printWindow.document.open(),printWindow.document.write(htmlContent),printWindow.document.close(),printWindow.print()},that.$onInit=function(){}}controller.$inject=["api","$window","$state","auth","localStorageService","$rootScope","SweetAlert","restaurant","core"],angular.module("inspinia").component("accounting",{templateUrl:"js/components/accounting/accounting.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("admin.accounting",{url:"/accounting",template:"<accounting></accounting>",data:{pageTitle:"Accounting"}})})}(),function(){"use strict";function modalController($uibModalInstance,api,alertService){var that=this;that.form={},that.api=api,that.location=null,that.submit=function(form){form.$valid&&that.api.get_omnivore_location(that.location).then(function(res){try{if(res.data.data.pos_info.errors){for(var reasons=[],i=0;res.data.data.pos_info.errors.length>i;i++)reasons.push(res.data.data.pos_info.errors[i].description);var message=reasons.join(", ");alertService.showErrorInvitation("",message)}else $uibModalInstance.close()}catch(e){}})},that.cancel=function(){$uibModalInstance.dismiss("cancel")}}function addPosHereController(api,$state,auth,localStorageService,alertService,$uibModal,$rootScope,restaurant,common){if(!auth.authentication.isLogged||0!=parseInt($state.params.pos_id)&&!parseInt($state.params.pos_id))return void $state.go("home");var that=this;if(that.base_api_url=appConfig.apiDomain,that.form={},that.api=api,that.auth=auth,that.$state=$state,that.location=null,that.posSyncList=[],that.instalation_manual=null,that.pos_id=$state.params.pos_id,that.pos_report_url=null,that.other_pos_name=null,that.other_pos_ver=null,1==that.pos_id?that.img_src=["/uploads/Focus_manual_1.png","/uploads/Focus_manual_2.png","/uploads/Focus_manual_3.png","/uploads/Focus_manual_4.png"]:10==that.pos_id?that.img_src=["/uploads/TouchBistro_manual_1.png","/uploads/TouchBistro_manual_2.png","/uploads/TouchBistro_manual_3.png","/uploads/TouchBistro_manual_4.png"]:11==that.pos_id&&(that.img_src=["/uploads/NCR_manual_1.png","/uploads/NCR_manual_2.png"]),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.connect=function(){$uibModal.open({templateUrl:"location_code.html",controller:modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",size:"sm"}).result.then(function(){alertService.showAlertSave(),that.$state.includes("foodSetup")?that.$state.go("foodSetup.inventoryComplete",{pos_id:$state.params.pos_id}):that.$state.includes("alcoholSetup")?that.$state.go("alcoholSetup.inventoryComplete",{pos_id:$state.params.pos_id}):that.$state.go("administrator.posSync",{pos_id:$state.params.pos_id})})},that.next=function(){that.$state.go("admin.analytics")},that.other_POS=function(form){form.$valid&&that.api.save_Other_POS_details({other_pos_name:that.other_pos_name,other_pos_ver:that.other_pos_ver}).then(function(res){try{1e3===res.data.data.code&&that.$state.go("admin.analytics")}catch(e){console.log(e)}})},that.updateCsvPath=function(form){form.$valid&&that.api.update_csv_path(that.restaurant_id.restaurant_id,{pos_report_url:that.pos_report_url}).then(function(res){try{if(1e3===res.data.data.code){if(4==$rootScope.subscription_type_id)return void $state.go("admin.analytics");if(3==$rootScope.subscription_type_id)return void $state.go("admin.inventoryAuditAsk");if(2==$rootScope.subscription_type_id)return void common.beginFoodInventoryCount();1==$rootScope.subscription_type_id&&common.beginAlcoholInventoryCount()}}catch(e){console.log(e)}})},that.$onInit=function(){that.info_src=[],api.get_pos_list().then(function(res){that.posSyncList=res.data.data.list;for(var i=0;that.posSyncList.length>i;i++)if(that.posSyncList[i].id==that.pos_id){that.instalation_manual=that.posSyncList[i].instalation_manual,1==that.pos_id||10==that.pos_id?(that.info_src.push(that.instalation_manual.substring(0,that.instalation_manual.indexOf("<img1>"))),that.info_src.push(that.instalation_manual.substring(that.instalation_manual.indexOf("<img1>")+6,that.instalation_manual.indexOf("<img2>"))),that.info_src.push(that.instalation_manual.substring(that.instalation_manual.indexOf("<img2>")+6,that.instalation_manual.indexOf("<img3>"))),that.info_src.push(that.instalation_manual.substring(that.instalation_manual.indexOf("<img3>")+6,that.instalation_manual.indexOf("<img4>"))),that.info_src.push(that.instalation_manual.substring(that.instalation_manual.indexOf("<img4>")+6,that.instalation_manual.length))):11==that.pos_id&&(that.info_src.push(that.instalation_manual.substring(0,that.instalation_manual.indexOf("<img1>"))),that.info_src.push(that.instalation_manual.substring(that.instalation_manual.indexOf("<img1>")+6,that.instalation_manual.indexOf("<img2>"))),that.info_src.push(that.instalation_manual.substring(that.instalation_manual.indexOf("<img2>")+6,that.instalation_manual.length)));break}}),api.get_restaurant(that.restaurant_id.restaurant_id).then(function(res){try{that.pos_report_url=res.data.data.restaurants_list[0].pos_report_url,that.other_pos_name=res.data.data.restaurants_list[0].other_pos_name,that.other_pos_ver=res.data.data.restaurants_list[0].other_pos_ver}catch(e){console.log(e)}})},that.backPosSync=function(){that.$state.includes("foodSetup")?that.$state.go("foodSetup.posSync",{pos_id:$state.params.pos_id}):that.$state.includes("alcoholSetup")?that.$state.go("alcoholSetup.posSync",{pos_id:$state.params.pos_id}):that.$state.go("administrator.posSync",{pos_id:$state.params.pos_id})}}addPosHereController.$inject=["api","$state","auth","localStorageService","alertService","$uibModal","$rootScope","restaurant","common"],angular.module("inspinia").component("addPosHereComponent",{templateUrl:"js/components/administrator/addPosHere/addPosHere.html",controller:addPosHereController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("administrator.addPosHere",{url:"/add_pos_here/:pos_id",template:"<add-pos-here-component></add-pos-here-component>",data:{pageTitle:"Add POS Here"},params:{pos_id:null}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("administrator",{url:"/administrator",data:{pageTitle:"Administrator"},template:"<ui-view></ui-view>",abstract:!0,resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]}])}}})})}(),function(){"use strict";function modalControllerAuditors($uibModalInstance,audit_schedule_item,budget,skrible_auditors,is_admin,user_id,alertService,api){var that=this;that.auditor_form={},that.api=api,that.audit_schedule_item=audit_schedule_item,that.budget=JSON.parse(JSON.stringify(budget)),that.budget_copy=JSON.parse(JSON.stringify(budget)),that.skrible_auditors=skrible_auditors,that.is_admin=is_admin,that.user_id=user_id;var req_auditors_slots={},auditor_slots={},schedule_id=audit_schedule_item.id,surcharge_percent=audit_schedule_item.surcharge_percent;that.generateAuditorSlots=function(){that.api.get_audit_details({audit_schedule_id:schedule_id,caller:"admin"}).then(function(res){if(that.auditors=res.data.data.Report.audit_list[0].auditors,that.is_admin){that.audit_status=res.data.data.Report.audit_list[0].status;for(var b=0;b<that.budget.length;b++)req_auditors_slots.hasOwnProperty(that.budget[b].assigned)?req_auditors_slots[that.budget[b].assigned].push(that.budget[b]):req_auditors_slots[that.budget[b].assigned]=[that.budget[b]];for(var a in req_auditors_slots){var total_budget=0;for(var aa in req_auditors_slots[a])total_budget+=req_auditors_slots[a][aa].budget_minutes;req_auditors_slots[a][0].budget_minutes=total_budget}for(var a=0;a<that.auditors.length;a++)auditor_slots.hasOwnProperty(that.auditors[a].assigned)?auditor_slots[that.auditors[a].assigned].push(that.auditors[a]):auditor_slots[that.auditors[a].assigned]=[that.auditors[a]];for(var a in auditor_slots){var total_rate=0,total_minutes=0;for(var aa in auditor_slots[a])total_rate+=auditor_slots[a][aa].budget_rate,total_minutes+=auditor_slots[a][aa].budget_minutes;auditor_slots[a][0].budget_rate=total_rate,auditor_slots[a][0].budget_minutes=total_minutes}}if(that.is_admin){that.auditors=[];for(var ra in req_auditors_slots)auditor_slots.hasOwnProperty(req_auditors_slots[ra][0].assigned)?(auditor_slots[req_auditors_slots[ra][0].assigned][0].auditor_user_id!=that.user_id&&(auditor_slots[req_auditors_slots[ra][0].assigned][0].budget_rate="-"),that.auditors.push(auditor_slots[req_auditors_slots[ra][0].assigned][0])):that.auditors.push({assigned:req_auditors_slots[ra][0].assigned,audit_schedule_id:schedule_id,auditor_user_id:null,budget_rate:null,budget_minutes:req_auditors_slots[ra][0].budget_minutes,status:"Pending"})}else for(var a in that.auditors)that.auditors[a].auditor_user_id!=that.user_id&&(that.auditors[a].budget_rate="-")})},that.generateAuditorSlots(),that.selectAuditor=function(selected_auditor){if(selected_auditor)for(var s=0;s<that.skrible_auditors.length;s++)if(that.skrible_auditors[s].id==selected_auditor.auditor_user_id){selected_auditor.budget_rate=that.skrible_auditors[s].hourly_rate*(selected_auditor.budget_minutes/60),selected_auditor.budget_rate*=surcharge_percent/100,selected_auditor.status="Pending";break}},that.submit=function(form){if(form.$valid){var to_save_auditors=[];for(var a in that.auditors)if(null!=that.auditors[a].auditor_user_id){for(var aud_hourly_rate=0,s=0;s<that.skrible_auditors.length;s++)if(that.skrible_auditors[s].id==that.auditors[a].auditor_user_id){aud_hourly_rate=that.skrible_auditors[s].hourly_rate,aud_hourly_rate*=surcharge_percent/100;break}for(var b=0;b<that.budget_copy.length;b++)that.auditors[a].assigned==that.budget_copy[b].assigned&&to_save_auditors.push({audit_schedule_id:schedule_id,auditor_user_id:that.auditors[a].auditor_user_id,category:that.budget_copy[b].category,budget_minutes:that.budget_copy[b].budget_minutes,budget_rate:aud_hourly_rate*(that.budget_copy[b].budget_minutes/60),assigned:that.auditors[a].assigned,status:that.auditors[a].status})}that.api.update_audit_details({audit_details:{id:schedule_id,auditors:to_save_auditors}}).then(function(res){res&&1e3==res.data.data.code?alertService.showAlertSave():alertService.showError("Something went wrong!")})}},that.cancel=function(){$uibModalInstance.dismiss("cancel")}}function modalControllerNotes($uibModalInstance,audit_schedule_item,alertService,api){var that=this;that.notes_form={},that.api=api,that.audit_schedule_item=audit_schedule_item,that.cancel=function(){$uibModalInstance.dismiss("cancel")}}function auditControlCenterController(api,$state,auth,core,localStorageService,alertService,SweetAlert,$uibModal,restaurant,$rootScope,$scope,$q){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.api=api,that.core=core,that.auth=auth,that.form={},that.audit_form={},that.InvType="Alcohol",that.rest_aud_profile={},$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.getModes=function(){var m_arr=[];return 1!=that.subscription_type_id&&3!=that.subscription_type_id&&5!=that.subscription_type_id&&7!=that.subscription_type_id||m_arr.push("Alcohol"),2!=that.subscription_type_id&&3!=that.subscription_type_id&&6!=that.subscription_type_id&&7!=that.subscription_type_id||m_arr.push("Food"),m_arr},that.changeInvType=function(){that.mode="profile",that.trans_start_date=new Date,that.trans_start_date.setMonth(that.trans_start_date.getMonth()-1),that.trans_end_date=new Date,that.timesheet_start_date=new Date,that.timesheet_end_date=new Date,that.timesheet_end_date.setMonth(that.timesheet_end_date.getMonth()+1),that.timesheet_filter_list=["--All--","Pending"],that.timesheet_filter="--All--",Promise.all([that.checkEmpType(),that.get_restaurants_list(),that.getSkribleAuditors("performance")]).then(function(response){if(!that.showCCData)return void $state.go("home");1!=that.user.userid?(that.getRestaurantAuditProfile(),that.changeMode("schedule"),that.current_auditor=that.user.userid):(that.current_auditor=-1,that.getRestaurantAuditProfile(),that.getActiveCategories())})},that.saveRestaurantAuditProfile=function(){that.api.update_restaurant_audit_profile({restaurant_id:that.restaurant_id.restaurant_id,inventory_type_id:"Food"==that.InvType?1:2,audit_profile:that.rest_aud_profile}).then(function(res){res&&1e3==res.data.data.code?(that.getRestaurantAuditProfile(),alertService.showAlertSave()):(that.getRestaurantAuditProfile(),alertService.showError("Something went wrong!"))})},that.addBudgetEntry=function(){that.rest_aud_profile.budget.push({category:null,budget_minutes:null,assigned:null})},that.delBudgetEntry=function($index){that.rest_aud_profile.budget.splice($index,1),that.recalcTotalBudget()},that.recalcTotalBudget=function(){that.total_est_hrs=that.rest_aud_profile.budget.reduce(function(a,b){return a+b.budget_minutes},0)/60},that.getRestaurantAuditProfile=function(){that.api.get_restaurant_audit_profile({restaurant_id:that.restaurant_id.restaurant_id,inventory_type_id:"Food"==that.InvType?1:2,is_admin:1==that.user.userid}).then(function(res){res&&void 0!==res.data.data.Report?(that.rest_aud_profile=res.data.data.Report,that.recalcTotalBudget()):(that.rest_aud_profile={},that.rest_aud_profile.contacts=[],that.rest_aud_profile.contacts.push({full_name:null,title:null,phone:null},{full_name:null,title:null,phone:null}),that.rest_aud_profile.budget=[],that.rest_aud_profile.audit_enabled=0,that.rest_aud_profile.replacement_auditor_allowed=1,that.rest_aud_profile.replacement_date_allowed=1,that.rest_aud_profile.wifi_password=null,that.rest_aud_profile.internal_notes=null)})},that.getActiveCategories=function(){that.api.get_active_SKU_categories({inventory_type_id:"Food"==that.InvType?1:2}).then(function(res){that.SKU_categories=res.data.data.categories})},that.getScheduledAudits=function(){if(that.loading=!0,1==that.user.userid)that.api.get_restaurant_audit_schedule({restaurant_id:that.restaurant_id.restaurant_id,inventory_type_id:"Food"==that.InvType?1:2,caller:"admin"}).then(function(res){that.audit_schedule=res.data.data.Report.audit_list,that.loading=!1});else{var dayfd=that.timesheet_start_date.getDate(),monthfd=that.timesheet_start_date.getMonth()+1,fd=that.timesheet_start_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=that.timesheet_end_date.getDate(),monthtd=that.timesheet_end_date.getMonth()+1,td=that.timesheet_end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd;that.api.get_auditor_schedule({inventory_type_id:"Food"==that.InvType?1:2,user_id:that.user.userid,start_date:fd,end_date:td,caller:"timesheet",aud_status:"--All--"==that.timesheet_filter?"All":"Upcoming"}).then(function(res){that.audit_schedule=res.data.data.Report.audit_list,-1!=that.current_rest&&(that.audit_schedule=that.audit_schedule.filter(function(x){return x.restaurant_id==that.current_rest}));for(var aud_s in that.audit_schedule){var ast=that.audit_schedule[aud_s];ast.budget_rate=ast.auditors.filter(function(x){return x.auditor_user_id==that.user.userid}).reduce(function(x,y){return x+y.budget_rate},0)}that.loading=!1})}},that.getSkribleAuditors=function(caller){that.api.get_auditors({restaurant_id:that.restaurant_id.restaurant_id,inventory_type_id:"Food"==that.InvType?1:2}).then(function(res){that.skrible_auditors=JSON.parse(JSON.stringify(res.data.data.Report)),"performance"==caller&&(that.skrible_auditor_emps=JSON.parse(JSON.stringify(res.data.data.Report)),1==that.user.userid?(that.skrible_auditor_emps.unshift({id:1,first_name:"Skrible ",last_name:"Admin"}),that.skrible_auditor_emps.unshift({id:-1,first_name:"--All ",last_name:"Auditors--"})):that.skrible_auditor_emps=that.skrible_auditor_emps.filter(function(x){return x.id==that.user.userid})),that.skrible_auditors.unshift({id:null})})},that.get_restaurants_list=function(){var m={order_by:"name",order_way:"ASC",paginationOffset:0};api.get_restaurants(m).then(function(res){that.rest_list=res.data.data.restaurants_list,that.rest_list.length&&(that.rest_list=that.rest_list.filter(function(x){return 5==x.subscription_type_id||6==x.subscription_type_id||7==x.subscription_type_id}),that.rest_list.unshift({id:-1,restaurant_name:"--All Restaurants--"}),that.current_rest=that.rest_list[0].id)})},that.getAuditorTransactionSummary=function(){that.loading=!0,that.trans_summary=[],that.avg_efficiency=0;var dayfd=that.trans_start_date.getDate(),monthfd=that.trans_start_date.getMonth()+1,fd=that.trans_start_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=that.trans_end_date.getDate(),monthtd=that.trans_end_date.getMonth()+1,td=that.trans_end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd,ts_params={restaurant_id:that.current_rest,auditor_user_id:that.current_auditor,inventory_type_id:"Food"==that.InvType?1:2,start_date:fd,end_date:td};-1==ts_params.restaurant_id&&delete ts_params.restaurant_id,-1==ts_params.auditor_user_id&&delete ts_params.auditor_user_id,that.api.get_auditor_transaction_summary(ts_params).then(function(res){that.trans_summary=res.data.data.trans_summary.transactions,that.trans_summary=that.trans_summary.filter(function(x){return 0==x.is_adjustment}),that.company_eff=res.data.data.trans_summary.company_eff,that.total_duration=0;for(var total_efficiency=0,i=0;i<that.trans_summary.length;i++)that.trans_summary[i].review_duration=0,that.trans_summary[i].efficiency>=1.4&&(that.trans_summary[i].duration>.25&&that.trans_summary[i].duration<=2?that.trans_summary[i].review_duration=.25:that.trans_summary[i].duration>2&&(that.trans_summary[i].review_duration=.5)),that.total_duration+=that.trans_summary[i].duration+that.trans_summary[i].review_duration,total_efficiency+=that.trans_summary[i].efficiency;that.avg_efficiency=total_efficiency/(that.trans_summary.length?that.trans_summary.length:1),that.loading=!1})},that.viewAuditors=function(audit_schedule_item){$uibModal.open({templateUrl:"view_edit_auditors.html",controller:modalControllerAuditors,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",resolve:{audit_schedule_item:function(){return audit_schedule_item},budget:function(){return that.rest_aud_profile.budget},skrible_auditors:function(){return that.skrible_auditors},is_admin:function(){return 1==that.user.userid},user_id:function(){return that.user.userid}}}).result.then(function(){that.getScheduledAudits()},function(){that.getScheduledAudits()})},that.acceptDenyAudit=function(audit_schedule_item,action_status){var popup_text="Do you want to "+action_status+" this audit?",title=action_status+"?";SweetAlert.swal({title:title,text:popup_text,type:"warning",showCancelButton:!0,confirmButtonColor:"#337ab7",confirmButtonText:"Confirm"},function(res){res&&that.api.accept_deny_audit({audit_schedule_id_list:[audit_schedule_item.id],auditor_user_id:that.user.userid,update_status:"Accept"==action_status?"Accepted":"Denied"}).then(function(res){alertService.showAlertSave(),that.mode="",that.changeMode("schedule")})})},that.viewNotes=function(audit_schedule_item){$uibModal.open({templateUrl:"view_edit_notes.html",controller:modalControllerNotes,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",resolve:{audit_schedule_item:function(){return audit_schedule_item}}})},that.checkEmpType=function(){var emps=restaurant.data.info.employees;if(that.user={userid:null,user_type_id:null},that.user.userid=that.auth.authentication.user.id,1==that.user.userid)that.showCCData=!0,that.showProfileData=!0;else{that.showProfileData=!1;for(var i=0;emps.length>i;i++)if(emps[i].id==that.user.userid){that.user.user_type_id=emps[i].type_ids,9==emps[i].type_ids||10==emps[i].type_ids?that.showCCData=!0:that.showCCData=!1;break}}},that.changeMode=function(mode){that.mode!=mode&&(that.mode=mode,"profile"==that.mode?that.getRestaurantAuditProfile():"schedule"==that.mode?(that.getScheduledAudits(),that.getSkribleAuditors()):"auditor"==that.mode&&that.getAuditorTransactionSummary())},this.exportReport=function(type){"auditor"==type&&this.downloadCSV()},this.downloadCSV=function(){that.export_loading=!0;const getData=[];that.trans_summary.forEach(function(data){getData.push({Restaurant:data.restaurant_name,AuditDate:data.audit_date,Auditor:data.auditor_name,StartTime:data.start_time,EndTime:data.end_time,Duration:data.duration,Budget:null==data.budget_in_hrs?0:data.budget_in_hrs,Variance:data.duration-(null==data.budget_in_hrs?0:data.budget_in_hrs),ReviewInMin:60*data.review_duration,Efficiency:data.efficiency,ErrorRate:data.error_rate,AuditClosedAt:data.audit_closed_at})});const headers=["Restaurant","AuditDate","Auditor","StartTime","EndTime","Duration","Budget","Variance","ReviewInMin","Efficiency","ErrorRate","AuditClosedAt"];var csv=headers.join(",")+"\r\n";getData.forEach(function(row){const values=headers.map(function(header){return row[header]});csv+=values.join(",")+"\r\n"});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="Auditor Performance.csv",hiddenElement.click(),that.export_loading=!1},that.$onInit=function(){that.subscription_type_id=$rootScope.subscription_type_id,that.loading=!1,that.export_loading=!1,that.changeInvType()}}auditControlCenterController.$inject=["api","$state","auth","core","localStorageService","alertService","SweetAlert","$uibModal","restaurant","$rootScope","$scope","$q"],angular.module("inspinia").component("auditControlCenterComponent",{templateUrl:"js/components/administrator/auditControlCenter/auditControlCenter.html",controller:auditControlCenterController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("administrator.auditControlCenter",{url:"/audit-control-center",template:"<audit-control-center-component></audit-control-center-component>",data:{pageTitle:"Audit Control Center"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]}])}}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("administrator.inventoryComplete",{url:"/inventory-complete",templateUrl:"js/components/administrator/inventoryComplete/inventoryComplete.html",data:{pageTitle:"Inventory Complete"}})})}(),function(){"use strict";function inviteController(api,$state,auth,core,$uibModal,alertService,SweetAlert,localStorageService,restaurant,$rootScope){if(!auth.authentication.isLogged)return void $state.go("login");var that=this;if(that.form={},that.api=api,that.usersList=[],that.typeIdSubscription=null,that.get_refbooks=[],that.authenticationUserId=auth.authentication.user.id,that.api.get_modules({is_tree_mode:1,subscription_type_id:$rootScope.subscription_type_id}).then(function(res){that.modules_tree=res.data.data.modules_tree}),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");$rootScope.$on("restaurantSelected",function(){that.api.get_modules({is_tree_mode:1,subscription_type_id:$rootScope.subscription_type_id}).then(function(res){that.modules_tree=res.data.data.modules_tree}),that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),api.get_restaurant(that.restaurant_id.restaurant_id).then(function(res){try{var restaurant_to_edit=res.data.data.restaurants_list[0];that.usersList=restaurant_to_edit.employees||[],that.checkEmpType(),that.typeIdSubscription=restaurant_to_edit.subscription_type_id}catch(e){$state.go("home")}}),that.checkEmpType=function(){var emps=that.usersList;if(that.user={userid:null,user_type_id:null},that.user.userid=that.authenticationUserId,1!=that.user.userid)for(var i=0;emps.length>i;i++)if(emps[i].id==that.user.userid){that.user.user_type_id=emps[i].type_ids;break}},that.$onInit=function(){core.getRefbooks().then(function(res){that.get_refbooks=res})},that.userTypesFilter=function(type_id){if(that.get_refbooks.user_types)for(var i=0;that.get_refbooks.user_types.length>i;i++)if(that.get_refbooks.user_types[i].id===type_id)return that.get_refbooks.user_types[i].name},that.delete=function($index,user){that.usersList[$index].id?SweetAlert.swal({title:"Are you sure?",text:"This user will be deleted from this restaurant",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){if(res){var m={user_type_id:user.type_ids,user_id:user.id};that.api.delete_invite(that.restaurant_id.restaurant_id,m).then(function(res){1e3===res.data.data.code&&that.usersList.splice($index,1)})}}):that.usersList.splice($index,1)},that.addUser=function(){$uibModal.open({animation:!0,templateUrl:"add-user-for-invite.html",controller:addUserInviteController,controllerAs:"vm",resolve:{user:function(){return null},who:that.user,refbooks:that.get_refbooks,modules:angular.copy(that.modules_tree)}}).result.then(function(user){user&&that.usersList.push(user)},function(){})},that.editUser=function(user,$index){$uibModal.open({animation:!0,templateUrl:"add-user-for-invite.html",controller:addUserInviteController,controllerAs:"vm",resolve:{user:function(){return user},refbooks:that.get_refbooks,modules:angular.copy(that.modules_tree)}}).result.then(function(user){user&&(that.usersList[$index]=user)},function(){})},that.changeUserStatus=function(user,$index){user.id&&SweetAlert.swal({title:"Are you sure?",text:"This user will be blocked and wouldn't be able work with this restaurant",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){if(res){var id=that.restaurant_id.restaurant_id,m={employees:[{user_id:user.id,user_type_id:user.type_ids,is_disabled:user.is_disabled}]};that.api.change_restaurant_employee_status(id,m).then(function(res){},function(error){that.usersList[$index].is_disabled=1===user.is_disabled?0:1})}else that.usersList[$index].is_disabled=1===user.is_disabled?0:1})},that.sentInvitations=function(isExit){if(!that.usersList.length)return void alert("Please add users before sending");for(var sentList=[],i=0;that.usersList.length>i;i++){var u={email:that.usersList[i].email,first_name:that.usersList[i].first_name,last_name:that.usersList[i].last_name,type_ids:[that.usersList[i].type_ids],is_disabled:that.usersList[i].is_disabled};that.usersList[i].permissions&&(u.permissions=that.usersList[i].permissions),sentList.push(u)}var model={users:sentList,restaurant_id:that.restaurant_id.restaurant_id};that.api.users_invite(model).then(function(res){1e3===res.data.data.code&&alertService.showSuccessText("Invitations were sent"),isExit?$state.go("home"):$state.go("admin.homeMenu")})}}var addUserInviteController=function(api,localStorageService,who,user,refbooks,modules,$uibModalInstance,alertService,restaurant){var that=this;that.form={},
that.userTypes=refbooks.user_types,that.modules=modules,that.myGrantLevel=restaurant.data.info.grant_level,that.restaurantSubscriptionTypeId=restaurant.data.info.subscription_type_id,that.restaurant_id=localStorageService.get("restaurant_id"),user&&user.permissions&&(that.modules=user.permissions),that.m={email:user?user.email:null,first_name:user?user.first_name:null,last_name:user?user.last_name:null,type_ids:user?user.type_ids:null,is_disabled:user?user.is_disabled:1},that.roleFilter=function(user){if(1!==who.userid)if(10==who.user_type_id){if(7==user.id||8==user.id)return!1}else if(7==user.id||8==user.id||9==user.id||10==user.id)return!1;return 2==that.restaurantSubscriptionTypeId||6==that.restaurantSubscriptionTypeId?2==user.subscription_type_id||3==user.subscription_type_id||6==that.restaurantSubscriptionTypeId||7==that.restaurantSubscriptionTypeId:1==that.restaurantSubscriptionTypeId||5==that.restaurantSubscriptionTypeId?1==user.subscription_type_id||3==user.subscription_type_id||5==that.restaurantSubscriptionTypeId||7==that.restaurantSubscriptionTypeId:3==that.restaurantSubscriptionTypeId||7==that.restaurantSubscriptionTypeId?1==user.subscription_type_id||2==user.subscription_type_id||3==user.subscription_type_id||5==user.subscription_type_id||6==user.subscription_type_id||7==user.subscription_type_id:void 0},that.grantLevelFilter=function(user){return user.grant_level>=that.myGrantLevel},that.add=function(form){form.$valid&&api.check_if_employee_exists(that.restaurant_id.restaurant_id+"&"+that.m.email).then(function(res){try{if("true"==res.data.data.does_exist.does_exist[0].emp_exists)return void alertService.showError("User already exists");7===that.m.type_ids&&(that.m.permissions=that.modules),$uibModalInstance.close(that.m)}catch(e){console.log("error")}})},that.close=function(){$uibModalInstance.dismiss("cancel")}};inviteController.$inject=["api","$state","auth","core","$uibModal","alertService","SweetAlert","localStorageService","restaurant","$rootScope"],angular.module("inspinia").component("adminInviteComponent",{templateUrl:"js/components/administrator/invite/invite.html",controller:inviteController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("administrator.invite",{url:"/invite",template:"<admin-invite-component></admin-invite-component>",data:{pageTitle:"Invite Users"}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("administrator.menu",{url:"/menu",templateUrl:"js/components/administrator/menu/menu.html",data:{pageTitle:"Administrator"}})})}(),function(){"use strict";function posSyncController(api,$state,auth,localStorageService,restaurant,$rootScope){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.base_api_url=appConfig.apiDomain,that.form={},that.api=api,that.auth=auth,that.posSyncList=[],that.setupStatus=restaurant.data.info.is_setup_completed,$rootScope.$on("restaurantSelected",function(){that.pos_id=$state.params.pos_id||restaurant.data.info.pos_id,that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),restaurant.data.info&&(that.pos_id=$state.params.pos_id||restaurant.data.info.pos_id),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.selectSyncPos=function(pos){$state.includes("foodSetup")?$state.go("foodSetup.addPosHere",{pos_id:pos.id}):$state.includes("alcoholSetup")?$state.go("alcoholSetup.addPosHere",{pos_id:pos.id}):$state.go("administrator.addPosHere",{pos_id:pos.id})},that.$onInit=function(){api.get_pos_list().then(function(res){that.posSyncList=res.data.data.list,that.posSyncList.splice(0,1)})},that.back=function(){$state.includes("foodSetup")?$state.go("foodSetup.confirmation"):$state.includes("alcoholSetup")?$state.go("alcoholSetup.confirmation"):$state.go("administrator.menu")}}posSyncController.$inject=["api","$state","auth","localStorageService","restaurant","$rootScope"],angular.module("inspinia").component("posSyncComponent",{templateUrl:"js/components/administrator/posSync/posSync.html",controller:posSyncController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("administrator.posSync",{url:"/pos_sync/:pos_id",template:"<pos-sync-component></pos-sync-component>",data:{pageTitle:"POS Sync"}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("administrator.restaurantPayment",{url:"/restaurant-payment",template:"<payment-component></payment-component>",data:{pageTitle:"Payment"}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("administrator.restaurantProfile",{url:"/restaurant-profile",template:"<restaurant-profile-component></restaurant-profile-component>",data:{pageTitle:"Restaurant Profile"}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("alcohol.orderSummary",{url:"/order-summary",template:"<order-summary-component></order-summary-component>",data:{pageTitle:"Alcohol Order Summary"}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("alcoholSetup.addPosHere",{url:"/add_pos_here/:pos_id",template:"<add-pos-here-component></add-pos-here-component>",data:{pageTitle:"Add POS Here"}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("alcoholSetup",{url:"/alcohol",data:{pageTitle:" Alcohol Setup"},abstract:!0,template:"<ui-view></ui-view>",resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]}])}}})})}(),function(){"use strict";function controller(api,$state,auth,localStorageService,$rootScope,restaurant,core,$scope){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.form={},that.$state=$state,that.core=core,that.api=api,that.auth=auth,that.m={},that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),$scope.SetUpStatus=0,restaurant.data.info&&($scope.SetUpStatus=restaurant.data.info.is_setup_completed),that.showInfo=function(){$uibModal.open({animation:!0,templateUrl:"quick_tutorial.html",controller:qt,controllerAs:"qt",windowClass:"animated fadeIn modal-lgg",size:"lg"})},that.next=function(form){if(form.$valid){var m={restaurant_id:that.restaurant_id.restaurant_id,serving_details:[]};for(var key in that.m)m.serving_details.push({serving_type_id:key,quantity:that.m[key]});that.api.save_bar_serving_details(m).then(function(res){try{1e3===res.data.data.code&&that.$state.go("alcoholSetup.menu")}catch(e){console.log(e)}})}},that.$onInit=function(){var resId=that.restaurant_id.restaurant_id;that.api.bar_serving_details(resId).then(function(res){try{var db=res.data.data.bar_servings.serving_details;angular.forEach(db,function(v,k){that.m[v.serving_type_id.toString()]=v.quantity})}catch(e){console.log(e)}}),that.core.getRefbooks().then(function(res){that.bar_serving_details_types=res.bar_serving_details_types})}}var qt=function($uibModalInstance){var that=this;that.q_title="Bar Serving Details Instructions",that.q_texts='<article style="display: block;"><p><b>Bar Serving Details</b>  Having a standard serving amount is extremely important. By knowing this data we Artecsan can help make your setup easier and analyze budgets with more insight</p></article>',that.skip=function(){$uibModalInstance.dismiss("cancel")}};controller.$inject=["api","$state","auth","localStorageService","$rootScope","restaurant","core","$scope"],angular.module("inspinia").component("barServingDetails",{templateUrl:"js/components/alcoholSetup/barServingDetails/barServingDetails.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("alcoholSetup.serving-details",{url:"/serving-details",template:"<bar-serving-details></bar-serving-details>",data:{pageTitle:"Bar Serving Details"}})})}(),function(){"use strict";function modalController($uibModal,$uibModalInstance,menu,filtered_menus,rest_id,get_refbooks,ingredients,alertService,SweetAlert,api){var that=this;that.form={},that.ingredients=ingredients;for(var i in that.ingredients)that.ingredients[i].item_name=that.ingredients[i].item_name+" ("+that.ingredients[i].vendor_name+")";that.ingredients.unshift({id:-1,item_name:"(+) Add a new Inventory Item"}),that.menus=[],that.filter_pl=0,that.get_refbooks=get_refbooks,that.menu=menu,that.filtered_menus=filtered_menus,that.rest_id=rest_id,that.mindex=0,that.stdisable=menu,that.api=api,that.savename=null,that.savelevel=null,that.savePL1=null,that.default_note=" Hover the mouse pointer over the form field headings to display their purpose.",that.current_note=that.default_note,that.notes={min:"Please enter the menu item name EXACTLY as it appears in your POS. To add your ingredients please select the plus symbol below the Ingredients header below.",pl:"Your P.O.S. normally has pricing levels for each Menu Item which can be used for discounts and drink special. Your default pricing level is usually pricing level 1 however if your restaurant uses multiple pricing level please select the level to match your POS. If you do not use pricing levels please select a 0.",category:"The first ingredient of the menu item dictates its sales category.",price:"Please enter the correct retail price that matches the menu item name and price level in your POS.",cp:"Represents your cost percentage for this menu item.",tc:"Represents your total dollar cost for this menu item.",st:"There are three options for serving type. Basic is your standard serving which is usually an amount poured from a bottle (example 1.5oz, 2oz, etc). A Batch is considered a large container meant to service multiple customers in multiple seating (example Margarita Mix). A Full Bottle/Beer  accounts for the serving of a full bottle of beer, wine, liquor or keg.",ss:"This represents the total alcohol ounces to be served to a customer. For a batch you must assign a serving size which is usually represented by the glass size which you will serve to the customer.",tro:"This represents total alcohol and non-alcoholic content in your recipe",ts:"Represents how many customers can be served based on the serving size and recipe ounces for the menu item.",i:"Please select the plus symbol below and to the right. Here you will add your ingredients for the menu item. The ingredients will include the item, recipe amount and unit of measure.",iname:"The items you selected in the previous steps are populated here and can be used as ingredients in your recipe. Please select the desired ingredient. If you do not see your desired ingredient please return to the previous step, select your item and return here to use your item.",iuom:"Please select the appropriate unit of measure. Alcohol is most frequently measured in ounces or full bottles, cans or kegs.",ira:"Please select how many ounces or bottles you will use for this ingredient. For examplethe standard recipe amount for alcohol is 1.25 ounces so you would enter 1.25.The best method is to measure your pour, set a standard and train your bartenders.",iops:"This is usually relevant when creating a Batch. For each specific item, ounces per serving tells you how many ounces of liquid each customer will receive when served.",iupr:"This is more relevant when creating a Batch. Usage per Recipe tells you how many total ounces of liquid you will be using in your recipe for each individual item.",icost:"Ingredient cost based on total price and serving size.",c:"You may also add comment to each menu item."},that.all_pricing_levels=[{name:0,level:"0"},{name:1,level:"1"},{name:2,level:"2"},{name:3,level:"3"},{name:4,level:"4"},{name:5,level:"5"},{name:6,level:"6"},{name:7,level:"7"},{name:8,level:"8"},{name:9,level:"9"},{name:10,level:"10"}],that.selected_pricing_level=that.all_pricing_levels[0].name,that.model={menu_item_name:menu?menu.menu_item_name:null,pricing_level:menu?menu.pricing_level:1,category:menu?menu.category:null,price:menu?menu.price:null,cost_margin:menu?menu.cost_margin:0,total_cost:menu?menu.cost:0,serving_type:menu?menu.serving_type:null,serving_size:menu?menu.serving_size:null,total_recipe_oz:menu?menu.oz_total:0,total_servings:menu?menu.total_servings:0,description:menu?menu.description:null,ingredients:menu?menu.menu_items:[]},that.reset_mindex=function(){if(menu)for(var i=0;i<that.filtered_menus.length;i++)if(that.menu.id==that.filtered_menus[i].id){that.mindex=i;break}},that.reset_mindex(),that.reset_model=function(){that.model.menu_item_name=null,that.model.pricing_level=1,that.model.category=null,that.model.price=null,that.model.cost_margin=0,that.model.total_cost=0,that.model.serving_type=null,that.model.serving_size=null,that.model.total_recipe_oz=0,that.model.total_servings=0,that.model.description=null,that.model.ingredients=[],that.selected_pricing_level=1,that.savePL1=null},that.savePL1=that.model.menu_item_name,that.selected_pricing_level=that.model.pricing_level,that.checkServingType=function(){if(3===that.model.serving_type&&(that.model.ingredients=[{recipe_id:null,vendor_sku_id:null,bar_recipe_uom_id:1,recipes_amount:1,oz_per_serving:0,usage_in_units:0,cost:0,content_weight:0,unit_cost:0,full_weight:0,time:(new Date).getTime()}]),1===that.model.serving_type||2===that.model.serving_type)return 1===that.model.serving_type&&(that.model.total_servings=1),void(0==that.model.ingredients.length&&(that.model.ingredients=[{recipe_id:null,vendor_sku_id:null,bar_recipe_uom_id:2,recipes_amount:0,oz_per_serving:0,usage_in_units:0,cost:0,content_weight:0,unit_cost:0,full_weight:0,time:(new Date).getTime()}]))},that.setAdditionalFields=function($index){var is_insert_new_inv=-1==that.model.ingredients[$index].vendor_sku_id;-1==that.model.ingredients[$index].vendor_sku_id&&(that.model.ingredients[$index].vendor_sku_id=that.model.ingredients[$index].bu_vendor_sku_id?that.model.ingredients[$index].bu_vendor_sku_id:null),that.model.ingredients[$index].bu_vendor_sku_id=that.model.ingredients[$index].vendor_sku_id,angular.isUndefined(that.model.ingredients[$index].vendor_sku_id)||null==that.model.ingredients[$index].vendor_sku_id||0!=$index||that.api.get_menu_category(that.model.ingredients[$index].vendor_sku_id).then(function(res){that.model.category=res.data.data.category[0].category});for(var i=0;that.ingredients.length>i;i++)if(that.model.ingredients[$index].vendor_sku_id===that.ingredients[i].id){that.model.ingredients[$index].full_weight=that.ingredients[i].full_weight,that.model.ingredients[$index].unit_cost=that.ingredients[i].unit_cost,that.model.ingredients[$index].content_weight=that.ingredients[i].content_weight||that.ingredients[i].full_weight-that.ingredients[i].tare_weight,that.model.ingredients[$index].tare_weight=that.ingredients[i].tare_weight;break}is_insert_new_inv&&SweetAlert.swal({title:"Discard Progress?",text:"This will open a new window and you may lose your progress. Go back to save your progress or proceed",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Discard Progress & Continue",cancelButtonText:"Go Back"},function(res){res&&($uibModalInstance.dismiss("cancel"),$uibModal.open({templateUrl:"add_new_alcohol_inventory_item.html",controller:newAlcoholItem_modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",size:"lg2x",resolve:{vendor_list:function(){return that.vendors?that.vendors:that.api.get_chosen_vendors(that.rest_id,{vendor_type_id:2}).then(function(res){return that.vendors=res.data.data.vendors})},inventory_type_id:function(){return 2},restaurant_id:function(){return that.rest_id}}}))})},that.update_note=function(key){that.current_note=" "+that.notes[key]},that.reset_note=function(){that.current_note=that.default_note},that.prev_menu_item=function(){0!=that.mindex&&(that.mindex--,that.api.get_menu_by_id(that.filtered_menus[that.mindex].id).then(function(res){that.reset_model(),that.menu=res.data.data.menus_list[0],that.model={menu_item_name:that.menu?that.menu.menu_item_name:null,pricing_level:that.menu?that.menu.pricing_level:1,category:that.menu?that.menu.category:null,price:that.menu?that.menu.price:null,cost_margin:that.menu?that.menu.cost_margin:0,total_cost:that.menu?that.menu.cost:0,serving_type:that.menu?that.menu.serving_type:null,serving_size:that.menu?that.menu.serving_size:null,total_recipe_oz:that.menu?that.menu.oz_total:0,total_servings:that.menu?that.menu.total_servings:0,description:that.menu?that.menu.description:null,ingredients:that.menu?that.menu.menu_items:[]},that.savePL1=that.model.menu_item_name,that.selected_pricing_level=that.model.pricing_level;for(var i=0;that.model.ingredients.length>i;i++)that.setAdditionalFields(i)}))},that.next_menu_item=function(){that.mindex!=that.filtered_menus.length-1&&(that.mindex++,that.api.get_menu_by_id(that.filtered_menus[that.mindex].id).then(function(res){that.reset_model(),that.menu=res.data.data.menus_list[0],that.model={menu_item_name:that.menu?that.menu.menu_item_name:null,pricing_level:that.menu?that.menu.pricing_level:1,category:that.menu?that.menu.category:null,price:that.menu?that.menu.price:null,cost_margin:that.menu?that.menu.cost_margin:0,total_cost:that.menu?that.menu.cost:0,serving_type:that.menu?that.menu.serving_type:null,serving_size:that.menu?that.menu.serving_size:null,total_recipe_oz:that.menu?that.menu.oz_total:0,total_servings:that.menu?that.menu.total_servings:0,description:that.menu?that.menu.description:null,ingredients:that.menu?that.menu.menu_items:[]},that.savePL1=that.model.menu_item_name,that.selected_pricing_level=that.model.pricing_level;for(var i=0;that.model.ingredients.length>i;i++)that.setAdditionalFields(i)}))},that.delete_current=function(){that.api.get_menu_by_name_and_pricing_level(that.model.menu_item_name+"&"+that.selected_pricing_level).then(function(res){var len=res.data.data.menus_list.length,del_item=res.data.data.menus_list[0];1==len?swal({title:"Are you sure?",text:"This menu will be deleted",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){res&&that.api.delete_menu(del_item.id).then(that.update_details)}):0==len&&swal({title:"Nothing to delete!",timer:1500,showConfirmButton:!1,type:"warning"})})},that.update_details=function(){that.savename=that.model.menu_item_name,that.savelevel=that.selected_pricing_level,that.api.get_menu_by_name_and_pricing_level(that.model.menu_item_name+"&"+that.selected_pricing_level).then(function(res){var len=res.data.data.menus_list.length,edit_item=res.data.data.menus_list[0];1==len?(that.stdisable=!0,that.model.price=edit_item.price,that.model.cost_margin=edit_item.cost_margin,that.model.total_cost=edit_item.cost,that.model.serving_type=edit_item.serving_type,that.model.serving_size=edit_item.serving_size,that.model.total_recipe_oz=edit_item.oz_total,that.model.ingredients=edit_item.menu_items,that.model.description=edit_item.description):0==len&&(that.stdisable=!1,that.reset_model(),that.model.menu_item_name=that.savename,that.model.pricing_level=that.savelevel,that.selected_pricing_level=that.savelevel)})},that.calculate=function($index){if($index&&0==that.model.ingredients[$index].recipes_amount)return void(that.model.ingredients[$index].recipes_amount=null);var _p=function(v){if(v)return parseFloat(v.toFixed(3))},price=that.model.price||0,total_cost=0,serving_type=that.model.serving_type,isButch=2===serving_type,serving_size=that.model.serving_size||0,total_recipe_oz=0,total_servings=1,cost_margin=0;(!isButch||serving_size&&serving_type&&price)&&(angular.forEach(that.model.ingredients,function(v,k){if(void 0!==v.recipes_amount&&null!==v.recipes_amount){var content_weight=v.content_weight||v.full_weight-v.tare_weight;v.usage_in_units=_p(1===v.bar_recipe_uom_id?content_weight*v.recipes_amount:v.recipes_amount),total_recipe_oz+=v.usage_in_units||0}}),angular.forEach(that.model.ingredients,function(v,k){v.content_weight||(v.full_weight,v.tare_weight),v.cost=_p(v.usage_in_units*v.unit_cost),total_cost+=v.cost}),isButch||(serving_size=total_recipe_oz,cost_margin=price?total_cost/price*100:0),isButch&&(total_servings=total_recipe_oz/serving_size,cost_margin=price?total_cost/(price*total_servings)*100:0),angular.forEach(that.model.ingredients,function(v,k){v.oz_per_serving=_p(isButch?v.usage_in_units/total_servings:v.usage_in_units)}),that.model.total_recipe_oz=_p(total_recipe_oz),that.model.total_servings=_p(total_servings),that.model.serving_size=_p(serving_size),that.model.total_cost=_p(total_cost),that.model.cost_margin=_p(cost_margin))},that.addIngredient=function(){that.model.ingredients.push(angular.copy({recipe_id:null,vendor_sku_id:null,bar_recipe_uom_id:null,recipes_amount:null,oz_per_serving:0,usage_in_units:0,cost:0,full_weight:0,time:(new Date).getTime()}))},that.removeIngredient=function($index){that.model.ingredients.splice($index,1),that.calculate(),that.model.ingredients.length>0?angular.isUndefined(that.model.ingredients[0].vendor_sku_id)||null==that.model.ingredients[0].vendor_sku_id?that.model.category=null:that.api.get_menu_category(that.model.ingredients[0].vendor_sku_id).then(function(res){that.model.category=res.data.data.category[0].category}):that.model.category=null},that.submit=function(form){if(!that.model.ingredients.length)return void alertService.showError("Please add at least one ingredient");if(form.$valid){for(var m={inventory_type_id:2,bar_serving_type_id:that.model.serving_type,menu_item_name:that.model.menu_item_name,pricing_level:that.selected_pricing_level,category:that.model.category,description:that.model.description,serving_size:that.model.serving_size,oz_total:that.model.total_recipe_oz,total_servings:that.model.total_servings,price:that.model.price,cost_margin:that.model.cost_margin,cost:that.model.total_cost,menu_items:[]},i=0;that.model.ingredients.length>i;i++)m.menu_items.push({recipe_id:that.model.ingredients[i].recipe_id,vendor_sku_id:that.model.ingredients[i].vendor_sku_id,bar_recipe_uom_id:that.model.ingredients[i].bar_recipe_uom_id,recipes_amount:that.model.ingredients[i].recipes_amount,oz_per_serving:that.model.ingredients[i].oz_per_serving,usage_in_units:that.model.ingredients[i].usage_in_units,cost:that.model.ingredients[i].cost});that.savePL1!=that.model.menu_item_name&&null!=that.savePL1?(that.api.update_menu(that.menu.id,m).then(function(res){try{1e3===res.data.data.code&&swal({title:"Menu Item updated successfully!",timer:1500,showConfirmButton:!1,type:"success"})}catch(e){console.log(e)}}),that.api.update_menu(that.model.menu_item_name+"&"+that.savePL1).then(function(res){try{res.data.data.code}catch(e){console.log(e)}})):that.stdisable?that.api.update_menu(that.menu.id,m).then(function(res){try{1e3===res.data.data.code&&swal({title:"Menu Item updated successfully!",timer:1500,showConfirmButton:!1,type:"success"})}catch(e){console.log(e)}}):that.api.save_menu(m).then(function(res){try{1e3===res.data.data.code&&swal({title:"New Menu Item created successfully!",timer:1500,showConfirmButton:!1,type:"success"})}catch(e){console.log(e)}})}},that.cancel=function(){$uibModalInstance.dismiss("cancel")}}function newAlcoholItem_modalController($uibModalInstance,alertService,api,core,restaurant_id,vendor_list,inventory_type_id,SweetAlert,$q){var that=this;that.form={},that.uniqueItem=[],that.categories=[],that.sub_categories=[],core.getRefbooks().then(function(res){that.refbooks=res,that.categories=res.vendor_cat,that.sub_categories=res.vendor_sub_cat}),that.api=api,that.model={},that.src="",that.vendor_list=vendor_list,that.selected_vendor=null,that.sku_lookup=function(search_for){return that.api.sku_lookup({search_for:search_for,vendor_id:that.selected_vendor}).then(function(res){return res.data.data.sku.slice(0,10)})},that.item_name_lookup=function(search_for){return that.api.item_name_lookup({search_for:search_for,vendor_id:that.selected_vendor}).then(function(res){return res.data.data.name})},that.submit=function(form){var deferred=$q.defer();return form.$valid?that.uniqueItem.length?void(null!=that.uniqueItem[0].vendor_sku&&that.uniqueItem[0].vendor_sku.length&&that.api.validateSKU({sku:that.uniqueItem[0].vendor_sku,vendor_id:that.selected_vendor}).then(function(res){if(res.data.data.sku_status.length&&"used"==res.data.data.sku_status[0].sku_status)return void alertService.showError("SKU already used!");for(var id=that.selected_vendor,m={inventory_type_id:2,sku_items:[]},i=0;that.uniqueItem.length>i;i++)m.sku_items.push({substitute_for:that.uniqueItem[i].substitute_for?that.uniqueItem[i].substitute_for:null,item_name:that.uniqueItem[i].item_name,tare_type_id:that.uniqueItem[i].tare_type_id,size:that.uniqueItem[i].content_weight||that.uniqueItem[i].size||1,content_weight:that.uniqueItem[i].content_weight||that.uniqueItem[i].size||1,full_weight:that.uniqueItem[i].full_weight,tare_weight:that.uniqueItem[i].tare_weight,total_unit_size:that.uniqueItem[i].case_qty*that.uniqueItem[i].pack*(that.uniqueItem[i].content_weight||that.uniqueItem[i].size||1),manufacturer:that.uniqueItem[i].manufacturer,vendor_sku:that.uniqueItem[i].vendor_sku,case_qty:that.uniqueItem[i].case_qty,pack:that.uniqueItem[i].pack,price:"Case"==that.uniqueItem[i].minimum_order_type?that.uniqueItem[i].case_cost:that.uniqueItem[i].pack_cost,vendor_cat_id:that.uniqueItem[i].vendor_cat_id,uom_id_of_delivery_unit:5,vendor_sub_cat_id:that.uniqueItem[i].vendor_sub_cat_id,is_active:that.uniqueItem[i].is_active,minimum_order_type:that.uniqueItem[i].minimum_order_type,id:that.uniqueItem[i].id});return that.api.add_update_own_inventory(id,m).then(function(res){1e3===res.data.data.code&&(that.clear(),alertService.showAlertSave(),deferred.resolve())}),deferred.promise})):(alertService.showError("Please, add at least one item"),deferred.reject(),deferred.promise):(alertService.showError("Please validate all inputs"),deferred.reject(),deferred.promise)},that.apply_values=function($item){that.src=$item.src,that.uniqueItem[0].vendor_sku=$item.vendor_sku,that.uniqueItem[0].item_name=$item.item_name,that.uniqueItem[0].vendor_cat_id=$item.vendor_cat_id,that.changeMOT(0),that.uniqueItem[0].vendor_sub_cat_id=$item.vendor_sub_cat_id,that.uniqueItem[0].tare_type_id=$item.tare_type_id,that.uniqueItem[0].full_weight=$item.full_weight,that.uniqueItem[0].pack=$item.pack,that.uniqueItem[0].case_cost=$item.case_cost,that.uniqueItem[0].pack_cost=$item.pack_cost,that.setWeights(0,$item.vendor_cat_id,$item.vendor_sub_cat_id,$item.tare_type_id),that.calculate(0),that.uniqueItem[0].substitute_for=$item.substitute_for},that.getSizes=function(cat_id,sub_cat_id){if(!cat_id&&!sub_cat_id)return[];for(var _a=[],i=0;that.refbooks.default_weights.length>i;i++)if(that.refbooks.default_weights[i].vendor_cat_id===cat_id&&that.refbooks.default_weights[i].vendor_sub_cat_id===sub_cat_id)for(var j=0;that.refbooks.tare_types.length>j;j++)that.refbooks.tare_types[j].tare_type_id===that.refbooks.default_weights[i].tare_type_id&&-1===_a.indexOf(that.refbooks.tare_types[j])&&_a.push(that.refbooks.tare_types[j]);return _a},that.calculate=function($index){var t=that.uniqueItem[$index].pack||1,u=that.uniqueItem[$index].pack_cost||1,c=that.uniqueItem[$index].case_qty||1;that.uniqueItem[$index].case_cost=parseFloat((t*u*1*c).toFixed(2))},that.setWeights=function($index,cat_id,sub_cat_id,tare_type_id){for(var i=0;that.refbooks.default_weights.length>i;i++)if(that.refbooks.default_weights[i].vendor_sub_cat_id===sub_cat_id&&that.refbooks.default_weights[i].vendor_cat_id===cat_id&&that.refbooks.default_weights[i].tare_type_id===tare_type_id){var f=71===that.uniqueItem[$index].vendor_cat_id?that.refbooks.default_weights[i].full_weight:that.uniqueItem[$index].full_weight,c=that.refbooks.default_weights[i].content_weight;that.uniqueItem[$index].tare_weight=f-c||0,that.uniqueItem[$index].content_weight=c,76===that.uniqueItem[$index].vendor_cat_id&&(that.uniqueItem[$index].tare_weight=0,that.uniqueItem[$index].content_weight=f*c)}if(cat_id&&sub_cat_id&&(74==cat_id||75==cat_id||99==cat_id))for(var i=0;that.refbooks.default_weights.length>i;i++)if(that.refbooks.default_weights[i].vendor_cat_id===cat_id&&that.refbooks.default_weights[i].vendor_sub_cat_id===sub_cat_id&&that.refbooks.default_weights[i].tare_type_id===tare_type_id){that.uniqueItem[$index].full_weight=that.refbooks.default_weights[i].full_weight,that.uniqueItem[$index].tare_weight=that.refbooks.default_weights[i].tare_weight,that.uniqueItem[$index].content_weight=that.refbooks.default_weights[i].content_weight;break}},that.addUniqueItem=function(){that.uniqueItem.push({item_name:null,size:null,full_weight:null,content_weight:null,tare_weight:null,manufacturer:null,vendor_sku:null,case_qty:1,total_unit_size:null,price:null,pack_cost:null,vendor_cat_id:that.categories.length?that.categories[0].id:null,uom_id_of_delivery_unit:5,vendor_sub_cat_id:that.sub_categories.length?that.sub_categories[0].id:null,is_active:1,minimum_order_type:"Pack",id:null,substitute_for:null})},that.filterItems=function(){that.inventoryListSelected=[];for(var i=0;i<that.inventoryItems.length;i++)that.inventoryItems[i].vendor_cat_id==that.uniqueItem[0].vendor_cat_id&&that.inventoryListSelected.push(that.inventoryItems[i]);if(that.inventoryListSelected.length){var first=JSON.stringify(that.inventoryListSelected[0]);that.inventoryListSelected.unshift(JSON.parse(first)),that.inventoryListSelected[0].id=null,that.inventoryListSelected[0].vendor_name="--No selection--",that.inventoryListSelected[0].item_name="--No selection--"}},that.getInventoriesByVendor=function(){that.api.get_active_inventory_by_vendor({inventory_type_id:2,caller:"sub_list"},restaurant_id).then(function(res){that.inventoryItems=res.data.data.sku,that.filterItems()})},that.changeMOT=function($index){that.uniqueItem[$index].full_weight=null,74==that.uniqueItem[$index].vendor_cat_id?that.uniqueItem[$index].minimum_order_type="Case":that.uniqueItem[$index].minimum_order_type="Pack",that.filterItems()},that.addUniqueItem(),that.getInventoriesByVendor(),that.clear=function(){that.uniqueItem=[],that.uniqueItem.push({vendor_sku:null,pack:null,uom_id_of_delivery_unit:null,item_name:null,vendor_cat_id:null,vendor_sub_cat_id:null,is_active:1,size:null,case_cost:null,minimum_order_type:"Case",id:null,substitute_for:null}),that.src=""},that.cancel=function(){$uibModalInstance.dismiss("cancel")}}function controller(api,$state,auth,localStorageService,$uibModal,core,alertService,SweetAlert,$rootScope,restaurant,$scope){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.form={},that.api=api,that.core=core,that.auth=auth,that.restaurant_id=localStorageService.get("restaurant_id"),that.status="active",that.has_ig="all",!that.restaurant_id)return void $state.go("home");restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),$scope.SetUpStatus=0,restaurant.data.info&&($scope.SetUpStatus=restaurant.data.info.is_setup_completed),$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),that.showInfo=function(){$uibModal.open({animation:!0,templateUrl:"quick_tutorial.html",controller:qt,controllerAs:"qt",windowClass:"animated fadeIn modal-lgg",size:"lg"})},that.createMissingMenus=function(){that.api.create_missing_menus({inventory_type_id:2
}).then(function(res){SweetAlert.swal({title:"Menus Created Successfully!",text:"Please find the new menus (marked in red) and proceed to add the ingredients in them. Also note these menus are being mapped to POS data as of now. Please allow a few minutes for the mapping to update.",type:"success",confirmButtonText:"OK"},function(res){that.getAllMenu()})})},that.updateMenuPrices=function(){SweetAlert.swal({title:"Are you sure?",text:"This will update the prices of all the menus to their latest average sales price.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){res&&that.getAllMenu(!0)})};var generateFile=function(menuList){const menuHeaders=["id","MenuItemName","PricingLevel","Category","Price","CostMargin","TotalCost","ServingType","ServingSize","TotalRecipeOz","TotalServings","Comments"],recipeHeaders=["IngredientItemName","UnitOfMeasure","RecipeAmt","OuncesPerServing","UsagePerRecipe","Cost"];var csv="";csv+=menuHeaders.join(",")+",",csv+=recipeHeaders.join(",")+"\r\n",menuList&&menuList.length&&menuList.forEach(function(menu){const m_values=menuHeaders.map(function(header){return menu[header]});menu.recipes&&menu.recipes.length?menu.recipes.forEach(function(recipe){const r_values=recipeHeaders.map(function(header){return recipe[header]});csv+=m_values.join(",")+",",csv+=r_values.join(",")+"\r\n"}):(csv+=m_values.join(",")+",",csv+=recipeHeaders.map(function(header){return","}).join("")+"\r\n")});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="Menu_list(alcohol).csv",hiddenElement.click(),that.export_loading=!1};this.downloadCSV=function(){that.export_loading=!0;const menuList=[];var refBooks=null,vendor=null,menus=this.filtered_menus,all_menus=[],menus_to_export=[];that.core.getRefbooks().then(function(res){refBooks=res}).then(function(){return that.api.get_menus({inventory_type_id:2,mode:"export"}).then(function(res){all_menus=res.data.data.menus_list;for(var rx in menus)for(var ax in all_menus)if(menus[rx].id==all_menus[ax].id){menus_to_export.push(all_menus[ax]);break}})}).then(function(){return that.api.get_active_inventory_by_vendor({inventory_type_id:2},that.restaurant_id.restaurant_id).then(function(response){vendor=response})}).then(function(){return new Promise(function(resolve,reject){function getServingType(st_id){for(var ri in refBooks.bar_serving_types)if(refBooks.bar_serving_types[ri].id==st_id)return refBooks.bar_serving_types[ri].name;return""}function next(){var menu=menus_to_export[index];if(!menu)return resolve(menuList);var menuData=new Object({id:menu.id,MenuItemName:menu.menu_item_name.replace(/[,'#]/g,""),PricingLevel:menu.pricing_level,Category:menu.category,Price:menu.price,TotalCost:menu.cost,CostMargin:menu.cost_margin,ServingType:getServingType(menu.serving_type),ServingSize:menu.serving_size,TotalRecipeOz:menu.oz_total,TotalServings:menu.total_servings,Comments:null==menu.description?menu.description:menu.description.replace(/[,'#\r\n|\n|\r]/g," ")+"",recipes:new Array});menu.menu_items.forEach(function(recipe,ingredientIndex){for(var vi in vendor.data.data.sku){var sku=vendor.data.data.sku[vi];if(sku.id===recipe.vendor_sku_id){menuData.recipes.push({IngredientItemName:sku.item_name.replace(/[,'#]/g,"")+" ("+sku.vendor_name.replace(/[,'#]/g,"")+")",UnitOfMeasure:sku.unit_of_delivery,RecipeAmt:recipe.recipes_amount,OuncesPerServing:recipe.oz_per_serving,UsagePerRecipe:recipe.usage_in_units,Cost:recipe.cost});break}}}),menuList.push(menuData),index++,next()}var index=0;next()})}).then(function(){generateFile(menuList)})},that.edit=function(menu){that.api.get_menu_by_id(menu.id).then(function(res){that.add(res.data.data.menus_list[0])})},that.deactivate=function(menu_id){that.api.act_deact_menu_item({item:[{action:"deactivate"}],id:menu_id}).then(function(res){that.getAllMenu()})},that.activate=function(menu_id){that.api.act_deact_menu_item({item:[{action:"activate"}],id:menu_id}).then(function(res){that.getAllMenu()})},that.changeList=function(){that.getAllMenu()},that.delete=function(menu){menu.id&&SweetAlert.swal({title:"Are you sure?",text:"This menu will be deleted",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){res&&that.api.delete_menu(menu.id).then(that.getAllMenu)})},that.apply_filter=function(){var pl=that.filter_pl;that.filtered_menus=null==pl||void 0==pl?that.menus.filter(function(x){return"yes"==that.has_ig?"Other"!=x.category:"no"!=that.has_ig||"Other"==x.category}):that.menus.filter(function(x){return x.pricing_level==pl&&("yes"==that.has_ig?"Other"!=x.category:"no"!=that.has_ig||"Other"==x.category)}),that.export_loading=!1},that.getAllMenu=function(upd_price){that.api.get_menus({inventory_type_id:2,update_price:upd_price||!1,menu_item_name:null!=that.search_menu?that.search_menu:"",recipe_item_name:null!=that.search_ingredient?that.search_ingredient:""}).then(function(res){try{that.menus=res.data.data.menus_list,that.curr_menus=[];for(var i=0;i<that.menus.length;i++)"active"==that.status&&1==that.menus[i].is_active?that.curr_menus.push(that.menus[i]):"inactive"==that.status&&0==that.menus[i].is_active&&that.curr_menus.push(that.menus[i]);that.menus=that.curr_menus,that.apply_filter()}catch(e){}})},that.getAllMenu(),that.add=function(menu){$uibModal.open({templateUrl:"add_new_menu_item.html",controller:modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",size:"lg",resolve:{menu:function(){return menu},filtered_menus:function(){if(menu)return that.filtered_menus},get_refbooks:function(){return that.get_refbooks?that.get_refbooks:that.core.getRefbooks().then(function(res){return that.get_refbooks=res})},ingredients:function(){return that.ingredients?JSON.parse(JSON.stringify(that.ingredients)):that.api.get_active_inventory_by_vendor({inventory_type_id:2,caller:"recipe_edit"},that.restaurant_id.restaurant_id).then(function(res){return that.ingredients=res.data.data.sku,JSON.parse(JSON.stringify(res.data.data.sku))})},rest_id:function(){return that.restaurant_id.restaurant_id}}}).result.then(function(){alertService.showAlertSave(),that.getAllMenu()},function(){that.getAllMenu()})},that.$onInit=function(){that.core.getRefbooks().then(function(res){that.get_refbooks=res,that.is_setup_completed=restaurant.data.info.is_setup_completed})}}var qt=function($uibModalInstance){var that=this;that.q_title="Menu Setup Instructions",that.q_texts='<article style="display: block;"><p><b>Alcohol Menu Setup</b>  This is where you will use your alcohol inventory items to duplicate the menu items in your POS.<br/><br/>Please check out our instruction video on setup <a href="https://youtu.be/DrzHflG3qP8" target="_blank">here</a>. In this section you may easily view your recipe cost and percentage. To begin please select New Menu Item. A new instruction popup screen should appear with the following fields:<br/><br/><b>Menu Item Name</b>  This is the name that should match the recipe name in your POS<br/><br/><b>Pricing Level</b>  This is the pricing level that should match the pricing level in your POS. Pricing levels are typically used to represent changes in prices such as happy hour or as a different serving size for the same item. For example, pricing level zero can be a price of Greygoose for regular hours, while pricing level 2 can be the Greygoose price during happy hour and pricing level 3 can be the pricing for a full bottle. Note: the pricing level should match your POS<br/><br/><b>Price$</b> - is the retail price for that item and pricing level.<br/><br/><b>Serving Type</b>  there are three serving type options which include basic, batch and full bottle. Basic is the standard pour such as 1.5oz or 2oz. Batch is for large pre-prepd mixes meant to server multiple people. Margaritas are a good. Full bottles are full bottles.<br/><br/><b>Serving Size</b>  this field will open up if you select Batch as your serving type. In this field you will need to tell us your glass sizes in ounces or the number of ounces you serve per customer. For example: you may have a 8oz glass but only serve 5oz because of the ice. Note: this will only appear if you select a batch as the serving type.<br/><br/><b>+ symbol</b>  will open lines so you can select your ingredients.<ul><li><b>Ingredient Name</b> is a dropdown list of all the items you added to your inventory.</li><li><b>Unit of Measure</b> is either ounces or bottle</li><li><b>Recipe amount</b> is the number of ounces or bottles. The standard unit for a single pour is 1.5oz but for many restaurants the serving size can be higher. If the serving size is a full bottle then select full bottle.</li><li>You may add <b>comments</b> to any recipe section</li></ul></p></article>',that.skip=function(){$uibModalInstance.dismiss("cancel")}};controller.$inject=["api","$state","auth","localStorageService","$uibModal","core","alertService","SweetAlert","$rootScope","restaurant","$scope"],angular.module("inspinia").component("alcoholCreateMenuItemComponent",{templateUrl:"js/components/alcoholSetup/createMenuItem/createMenuItem.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("alcoholSetup.menu",{url:"/menu-setup",template:"<alcohol-create-menu-item-component></alcohol-create-menu-item-component>",data:{pageTitle:" Create Menu Item"}})})}(),function(){"use strict";function deliverySetupController(api,$state,auth,localStorageService,$uibModal,core,alertService,SweetAlert,$rootScope,restaurant){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.form={},that.api=api,that.core=core,that.auth=auth,that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),restaurant.data.info&&(that.isCompleted=restaurant.data.info.is_setup_completed),$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions,that.isCompleted=restaurant.data.info.is_setup_completed});for(var i in restaurant.data.info.employees)restaurant.data.info.employees[i].id==auth.authentication.user.id&&(that.emp_id=restaurant.data.info.employees[i].type_ids);that.showInfo=function(){$uibModal.open({animation:!0,templateUrl:"quick_tutorial.html",controller:qt,controllerAs:"qt",windowClass:"animated fadeIn modal-lgg",size:"lg"})},that.getAllDeliveries=function(){that.api.delivery_schedules({inventory_type_id:2}).then(function(res){try{that.deliveries=res.data.data.delivery_schedules_list;for(var c in that.categories)if("Non Alcoholic"!=that.categories[c].category){var found_d=!1;for(var d in that.deliveries)if(that.deliveries[d].vendor_category_id==that.categories[c].id){found_d=!0;break}found_d||that.deliveries.push({category:that.categories[c].category,vendor_category_id:that.categories[c].id,is_on_sunday:0,is_on_monday:0,is_on_tuesday:0,is_on_wednesday:0,is_on_thursday:0,is_on_friday:0,is_on_saturday:0})}}catch(e){}})},that.saveAllDeliveries=function(form){if(form.$valid){var m={inventory_type_id:2,deliveries:[]};for(var d in that.deliveries)m.deliveries.push(that.deliveries[d]);that.api.save_delivery(m).then(function(res){try{1e3===res.data.data.code&&(alertService.showAlertSave(),that.getAllDeliveries())}catch(e){alertService.showError("Something went wrong!"),console.log(e)}})}},that.$onInit=function(){Promise.all([api.get_vendors_categories({is_restaurant_used_only:1,inventory_type_id:2})]).then(function(response){that.categories=response[0].data.data.categories,that.getAllDeliveries()})}}var qt=function($uibModalInstance){var that=this;that.q_title="Order Schedule Instructions",that.q_texts='<article style="display: block;"><p><b>Order schedule</b>  For users who upgrade to our Machine Learning you can tell Artecsan what days you like to order and which category of items. On those designated days Artecsan will make a suggestion of what items to order and how much. Just select the vendor name, category and the days you prefer to generate your orders for each category.</p></article>',that.skip=function(){$uibModalInstance.dismiss("cancel")}};deliverySetupController.$inject=["api","$state","auth","localStorageService","$uibModal","core","alertService","SweetAlert","$rootScope","restaurant"],angular.module("inspinia").component("alcoholDeliverySetupComponent",{templateUrl:"js/components/alcoholSetup/deliverySetup/deliverySetup.html",controller:deliverySetupController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("alcoholSetup.delivery",{url:"/delivery-setup",template:"<alcohol-delivery-setup-component></alcohol-delivery-setup-component>",data:{pageTitle:" Delivery Setup"}})})}(),function(){"use strict";function controller(api,$state,auth,localStorageService,$uibModal,alertService,$rootScope,restaurant,core,$scope,SweetAlert,$q,$interval,$timeout){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;that.form={},that.api=api,that.auth=auth,that.get_vendors_categories=[],that.selectedRow=null,that.inventories=[],that.save_type=null,that.typeInventory=$state.params.typeInventory,that.pickers={beginDate:{open:!1,date:new Date},endDate:{open:!1,date:new Date}};var INVENTORIES=[];if(that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.isAdmin=1==auth.authentication.user.id,restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),core.getRefbooks().then(function(res){that.refbooks=res}),that.model={vendor_category_id:null,measurement_units_of_delivery:function(id){for(var i=0;that.refbooks.measurement_units_of_delivery.length>i;i++)if(that.refbooks.measurement_units_of_delivery[i].id===id)return that.refbooks.measurement_units_of_delivery[i].name},inventory_item:null},that.showInfo=function(){$uibModal.open({animation:!0,templateUrl:"quick_tutorial.html",controller:qt,controllerAs:"qt",windowClass:"animated fadeIn modal-lgg",size:"lg"})},that.calculateCount=function(item,$index){var totalUnits=item.total_unit_size||0;"Case"==that.inventories[$index].case_or_qty?that.inventories[$index].item_qty=that.inventories[$index].item_qty/totalUnits:that.inventories[$index].item_qty=totalUnits*that.inventories[$index].item_qty},that.calculateUnitWeight=function(item,$index){that.total_in_uom_of_delivery=0;var totalUnits=item.total_unit_size||0,size=item.size;if(2==item.inventory_type_id)var tareWeight=that.inventories[$index].nof_bottles*item.tare_weight;else tareWeight=0;that.inventories[$index].total_in_uom_of_delivery=that.inventories[$index].cases_qty*totalUnits+that.inventories[$index].packs_qty*size+(that.inventories[$index].item_qty-tareWeight)},that.calculateUW=function(item,$index,form){$timeout(function(){return item.item_qty=item.item_qty?item.item_qty.replace(/[^\+^\d((,|\.)\d)?]+/g,""):null},500);var item_qty=item.item_qty?item.item_qty:0;item_qty&&(that.inventories[$index].item_qty_formula=item.item_qty.replace(/[^\d((,|\.)\d)?]+/g,"+").replace(/^\D*|\D*$/g,""),that.itemQtyStr=item_qty.match(/\d+((,|\.)\d+)?/g).reduce(function(previousValue,currentValue,index,array){return 1*previousValue+1*currentValue})),item.itemQtyStrlabel=that.itemQtyStr?that.itemQtyStr:item.item_qty},that.calculateUWSum=function(item,$index){var item_qty=item.item_qty?item.item_qty:null;if(!item_qty)return void(that.itemQtyStr=null);that.itemQtyStr=item_qty.match(/\d+((,|\.)\d+)?/g).reduce(function(previousValue,currentValue,index,array){return 1*previousValue+1*currentValue}),that.inventories[$index].item_qty=that.itemQtyStr,that.itemQtyStr>0&&(0==item.nof_bottles||null==item.nof_bottles)&&(that.inventories[$index].nof_bottles=1)},that.calculateUWFormula=function(item,$index){that.inventories[$index].item_qty=that.inventories[$index].item_qty_formula?that.inventories[$index].item_qty_formula:null},that.initOfBottle=function(item,$index){item.item_qty>0&&(0==item.nof_bottles||null==item.nof_bottles)&&(that.inventories[$index].nof_bottles=1),0==item.item_qty&&(that.inventories[$index].nof_bottles=0)},api.get_vendors_categories({is_restaurant_used_only:1,inventory_type_id:2}).then(function(res){try{that.get_vendors_categories=res.data.data.categories,that.get_vendors_categories.unshift({id:"all",category:"All Items"}),that.model.vendor_category_id=res.data.data.categories[0].id,that.getInventories(that.model.vendor_category_id)}catch(e){console.log(e)}}),that.mergeItems=function(){for(var i=0;i<that.inventories.length;i++)if(null==that.inventories[i].substitute_for)that.inventories[i].show=1;else for(var j=0;j<that.inventories.length;j++)if(that.inventories[i].substitute_for==that.inventories[j].vendor_sku_id&&that.inventories[i].tare_type!=that.inventories[j].tare_type){that.inventories[i].show=1;break}},that.getInventories=function(categoryId,categoryOldId){var _setToZero=function(data){if(data.length){for(var i=0;data.length>i;i++)"adjustment"==that.typeInventory?(data[i].cases_qty=null,data[i].packs_qty=null,data[i].nof_bottles=null,data[i].item_qty=null):(data[i].cases_qty=0,data[i].packs_qty=0,data[i].nof_bottles=0,data[i].item_qty=0);return data}},m={is_adjustment:"adjustment"==that.typeInventory?1:0,inventory_type_id:2,vendor_cat_id:"all"==categoryId?null:categoryId,inventory_item:that.model.inventory_item};_.isEqual(INVENTORIES,that.inventories)?that.api.get_inventory_audit(m).then(function(res){for(var filter_visible=[],fv=0;fv<res.data.data.inventory.length;fv++)1==res.data.data.inventory[fv].visible&&filter_visible.push(res.data.data.inventory[fv]);"adjustment"==that.typeInventory?(that.inventories=_setToZero(filter_visible),that.mergeItems(),INVENTORIES=angular.copy(that.inventories)):(that.inventories=filter_visible,that.mergeItems(),INVENTORIES=angular.copy(filter_visible))}):SweetAlert.swal({title:"Save changes?",text:"Changes not been saved yet!",type:"warning",showCancelButton:!0,confirmButtonColor:"#337ab7",confirmButtonText:"Save"},function(res){res?that.saveAll(that.form,!0).then(function(){that.api.get_inventory_audit(m).then(function(res){that.inventories=res.data.data.inventory,"adjustment"==that.typeInventory&&(that.inventories=_setToZero(that.inventories)),that.mergeItems(),INVENTORIES=angular.copy(that.inventories)})}):that.model.vendor_category_id=categoryOldId})},that.saveAll=function(form,is_search,is_final_save){var deferred=$q.defer();if(form.$valid&&(!is_final_save||that.pickers.beginDate.date&&that.pickers.endDate.date)){if("adjustment"==that.typeInventory){var is_adjustment=1;is_final_save=1}if(is_search){for(var m={inventory_type_id:2,counting_started_at:new Date(that.pickers.beginDate.date).getTime(),counting_ended_at:new Date(that.pickers.endDate.date).getTime(),is_final_save:is_final_save||0,is_adjustment:is_adjustment||0,inventory_items:[]},i=0;that.inventories.length>i;i++)null===that.inventories[i].item_qty&&null===that.inventories[i].cases_qty&&null===that.inventories[i].packs_qty&&null===that.inventories[i].nof_bottles||m.inventory_items.push({id:that.inventories[i].id,item_qty:that.inventories[i].item_qty?that.inventories[i].item_qty:0,cases_qty:that.inventories[i].cases_qty?that.inventories[i].cases_qty:0,nof_bottles:that.inventories[i].nof_bottles?that.inventories[i].nof_bottles:0,packs_qty:that.inventories[i].packs_qty?that.inventories[i].packs_qty:0,total_in_uom_of_delivery:that.inventories[i].total_in_uom_of_delivery,item_qty_formula:that.inventories[i].item_qty_formula});if(!m.inventory_items.length)return;that.api.update_inventory_audit(m).then(function(res){try{1e3===res.data.data.code&&deferred.resolve()}catch(e){console.log(e),deferred.reject()}},function(){deferred.reject()})}else{var popup_text=0==restaurant.data.info.is_setup_completed?1==is_final_save?"This will permanently update your on-hand count as of today. Also access to other features of the system will be restricted until Artecsan has successfully connected to your POS.":"This will save this as a draft.":1==is_final_save?"This will permanently update your on-hand count as of today.":"This will save this as a draft.",title=1==is_final_save?"Final Save?":"Save?";SweetAlert.swal({title:title,text:popup_text,type:"warning",showCancelButton:!0,confirmButtonColor:"#337ab7",confirmButtonText:"Save"},function(res){if(res){for(var m={inventory_type_id:2,counting_started_at:new Date(that.pickers.beginDate.date).getTime(),counting_ended_at:new Date(that.pickers.endDate.date).getTime(),is_final_save:is_final_save||0,is_adjustment:is_adjustment||0,inventory_items:[]},i=0;that.inventories.length>i;i++)null===that.inventories[i].item_qty&&null===that.inventories[i].cases_qty&&null===that.inventories[i].packs_qty&&null===that.inventories[i].nof_bottles||m.inventory_items.push({id:that.inventories[i].id,item_qty:that.inventories[i].item_qty?that.inventories[i].item_qty:0,cases_qty:that.inventories[i].cases_qty?that.inventories[i].cases_qty:0,nof_bottles:that.inventories[i].nof_bottles?that.inventories[i].nof_bottles:0,packs_qty:that.inventories[i].packs_qty?that.inventories[i].packs_qty:0,total_in_uom_of_delivery:that.inventories[i].total_in_uom_of_delivery,item_qty_formula:that.inventories[i].item_qty_formula});m.inventory_items.length&&that.api.update_inventory_audit(m).then(function(res){try{1e3===res.data.data.code&&(INVENTORIES=angular.copy(that.inventories),"final"==that.save_type?0==restaurant.data.info.is_setup_completed?$state.go("home"):$state.go("admin.homeMenu"):"review"==that.save_type?$state.go("reports.alcoholCostOfSummary"):"save"==that.save_type&&that.getInventories(that.model.vendor_category_id),alertService.showAlertSave(),deferred.resolve())}catch(e){console.log(e),deferred.reject()}},function(){deferred.reject()})}})}return deferred.promise}},$scope.$on("$stateChangeStart",function(event,toState,toParams,fromState,fromParams,options){var toState=toState.name;_.isEqual(INVENTORIES,that.inventories)||(event.preventDefault(),SweetAlert.swal({title:"Save changes?",text:"Changes not been saved yet!",type:"warning",showCancelButton:!0,confirmButtonColor:"#337ab7",confirmButtonText:"Save"},function(res){res?that.saveAll(that.form,!0).then(function(){INVENTORIES=angular.copy(that.inventories),window.onbeforeunload=null,$state.go(toState)}):(INVENTORIES=angular.copy(that.inventories),window.onbeforeunload=null,$state.go(toState))}))}),that.openCalendar=function(e,picker){that.pickers[picker].open=!0}}var qt=function($uibModalInstance){var that=this;that.q_title="Alcohol Inventory Audit Pad Instructions",that.q_texts='<article style="display: block;"><p><b>Audit</b> - This is the final step in your setup process. In order to start your reporting we must first know exactly how much inventory you have on-hand. Your alcohol audit will cover all your alcohol and is broken up between cases, full bottles and open bottles.<br/><br/>All open bottles of alcohol and tapped kegs are both weighed and recorded in ounces.<br/><br/>Full bottles are counted as full bottles<br/><br/>Cases are counted as full cases<br/><br/>The save button on Full Audit pad allows you to save your work and complete it later.<br/><br/>Final Save is final and cannot be changed<br/><br/>Note: BE SURE THAT THE BEGINNING DATE IS THE ACTUAL DATE YOU COUNTED. IF THE BEGINNING DATE IS ENTERED INCORRECTLY THEN ALL OF YOUR RESULTS WILL BE INCORRECT.</p></article>',that.skip=function(){$uibModalInstance.dismiss("cancel")}};controller.$inject=["api","$state","auth","localStorageService","$uibModal","alertService","$rootScope","restaurant","core","$scope","SweetAlert","$q","$interval","$timeout"],angular.module("inspinia").component("alcoholInventoryComponent",{templateUrl:"js/components/alcoholSetup/foodInventory/foodInventory.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("alcoholSetup.foodInventory",{url:"/inventory/:typeInventory",template:"<alcohol-inventory-component></alcohol-inventory-component>",data:{pageTitle:" Alcohol Inventory Audit Pad"},resolve:{refbooks:function(core){return core.getRefbooks().then(function(res){return res})}}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("alcoholSetup.inventoryComplete",{url:"/inventory-complete",templateUrl:"js/components/alcoholSetup/inventoryComplete/inventoryComplete.html",data:{pageTitle:"Inventory Complete"}})})}(),function(){"use strict";function inventoryMergeController(api,$state,auth,localStorageService,alertService,SweetAlert,$rootScope,restaurant,$uibModal,core,$scope,$q){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.form={},that.api=api,that.auth=auth,that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.inventoryList=[],that.vendors=[],that.currentVendor=null,that.searchModel={order_by:"item_name",order_way:"ASC",inRequest:!1,paginationTotal:0,city:null,item_name:null,sub_category:null,vendor_sku:null,filter:"any",category:null},restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),that.showInfo=function(){$uibModal.open({animation:!0,templateUrl:"quick_tutorial.html",controller:qt,controllerAs:"qt",windowClass:"animated fadeIn modal-lgg",size:"lg"})},that.chkIfSubSelected=function($index){for(var e_type=0,parent_name="",child_list=[],i=0;that.inventoryList.length>i;i++)if(that.inventoryList[i].id==that.inventoryList[$index].substitute_for&&null!=that.inventoryList[i].substitute_for){e_type=1,child_list.push(that.inventoryList[i]),that.inventoryList[$index].substitute_for=null;break}for(var i=0;that.inventoryItemsForSubCheck.length>i;i++)that.inventoryList[$index].id==that.inventoryItemsForSubCheck[i].substitute_for&&(e_type=2,parent_name=that.inventoryList[$index].item_name,child_list.push(that.inventoryItemsForSubCheck[i]),that.inventoryList[$index].substitute_for=null);1==e_type?swal({title:"Error! "+child_list.map(function(x){return x.item_name}).join("\n")+" is already a substitute item.",type:"error"}):2==e_type&&swal({title:"Error! "+parent_name+" is already a primary item of the following.",text:child_list.map(function(x){return x.vendor_name+" - "+x.item_name+" - "+(1==x.is_used?"(Active)":"(Inactive)")}).join("\n"),type:"error"})},that.filterItems=function(id,cat_id){if(!cat_id)return[];for(var _a=[],i=0;i<that.inventoryItems.length;i++)that.inventoryItems[i].id!=id&&that.inventoryItems[i].vendor_cat_id==cat_id&&_a.push(that.inventoryItems[i]);if(_a.length){var first=JSON.stringify(_a[0]);_a.unshift(JSON.parse(first)),_a[0].id=null,_a[0].vendor_name="--No selection--",_a[0].item_name="--No selection--"}return _a},that.actInactItem=function(inventory){var id=that.restaurant_id.restaurant_id,m={vendor_id:that.currentVendor.id,sku_id:inventory.id,is_active:"active"==that.activate_mode?0:1,inventory_type_id:2,action:"update"};that.api.add_inventory(id,m).then(function(res){try{1e3===res.data.data.code?swal({title:"Updated!",timer:1500,showConfirmButton:!1,type:"success"}):2079===res.data.data.code.code?swal({title:"Can't perform this action as this item is attached to the following recipes. To make this item inactive you must first visit the recipe screen and either replace the item in the recipe or make the recipe(s) inactive.",text:""+res.data.data.code.res_data.map(function(x){return x.menu_item_name+" ("+x.pricing_level+")"}).join("\n"),type:"error"}):2081!==res.data.data.code.code&&2082!==res.data.data.code.code||swal({title:"Cannot perform this action as this is a primary item of the below listed items. To make this item inactive you will need to either remove the attached items or make the attached items inactive.",text:""+res.data.data.code.res_data.map(function(x){return x.child_name}).join("\n"),type:"error"}),that.search(!1,!1)}catch(e){console.log(e)}})},that.deleteItem=function(inventory){var id=that.restaurant_id.restaurant_id,m={vendor_id:that.currentVendor.id,sku_id:inventory.id,is_active:0,inventory_type_id:2,action:"delete"};that.api.add_inventory(id,m).then(function(res){try{1e3===res.data.data.code?swal({title:"Updated!",timer:1500,showConfirmButton:!1,type:"success"}):2080===res.data.data.code?swal({title:"This item has historical data and therefore cannot be deleted. You may instead, make this item inactive.",type:"error"}):2079===res.data.data.code.code?swal({title:"Can't perform this action as this item is attached to the following recipes. To make this item inactive you must first visit the recipe screen and either replace the item in the recipe or make the recipe(s) inactive.",text:""+res.data.data.code.res_data.map(function(x){return x.menu_item_name+" ("+x.pricing_level+")"}).join("\n"),type:"error"}):2081!==res.data.data.code.code&&2082!==res.data.data.code.code||swal({title:"Cannot perform this action as this is a primary item of the below listed items. To make this item inactive you will need to either remove the attached items or make the attached items inactive.",text:""+res.data.data.code.res_data.map(function(x){return x.child_name}).join("\n"),type:"error"}),that.search(!1,!1)}catch(e){console.log(e)}})},that.submit=function($index){var deferred=$q.defer(),id=that.currentVendor.id,m={inventory_type_id:2,sku_items:[]};return m.sku_items.push({substitute_for:that.inventoryList[$index].substitute_for?that.inventoryList[$index].substitute_for:null,item_name:that.inventoryList[$index].item_name,tare_type_id:that.inventoryList[$index].tare_type_id,size:that.inventoryList[$index].content_weight||that.inventoryList[$index].size||1,content_weight:that.inventoryList[$index].content_weight||that.inventoryList[$index].size||1,full_weight:that.inventoryList[$index].full_weight,tare_weight:that.inventoryList[$index].tare_weight,total_unit_size:that.inventoryList[$index].case_qty*that.inventoryList[$index].pack*(that.inventoryList[$index].content_weight||that.inventoryList[$index].size||1),manufacturer:that.inventoryList[$index].manufacturer,vendor_sku:that.inventoryList[$index].vendor_sku,case_qty:that.inventoryList[$index].case_qty,pack:that.inventoryList[$index].pack,price:"Case"==that.inventoryList[$index].minimum_order_type?that.inventoryList[$index].case_cost:that.inventoryList[$index].pack_cost,vendor_cat_id:that.inventoryList[$index].vendor_cat_id,uom_id_of_delivery_unit:5,vendor_sub_cat_id:that.inventoryList[$index].vendor_sub_cat_id,is_active:that.inventoryList[$index].is_active,minimum_order_type:that.inventoryList[$index].minimum_order_type,id:that.inventoryList[$index].id}),that.api.add_update_own_inventory(id,m).then(function(res){1e3===res.data.data.code&&alertService.showAlertSave(),Promise.all([that.getItemsForSubCheck()]).then(function(response){deferred.resolve()})}),deferred.promise},that.changeAction=function(){"merge"==that.mode?getMergeModeData(!1):(that.activate_mode="active",getActivateModeData(!1))},that.selectActiveInactive=function(){that.search(!1,!1)},that.selectVendor=function(vendor){that.currentVendor=vendor,that.search(!1,!0)},that.search=function(is_category_change,is_vendor_change,keyword){that.inventoryList=[],that.loading=!0,that.searchModel.inRequest=!0;var m={order_by:that.searchModel.order_by,order_way:that.searchModel.order_way,paginationOffset:that.searchModel.paginationOffset,paginationCount:that.searchModel.paginationCount,city:that.searchModel.city,item_name:that.searchModel.item_name,sub_category:that.searchModel.sub_category,
vendor_sku:that.searchModel.vendor_sku,filter:that.searchModel.filter,category:is_category_change?that.searchModel.category:null,inventory_type_id:2};for(var i in m)m[i]||delete m[i];keyword&&(m.paginationOffset=0,that.searchModel.order_by==keyword?(that.searchModel.order_way="ASC"==m.order_way?"DESC":"ASC",m.order_way="ASC"==m.order_way?"DESC":"ASC"):(that.searchModel.order_by=keyword,m.order_by=keyword)),m.paginationOffset>0&&!keyword&&(m.paginationOffset=(m.paginationOffset-1)*m.paginationCount),api.get_inventory_by_vendor(m,that.currentVendor.id).then(function(res){that.loading=!1,that.searchModel.inRequest=!1;try{if(that.searchModel.paginationTotal=res.data.data.total,is_category_change)that.inventoryList=res.data.data.sku;else{that.inventoryListAll=res.data.data.sku;var temp_cats=that.inventoryListAll.map(function(x){return x.category}),c_set=new Set(temp_cats);that.SKU_categories=Array.from(c_set).filter(function(x){return"Non Alcoholic"!=x}),that.searchModel.category=is_vendor_change?that.SKU_categories[0]:null==that.searchModel.category?that.SKU_categories[0]:that.searchModel.category,that.inventoryList=that.inventoryListAll.filter(function(x){return x.category==that.searchModel.category})}"activate"==that.mode?that.inventoryList=that.inventoryList.filter(function(x){return x.is_used==("active"==that.activate_mode?1:0)}):that.inventoryList=that.inventoryList.filter(function(x){return 1==x.is_used})}catch(e){console.log(e)}},function(){that.searchModel.inRequest=!1})},that.getVendorList=function(){var deferred=$q.defer();return that.api.get_chosen_vendors(that.restaurant_id.restaurant_id,{vendor_type_id:2}).then(function(res){try{if(that.vendors=res.data.data.vendors,!that.vendors.length)return void $state.go("alcoholSetup.vendor");that.currentVendor=that.vendors[0]}catch(e){console.log(e)}deferred.resolve()}),deferred.promise},that.getItemsForSubCheck=function(){var deferred=$q.defer();return that.api.get_active_inventory_by_vendor({inventory_type_id:2,caller:"sub_list"},that.restaurant_id.restaurant_id).then(function(res){that.inventoryItemsForSubCheck=res.data.data.sku,that.inventoryItems=JSON.parse(JSON.stringify(that.inventoryItemsForSubCheck)),that.inventoryItems=that.inventoryItems.filter(function(x){return null==x.substitute_for}),deferred.resolve()}),deferred.promise};var getMergeModeData=function(is_category_change){Promise.all([that.getItemsForSubCheck(),that.getVendorList()]).then(function(response){that.search(is_category_change,!0)})},getActivateModeData=function(is_category_change){Promise.all([that.getVendorList()]).then(function(response){that.search(is_category_change,!0)})};that.$onInit=function(){that.mode="merge",getMergeModeData(!1)}}var qt=function($uibModalInstance){var that=this;that.q_title="Merge/Edit/Delete Items Help",that.q_texts='<article style="display: block;"><p><b>Merge/Edit/Delete Items</b>  Please check out our instruction video <a href="https://youtu.be/uGnxBV3Xkws" target="_blank">here</a>.</li></ul></p></article>',that.skip=function(){$uibModalInstance.dismiss("cancel")}};inventoryMergeController.$inject=["api","$state","auth","localStorageService","alertService","SweetAlert","$rootScope","restaurant","$uibModal","core","$scope","$q"],angular.module("inspinia").component("alcoholInventoryMergeComponent",{templateUrl:"js/components/alcoholSetup/inventoryMerge/inventoryMerge.html",controller:inventoryMergeController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("alcoholSetup.inventoryMerge",{url:"/inventory-merge",template:"<alcohol-inventory-merge-component></alcohol-inventory-merge-component>",data:{pageTitle:" Inventory Merge"}})})}(),function(){"use strict";function addUniqueItemsController($uibModalInstance,alertService,api,core,searchParams,SweetAlert,$q){var that=this;that.form={},that.uniqueItem=[],that.searchParams=searchParams;var INVENTORIES=[],checkChanges=function(){return _.isEqual(INVENTORIES,JSON.parse(angular.toJson(that.uniqueItem)))};that.vendorsName=that.searchParams.vendors_name;for(var i=0;that.vendorsName.length>i;i++)1==that.vendorsName[i].is_selected&&(that.vendorsName=that.vendorsName[i].vendor_name);that.searchModel={order_by:"item_name",order_way:"ASC",paginationOffset:0,paginationCount:25,inRequest:!1,paginationTotal:0,city:null,item_name:null,sub_category:null,vendor_sku:null,filter:"own",category:null},that.categories=[],that.sub_categories=[],core.getRefbooks().then(function(res){that.refbooks=res,that.categories=res.vendor_cat,that.sub_categories=res.vendor_sub_cat}),that.api=api,that.model={},that.sku_lookup=function(search_for){return that.api.sku_lookup({search_for:search_for,vendor_id:that.searchParams.vendor_id}).then(function(res){return res.data.data.sku.slice(0,10)})},that.item_name_lookup=function(search_for){return that.api.item_name_lookup({search_for:search_for,vendor_id:that.searchParams.vendor_id}).then(function(res){return res.data.data.name})},that.chkIfSubSelected=function($index){for(var e_type=0,parent_name="",child_list=[],i=0;that.uniqueItem.length>i;i++)if(that.uniqueItem[i].id==that.uniqueItem[$index].substitute_for&&null!=that.uniqueItem[i].substitute_for){e_type=1,child_list.push(that.uniqueItem[i]),that.uniqueItem[$index].substitute_for=null;break}if(0==e_type&&null!=that.uniqueItem[$index].id)for(var i=0;that.inventoryItemsForSubCheck.length>i;i++)that.uniqueItem[$index].id==that.inventoryItemsForSubCheck[i].substitute_for&&(e_type=2,parent_name=that.uniqueItem[$index].item_name,child_list.push(that.inventoryItemsForSubCheck[i]),that.uniqueItem[$index].substitute_for=null);1==e_type?swal({title:"Error! "+child_list.map(function(x){return x.item_name}).join("\n")+" is already a substitute item.",type:"error"}):2==e_type&&swal({title:"Error! "+parent_name+" is already a primary item of the following.",text:child_list.map(function(x){return x.vendor_name+" - "+x.item_name+" - "+(1==x.is_used?"(Active)":"(Inactive)")}).join("\n"),type:"error"})},that.submit=function(form,get_list){var deferred=$q.defer();if(!form.$valid)return alertService.showError("Please validate all inputs"),deferred.reject(),deferred.promise;if(!that.uniqueItem.length)return alertService.showError("Please, add at least one item"),deferred.reject(),deferred.promise;for(var id=that.searchParams.vendor_id,m={inventory_type_id:2,sku_items:[]},i=0;that.uniqueItem.length>i;i++)m.sku_items.push({substitute_for:that.uniqueItem[i].substitute_for?that.uniqueItem[i].substitute_for:null,item_name:that.uniqueItem[i].item_name,tare_type_id:that.uniqueItem[i].tare_type_id,size:that.uniqueItem[i].content_weight||that.uniqueItem[i].size||1,content_weight:that.uniqueItem[i].content_weight||that.uniqueItem[i].size||1,full_weight:that.uniqueItem[i].full_weight,tare_weight:that.uniqueItem[i].tare_weight,total_unit_size:that.uniqueItem[i].case_qty*that.uniqueItem[i].pack*(that.uniqueItem[i].content_weight||that.uniqueItem[i].size||1),manufacturer:that.uniqueItem[i].manufacturer,vendor_sku:that.uniqueItem[i].vendor_sku,case_qty:that.uniqueItem[i].case_qty,pack:that.uniqueItem[i].pack,price:"Case"==that.uniqueItem[i].minimum_order_type?that.uniqueItem[i].case_cost:that.uniqueItem[i].pack_cost,vendor_cat_id:that.uniqueItem[i].vendor_cat_id,uom_id_of_delivery_unit:5,vendor_sub_cat_id:that.uniqueItem[i].vendor_sub_cat_id,is_active:that.uniqueItem[i].is_active,minimum_order_type:that.uniqueItem[i].minimum_order_type,id:that.uniqueItem[i].id});return that.api.add_update_own_inventory(id,m).then(function(res){1e3===res.data.data.code&&(alertService.showAlertSave(),deferred.resolve(),get_list&&that.search())}),deferred.promise},that.checkForUniqueSKU=function($index){for(var i=0;that.uniqueItem.length>i;i++)$index!=i&&that.uniqueItem[i].vendor_sku==that.uniqueItem[$index].vendor_sku&&(that.uniqueItem[$index].vendor_sku=null)},that.apply_values=function($index,$item){that.uniqueItem[$index].src=$item.src,that.uniqueItem[$index].vendor_sku=$item.vendor_sku,that.checkForUniqueSKU($index),that.uniqueItem[$index].item_name=$item.item_name,that.uniqueItem[$index].vendor_cat_id=$item.vendor_cat_id,that.changeMOT($index),that.uniqueItem[$index].vendor_sub_cat_id=$item.vendor_sub_cat_id,that.uniqueItem[$index].tare_type_id=$item.tare_type_id,that.uniqueItem[$index].full_weight=$item.full_weight,that.uniqueItem[$index].pack=$item.pack,that.uniqueItem[$index].case_cost=$item.case_cost,that.uniqueItem[$index].pack_cost=$item.pack_cost,that.setWeights($index,$item.vendor_cat_id,$item.vendor_sub_cat_id,$item.tare_type_id),that.calculate($index)},that.filterItems=function(id,cat_id){if(!cat_id)return[];for(var _a=[],i=0;i<that.inventoryItems.length;i++)that.inventoryItems[i].id!=id&&that.inventoryItems[i].vendor_cat_id==cat_id&&_a.push(that.inventoryItems[i]);if(_a.length){var first=JSON.stringify(_a[0]);_a.unshift(JSON.parse(first)),_a[0].id=null,_a[0].vendor_name="--No selection--",_a[0].item_name="--No selection--"}else _a.push({}),_a[0].id=null,_a[0].vendor_name="--No selection--",_a[0].item_name="--No selection--";return _a},that.getSizes=function(cat_id,sub_cat_id){if(!cat_id&&!sub_cat_id)return[];for(var _a=[],i=0;that.refbooks.default_weights.length>i;i++)if(that.refbooks.default_weights[i].vendor_cat_id===cat_id&&that.refbooks.default_weights[i].vendor_sub_cat_id===sub_cat_id)for(var j=0;that.refbooks.tare_types.length>j;j++)that.refbooks.tare_types[j].tare_type_id===that.refbooks.default_weights[i].tare_type_id&&-1===_a.indexOf(that.refbooks.tare_types[j])&&_a.push(that.refbooks.tare_types[j]);return _a},that.calculate=function($index){var t=that.uniqueItem[$index].pack||1,u=that.uniqueItem[$index].pack_cost||1,c=that.uniqueItem[$index].case_qty||1;that.uniqueItem[$index].case_cost=parseFloat((t*u*1*c).toFixed(2))},that.setWeights=function($index,cat_id,sub_cat_id,tare_type_id){for(var i=0;that.refbooks.default_weights.length>i;i++)if(that.refbooks.default_weights[i].vendor_sub_cat_id===sub_cat_id&&that.refbooks.default_weights[i].vendor_cat_id===cat_id&&that.refbooks.default_weights[i].tare_type_id===tare_type_id){var f=71===that.uniqueItem[$index].vendor_cat_id?that.refbooks.default_weights[i].full_weight:that.uniqueItem[$index].full_weight,c=that.refbooks.default_weights[i].content_weight;that.uniqueItem[$index].tare_weight=f-c||0,that.uniqueItem[$index].content_weight=c,76===that.uniqueItem[$index].vendor_cat_id&&(that.uniqueItem[$index].tare_weight=0,that.uniqueItem[$index].content_weight=f*c)}if(cat_id&&sub_cat_id&&(74==cat_id||75==cat_id||99==cat_id))for(var i=0;that.refbooks.default_weights.length>i;i++)if(that.refbooks.default_weights[i].vendor_cat_id===cat_id&&that.refbooks.default_weights[i].vendor_sub_cat_id===sub_cat_id&&that.refbooks.default_weights[i].tare_type_id===tare_type_id){that.uniqueItem[$index].full_weight=that.refbooks.default_weights[i].full_weight,that.uniqueItem[$index].tare_weight=that.refbooks.default_weights[i].tare_weight,that.uniqueItem[$index].content_weight=that.refbooks.default_weights[i].content_weight;break}},that.addUniqueItem=function(){that.uniqueItem.push({src:"",item_name:null,size:null,full_weight:null,content_weight:null,tare_weight:null,manufacturer:null,vendor_sku:null,case_qty:1,total_unit_size:null,price:null,pack_cost:null,vendor_cat_id:that.categories.length?that.categories[0].id:null,uom_id_of_delivery_unit:5,vendor_sub_cat_id:that.sub_categories.length?that.sub_categories[0].id:null,is_active:1,minimum_order_type:"Pack",id:null,substitute_for:null,sub_dd_options:that.filterItems(null,that.categories.length?that.categories[0].id:null)})},that.changeMOT=function($index){that.uniqueItem[$index].full_weight=null,74==that.uniqueItem[$index].vendor_cat_id?that.uniqueItem[$index].minimum_order_type="Case":that.uniqueItem[$index].minimum_order_type="Pack"},that.removeUniqueItem=function($index,item){if(that.uniqueItem[$index].id){var vendor_id=that.searchParams.vendor_id;that.api.delete_my_sku(vendor_id,that.uniqueItem[$index].id).then(function(res){if(1e3===res.data.data.code){for(var i=0;that.uniqueItem.length>i;i++)if(item.id===that.uniqueItem[i].id){that.uniqueItem.splice(i,1);break}that.search()}})}else that.uniqueItem.splice($index,1)},that.search=function(keyword){that.api.get_active_inventory_by_vendor({inventory_type_id:2,caller:"sub_list"},that.searchParams.restaurant_id).then(function(res){that.inventoryItemsForSubCheck=res.data.data.sku,that.inventoryItems=JSON.parse(JSON.stringify(that.inventoryItemsForSubCheck)),that.inventoryItems=that.inventoryItems.filter(function(x){return null==x.substitute_for}),that.searchModel.inRequest=!0;var m={order_by:that.searchModel.order_by,order_way:that.searchModel.order_way,paginationOffset:that.searchModel.paginationOffset,paginationCount:that.searchModel.paginationCount,filter:that.searchModel.filter,inventory_type_id:2,city:that.searchModel.city,item_name:that.searchModel.item_name,sub_category:that.searchModel.sub_category,vendor_sku:that.searchModel.vendor_sku,category:that.searchModel.category};for(var i in m)null==m[i]&&delete m[i];keyword&&(m.paginationOffset=0,that.searchModel.order_by==keyword?(that.searchModel.order_way="ASC"==m.order_way?"DESC":"ASC",m.order_way="ASC"==m.order_way?"DESC":"ASC"):(that.searchModel.order_by=keyword,m.order_by=keyword)),m.paginationOffset>0&&!keyword&&(m.paginationOffset=(m.paginationOffset-1)*m.paginationCount);var vendorId=that.searchParams.vendor_id;that.api.get_inventory_by_vendor(m,vendorId).then(function(res){try{$(".modal").animate({scrollTop:0},200),that.uniqueItem=res.data.data.sku,that.searchModel.paginationTotal=res.data.data.total,INVENTORIES=angular.copy(that.uniqueItem),that.uniqueItem=that.uniqueItem.map(function(x){return x.sub_dd_options=that.filterItems(x.id,x.vendor_cat_id),x}),that.searchModel.inRequest=!1}catch(e){console.log(e),that.searchModel.inRequest=!1}},function(){that.searchModel.inRequest=!1})})},that.getMyItems=function(keyword){checkChanges()?that.search(keyword):SweetAlert.swal({title:"Save changes?",text:"Changes not been saved yet!",type:"warning",showCancelButton:!0,confirmButtonColor:"#337ab7",confirmButtonText:"Save"},function(res){res?(that.form.$setSubmitted(),that.submit(that.form).then(function(){that.search(keyword)})):that.search(keyword)})},that.getMyItems(),that.cancel=function(){checkChanges()?$uibModalInstance.dismiss("cancel"):SweetAlert.swal({title:"Save changes?",text:"Changes not been saved yet!",type:"warning",showCancelButton:!0,confirmButtonColor:"#337ab7",confirmButtonText:"Save"},function(res){res?(that.form.$setSubmitted(),that.submit(that.form).then(function(){$uibModalInstance.dismiss("cancel")})):$uibModalInstance.dismiss("cancel")})}}addUniqueItemsController.$inject=["$uibModalInstance","alertService","api","core","searchParams","SweetAlert","$q"],angular.module("inspinia").controller("alcoholAddUniqueItemsController",addUniqueItemsController)}(),function(){"use strict";function inventorySetupController(api,$state,auth,localStorageService,SweetAlert,$rootScope,restaurant,$uibModal,core,$scope){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.form={},that.api=api,that.auth=auth,that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.inventoryList=[],that.vendors=[],that.inventoryListSelected=[],that.currentVendor=null,that.searchModel={order_by:"item_name",order_way:"ASC",paginationOffset:0,paginationCount:25,inRequest:!1,paginationTotal:0,city:null,item_name:null,sub_category:null,vendor_sku:null,filter:"any",category:null},restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),$scope.SetUpStatus=0,restaurant.data.info&&($scope.SetUpStatus=restaurant.data.info.is_setup_completed),that.showInfo=function(){$uibModal.open({animation:!0,templateUrl:"quick_tutorial.html",controller:qt,controllerAs:"qt",windowClass:"animated fadeIn modal-lgg",size:"lg"})};var getInventoriesByVendor=function(){that.api.get_active_inventory_by_vendor({vendor_id:that.currentVendor.id,inventory_type_id:2},that.restaurant_id.restaurant_id).then(function(res){that.inventoryListSelected=res.data.data.sku})};that.search=function(keyword){that.searchModel.inRequest=!0;var m={order_by:that.searchModel.order_by,order_way:that.searchModel.order_way,paginationOffset:that.searchModel.paginationOffset,paginationCount:that.searchModel.paginationCount,city:that.searchModel.city,item_name:that.searchModel.item_name,sub_category:that.searchModel.sub_category,vendor_sku:that.searchModel.vendor_sku,filter:that.searchModel.filter,category:that.searchModel.category,inventory_type_id:2};for(var i in m)null==m[i]&&delete m[i];keyword&&(m.paginationOffset=0,that.searchModel.order_by==keyword?(that.searchModel.order_way="ASC"==m.order_way?"DESC":"ASC",m.order_way="ASC"==m.order_way?"DESC":"ASC"):(that.searchModel.order_by=keyword,m.order_by=keyword)),m.paginationOffset>0&&!keyword&&(m.paginationOffset=(m.paginationOffset-1)*m.paginationCount),api.get_inventory_by_vendor(m,that.currentVendor.id).then(function(res){try{that.inventoryList=res.data.data.sku,that.searchModel.paginationTotal=res.data.data.total}catch(e){console.log(e)}that.searchModel.inRequest=!1},function(){that.searchModel.inRequest=!1}),getInventoriesByVendor()},that.selectVendor=function(vendor){that.vendors.forEach(function(val,key){vendor.id==val.id?val.is_selected=!0:val.is_selected=!1}),that.currentVendor=vendor,that.search()};var getChosenVendors=function(){api.get_chosen_vendors(that.restaurant_id.restaurant_id,{vendor_type_id:2}).then(function(res){try{if(that.vendors=res.data.data.vendors,!that.vendors.length)return void $state.go("alcoholSetup.vendor");that.vendors[0].is_selected=!0,that.vendors[0].is_first=!0,that.vendors[that.vendors.length-1].is_last=!0,that.currentVendor=that.vendors[0],that.search()}catch(e){console.log(e)}})};that.addInventory=function(inventory){var id=that.restaurant_id.restaurant_id,m={vendor_id:that.currentVendor.id,sku_id:inventory.id,is_active:inventory.is_used,inventory_type_id:2,action:"update"};that.api.add_inventory(id,m).then(function(){getInventoriesByVendor(),that.search()})},that.deleteInventory=function(inventory){if(1==inventory.is_used_by_receipts)return void SweetAlert.swal({title:"",text:"You can not remove the inventory item, if he has any elements with historical data, or if the item is used in any menu. Instead, you can disable inventory item, but first remove it from menus in which it is used.",type:"warning",confirmButtonColor:"#DD6B55"});var id=that.restaurant_id.restaurant_id,m={vendor_id:that.currentVendor.id,sku_id:inventory.id,is_active:0,inventory_type_id:2,action:"delete"};that.api.add_inventory(id,m).then(function(){getInventoriesByVendor(),that.search()})},that.addUniqueItems=function(){$uibModal.open({templateUrl:"js/components/alcoholSetup/inventorySetup/addUniqueItems/addUniqueItems.html",controller:"alcoholAddUniqueItemsController",windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",size:"lg2x",resolve:{searchParams:{vendor_id:that.currentVendor.id,restaurant_id:that.restaurant_id.restaurant_id,vendors_name:that.vendors}}}).result.then(function(result){that.search()},function(reason){that.search()})},that.back=function(){if(that.currentVendor.is_first)$state.go("alcoholSetup.vendor");else{for(var prevVendor,i=0;that.vendors.length>i;i++)that.vendors[i].is_selected&&(prevVendor=that.vendors[i-1]);that.selectVendor(prevVendor)}},that.next=function(){if(that.currentVendor.is_last)$state.go("alcoholSetup.serving-details");else{for(var nextVendor,i=0;that.vendors.length>i;i++)that.vendors[i].is_selected&&(nextVendor=that.vendors[i+1]);that.selectVendor(nextVendor)}},that.$onInit=function(){core.getRefbooks().then(function(res){that.refbooks=res,getChosenVendors()})}}var qt=function($uibModalInstance){var that=this;that.q_title="Inventory Setup Instructions",that.q_texts='<article style="display: block;"><p><b>Alcohol Inventory Setup</b>  this is the page which you will use to add all of your inventory items for each vendor. This page will show all the vendors which you selected on the previous page. The vendor that you are working with at the moment will be highlighted in blue. If you selected a vendor that was already in the Artecsan database, that vendor may already have a database of items. If you added a new vendor, it will also mean that you have to add all of the vendor items as well.<br/><br/><b>Step 1:</b> Select the vendor which you want to work with. The vendor will be highlighted in Blue<br/><br/><b>Step 2:</b> Select Modify/Add which will produce a popup screen which you can enter all of your vendor items into.<br/><br/><b>Step 3:</b> Select the + symbol in the right hand corner. This will open up the necessary fields to add your items.<br/><br/><b>Step 4:</b> Add the necessary details to the add/modify vendor fields. NOTE: We suggest acquiring a purchases list from your vendor which includes all of the needed information. Skrible can also import the data for you if its in excel or csv format and all of the fields are completed<ul><li><b>Sku</b>  this info will come from the vendor. Be sure to use the vendor sku and not the manufacturer sku. The vendor sku is how the vendor knows which items you really want. The difference between manufacturer sku and vendor sku is the manufacturer sku is generated by the maker of the product while the vendor sku is generated by the seller of the produce. Therefore you must use the vendor sku</li><li><b>Item Name</b>  you may enter the item name that works for you however we suggest duplicating the name that was provided by the vendor</li><li><b>Category/Subcategory</b>  categories are preset and as of now cannot be changed</li><li><b>Size</b>  this is a dropdown list of the most common sizes. If you have an unusual size that you would like for us to add please email your request to admin@artecsan.com</li><li><b>Full Unit Weight</b>  if this option appears you will need to add the full weight of an unopened bottle in ounces. You can do this by simply placing a full unopen bottle on a scale, weighing it in ounces and entering the number here</li><li><b>Unit</b>  is the number of individual items in a case. For example: a case of alcohol that has 12 bottles is the same as 12 units.</li><li><b>Case$</b> - automatically calculated based on Unit X Item($)</li><li><b>Item($)</b>  this is the individual price of a single unit. You can get this number by multiplying a case by units. For example: if we have 12 units (bottles) that cost $24 it would mean that the Item($) is $2</li><li><b>Substitute For</b> - If you purchase the same item from multiple vendors or if you have items that are used as replacements, you can assign them to parent items. For example: if I purchase a case of Greygoose from vendor #1 but they run out so I purchase from Vendor #2. I would assign the Greygoose from Vendor #1 as the parent of Greygoose from vendor #2. This will merge the two items so that only one item merges the transactions and details and only one item shows on the reports.</li></ul>Once the data is in you may select Save and all the item details will be added to your restaurant.</p></article>',that.skip=function(){$uibModalInstance.dismiss("cancel")}};inventorySetupController.$inject=["api","$state","auth","localStorageService","SweetAlert","$rootScope","restaurant","$uibModal","core","$scope"],angular.module("inspinia").component("alcoholInventorySetupComponent",{templateUrl:"js/components/alcoholSetup/inventorySetup/inventorySetup.html",controller:inventorySetupController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("alcoholSetup.inventory",{url:"/inventory-setup",template:"<alcohol-inventory-setup-component></alcohol-inventory-setup-component>",data:{pageTitle:" Inventory Setup"}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("alcoholSetup.posSync",{url:"/pos_sync/:pos_id",template:"<pos-sync-component></pos-sync-component>",data:{pageTitle:" POS Setup"}})})}(),function(){"use strict";function setParController(api,$state,auth,core,localStorageService,alertService,SweetAlert,restaurant,$rootScope,$scope,$q){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.api=api,that.core=core,that.auth=auth,that.processed_par_items=[],$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.setDirty=function(){that.dataChanged=!0},that.goToOrder=function(){$state.go("alcohol.newAlcoholOrder")},that.processPar=function(){that.processed_par_items=[];for(var pd in that.par_data){var pdi=that.par_data[pd];null==pdi.substitute_for&&(pdi.bu_minimum_order_type=pdi.minimum_order_type.substr(),"Case"==pdi.minimum_order_type&&(pdi.suggested_par_units=Math.ceil(pdi.suggested_par_units/pdi.pack)),pdi.actual_order_unit!=pdi.minimum_order_type&&null!=pdi.actual_par_units&&("Case"==pdi.minimum_order_type?pdi.actual_par_units=Math.ceil(pdi.actual_par_units/pdi.pack):"Wine"!=that.category&&(pdi.actual_par_units=pdi.actual_par_units*pdi.pack)),"Wine"==that.category&&"Case"!=pdi.minimum_order_type&&(pdi.suggested_par_units=Math.ceil(pdi.suggested_par_units/pdi.pack),pdi.minimum_order_type="Case"),pdi.units_on_hand="Loading...",that.processed_par_items.push(pdi))}},that.checkCount=function(item){1==item.alert_if_low?that.count_limit<1?(swal({title:"Limit reached! Please uncheck some items first.",timer:3e3,showConfirmButton:!1,type:"warning"}),item.alert_if_low=0):that.count_limit--:that.count_limit++},that.getData=function(){that.loading=!0,Promise.all([that.getParData()]).then(function(response){that.getOH(),that.getSuggestedOrder()})},that.getOH=function(){that.api.alcohol({RestaurantId:that.restaurant_id.restaurant_id,Category:that.category,caller:"oh_report"}).then(function(res){if(res){that.oh_table_data=res.data.data.Report;for(var pt in that.processed_par_items){var found_item=!1;for(var ot in that.oh_table_data){if(that.oh_table_data[ot].vendor_sku_id==that.processed_par_items[pt].vendor_sku_id){that.processed_par_items[pt].units_on_hand=that.oh_table_data[ot].units_on_hand,found_item=!0;break}found_item||(that.processed_par_items[pt].units_on_hand="N/A")}}}that.loading=!1})},that.getSuggestedOrder=function(){that.api.get_suggested_orders({RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:2}).then(function(res){if(res){that.suggested_table_data=res.data.data.Report;for(var pt in that.processed_par_items)for(var ot in that.suggested_table_data)if(that.suggested_table_data[ot].vendor_sku_id==that.processed_par_items[pt].vendor_sku_id){that.processed_par_items[pt].suggested_amount=that.suggested_table_data[ot].suggested_amount,that.processed_par_items[pt].suggested_order_type=that.suggested_table_data[ot].suggested_order_type;break}}})},that.getParData=function(){var deferred=$q.defer();return that.count_limit=100,that.dataChanged?SweetAlert.swal({title:"Are you sure?",text:"Unsaved changes will be lost if you change the category.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"OK"},function(sres){sres&&(that.dataChanged=!1,that.api.get_par({category:that.category,inventory_type_id:2,get_notif_status:!0}).then(function(res){res&&(that.par_data=res.data.data.pars,that.count_limit=isNaN(res.data.data.notif_count)?0:that.count_limit-res.data.data.notif_count,that.processPar()),deferred.resolve()}))}):that.api.get_par({category:that.category,inventory_type_id:2,get_notif_status:!0}).then(function(res){res&&(that.par_data=res.data.data.pars,that.count_limit=isNaN(res.data.data.notif_count)?0:that.count_limit-res.data.data.notif_count,that.processPar()),deferred.resolve()}),deferred.promise},that.saveActualPar=function(){that.api.update_par({inventory_type_id:2,pars_data:that.par_data.map(function(x){return{vendor_sku_id:x.vendor_sku_id,actual_par_units:x.actual_par_units,order_unit:x.bu_minimum_order_type,alert_if_low:x.alert_if_low,notify_units:x.notify_units}})}).then(function(res){res&&1e3==res.data.data.code?(that.dataChanged=!1,alertService.showAlertSave()):alertService.showError("Something went wrong!")})},that.$onInit=function(){that.api.get_active_SKU_categories({inventory_type_id:2}).then(function(res){that.SKU_categories=res.data.data.categories,that.SKU_categories.length&&(that.category=that.SKU_categories[0].category,that.dataChanged=!1,that.getData())})}}setParController.$inject=["api","$state","auth","core","localStorageService","alertService","SweetAlert","restaurant","$rootScope","$scope","$q"],angular.module("inspinia").component("setParComponent",{templateUrl:"js/components/alcoholSetup/setPar/setPar.html",controller:setParController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("alcoholSetup.setPar",{url:"/set-par",template:"<set-par-component></set-par-component>",data:{pageTitle:"Set Par"}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("alcoholSetup.confirmation",{url:"/confirmation",template:"<setup-confirmation-component></setup-confirmation-component>",data:{pageTitle:"Setup Confirmation"}})})}(),function(){"use strict";function addEditLocationsController($uibModalInstance,api,alertService,locations,restaurant_id){var that=this;that.form={},that.api=api,that.addLocation=function(){if(!(that.active_locations_length<that.locations_limit))return void alertService.showError("Active locations limit reached!");that.active_locations_length++,that.locations.push({location_name:null,status:1,added:!0})},that.changeLocationsStatus=function($index,action){if("hide"==action)that.active_locations_length--,that.locations[$index].status=0;else{if(!(that.active_locations_length<that.locations_limit))return void alertService.showError("Active locations limit reached!");that.active_locations_length++,that.locations[$index].status=1}},that.remove=function($index){1==that.locations[$index].status&&that.active_locations_length--,that.locations.splice($index,1)},that.save=function(form){if(!form.$valid)return void alertService.showError("Please validate all inputs");if(!(that.active_locations_length<=that.locations_limit))return void alertService.showError("Active locations limit reached!");var headers={restaurant_id:restaurant_id,inventory_type_id:2,loc_list:that.locations};that.api.add_edit_locations(headers).then(function(res){try{1e3===res.data.data.code&&(alertService.showSuccessText("Saved!"),that.getLocations())}catch(e){console.log(e)}})},that.cancel=function(){$uibModalInstance.dismiss("cancel")},that.getLocations=function(){var headers={restaurant_id:restaurant_id,inventory_type_id:2};that.api.get_restaurant_audit_locations(headers).then(function(res){that.locations=res.data.data.Report,that.active_locations_length=that.locations.filter(function(x){return 1==x.status}).length,"active"==that.show_status?that.locations=that.locations.filter(function(x){return 1==x.status}):that.locations=that.locations.filter(function(x){return 0==x.status})})},that.locations_limit=7,that.show_status="active",that.getLocations()}addEditLocationsController.$inject=["$uibModalInstance","api","alertService","locations","restaurant_id"],angular.module("inspinia").controller("addEditLocationsController",addEditLocationsController)}(),function(){"use strict"
;function addItemsController($uibModalInstance,alertService,searchParams,locations,selected_location){var that=this,parseStringToNum=function(st){return st.split("+").filter(function(item){return""!==item.split("_")[0]}).map(function(item,i){return{id:i,value:parseFloat(item.split("_")[0]),locn_id:parseInt(item.split("_")[1])}})},parseNumToString=function(array){return array.map(function(item){return item.value+"_"+item.locn_id}).join("+")};searchParams&&(that.item=searchParams,that.locations=locations,that.selected_location=selected_location),that.entries={full:null!=that.item.full_values?parseStringToNum(that.item.full_values):[],partial:null!=that.item.partial_values?parseStringToNum(that.item.partial_values):[]},that.checkPartial=function($index,value){value>=that.item.tare_weight&&value<=that.item.full_weight||(alertService.showError("Incorrect partial weight! Try again"),that.entries.partial.splice($index,1))},that.addField=function(){var fid=that.entries.full.length?that.entries.full.length+1:0;if(that.entries.full.push({id:fid,value:0,locn_id:selected_location}),"Bottle Beer"!=that.item.category){var pid=that.entries.partial.length?that.entries.partial.length+1:0;that.entries.partial.push({id:pid,value:0,locn_id:selected_location})}},that.removeField=function(type,index){"full"==type?that.entries.full.splice(index,1):"partial"==type&&that.entries.partial.splice(index,1)},that.save=function(){that.item.full_values=null!=that.entries.full?parseNumToString(that.entries.full):null,that.item.partial_values=null!=that.entries.partial?parseNumToString(that.entries.partial):null,$uibModalInstance.close(that.item)},that.cancel=function(){$uibModalInstance.dismiss("cancel")}}addItemsController.$inject=["$uibModalInstance","alertService","searchParams","locations","selected_location"],angular.module("inspinia").controller("addItemsController",addItemsController)}(),function(){"use strict";function tabletEntryController(api,$state,auth,localStorageService,restaurant,core,alertService,SweetAlert,$uibModal){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.api=api,that.auth=auth,that.is_sug_aud=void 0!==$state.params.is_sug_aud&&""!=$state.params.is_sug_aud?$state.params.is_sug_aud:"false",restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.pickers={beginDate:{open:!1,date:new Date},endDate:{open:!1,date:new Date},beginDateBackup:{open:!1,date:new Date}};var INVENTORY_MASTER_LIST=[];that.currentDrinkIndex=0,that.model={categories:[],subcategories:[],quick_search_keys:[],prev_item:null,current_item:null,next_item:null,size_enabled:!1,weight_enabled:!1,search_query:null,inventory:[],full_total:null,partial_total:null,n_partial_entries:null,global_partial_input_mode:null},that.get_partial_input_modes=function(category){return"Draft Beer"==category||"Draft Wine"==category?["Lbs","Pts"]:["Oz","Pts"]},that.set_gloabl_partial_input_mode=function(){that.model.global_partial_input_mode=that.model.current_item.selected_partial_input_mode},that.changeLocation=function(){-1==that.selected_location&&(that.selected_location=that.locations[0].sr_no,$uibModal.open({templateUrl:"js/components/alcoholSetup/tabletEntry/locationEntry.html",controller:"addEditLocationsController",windowClass:"animated fadeIn",controllerAs:"$ctr",size:"md",resolve:{locations:function(){return that.locations.filter(function(x){return-1!=x.sr_no})},restaurant_id:function(){return that.restaurant_id.restaurant_id}}}).closed.then(function(){that.getLocations()}))},that.addUniqueItems=function(){var headers={is_adjustment:0,inventory_type_id:2,vendor_cat_id:"Shelf to Sheet"==that.selected_category.category?that.selected_subcategory.id:that.selected_category.id,vendor_sku_id:that.model.current_item.vendor_sku_id};that.api.get_inventory_audit(headers).then(function(res){res.data.data.inventory.length&&(that.model.current_item.full_values=res.data.data.inventory[0].full_values,that.model.current_item.partial_values=res.data.data.inventory[0].partial_values),$uibModal.open({templateUrl:"js/components/alcoholSetup/tabletEntry/modalEntry.html",controller:"addItemsController",windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",size:"md",resolve:{searchParams:function(){return that.model.current_item},locations:function(){return that.locations.filter(function(x){return-1!=x.sr_no})},selected_location:function(){return that.selected_location}}}).result.then(function(){that._recalculateTotal();var item={id:that.model.current_item.id,vendor_sku_id:that.model.current_item.vendor_sku_id,item_qty:that.model.current_item.partial_total,cases_qty:0,nof_bottles:that.model.current_item.n_partial_entries,packs_qty:that.model.current_item.full_total,total_in_uom_of_delivery:that.calculate_uom_of_delivery(that.model.current_item),item_qty_formula:that.model.current_item.partial_values,full_values:that.model.current_item.full_values,partial_values:that.model.current_item.partial_values};that._submitInventory(item,!0)})})},that.handleSubmitEntries=function(){if(that.model.current_item.packs_qty_inp||that.model.current_item.item_qty_inp){var headers={is_adjustment:0,inventory_type_id:2,vendor_cat_id:"Shelf to Sheet"==that.selected_category.category?that.selected_subcategory.id:that.selected_category.id,vendor_sku_id:that.model.current_item.vendor_sku_id};that.api.get_inventory_audit(headers).then(function(res){res.data.data.inventory.length&&(that.model.current_item.full_values=res.data.data.inventory[0].full_values,that.model.current_item.partial_values=res.data.data.inventory[0].partial_values),that.model.current_item.full_values=null!=that.model.current_item.packs_qty_inp?null!=that.model.current_item.full_values?that.model.current_item.full_values+"+"+that.model.current_item.packs_qty_inp.toString()+"_"+that.selected_location:that.model.current_item.packs_qty_inp.toString()+"_"+that.selected_location:null!=that.model.current_item.full_values?that.model.current_item.full_values:null,that.model.current_item.partial_values=null!=that.model.current_item.item_qty_inp?null!=that.model.current_item.partial_values?that.model.current_item.partial_values+"+"+("Pts"==that.model.current_item.selected_partial_input_mode?(Math.round(100*(that.model.current_item.item_qty_inp*that.model.current_item.size+that.model.current_item.tare_weight))/100).toString():"Oz"==that.model.current_item.selected_partial_input_mode?(Math.round(100*that.model.current_item.item_qty_inp)/100).toString():(Math.round(16*that.model.current_item.item_qty_inp*100)/100).toString())+"_"+that.selected_location:("Pts"==that.model.current_item.selected_partial_input_mode?(Math.round(100*(that.model.current_item.item_qty_inp*that.model.current_item.size+that.model.current_item.tare_weight))/100).toString():"Oz"==that.model.current_item.selected_partial_input_mode?(Math.round(100*that.model.current_item.item_qty_inp)/100).toString():(Math.round(16*that.model.current_item.item_qty_inp*100)/100).toString())+"_"+that.selected_location:null!=that.model.current_item.partial_values?that.model.current_item.partial_values:null,that._recalculateTotal();var item={id:that.model.current_item.id,vendor_sku_id:that.model.current_item.vendor_sku_id,item_qty:that.model.current_item.partial_total,cases_qty:0,nof_bottles:that.model.current_item.n_partial_entries,packs_qty:that.model.current_item.full_total,total_in_uom_of_delivery:that.calculate_uom_of_delivery(that.model.current_item),item_qty_formula:that.model.current_item.partial_values,full_values:that.model.current_item.full_values,partial_values:that.model.current_item.partial_values};that._submitInventory(item,!1)})}},that.preProcessCOS=function(){for(var dict={},signs={},i=0;i<that.cos_table_data.length;i++)null==that.cos_table_data[i].substitute_for?dict.hasOwnProperty(that.cos_table_data[i].vendor_sku_id)?(dict[that.cos_table_data[i].vendor_sku_id].push(that.cos_table_data[i]),that.cos_table_data[i].theor_sales<0?signs[that.cos_table_data[i].vendor_sku_id][0]++:0==that.cos_table_data[i].theor_sales?signs[that.cos_table_data[i].vendor_sku_id][1]++:signs[that.cos_table_data[i].vendor_sku_id][2]++):(dict[that.cos_table_data[i].vendor_sku_id]=[that.cos_table_data[i]],signs[that.cos_table_data[i].vendor_sku_id]=[0,0,0],that.cos_table_data[i].theor_sales<0?signs[that.cos_table_data[i].vendor_sku_id][0]++:0==that.cos_table_data[i].theor_sales?signs[that.cos_table_data[i].vendor_sku_id][1]++:signs[that.cos_table_data[i].vendor_sku_id][2]++):dict.hasOwnProperty(that.cos_table_data[i].substitute_for)?(dict[that.cos_table_data[i].substitute_for].push(that.cos_table_data[i]),that.cos_table_data[i].theor_sales<0?signs[that.cos_table_data[i].substitute_for][0]++:0==that.cos_table_data[i].theor_sales?signs[that.cos_table_data[i].substitute_for][1]++:signs[that.cos_table_data[i].substitute_for][2]++):(dict[that.cos_table_data[i].substitute_for]=[that.cos_table_data[i]],signs[that.cos_table_data[i].substitute_for]=[0,0,0],that.cos_table_data[i].theor_sales<0?signs[that.cos_table_data[i].substitute_for][0]++:0==that.cos_table_data[i].theor_sales?signs[that.cos_table_data[i].substitute_for][1]++:signs[that.cos_table_data[i].substitute_for][2]++);var total={};for(var key in dict)if(dict.hasOwnProperty(key))if(total[key]=0,0!=signs[key][0]&&0==signs[key][2])for(var i=0;i<dict[key].length;i++)dict[key][i].theor_sales<0&&(total[key]+=dict[key][i].theor_sales);else if(0==signs[key][0]&&0!=signs[key][2])for(var i=0;i<dict[key].length;i++)dict[key][i].theor_sales>0&&(total[key]+=dict[key][i].theor_sales);else if(0!=signs[key][0]&&0!=signs[key][2])for(var i=0;i<dict[key].length;i++)dict[key][i].theor_sales>0&&(total[key]+=dict[key][i].theor_sales);for(var key in dict)if(dict.hasOwnProperty(key))if(0!=signs[key][0]&&0==signs[key][2])for(var i=0;i<dict[key].length;i++)dict[key][i].theor_sales<0?dict[key][i].wauc=dict[key][i].theor_sales/total[key]*dict[key][i].item_cost:dict[key][i].wauc=0;else if(0==signs[key][0]&&0!=signs[key][2])for(var i=0;i<dict[key].length;i++)dict[key][i].theor_sales>0?dict[key][i].wauc=dict[key][i].theor_sales/total[key]*dict[key][i].item_cost:dict[key][i].wauc=0;else if(0!=signs[key][0]&&0!=signs[key][2])for(var i=0;i<dict[key].length;i++)dict[key][i].theor_sales>0?dict[key][i].wauc=dict[key][i].theor_sales/total[key]*dict[key][i].item_cost:dict[key][i].wauc=0;else for(var i=0;i<dict[key].length;i++)null==dict[key][i].substitute_for?dict[key][i].wauc=dict[key][i].item_cost:dict[key][i].wauc=0;var p_indx={},yo=[];for(var key in dict)if(dict.hasOwnProperty(key)){for(var uc=0,pur=0,sales=0,beg=0,end=0,ther=0,unit=0,cost=0,i=0;i<dict[key].length;i++)null==dict[key][i].substitute_for&&(p_indx[key]=i),uc+=dict[key][i].wauc,pur+=dict[key][i].purchases,sales+=dict[key][i].sales,beg+=dict[key][i].beg_oz,end+=dict[key][i].end_oz,ther+=dict[key][i].theor_sales,unit+=dict[key][i].unit_variance,cost+=dict[key][i].cost_variance;dict[key][p_indx[key]].wauc=uc,dict[key][p_indx[key]].purchases=pur,dict[key][p_indx[key]].sales=sales,dict[key][p_indx[key]].beg_oz=beg,dict[key][p_indx[key]].end_oz=end,dict[key][p_indx[key]].theor_sales=ther,dict[key][p_indx[key]].unit_variance=unit,dict[key][p_indx[key]].cost_variance=cost,yo.push(dict[key][p_indx[key]])}that.cos_table_data=yo},that.getCOS=function(item,is_ve){if(that.loadingCOS=!0,void 0===item||is_ve)that.api.get_audit_dates({RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:2}).then(function(res1){that.audit_dates=res1.data.data.Report,that.audit_dates_f=res1.data.data.Report.map(function(x){return x.audit_dates.substring(0,10)}),that.audit_dates_t=JSON.parse(JSON.stringify(that.audit_dates_f)),that.audit_dates_f.splice(0,1),that.start_date=that.audit_dates_f[0],that.end_date=that.audit_dates_t[0];var params=item?{RestaurantId:that.restaurant_id.restaurant_id,Category:"Shelf to Sheet"==that.selected_category.category?that.selected_subcategory.category:that.selected_category.category,start_date:that.start_date,end_date:that.end_date,inventory_type_id:2,vendor_sku_id:that.model.current_item.vendor_sku_id}:{RestaurantId:that.restaurant_id.restaurant_id,Category:"Shelf to Sheet"==that.selected_category.category?that.selected_subcategory.category:that.selected_category.category,start_date:that.start_date,end_date:that.end_date,inventory_type_id:2};that.api.sku_table(params).then(function(res){if(that.loadingCOS=!1,res&&(that.cos_table_data=res.data.data.sku_table,void 0!==that.cos_table_data&&null!=that.cos_table_data&&that.cos_table_data.length)){that.global_cos_table_data=JSON.parse(JSON.stringify(that.cos_table_data));for(var i=0;i<that.model.inventory.length;i++)for(var c=0;c<that.cos_table_data.length;c++)if(that.model.inventory[i].vendor_sku_id==that.cos_table_data[c].vendor_sku_id){that.model.inventory[i].unit_variance=that.cos_table_data[c].unit_variance,that.model.inventory[i].OH=that.cos_table_data[c].beg_oz+that.cos_table_data[c].purchases-that.cos_table_data[c].sales;break}}})});else{if(void 0!==that.global_cos_table_data)for(var c=0;c<that.global_cos_table_data.length;c++)if(null==item.substitute_for&&item.vendor_sku_id==that.global_cos_table_data[c].vendor_sku_id){var pw=(that.model.current_item.partial_total-item.tare_weight*that.model.current_item.n_partial_entries)/item.size;that.global_cos_table_data[c].unit_variance=that.model.current_item.full_total+pw-that.model.current_item.OH,that.global_cos_table_data[c].end_oz=that.calculate_uom_of_delivery(that.model.current_item);for(var i=0;i<that.model.inventory.length;i++)if(that.model.inventory[i].vendor_sku_id==that.global_cos_table_data[c].vendor_sku_id){that.model.inventory[i].unit_variance=that.global_cos_table_data[c].unit_variance;break}break}that.loadingCOS=!1}},that._recalculateTotal=function(){null!=that.model.current_item.partial_values?that.model.current_item.n_partial_entries=that.model.current_item.partial_values.split("+").filter(function(item){return""!==(item=item.split("_")[0])&&"0"!=item}).length:that.model.current_item.n_partial_entries=0,that.model.current_item.full_total=that._computeTotalByString(that.model.current_item.full_values),that.model.current_item.partial_total=that._computeTotalByString(that.model.current_item.partial_values),that.model.current_item.packs_qty_inp=null,that.model.current_item.item_qty_inp=null,that.model.current_item.selected_partial_input_mode="Draft Beer"==that.model.current_item.category||"Draft Wine"==that.model.current_item.category?"Oz"==that.model.global_partial_input_mode?"Lbs":that.model.global_partial_input_mode:"Lbs"==that.model.global_partial_input_mode?"Oz":that.model.global_partial_input_mode},that._computeTotalByString=function(st){return st?st.split("+").filter(function(item){return""!==(item=item.split("_")[0])}).map(function(entry){return parseFloat(entry)}).reduce(function(pV,cV){return pV+cV}):0},that.deleteCurrentInventoryAudit=function(){SweetAlert.swal({title:"Are you sure?",text:"This will completely delete the saved Audit for this restaurant and you will have to startover!",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){res&&that.api.delete_inventory_audit(2,that.is_sug_aud).then(function(res1){res&&(SweetAlert.swal("Deleted!","Please proceed to startover a new audit.","success"),$state.go("alcoholSubCategories"))})})},that._submitInventory=function(item,is_ve){var m={inventory_type_id:2,counting_started_at:new Date(that.pickers.beginDate.date).getTime(),counting_ended_at:(new Date).getTime(),is_final_save:0,is_adjustment:0,inventory_items:[item],shelf_to_sheet:!0,tablet_mode:!0,is_suggested:"true"==that.is_sug_aud?1:0};that.api.update_inventory_audit(m).then(function(res){SweetAlert.swal("Saved!","Your changes has been saved!","success"),void 0!==that.res_data_audit_start&&null!=that.res_data_audit_start[0].audit_start||(that.res_data_audit_start=[{audit_start:new Date}]),null==that.model.current_item.substitute_for&&that.showCOSDetails&&that.getCOS(that.model.current_item,is_ve)})},that.calculate_uom_of_delivery=function(item){return item.full_total*item.size+(item.partial_total-item.n_partial_entries*item.tare_weight)},that.disableCheckBoxes=function(){that.model.subcat_enabled=!1,that.model.size_enabled=!1,that.model.weight_enabled=!1},that.viewReport=function(){$state.go("reports.alcoholCostOfSummary")},that.finalSaveAudit=function(caller){if("suggested"==caller)that.api.get_audit_dates({RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:2}).then(function(res1){that.audit_dates=res1.data.data.Report,that.audit_dates_f=res1.data.data.Report.map(function(x){return{aud_title:x.audit_dates.substring(0,10)+" ("+x.type+" by "+x.audited_by_org+")",audit_dates:x.audit_dates.substring(0,10),src:x.src,type:x.type,is_suggested:x.is_suggested}});var adminFS=function(){var m={inventory_type_id:2,counting_started_at:(new Date).getTime(),counting_ended_at:(new Date).getTime(),is_final_save:1,is_adjustment:"suggested"==caller?1:0,send_email:"suggested"==caller,additional_notes:that.additional_notes,inventory_items:[],is_suggested:"true"==that.is_sug_aud?1:0};void 0!==that.prev_audit_date&&null!=that.prev_audit_date&&(m.prev_audit_date=that.prev_audit_date),null==m.additional_notes&&delete m.additional_notes,that.api.update_inventory_audit(m).then(function(res){try{1e3===res.data.data.code&&(alertService.showAlertSave(),$state.go("alcoholSubCategories"))}catch(e){console.log(e)}},function(){})};if("true"==that.is_sug_aud){var conf={title:"Are you sure?",text:"This will permanently update your on-hand count as of today. You will shortly receive a report on your email.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"};swal(conf,function(res){res&&(that.is_send_email=!0,that.audit_type="adjustment",that.additional_notes=null,that.prev_audit_date=that.audit_dates_f[1],adminFS())})}});else if("first_audit"==caller){var adminFS=function(){var m={inventory_type_id:2,counting_started_at:(new Date).getTime(),counting_ended_at:(new Date).getTime(),is_final_save:1,is_adjustment:0,send_email:!1,additional_notes:that.additional_notes,inventory_items:[],is_suggested:0};null==m.additional_notes&&delete m.additional_notes,that.api.update_inventory_audit(m).then(function(res){try{1e3===res.data.data.code&&(alertService.showAlertSave(),$state.go("alcoholSubCategories"))}catch(e){console.log(e)}},function(){})},conf={title:"Are you sure?",text:"This will permanently update your on-hand count as of today. You will shortly receive a report on your email.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"};swal(conf,function(res){res&&(that.additional_notes=null,adminFS())})}},that.back=function(){0==that.SetUpStatus?$state.go("setupFirstAudit"):$state.go("alcoholSubCategories")},that.navigate=function(direction){that.disableCheckBoxes(),"next"===direction&&that.currentDrinkIndex<that.model.inventory.length-1?(that.currentDrinkIndex++,that.model.current_item=that.model.inventory[that.currentDrinkIndex]):"previous"===direction&&that.currentDrinkIndex>0&&(that.currentDrinkIndex--,that.model.current_item=that.model.inventory[that.currentDrinkIndex]),that._recalculateTotal(),that.setPrevNext(that.currentDrinkIndex)},that.setPrevNext=function(index){that.model.inventory&&(that.model.prev_item=index>0?that.model.inventory[index-1]:null,that.model.next_item=index<that.model.inventory.length-1?that.model.inventory[index+1]:null)},that.handleSubmitSubcategory=function(){if(null==that.model.current_item.vendor_sub_cat_id)return void alertService.showError("Please select a subcategory.");SweetAlert.swal({title:"Are you sure?",text:"Are you sure you want to change the subcategory of the item. This change could affect multiple reports.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){if(res){var m={vendor_sub_cat_id:that.model.current_item.vendor_sub_cat_id};that.api.update_sku(that.model.current_item.vendor_sku_id,m).then(function(res){200===res.status&&(that.disableCheckBoxes(),SweetAlert.swal("Saved!","Your changes has been saved!","success"))})}})},that.handleSubmitSize=function(){SweetAlert.swal({title:"Are you sure?",text:"Are you sure you want to change the item size or weight. This change could affect multiple reports.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){if(res){var m={tare_type_id:that.model.current_item.tare_type_id,full_weight:that.model.current_item.full_weight};that.api.update_sku(that.model.current_item.vendor_sku_id,m).then(function(res){if(200===res.status){var sizes=that._getItemSizes(that.model.current_item.vendor_cat_id,that.model.current_item.vendor_sub_cat_id);for(var s in sizes)if(sizes[s].tare_type_id==that.model.current_item.tare_type_id){that.model.current_item.size=sizes[s].content_weight;break}that.model.current_item.tare_weight=that.model.current_item.full_weight-that.model.current_item.size,that.disableCheckBoxes(),that._recalculateTotal();var item={id:that.model.current_item.id,vendor_sku_id:that.model.current_item.vendor_sku_id,item_qty:that.model.current_item.partial_total,cases_qty:0,nof_bottles:that.model.current_item.n_partial_entries,packs_qty:that.model.current_item.full_total,total_in_uom_of_delivery:that.calculate_uom_of_delivery(that.model.current_item),item_qty_formula:that.model.current_item.partial_values,full_values:that.model.current_item.full_values,partial_values:that.model.current_item.partial_values};that._submitInventory(item,!0)}})}})},that._getItemSizes=function(cat_id,sub_cat_id){if(!cat_id&&!sub_cat_id)return[];for(var _a=[],i=0;that.refbooks.default_weights.length>i;i++)if(that.refbooks.default_weights[i].vendor_cat_id===cat_id&&that.refbooks.default_weights[i].vendor_sub_cat_id===sub_cat_id)for(var j=0;that.refbooks.tare_types.length>j;j++)if(that.refbooks.tare_types[j].tare_type_id===that.refbooks.default_weights[i].tare_type_id&&-1===_a.indexOf(that.refbooks.tare_types[j])){var tt=that.refbooks.tare_types[j];tt.content_weight=that.refbooks.default_weights[i].content_weight,_a.push(tt)}return _a},that.hideShowSubstitutes=function(is_manual,inv_list){that.hide_subs=is_manual?!that.hide_subs:that.hide_subs,inv_list||(that.currentDrinkIndex=0);var fl=inv_list||INVENTORY_MASTER_LIST;that.hide_subs?(that.model.inventory=fl.filter(function(item){return null==item.substitute_for}),inv_list||(that.model.current_item=that.model.inventory[0])):(that.model.inventory=fl,inv_list||(that.model.current_item=that.model.inventory[0])),is_manual&&(that.model.quick_search_keys=that._extractKeys(),that._recalculateTotal()),inv_list||that.setPrevNext(that.currentDrinkIndex)},that.handleSearch=function(query){that.disableCheckBoxes(),that.currentDrinkIndex=0,that.hide_subs?that.hideShowSubstitutes(!1,INVENTORY_MASTER_LIST):that.model.inventory=INVENTORY_MASTER_LIST,query&&query.length?that.model.inventory=that.model.inventory.filter(function(item){return item.inventory_item.toUpperCase().includes(query.toUpperCase())}):(that.model.inventory=INVENTORY_MASTER_LIST,that.hide_subs&&that.hideShowSubstitutes(!1,that.model.inventory)),that.model.current_item=that.model.inventory[0],that.model.quick_search_keys=that._extractKeys(),that._recalculateTotal(),that.setPrevNext(that.currentDrinkIndex)},that.jumpToLetter=function(key){that.disableCheckBoxes(),that.currentDrinkIndex=0,null!=that.selected_subcategory&&(that.model.inventory=that._filterBySubCategoryId(that.selected_subcategory)),that.hide_subs&&that.hideShowSubstitutes(!1,that.model.inventory);for(var i=0;i<that.model.inventory.length&&key!=that.model.inventory[i].inventory_item[0].toUpperCase();i++)that.currentDrinkIndex++;that.model.current_item=that.model.inventory[that.currentDrinkIndex],that._recalculateTotal(),that.setPrevNext(that.currentDrinkIndex)},that._extractKeys=function(){var letters=new Set;return that.model.inventory.forEach(function(item){var letter=item.inventory_item[0].toUpperCase();letters.add(letter)}),Array.from(letters).sort()},that.generateShelfToSheet=function(data){var sh_sh_list=[];if(data.inventory.length){for(var i=0;i<data.shelf_to_sheet.length;i++)for(var j=0;j<data.inventory.length;j++)if(data.shelf_to_sheet[i].vendor_sku_id==data.inventory[j].vendor_sku_id){sh_sh_list.push(data.inventory[j]);break}if(sh_sh_list.length)for(var i=0;i<data.inventory.length;i++){for(var exists=!1,j=0;j<sh_sh_list.length;j++)if(data.inventory[i].id==sh_sh_list[j].id){exists=!0;break}exists||sh_sh_list.push(data.inventory[i])}else sh_sh_list=data.inventory}return sh_sh_list},that._filterBySubCategoryId=function(sub_cat){var filtered_items;return sub_cat&&(filtered_items=INVENTORY_MASTER_LIST.filter(function(item){return item.vendor_sub_cat_id===sub_cat.id})),filtered_items},that.handleSubcatClick=function(sub_cat){that.disableCheckBoxes(),that.currentDrinkIndex=0,"Shelf to Sheet"==that.selected_category.category?that._getInventories(sub_cat,!0,sub_cat):(that.model.inventory=that._filterBySubCategoryId(sub_cat),that.hide_subs&&that.hideShowSubstitutes(!1,that.model.inventory),that.model.quick_search_keys=that._extractKeys(),that.model.current_item=that.model.inventory[0],that.selected_subcategory=sub_cat,that._recalculateTotal(),that.setPrevNext(that.currentDrinkIndex))},that._getSubcategories=function(){function compare(a,b){return a.sub_category>b.sub_category?1:b.sub_category>a.sub_category?-1:0}var subcats=new Set;return that.model.inventory.forEach(function(item){for(var i=0;i<that.refbooks.vendor_sub_cat.length;i++)if(item.vendor_cat_id==that.refbooks.vendor_sub_cat[i].vendor_cat_id&&item.vendor_sub_cat_id==that.refbooks.vendor_sub_cat[i].id){subcats.add(that.refbooks.vendor_sub_cat[i]);break}}),Array.from(subcats).sort(compare)},that._getInventories=function(category,shelf_to_sheet,sub_cat_to){var headers={is_adjustment:0,inventory_type_id:2,vendor_cat_id:category.id,inventory_item:null,shelf_to_sheet:shelf_to_sheet,audit_start_TS:!0,suggested:that.is_sug_aud};that.api.get_inventory_audit(headers).then(function(res){that.res_data_audit_start=res.data.data.audit_start,that.pickers.beginDate.date=void 0!==res.data.data.audit_start&&null!=res.data.data.audit_start[0].audit_start?new Date(res.data.data.audit_start[0].audit_start):new Date,that.pickers.beginDateBackup.date=JSON.parse(JSON.stringify(that.pickers.beginDate.date)),shelf_to_sheet?(INVENTORY_MASTER_LIST=that.generateShelfToSheet(res.data.data),that.hideShowSubstitutes(!1),that.model.subcategories=JSON.parse(JSON.stringify(that.model.categories)),that.model.subcategories.shift(),that.selected_subcategory=sub_cat_to||that.model.subcategories[0]):(INVENTORY_MASTER_LIST=res.data.data.inventory,that.hideShowSubstitutes(!1),that.model.subcategories=that._getSubcategories(),that.selected_subcategory=null,that.model.quick_search_keys=that._extractKeys()),that.currentDrinkIndex=shelf_to_sheet?res.data.data.shelf_to_sheet.length<that.model.inventory.length-1?res.data.data.shelf_to_sheet.length:that.model.inventory.length-1:0,that.model.current_item=that.model.inventory[that.currentDrinkIndex],that._recalculateTotal(),that.setPrevNext(that.currentDrinkIndex),that.showCOSDetails&&that.getCOS()})},that.handleCategoryClick=function(category){that.disableCheckBoxes(),that.selected_category=category,"Shelf to Sheet"==category.category?that._getInventories(that.model.categories[1],!0,null):that._getInventories(category,!1,null)},that.checkEmpType=function(){that.SetUpStatus=restaurant.data.info.is_setup_completed;var emps=restaurant.data.info.employees;if(that.user={userid:null,user_type_id:null},that.user.userid=that.auth.authentication.user.id,that.model.global_partial_input_mode="Pts",1==that.user.userid)that.showCOSDetails=!0,that.model.global_partial_input_mode="Oz";else{that.showCOSDetails=!1;for(var i=0;emps.length>i;i++)if(emps[i].id==that.user.userid){that.user.user_type_id=emps[i].type_ids,1==emps[i].type_ids||2==emps[i].type_ids||4==emps[i].type_ids?that.showCOSDetails=!0:9!=emps[i].type_ids&&10!=emps[i].type_ids||(that.showCOSDetails=!0,that.model.global_partial_input_mode="Oz");break}}},that.showInfo=function(){$uibModal.open({animation:!0,templateUrl:"quick_tutorial.html",controller:qt,controllerAs:"qt",windowClass:"animated fadeIn modal-lgg",size:"lg"})},that.getLocations=function(){var headers={restaurant_id:that.restaurant_id.restaurant_id,inventory_type_id:2,active_only:1};that.api.get_restaurant_audit_locations(headers).then(function(res){that.locations=res.data.data.Report,that.locations.push({sr_no:-1,location_name:"-- Add/Edit Locations --"}),that.selected_location=that.locations[0].sr_no})},that.changeAuditDate=function(){if(void 0===that.res_data_audit_start||null==that.res_data_audit_start[0].audit_start)return SweetAlert.swal({title:"Alert!",text:"You need to count at least one item before changing the Audit date!",type:"error",confirmButtonColor:"#ed5565",confirmButtonText:"OK"},function(res){}),void(that.pickers.beginDate.date=new Date(that.pickers.beginDateBackup.date));var valid_date=!0;if(that.pickers.beginDate.date>new Date)SweetAlert.swal({title:"Error!",text:"Audit date cannot be greater than now!",type:"error",confirmButtonColor:"#ed5565",confirmButtonText:"OK"},function(res){}),that.pickers.beginDate.date=new Date(that.pickers.beginDateBackup.date),valid_date=!1;else if(that.audit_dates.length>1){var prev_aud=null;prev_aud="history"==that.audit_dates[0].src?that.audit_dates[0].audit_dates:that.audit_dates[1].audit_dates,that.pickers.beginDate.date<=new Date(prev_aud)&&(SweetAlert.swal({title:"Error!",text:"Audit date cannot be less than or equal to the previous audit!",type:"error",confirmButtonColor:"#ed5565",confirmButtonText:"OK"},function(res){}),that.pickers.beginDate.date=new Date(that.pickers.beginDateBackup.date),valid_date=!1)}valid_date&&SweetAlert.swal({title:"Are you sure?",text:"Are you sure you want to change the audit date? This change could affect multiple reports.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){res&&that.api.set_audit_date({inventory_type_id:2,audit_date:new Date(that.pickers.beginDate.date).getTime()}).then(function(res1){SweetAlert.swal("Audit Date Updated!","","success"),that.handleCategoryClick(that.selected_category)})})},that.openCalendar=function(e,picker){that.pickers[picker].open=!0},that.init_tasks=function(response){that.refbooks=response[0],that.hide_subs=!0,that.model.categories=response[1].data.data.categories,that.model.categories.unshift({id:-1,category:"Shelf to Sheet",inventory_type_id:2}),that.handleCategoryClick(that.model.categories[0])},Promise.all([core.getRefbooks(),api.get_vendors_categories({is_restaurant_used_only:1,inventory_type_id:2}),that.checkEmpType(),that.getLocations()]).then(function(response){"false"==that.is_sug_aud?SweetAlert.swal({title:"Note",text:"Here you may do a full audit or mini-audit (adjustment). A full audit saves everything, including items you do not count, while a mini-audit or adjustment will only affect the items you count. Once your count is complete, select 'View Report'. From the reports page, you may choose your audit type (full audit or mini-audit) after you select 'Final Save'.",type:"info",showCancelButton:!1,confirmButtonColor:"#ed5565",confirmButtonText:"OK"},function(res){that.init_tasks(response)}):that.init_tasks(response)})}var qt=function($uibModalInstance){var that=this;that.q_title="Inventory Audit Help",that.q_texts='<article style="display: block;"><p><b>Inventory Audit</b>  Please check out our instruction video <a href="https://youtu.be/3M5KkduTc94" target="_blank">here</a>.</li></ul></p></article>',that.skip=function(){$uibModalInstance.dismiss("cancel")}}
;tabletEntryController.$inject=["api","$state","auth","localStorageService","restaurant","core","alertService","SweetAlert","$uibModal"],angular.module("inspinia").component("tabletEntryComponent",{templateUrl:"js/components/alcoholSetup/tabletEntry/tabletEntry.html",controller:tabletEntryController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("alcoholSetup.tabletEntry",{url:"/tablet-entry/:is_sug_aud",template:"<tablet-entry-component></tablet-entry-component>"})})}(),function(){"use strict";function modalController($uibModalInstance,vendor,global_Vendors,showPrimaryVendor,localStorageService,get_refbooks,api){var that=this;that.form={},that.api=api,that.get_refbooks=get_refbooks,that.restaurant_id=localStorageService.get("restaurant_id"),that.vendor=vendor,that.global_Vendors=global_Vendors,that.showPrimaryVendor=showPrimaryVendor,that.model={},that.is_add=!that.vendor,function(){that.model={restaurant_id:that.vendor?that.vendor.restaurant_id:null,vendor_name:that.vendor?that.vendor.vendor_name:null,primary_vendor:that.vendor?that.vendor.primary_vendor:null,vendor_type_id:(that.vendor,2),address:that.vendor?that.vendor.address:null,city:that.vendor?that.vendor.city:null,state:that.vendor?that.vendor.state:null,zip:that.vendor?that.vendor.zip_code:null,sales_rep:that.vendor?that.vendor.sales_rep:null,phone_number:that.vendor?that.vendor.phone_number:null,primary_email:that.vendor?that.vendor.primary_email:null,secondary_email_1:that.vendor?that.vendor.secondary_email_1:null,secondary_email_2:that.vendor?that.vendor.secondary_email_2:null,account_no:that.vendor?that.vendor.account_no:null}}(),that.onZipChanged=function(z){that.api.locations_lookup({search_for:z.toString()}).then(function(response){if(response.data.data.locations.length){that.model.city=response.data.data.locations[0].clear_name;for(var i=0;that.get_refbooks.country_states.length>i;i++)if(response.data.data.locations[0].state_geoname_id===that.get_refbooks.country_states[i].geoname_id){that.model.state=that.get_refbooks.country_states[i].state;break}}},function(error){console.log("error")})},that.submit=function(form){if(form.$valid){var m={restaurant_id:that.restaurant_id.restaurant_id,vendor_details:[]};m.vendor_details.push({vendor_name:that.model.vendor_name,primary_vendor:that.model.primary_vendor,vendor_type_id:that.model.vendor_type_id,address:that.model.address,city:that.model.city,state:that.model.state,zip_code:that.model.zip,sales_rep:that.model.sales_rep,phone_number:that.model.phone_number,primary_email:that.model.primary_email,secondary_email_1:that.model.secondary_email_1,secondary_email_2:that.model.secondary_email_2,account_no:that.model.account_no}),that.vendor?that.api.update_vendor_details(that.vendor.id,m).then(function(res){try{1e3===res.data.data.code&&(swal({title:"Vendor updated successfully!",timer:1500,showConfirmButton:!1,type:"success"}),$uibModalInstance.close())}catch(e){console.log(e)}}):that.api.add_new_vendor(that.restaurant_id.restaurant_id,m).then(function(res){try{1e3===res.data.data.code&&(swal({title:"New Vendor added successfully!",timer:1500,showConfirmButton:!1,type:"success"}),$uibModalInstance.close())}catch(e){console.log(e)}})}},that.cancel=function(){$uibModalInstance.dismiss("cancel")}}function vendorSetupController(api,$state,auth,core,localStorageService,$uibModal,SweetAlert,$rootScope,restaurant,$window,$scope){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.form={},that.api=api,that.auth=auth,that.core=core,that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),$scope.SetUpStatus=0,restaurant.data.info&&($scope.SetUpStatus=restaurant.data.info.is_setup_completed),$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),that.vendorList=[],that.vendorsSelected=[],that.searchModel={order_by:null,order_way:"DESC",paginationOffset:0,paginationCount:25,inRequest:!1,search_by:null,paginationTotal:0,city:null,vendor_name:null,zip_code:null},that.checkEmpType=function(){that.user={userid:null,user_type_id:null},that.user.userid=that.auth.authentication.user.id,that.showPrimaryVendor=!1,1==that.user.userid&&(that.showPrimaryVendor=!0)},that.showInfo=function(){$uibModal.open({animation:!0,templateUrl:"quick_tutorial.html",controller:qt,controllerAs:"qt",windowClass:"animated fadeIn modal-lgg",size:"lg"})},that.addNewVendor=function(vendor){$uibModal.open({templateUrl:"add_new_vendor.html",controller:modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",resolve:{vendor:function(){return vendor},global_Vendors:function(){return that.global_Vendors},get_refbooks:function(){return that.get_refbooks?that.get_refbooks:that.core.getRefbooks().then(function(res){return that.get_refbooks=res})},showPrimaryVendor:function(){return that.showPrimaryVendor}}}).result.then(function(){getChosenVendors(),that.search()},function(){getChosenVendors()})},that.editVendor=function(vendor){that.api.get_vendor_by_id(vendor.id).then(function(res){var vd=res.data.data.vendordetails[0];vd.id=vendor.id,vd.restaurant_id=vendor.restaurant_id,that.addNewVendor(vd)})},that.search=function(keyword){that.searchModel.inRequest=!0;var m={vendor_type_id:2,order_by:that.searchModel.order_by,order_way:that.searchModel.order_way,paginationOffset:that.searchModel.paginationOffset,paginationCount:that.searchModel.paginationCount,search_by:that.searchModel.search_by,city:that.searchModel.city,vendor_name:that.searchModel.vendor_name,zip_code:that.searchModel.zip_code};for(var i in m)m[i]||delete m[i];keyword&&(m.paginationOffset=0,that.searchModel.order_by==keyword?(that.searchModel.order_way="ASC"==m.order_way?"DESC":"ASC",m.order_way="ASC"==m.order_way?"DESC":"ASC"):(that.searchModel.order_by=keyword,m.order_by=keyword)),m.paginationOffset>0&&!keyword&&(m.paginationOffset=(m.paginationOffset-1)*m.paginationCount),api.get_vendors(m).then(function(res){try{that.vendorList=res.data.data.vendors,that.searchModel.paginationTotal=res.data.data.total}catch(e){console.log(e)}that.searchModel.inRequest=!1},function(){that.searchModel.inRequest=!1})},that.search();var getChosenVendors=function(){api.get_chosen_vendors(that.restaurant_id.restaurant_id,{vendor_type_id:2}).then(function(res){try{that.vendorsSelected=res.data.data.vendors}catch(e){console.log(e)}})},getGlobalVendors=function(){api.get_global_vendors({vendor_type_id:2}).then(function(res){try{that.global_Vendors=res.data.data.vendors}catch(e){console.log(e)}})};that.addVendor=function(vendor){var id=that.restaurant_id.restaurant_id,m={vendor_id:vendor.id,is_active:vendor.is_used,inventory_type_id:2};that.api.add_vendor(id,m).then(getChosenVendors)},that.deleteVendor=function(vendor){if(1==vendor.is_has_active_sku_uses)return void SweetAlert.swal({title:"",text:"You can not delete the vendor, if he has any elements with historical data, or if elements are used in any menu. Instead, you can disable the provider, but first remove all the items belonging to the supplier, which are associated with the menu.",type:"warning",confirmButtonColor:"#DD6B55"});var id=that.restaurant_id.restaurant_id,m={vendor_id:vendor.id,is_active:0,inventory_type_id:2};that.api.add_vendor(id,m).then(function(){getChosenVendors(),that.search()})},that.next=function(){if(that.vendorsSelected.length)return void $state.go("alcoholSetup.inventory");SweetAlert.swal({title:"At first select vendors",showConfirmButton:!1,type:"error",timer:2e3})},that.$onInit=function(){Promise.all([that.checkEmpType()]).then(function(response){getChosenVendors(),getGlobalVendors()})}}var qt=function($uibModalInstance){var that=this;that.q_title="Vendor Setup Instructions",that.q_texts='<article style="display: block;"><p><b>Add a New Vendor</b>  to add a new vendor you should first start a search for vendors by Name, City or Zip Code. If your search return a result you should first select the Edit button to view the vendor details to assure that you have an exact match. If youre vendor matches, while in the edit section, be sure to add your sale rep name and account number.<br/><br/><b>Cant locate your vendor?</b> Simply select the Add a New Vendor button on the right.<br/>From there you can manually enter all of your vendor details which includes name, address, phone number, account number and sale rep name.<br/><br/><b>Email Inventory Orders</b>  to email an inventory order you will need to include your sales rep email address. To add your sales rep email address simply locate your vendor and select Edit. Once inside the edit module you will see three email addresses. These email addresses are who your online orders will be delivered to. You may enter up to three email addresses.</p></article>',that.skip=function(){$uibModalInstance.dismiss("cancel")}};vendorSetupController.$inject=["api","$state","auth","core","localStorageService","$uibModal","SweetAlert","$rootScope","restaurant","$window","$scope"],angular.module("inspinia").component("alcoholVendorSetupComponent",{templateUrl:"js/components/alcoholSetup/vendorSetup/vendorSetup.html",controller:vendorSetupController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("alcoholSetup.vendor",{url:"/vendor-setup",template:"<alcohol-vendor-setup-component></alcohol-vendor-setup-component>",data:{pageTitle:"Vendor Setup"}})})}(),function(){"use strict";function controller(api,$state,auth,localStorageService,$rootScope,SweetAlert,restaurant,core){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.form={},that.state=$state,that.core=core,that.api=api,that.auth=auth,that.subscription_type_id=restaurant.data.info.subscription_type_id,that.setupStatus=restaurant.data.info.is_setup_completed,that.pg1_exists=!1,that.analytics_questionare=[],that.all_restaurant_categories=[{name:"Bakery",sub:["Cakes","Pies","Cookies","Donuts","All","Other"]},{name:"Bar",sub:["Basic Bar","Brewpub","Biker Bar","Cigar Bar","Cocktail Bar","College Bar","Country Bar","Craft","Dive Bar","Gay Bar","High End Bar","Hotel Bar","Irish Pub","Juke Joint","Karaoke Bar","Lounge","Members Only","Pop Bar","Pub","R&B-Hip Hop","Sports Bar","Tavern","Topless Bar","Underground Bar","Wine Bar","Other"]},{name:"Bistro",sub:null},{name:"Buffet",sub:null},{name:"Deli",sub:["Cold Sandwiches","Other"]},{name:"Diner",sub:null},{name:"Dinner Train",sub:null},{name:"Drive In",sub:null},{name:"Cafeteria",sub:null},{name:"Casual",sub:null},{name:"Fast Food/QSR",sub:null},{name:"Family Style (Food/No Alcohol)",sub:null},{name:"Food Truck",sub:null},{name:"Full Service (Food/Alcohol)",sub:null},{name:"Full Service Bar",sub:null},{name:"Fine Dining",sub:null},{name:"Gentleman's Club",sub:["Full Nudity Female","Full Nudity Female","Male"]},{name:"Hotel Restaurant",sub:null},{name:"Live Music Venue",sub:null},{name:"Lunch Counter",sub:null},{name:"Night Club",sub:["Alternative Rock","Country","Dance","House","Jazz","Pop","R&B-Hip Hop","Techno","Trance","World Music","Other"]},{name:"Theatre",sub:null}],that.all_restaurant_types=[{name:"American Comfort"},{name:"Africa Eastern"},{name:"Africa Northern"},{name:"Africa Southern"},{name:"Africa Western"},{name:"Arabic"},{name:"Asian Latin Fusion"},{name:"Australian"},{name:"Barbecue"},{name:"Belgium"},{name:"Burgers"},{name:"Canadian"},{name:"Caribbean"},{name:"Chicken"},{name:"Chinese Restaurant"},{name:"Coffee House"},{name:"Country"},{name:"Craft"},{name:"Cuban"},{name:"Dinner Theatre"},{name:"Donut Shop"},{name:"Dutch"},{name:"Ethopian"},{name:"European Eastern"},{name:"European Northern"},{name:"European Southern"},{name:"European Western"},{name:"Fish & Chips"},{name:"French"},{name:"Gastropub"},{name:"Greek"},{name:"Health Food"},{name:"Ice Cream Shop"},{name:"Indian Cuisine"},{name:"Irish"},{name:"Italian Restaurant"},{name:"Japanese"},{name:"Juke Joint"},{name:"Korean"},{name:"Lebanese"},{name:"Mediterranean"},{name:"Members Only"},{name:"Mexican Restaurant"},{name:"Middle Eastern"},{name:"Mongolian"},{name:"Pancake Restaurant"},{name:"Pizza"},{name:"Puerto Rican"},{name:"Polish"},{name:"Revolving Restaurant"},{name:"Russian"},{name:"Sandwich Bar"},{name:"Seafood Restaurant"},{name:"Serbian"},{name:"Spanish"},{name:"Soul Food"},{name:"South American"},{name:"Steak House"},{name:"Sushi"},{name:"Swiss"},{name:"Thai"},{name:"Vegetarian"},{name:"Vietnamese"},{name:"Other"}],that.rest_locn=[{name:"Inside of a hotel lobby"},{name:"Inside of a office building lobby"},{name:"Inside of a airport lobby"},{name:"Inside of a shopping mall"},{name:"In a shopping mall parking lot"},{name:"Within 1 mile of a college or university"},{name:"Multi-Restaurants/Entertainment Complex"},{name:"Multi-Restaurants/Shopping Complex (NOT a strip mall)"},{name:"Strip Mall Restaurant"},{name:"Area with high tourist traffic in or within 1/2 mile of major metro downtown"},{name:"Area with high tourist traffic NOT near major metro downtown"},{name:"Major Metropolitan Downtown"},{name:"Non Major Metropolitan Downtown"},{name:"Within 1/2 mile of Airport"},{name:"Outside edge of Downtown"},{name:"Business district"},{name:"Restaurant Row or local hotspot"},{name:"Within 1 mile of a shopping mall"},{name:"Near Major Intersection"},{name:"Neighborhood"},{name:"Adjacent to Highway or Freeway"}],that.days_of_the_week=[{name:"Sunday"},{name:"Monday"},{name:"Tuesday"},{name:"Wednesday"},{name:"Thrusday"},{name:"Friday"},{name:"Saturday"}],that.hours_of_the_day=[{name:"12:00 AM"},{name:"01:00 AM"},{name:"02:00 AM"},{name:"03:00 AM"},{name:"04:00 AM"},{name:"05:00 AM"},{name:"06:00 AM"},{name:"07:00 AM"},{name:"08:00 AM"},{name:"09:00 AM"},{name:"10:00 AM"},{name:"11:00 AM"},{name:"12:00 PM"},{name:"01:00 PM"},{name:"02:00 PM"},{name:"03:00 PM"},{name:"04:00 PM"},{name:"05:00 PM"},{name:"06:00 PM"},{name:"07:00 PM"},{name:"08:00 PM"},{name:"09:00 PM"},{name:"10:00 PM"},{name:"11:00 PM"},{name:"N/A"}],that.close_hours_of_the_day=[{name:"12:00 PM"},{name:"01:00 PM"},{name:"02:00 PM"},{name:"03:00 PM"},{name:"04:00 PM"},{name:"05:00 PM"},{name:"06:00 PM"},{name:"07:00 PM"},{name:"08:00 PM"},{name:"09:00 PM"},{name:"10:00 PM"},{name:"11:00 PM"},{name:"Next Day"},{name:"12:00 AM"},{name:"01:00 AM"},{name:"02:00 AM"},{name:"03:00 AM"},{name:"04:00 AM"},{name:"05:00 AM"},{name:"06:00 AM"},{name:"07:00 AM"},{name:"08:00 AM"},{name:"09:00 AM"},{name:"10:00 AM"},{name:"11:00 AM"},{name:"N/A"}],that.yes_no=[{name:"Yes"},{name:"No"}],that.phy_attr_emp_desc_list=[{name:"All Nude"},{name:"Topless"},{name:"Shorts / Small top"},{name:"Other"}],that.play_lic_music_freq_list=[{name:"During all open hours"},{name:"Evenings Only"},{name:"Weekend Only"},{name:"Evenings and Weekend Only"},{name:"Other"}],that.play_lic_music_type_list=[{name:"Alternative"},{name:"Asian Pop (k-pop/j-pop)"},{name:"Blues"},{name:"Classical"},{name:"Country"},{name:"Dance"},{name:"Easy Listening"},{name:"Electronic"},{name:"European (folk/pop)"},{name:"Folk"},{name:"Hip Hop/Rap"},{name:"Indie Pop"},{name:"Inspirational Gospel"},{name:"Jazz"},{name:"Latin"},{name:"New Age"},{name:"Opera"},{name:"Other"},{name:"Pop"},{name:"R&B/Soul"},{name:"Reggae"},{name:"Rock"},{name:"World/Music"}],that.live_band_freq_list=[{name:"Daily"},{name:"Almost daily"},{name:"Weekend Only"},{name:"At least once per month"},{name:"Multiple times per month"}],that.male_female=[{name:"Male"},{name:"Female"}],that.inventory_count_frequency=[{name:"Daily"},{name:"Weekly"},{name:"Bi-Weekly"},{name:"Monthly"},{name:"Annually"},{name:"No Schedule"},{name:"Never"}],that.model={},that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),that.next=function(form){if(form.$valid){var m={restaurant_id:that.restaurant_id.restaurant_id,serving_details:[],pg_no:that.page};if(1==that.page){if(that.pg1_exists)return that.page=that.page?that.page+1:1,void that.change_qns(!0);SweetAlert.swal({title:"Save response?",text:"This data cannot be changed once saved!",type:"warning",showCancelButton:!0,confirmButtonColor:"#337ab7",confirmButtonText:"Save"},function(res){res&&(m.serving_details.push({restaurant_category:that.model.restaurant_category,restaurant_subcategory:"Other"==that.model.restaurant_subcategory?"Other:"+that.model.restaurant_subcategory_other:that.model.restaurant_subcategory,total_area_sqft:that.model.total_area_sqft,kitchen_area_sqft:that.model.kitchen_area_sqft,dining_area_sqft:that.model.dining_area_sqft,patio_area_sqft:that.model.patio_area_sqft,other_area_sqft:that.model.other_area_sqft,rest_locality:that.model.rest_locality}),that.api.set_analytics_answers(m).then(function(res){try{if(1e3===res.data.data.code)return void(that.pg1_exists=!0)}catch(e){console.log(e)}}))})}else 2==that.page?m.serving_details.push({food_cost_budget:that.model.food_cost_budget,liq_cost_budget:that.model.liq_cost_budget,beer_cost_budget:that.model.beer_cost_budget,wine_cost_budget:that.model.wine_cost_budget,base_rent:that.model.base_rent,percent_rent:that.model.percent_rent,percent_rent_value:that.model.percent_rent_value,labor_budget:that.model.labor_budget}):3==that.page?m.serving_details.push({sunday_open:that.model.open_times[0],monday_open:that.model.open_times[1],tuesday_open:that.model.open_times[2],wednesday_open:that.model.open_times[3],thursday_open:that.model.open_times[4],friday_open:that.model.open_times[5],saturday_open:that.model.open_times[6],sunday_close:that.model.close_times[0],monday_close:that.model.close_times[1],tuesday_close:that.model.close_times[2],wednesday_close:that.model.close_times[3],thursday_close:that.model.close_times[4],friday_close:that.model.close_times[5],saturday_close:that.model.close_times[6],part_of_grp:that.model.part_of_grp,inventory_food_count:that.model.inventory_food_count,inventory_alcohol_count:that.model.inventory_alcohol_count,managed_by_primary_rest_owner:that.model.managed_by_primary_rest_owner,partially_owned_by_chef:that.model.partially_owned_by_chef,years_in_business:that.model.years_in_business,emp_full_time:that.model.emp_full_time,emp_part_time:that.model.emp_part_time,servers_full_time:that.model.servers_full_time,servers_part_time:that.model.servers_part_time,bartenders_full_time:that.model.bartenders_full_time,bartenders_part_time:that.model.bartenders_part_time,kitchen_emp_full_time:that.model.kitchen_emp_full_time,kitchen_emp_part_time:that.model.kitchen_emp_part_time,gm_exp:that.model.gm_exp,gm_gender:that.model.gm_gender,owner_gender:that.model.owner_gender}):4==that.page&&m.serving_details.push({serve_bkfst:that.model.serve_bkfst,serve_lunch:that.model.serve_lunch,serve_brunch:that.model.serve_brunch,serve_dinner:that.model.serve_dinner,is_rest_attached_to_mall:that.model.is_rest_attached_to_mall,is_rest_standalone_bldg:that.model.is_rest_standalone_bldg,attached_sign:that.model.attached_sign,near_freeway:that.model.near_freeway,phy_attr_emp:that.model.phy_attr_emp,phy_attr_emp_desc:that.model.phy_attr_emp_desc,play_lic_music:that.model.play_lic_music,play_lic_music_freq:that.model.play_lic_music_freq,play_lic_music_type:that.model.play_lic_music_type,live_band:that.model.live_band,live_band_freq:that.model.live_band_freq,party_n_group:that.model.party_n_group,occupancy_limit:that.model.occupancy_limit,built_in_stage:that.model.built_in_stage,dance_floor:that.model.dance_floor,valet_parking:that.model.valet_parking,total_seats:that.model.total_seats,total_tables:that.model.total_tables,cover_charge:that.model.cover_charge,multiple_locns:that.model.multiple_locns,multiple_locns_count:that.model.multiple_locns_count,cater:that.model.cater,food_truck:that.model.food_truck,delivery_staff:that.model.delivery_staff}),that.api.set_analytics_answers(m).then(function(res){try{if(1e3===res.data.data.code)return void(that.page>3?4==that.subscription_type_id?$state.go("reports.compgroupReport"):$state.go("admin.homeMenu"):(that.page=that.page?that.page+1:1,that.change_qns(!0)))}catch(e){console.log(e)}})}},that.go_back=function(){that.page=that.page?that.page-1:1,that.change_qns(!1)},that.change_qns=function(show_popup){var resId=that.restaurant_id.restaurant_id;that.api.get_analytics_answers({rest_id:resId,pg_no:that.page}).then(function(res){if(res.data.data.analytics_answers.analytics_answers&&Array.isArray(res.data.data.analytics_answers.analytics_answers))switch(that.page){case 1:if(0!=res.data.data.analytics_answers.analytics_answers.length){that.pg1_exists=!0;var aa=res.data.data.analytics_answers.analytics_answers[0];that.model.restaurant_category=aa.restaurant_category,that.model.restaurant_subcategory="Other"==aa.restaurant_subcategory.substring(0,5)?"Other":aa.restaurant_subcategory,that.model.restaurant_subcategory_other="Other"==aa.restaurant_subcategory.substring(0,5)?aa.restaurant_subcategory.substring(6,aa.restaurant_subcategory.length):null,that.model.total_area_sqft=aa.total_area_sqft,that.model.kitchen_area_sqft=aa.kitchen_area_sqft,that.model.dining_area_sqft=aa.dining_area_sqft,that.model.patio_area_sqft=aa.patio_area_sqft,that.model.other_area_sqft=aa.other_area_sqft,that.model.rest_locality=aa.rest_locality}else that.model={restaurant_category:null,restaurant_subcategory:null,restaurant_subcategory_other:null,total_area_sqft:null,kitchen_area_sqft:null,dining_area_sqft:null,patio_area_sqft:null,other_area_sqft:null,rest_locality:null};that.pg1_exists?that.analytics_questionare=that.all_analytics_questionare.slice(0,3):SweetAlert.swal({title:"",text:"The questions on page #1 will determine how we categorize your restaurant and therefore must be answered correctly. Please note that you cannot change the answers on Page #1 once you select save. If you have questions or need additional explanations please select the ? next to each answer box.",confirmButtonColor:"#337ab7",confirmButtonText:"OK"},function(res){that.analytics_questionare=that.all_analytics_questionare.slice(0,3)});break;case 2:if(0!=res.data.data.analytics_answers.analytics_answers.length){var aa=res.data.data.analytics_answers.analytics_answers[0];that.model.food_cost_budget=aa.food_cost_budget,that.model.liq_cost_budget=aa.liq_cost_budget,that.model.beer_cost_budget=aa.beer_cost_budget,that.model.wine_cost_budget=aa.wine_cost_budget,that.model.base_rent=aa.base_rent,that.model.percent_rent=aa.percent_rent,that.model.percent_rent_value=aa.percent_rent_value,that.model.labor_budget=aa.labor_budget}else that.model={food_cost_budget:null,liq_cost_budget:null,beer_cost_budget:null,wine_cost_budget:null,base_rent:null,percent_rent:null,percent_rent_value:null,labor_budget:null};show_popup?SweetAlert.swal({title:"",text:"Would you like to know if your budget is inline with your peers? The following questions are optional but sharing the data will provide greater insight into your expenses and budget. Remember that in order to get data, you must confidentially share data.",confirmButtonColor:"#337ab7",confirmButtonText:"OK"},function(res){that.analytics_questionare=that.all_analytics_questionare.slice(3,10)}):that.analytics_questionare=that.all_analytics_questionare.slice(3,10);break;case 3:if(0!=res.data.data.analytics_answers.analytics_answers.length){var aa=res.data.data.analytics_answers.analytics_answers[0];that.model.open_times=[aa.sunday_open,aa.monday_open,aa.tuesday_open,aa.wednesday_open,aa.thursday_open,aa.friday_open,aa.saturday_open],that.model.close_times=[aa.sunday_close,aa.monday_close,aa.tuesday_close,aa.wednesday_close,aa.thursday_close,aa.friday_close,aa.saturday_close],that.model.part_of_grp=aa.part_of_grp,that.model.inventory_food_count=aa.inventory_food_count,that.model.inventory_alcohol_count=aa.inventory_alcohol_count,that.model.managed_by_primary_rest_owner=aa.managed_by_primary_rest_owner,that.model.partially_owned_by_chef=aa.partially_owned_by_chef,that.model.years_in_business=aa.years_in_business,that.model.emp_full_time=aa.emp_full_time,that.model.emp_part_time=aa.emp_part_time,that.model.servers_full_time=aa.servers_full_time,that.model.servers_part_time=aa.servers_part_time,that.model.bartenders_full_time=aa.bartenders_full_time,that.model.bartenders_part_time=aa.bartenders_part_time,that.model.kitchen_emp_full_time=aa.kitchen_emp_full_time,that.model.kitchen_emp_part_time=aa.kitchen_emp_part_time,that.model.gm_exp=aa.gm_exp,that.model.gm_gender=aa.gm_gender,that.model.owner_gender=aa.owner_gender}else that.model={open_times:[null,null,null,null,null,null,null],close_times:[null,null,null,null,null,null,null],part_of_grp:null,inventory_food_count:null,inventory_alcohol_count:null,managed_by_primary_rest_owner:null,partially_owned_by_chef:null,years_in_business:null,emp_full_time:null,emp_part_time:null,servers_full_time:null,servers_part_time:null,bartenders_full_time:null,bartenders_part_time:null,kitchen_emp_full_time:null,kitchen_emp_part_time:null,gm_exp:null,gm_gender:null,owner_gender:null};show_popup?SweetAlert.swal({title:"",text:"An extremely important part of any restaurant comes from the top as owners and managers. Tell us about your executive team and structure.",confirmButtonColor:"#337ab7",confirmButtonText:"OK"},function(res){that.analytics_questionare=that.all_analytics_questionare.slice(10,24)}):that.analytics_questionare=that.all_analytics_questionare.slice(10,24);break;case 4:if(0!=res.data.data.analytics_answers.analytics_answers.length){var aa=res.data.data.analytics_answers.analytics_answers[0];that.model.serve_bkfst=aa.serve_bkfst,that.model.serve_lunch=aa.serve_lunch,that.model.serve_brunch=aa.serve_brunch,that.model.serve_dinner=aa.serve_dinner,that.model.is_rest_attached_to_mall=aa.is_rest_attached_to_mall,that.model.is_rest_standalone_bldg=aa.is_rest_standalone_bldg,that.model.attached_sign=aa.attached_sign,that.model.near_freeway=aa.near_freeway,that.model.phy_attr_emp=aa.phy_attr_emp,that.model.phy_attr_emp_desc=aa.phy_attr_emp_desc,that.model.play_lic_music=aa.play_lic_music,that.model.play_lic_music_freq=aa.play_lic_music_freq,that.model.play_lic_music_type=aa.play_lic_music_type,that.model.live_band=aa.live_band,that.model.live_band_freq=aa.live_band_freq,that.model.party_n_group=aa.party_n_group,that.model.occupancy_limit=aa.occupancy_limit,that.model.built_in_stage=aa.built_in_stage,that.model.dance_floor=aa.dance_floor,that.model.valet_parking=aa.valet_parking,that.model.total_seats=aa.total_seats,that.model.total_tables=aa.total_tables,that.model.cover_charge=aa.cover_charge,that.model.multiple_locns=aa.multiple_locns,that.model.multiple_locns_count=aa.multiple_locns_count,that.model.cater=aa.cater,that.model.food_truck=aa.food_truck,that.model.delivery_staff=aa.delivery_staff}else that.model={serve_bkfst:null,serve_lunch:null,serve_brunch:null,serve_dinner:null,is_rest_attached_to_mall:null,is_rest_standalone_bldg:null,attached_sign:null,near_freeway:null,phy_attr_emp:null,phy_attr_emp_desc:null,play_lic_music:null,play_lic_music_freq:null,play_lic_music_type:null,live_band:null,live_band_freq:null,party_n_group:null,occupancy_limit:null,built_in_stage:null,dance_floor:null,valet_parking:null,total_seats:null,total_tables:null,cover_charge:null,multiple_locns:null,multiple_locns_count:null,cater:null,food_truck:null,delivery_staff:null};show_popup?SweetAlert.swal({title:"",text:"In order to provide the most insight, lets dig a bit deeper into your restaurant. These questions are optional and you can return to them later however in order to get additional insight, you must confidentially share.",confirmButtonColor:"#337ab7",confirmButtonText:"OK"},function(res){that.analytics_questionare=that.all_analytics_questionare.slice(24,that.all_analytics_questionare.length)}):that.analytics_questionare=that.all_analytics_questionare.slice(24,that.all_analytics_questionare.length)}})},that.$onInit=function(){that.page=1,that.core.getRefbooks().then(function(res1){that.all_analytics_questionare=res1.analytics_questionare,that.change_qns(!0)})}}controller.$inject=["api","$state","auth","localStorageService","$rootScope","SweetAlert","restaurant","core"],angular.module("inspinia").component("analytics",{templateUrl:"js/components/analytics/analytics.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("admin.analytics",{url:"/analytics",template:"<analytics></analytics>",data:{pageTitle:"Analytics"}})})}(),function(){"use strict";function controller(api,$state,auth,localStorageService,$rootScope,SweetAlert,restaurant,core){var that=this;that.form={},that.state=$state,that.core=core,that.api=api,that.auth=auth,that.$onInit=function(){}}controller.$inject=["api","$state","auth","localStorageService","$rootScope","SweetAlert","restaurant","core"],angular.module("inspinia").component("balance",{templateUrl:"js/components/balance/balance.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("admin.balance",{url:"/balance",template:"<balance></balance>",data:{pageTitle:"Accounting"}})})}(),function(){"use strict";function compareRestaurantsController($state,auth,api,$q,$scope,$filter,$rootScope,alertService,SweetAlert){if(!auth.authentication.isLogged)return void $state.go("login");var that=this;that.api=api,that.r_list=[],that.m={order_by:"id",order_way:"DESC"},that.updmaploading=0,that.restaurantsList=[],that.selectedRestaurants=[],that.multiSelectSettings={selectionLimit:7,scrollableHeight:"200px",scrollable:!0},that.inventory_category="Total Sales",that.prev_cat=null,that.period="Daily";var from_date=new Date;from_date.setDate(from_date.getDate()-21),that.begin_date=from_date,that.end_date=new Date,that.is_total_sales=0,that.restaurantsList_b=[],that.selectedRestaurants_b=[],that.multiSelectSettings_b={selectionLimit:7,scrollableHeight:"200px",scrollable:!0},that.inventory_category_b=null,that.prev_cat_b=null;var from_date_b=new Date;from_date_b.setDate(from_date_b.getDate()-21),that.begin_date_b=from_date_b,that.end_date_b=new Date,that.select_report="Unit Cost",that.reset_table=function(){that.bottom_table_result=[]},that.loadDetailsTable=function(){that.detailsloading=0;var dayfd=that.begin_date_b.getDate(),monthfd=that.begin_date_b.getMonth()+1,fd=that.begin_date_b.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=that.end_date_b.getDate(),monthtd=that.end_date_b.getMonth()+1,td=that.end_date_b.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd;"Unit Cost"==that.select_report?api.compareRestaurants_unitCost({rest_list:that.selectedRestaurants_b.map(function(r){return r.id}),type:"Total Alcohol"==that.inventory_category_b?["Liquor","Bottle Beer","Draft Beer","Draft Wine","Wine"]:[that.inventory_category_b]}).then(function(res){that.detailsloading=1,that.columns=JSON.parse(JSON.stringify(that.selectedRestaurants_b)),that.bottom_table_result=res.data.data.result}):"Units Purchased"==that.select_report?api.compareRestaurants_unitPurchased({rest_list:that.selectedRestaurants_b.map(function(r){return r.id}),type:"Total Alcohol"==that.inventory_category_b?["Liquor","Bottle Beer","Draft Beer","Draft Wine","Wine"]:[that.inventory_category_b],begin_date:fd,end_date:td}).then(function(res){that.detailsloading=1,that.columns=JSON.parse(JSON.stringify(that.selectedRestaurants_b)),that.bottom_table_result=res.data.data.result}):"Total Purchases"==that.select_report?api.compareRestaurants_totalPurchase({
rest_list:that.selectedRestaurants_b.map(function(r){return r.id}),type:"Total Alcohol"==that.inventory_category_b?["Liquor","Bottle Beer","Draft Beer","Draft Wine","Wine"]:[that.inventory_category_b],begin_date:fd,end_date:td}).then(function(res){that.detailsloading=1,that.columns=JSON.parse(JSON.stringify(that.selectedRestaurants_b)),that.bottom_table_result=res.data.data.result}):"Unit Sales"==that.select_report&&api.compareRestaurants_unitSales({rest_list:that.selectedRestaurants_b.map(function(r){return r.id}),type:"Total Alcohol"==that.inventory_category_b?["Liquor","Bottle Beer","Draft Beer","Draft Wine","Wine"]:[that.inventory_category_b],begin_date:fd,end_date:td}).then(function(res){that.detailsloading=1,that.columns=JSON.parse(JSON.stringify(that.selectedRestaurants_b)),that.bottom_table_result=res.data.data.result})},that.loadTable=function(){"Total Sales"==that.inventory_category?that.is_total_sales=1:that.is_total_sales=0;var dayfd=that.begin_date.getDate(),monthfd=that.begin_date.getMonth()+1,fd=that.begin_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1,td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd;that.api.compareRestaurants_tableSnS({rest_list:that.selectedRestaurants.map(function(r){return r.id}),type:"Total Sales"==that.inventory_category?["Liquor","Bottle Beer","Draft Beer","Draft Wine","Wine","Food"]:"Total Alcohol"==that.inventory_category?["Liquor","Bottle Beer","Draft Beer","Draft Wine","Wine"]:[that.inventory_category],begin_date:fd,end_date:td}).then(function(res){that.loading++,that.sns_result_temp=res.data.data.result,that.sns_result=[];for(var i=0;i<that.selectedRestaurants.length;i++){for(var found=!1,j=0;j<that.sns_result_temp.length;j++)if(that.selectedRestaurants[i].label==that.sns_result_temp[j].restaurant_name){that.sns_result.push(that.sns_result_temp[j]),found=!0;break}found||that.sns_result.push({restaurant_name:that.selectedRestaurants[i].label})}that.salesAndPurchasesDonut(that.sns_result);for(var i=0;i<7-that.selectedRestaurants.length;i++)that.sns_result.push({restaurant_name:"N/A"})})},that.hideShowDonut=function(){that.food_exists=!1,that.alcohol_exists=!1;for(var i=0;i<that.r_list.length;i++)for(var j=0;j<that.selectedRestaurants.length;j++)if(that.selectedRestaurants[j].id==that.r_list[i].id){5==that.r_list[i].subscription_type_id?that.alcohol_exists=!0:6==that.r_list[i].subscription_type_id?that.food_exists=!0:7==that.r_list[i].subscription_type_id&&(that.food_exists=!0,that.alcohol_exists=!0);break}},that.loadDonut=function(type,d_data){for(var chart_id="sales"==type?"sales_donut":"purchases"==type?"purchases_donut":"",empty_data=!0,i=0;i<d_data.length;i++)if(!d_data[i].includes(0)){empty_data=!1;break}empty_data&&(d_data=[]),c3.generate({bindto:"#"+chart_id,data:{columns:d_data,type:"donut",empty:{label:{text:"No Data Available"}}},donut:{label:{format:function(value){return value}}},tooltip:{contents:function(data){return"<p style='border:1px groove; background-color: white; color: black;'>"+data[0].id+": "+data[0].value+"</p>"}}})},that.foodAndAlcoholDonut=function(type,f,a){function getMonday(d){d=new Date(d);var day=d.getDay(),diff=d.getDate()-day+(0==day?-6:1);return new Date(d.setDate(diff))}if(that.selectedRestaurants.length<1)return void(f&&a?that.loading++:that.loading=that.loading+2);var dayfd=that.begin_date.getDate(),monthfd=that.begin_date.getMonth()+1,fd=that.begin_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1,td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd,curr_monday=getMonday(new Date);curr_monday.setDate(curr_monday.getDate()-14),curr_monday.getDate(),curr_monday.getMonth(),curr_monday.getFullYear(),api.compareRestaurants_donutScores({rest_list:that.selectedRestaurants.map(function(r){return r.id}),type:1==type?"Food Cost":"Alcohol Cost",begin_date:fd,end_date:td}).then(function(res){function calc_total_score(r){var a=[];a.push(r.label);for(var found=!1,f_indx=0,f=0;f<res.data.data.result.length;f++)if(res.data.data.result[f].restaurant_id==r.id){f_indx=f,found=!0;break}var s_tot=0,s_count=1;return found?(s_tot=res.data.data.result[f_indx].score,s_count=0,s_count+=res.data.data.result[f_indx].s_count,a.push(Math.round(s_tot/s_count,2))):a.push(0),a}var promises=[];that.selectedRestaurants.forEach(function(r,index){var promise=calc_total_score(r);promises.push(promise)}),$q.all(promises).then(function(result){f&&a?that.loading++:that.loading=that.loading+2,that.loadDonut(type,result)},function(err){console.log("Failed: "+err)})})},that.salesAndPurchasesDonut=function(sp_data){if(that.selectedRestaurants.length<1)return void(that.loading=that.loading+2);var d_sales_data=[],d_purchases_data=[];for(var si in sp_data){var st=sp_data[si];d_sales_data.push([st.restaurant_name,void 0===st.total_sales?0:st.total_sales]),d_purchases_data.push([st.restaurant_name,void 0===st.total_purchase?0:st.total_purchase])}that.loadDonut("sales",d_sales_data),that.loadDonut("purchases",d_purchases_data),that.loading=that.loading+2},that.loadLineGraph=function(){var dayfd=that.begin_date.getDate(),monthfd=that.begin_date.getMonth()+1,fd=that.begin_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1,td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd;that.api.compareRestaurants_lineSales({type:"Total Sales"==that.inventory_category?["Liquor","Bottle Beer","Draft Beer","Draft Wine","Wine","Food"]:"Total Alcohol"==that.inventory_category?["Liquor","Bottle Beer","Draft Beer","Draft Wine","Wine"]:[that.inventory_category],rest_list:that.selectedRestaurants.map(function(r){return r.id}),period:that.period,begin_date:fd,end_date:td}).then(function(res){that.loading++;var chartData=[];if(void 0!==res.data.data.result&&0!=res.data.data.result.length){var total_sales=res.data.data.result,d=new Set;for(var i in total_sales)"Daily"==that.period?d.add(total_sales[i].act_date_l.substring(0,10)):"Monthly"==that.period?d.add(total_sales[i].act_date_l.substring(5,7)):"Yearly"==that.period&&d.add(total_sales[i].act_date_l.substring(0,4));"Monthly"!=that.period&&(d=Array.from(d),d.sort());var month_dict={"01":"January","02":"February","03":"March","04":"April","05":"May","06":"June","07":"July","08":"August","09":"September",10:"October",11:"November",12:"December"};"Monthly"==that.period&&(d.clear(),d.add("January").add("February").add("March").add("April").add("May").add("June").add("July").add("August").add("September").add("October").add("November").add("December")),d.forEach(function(value){for(var r={},i=0;i<that.selectedRestaurants.length;i++)r[that.selectedRestaurants[i].id]=0;for(var i in total_sales)"Daily"==that.period?total_sales[i].act_date_l.substring(0,10)==value&&(r[total_sales[i].restaurant_id]=total_sales[i].Actual_Total_Sales):"Monthly"==that.period?month_dict[total_sales[i].act_date_l.substring(5,7)]==value&&(r[total_sales[i].restaurant_id]=total_sales[i].Actual_Total_Sales):"Yearly"==that.period&&total_sales[i].act_date_l.substring(0,4)==value&&(r[total_sales[i].restaurant_id]=total_sales[i].Actual_Total_Sales);for(var c_obj={_id:value},i=0;i<that.selectedRestaurants.length;i++)c_obj[that.selectedRestaurants[i].label]=r[that.selectedRestaurants[i].id];chartData.push(c_obj)})}c3.generate({bindto:"#compare_chart",data:{json:chartData,keys:{x:"_id",value:that.selectedRestaurants.map(function(r){return r.label})},empty:{label:{text:"No data found"}},type:"spline"},axis:{x:{type:"category",tick:{rotate:75,multiline:!1},height:60},y:{tick:{format:d3.format("$,")}}},legend:{position:"inset"}})})},that.loadGraphAndTable=function(){that.loading=0,that.loadLineGraph(),that.loadTable()},that.getRestuarants=function(mode){if(-1==mode||0==mode){var ok_to_change=!1;if(null==that.prev_cat?ok_to_change=!0:"Total Sales"==that.prev_cat?ok_to_change=!0:"Food"==that.prev_cat?"Food"!=that.inventory_category&&(ok_to_change=!0):"Food"==that.inventory_category&&(ok_to_change=!0),ok_to_change){that.prev_cat=that.inventory_category,that.restaurantsList=[];for(var i=0;i<that.r_list.length;i++)"Total Sales"==that.inventory_category?that.restaurantsList.push({id:that.r_list[i].id,label:that.r_list[i].restaurant_name}):"Food"==that.inventory_category?6!=that.r_list[i].subscription_type_id&&7!=that.r_list[i].subscription_type_id||that.restaurantsList.push({id:that.r_list[i].id,label:that.r_list[i].restaurant_name}):"Total Sales"!=that.inventory_category&&"Food"!=that.inventory_category&&(5!=that.r_list[i].subscription_type_id&&7!=that.r_list[i].subscription_type_id||that.restaurantsList.push({id:that.r_list[i].id,label:that.r_list[i].restaurant_name}));that.selectedRestaurants=that.restaurantsList.length<=7?that.restaurantsList.length?that.restaurantsList.map(function(r){return r}):[]:[that.restaurantsList[0],that.restaurantsList[1],that.restaurantsList[2],that.restaurantsList[3],that.restaurantsList[4],that.restaurantsList[5],that.restaurantsList[6]],that.hideShowDonut()}}if(1==mode||0==mode){var ok_to_change=!1;if(null==that.prev_cat_b?ok_to_change=!0:"Food"==that.prev_cat_b?"Food"!=that.inventory_category_b&&(ok_to_change=!0):"Food"==that.inventory_category_b&&(ok_to_change=!0),ok_to_change){that.prev_cat_b=that.inventory_category_b,that.restaurantsList_b=[];for(var i=0;i<that.r_list.length;i++)"Food"==that.inventory_category_b?6!=that.r_list[i].subscription_type_id&&7!=that.r_list[i].subscription_type_id||that.restaurantsList_b.push({id:that.r_list[i].id,label:that.r_list[i].restaurant_name}):"Food"!=that.inventory_category_b&&null!=that.inventory_category_b&&(5!=that.r_list[i].subscription_type_id&&7!=that.r_list[i].subscription_type_id||that.restaurantsList_b.push({id:that.r_list[i].id,label:that.r_list[i].restaurant_name}));that.selectedRestaurants_b=that.restaurantsList_b.length<=7?that.restaurantsList_b.length?that.restaurantsList_b.map(function(r){return r}):[]:[that.restaurantsList_b[0],that.restaurantsList_b[1],that.restaurantsList_b[2],that.restaurantsList_b[3],that.restaurantsList_b[4],that.restaurantsList_b[5],that.restaurantsList_b[6]]}}},that.updateMapping=function(){that.updmaploading=1,that.api.compareRestaurants_getMapping({rest_list:that.r_list.map(function(r){return r.id}),type:that.inventory_category_b,search:!1}).then(function(res){that.updmaploading=0})},that.$onInit=function(){var m={caller:"Compare",order_by:that.m.order_by,order_way:that.m.order_way};api.get_restaurants(m).then(function(res){try{that.r_list=res.data.data.restaurants_list;for(var paid_rest=[],i=0;i<that.r_list.length;i++)(5==that.r_list[i].subscription_type_id||6==that.r_list[i].subscription_type_id||7==that.r_list[i].subscription_type_id)&&1==that.r_list[i].is_setup_completed&&that.r_list[i].grant_level<=3&&paid_rest.push(that.r_list[i]);that.r_list=[],that.r_list=paid_rest,that.r_list.length<2?SweetAlert.swal({title:"Access Denied!",text:"You need to be an Owner/Admin/Manager of at least 2 restaurants with paid subscription.",type:"warning",confirmButtonColor:"#337ab7",confirmButtonText:"OK"},function(res){$state.go("home")}):(that.r_list.sort(function(a,b){return a.restaurant_name.toLowerCase()>b.restaurant_name.toLowerCase()?1:a.restaurant_name.toLowerCase()<b.restaurant_name.toLowerCase()?-1:void 0}),that.getRestuarants(0),that.loadGraphAndTable(),that.loadDetailsTable())}catch(e){console.log(e)}})}}compareRestaurantsController.$inject=["$state","auth","api","$q","$scope","$filter","$rootScope","alertService","SweetAlert"],angular.module("inspinia").component("comprest",{templateUrl:"js/components/compareRestaurants/compareRestaurants.html",controller:compareRestaurantsController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("compareRestaurants",{url:"/compareRestaurants",template:"<comprest></comprest>",data:{pageTitle:"Compare Restaurants"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]},{serie:!0,files:["css/plugins/c3/c3.min.css","js/plugins/d3/d3.min.js","js/plugins/c3/c3.min.js"]},{serie:!0,name:"gridshore.c3js.chart",files:["js/plugins/c3/c3-angular.min.js"]}])}}})})}(),function(){"use strict";function compareRestaurantsMappingController($state,auth,api,$q,$scope,$filter,$rootScope,alertService,SweetAlert){if(!auth.authentication.isLogged)return void $state.go("login");var that=this;that.api=api,that.r_list=[],that.restaurantsList=[],that.selectedRestaurants=[],that.multiSelectSettings={selectionLimit:7,scrollableHeight:"200px",scrollable:!0},that.inventory_category=null,that.prev_cat=null,that.item_set=[],that.mapping_arr=[],that.sku_items={},that.finish_save=!1,that.m={order_by:"id",order_way:"DESC"},that.validate=function(r_id,item){if(that.finish_save)return item.grid[r_id]=JSON.parse(JSON.stringify(item.grid_copy[r_id])),void alertService.showError("Please save your previous changes!");that.finish_save=!0,item.need_save=!0;for(var count=0,m=0;m<that.mapping_arr.length;m++)null!=item.grid[r_id]&&that.mapping_arr[m].grid[r_id]==item.grid[r_id]&&count++;return count>1?(item.grid[r_id]=JSON.parse(JSON.stringify(item.grid_copy[r_id])),that.finish_save=!1,item.need_save=!1,void alertService.showError("This item is already mapped to a SKU!")):void 0},that.saveMapping=function(item){for(var k in item.grid)null==item.grid[k]&&(item.grid[k]=-1,item.grid_copy[k]=-1);api.compareRestaurants_saveMapping({item:{v_sku:item.v_sku,grid:item.grid}}).then(function(res){item.grid_copy=JSON.parse(JSON.stringify(item.grid)),that.finish_save=!1,item.need_save=!1,alertService.showAlertSave()})},that.getSkuItems=function(item,rest_id){return that.sku_items[rest_id]},that.getRestuarants=function(is_init){var ok_to_change=!1;if(null==that.prev_cat?ok_to_change=!0:"Food"==that.prev_cat?"Food"!=that.inventory_category&&(ok_to_change=!0):"Food"==that.inventory_category&&(ok_to_change=!0),ok_to_change){that.prev_cat=that.inventory_category;var m={caller:"Compare",order_by:that.m.order_by,order_way:that.m.order_way};api.get_restaurants(m).then(function(res){try{that.r_list=res.data.data.restaurants_list;for(var paid_rest=[],i=0;i<that.r_list.length;i++)5!=that.r_list[i].subscription_type_id&&6!=that.r_list[i].subscription_type_id&&7!=that.r_list[i].subscription_type_id||1!=that.r_list[i].is_setup_completed||1!=that.r_list[i].grant_level||paid_rest.push(that.r_list[i]);if(that.r_list=[],that.r_list=paid_rest,that.r_list.length<2)SweetAlert.swal({title:"Access Denied!",text:"You need to be an Owner/Admin of at least 2 restaurants with paid subscription.",type:"warning",confirmButtonColor:"#337ab7",confirmButtonText:"OK"},function(res){$state.go("home")});else{that.r_list.sort(function(a,b){return a.restaurant_name.toLowerCase()>b.restaurant_name.toLowerCase()?1:a.restaurant_name.toLowerCase()<b.restaurant_name.toLowerCase()?-1:void 0}),that.restaurantsList=[];for(var i=0;i<that.r_list.length;i++)"Food"==that.inventory_category?6!=that.r_list[i].subscription_type_id&&7!=that.r_list[i].subscription_type_id||that.restaurantsList.push({id:that.r_list[i].id,label:that.r_list[i].restaurant_name}):"Food"!=that.inventory_category&&(5!=that.r_list[i].subscription_type_id&&7!=that.r_list[i].subscription_type_id||that.restaurantsList.push({id:that.r_list[i].id,label:that.r_list[i].restaurant_name}));that.selectedRestaurants=that.restaurantsList.length<=7?that.restaurantsList.length?that.restaurantsList.map(function(r){return r}):[]:[that.restaurantsList[0],that.restaurantsList[1],that.restaurantsList[2],that.restaurantsList[3],that.restaurantsList[4],that.restaurantsList[5],that.restaurantsList[6]],is_init&&that.retriveMergedMapping(is_init)}}catch(e){console.log(e)}})}},that.retriveMergedMapping=function(is_init){is_init&&!that.r_list.length||!that.selectedRestaurants.length||(is_init||null!=that.inventory_category)&&(that.finish_save=!1,that.loading=1,that.columns=JSON.parse(JSON.stringify(that.selectedRestaurants)),that.item_set=[],that.sku_items={},that.mapping_arr=[],that.api.compareRestaurants_getMapping({rest_list:is_init?that.r_list.map(function(r){return r.id}):that.selectedRestaurants.map(function(r){return r.id}),type:that.inventory_category,search:!is_init||!is_init}).then(function(res){if(that.loading=0,!is_init){that.item_set=res.data.data.result.item_set,that.sku_items=res.data.data.result.sku_items;for(var mapping=res.data.data.result.mapping,i=0;i<that.item_set.length;i++){for(var g={},c=0;c<that.columns.length;c++){for(var found=!1,m=0;m<mapping.length;m++)if(mapping[m].restaurant_id==that.columns[c].id&&mapping[m].vendor_sku==that.item_set[i]){g[that.columns[c].id]=mapping[m].vendor_sku_id,found=!0;break}found||(g[that.columns[c].id]=null)}that.mapping_arr.push({v_sku:that.item_set[i],grid:g,grid_copy:JSON.parse(JSON.stringify(g)),need_save:!1})}}}))},that.$onInit=function(){that.getRestuarants(!0)}}compareRestaurantsMappingController.$inject=["$state","auth","api","$q","$scope","$filter","$rootScope","alertService","SweetAlert"],angular.module("inspinia").component("comprestmap",{templateUrl:"js/components/compareRestaurantsMapping/compareRestaurantsMapping.html",controller:compareRestaurantsMappingController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("compareRestaurantsMapping",{url:"/compareRestaurantsMapping",template:"<comprestmap></comprestmap>",data:{pageTitle:"Compare Restaurants - Mapping"}})})}(),function(){"use strict";function controller(api,$state,auth,localStorageService,$rootScope,$scope,SweetAlert,alertService,restaurant,core){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.form={},that.state=$state,that.core=core,that.api=api,that.auth=auth,that.instructions='<article style=\'display: block;\'><h1 id=\'Setup Assistance\'>Let us help you get setup!</h1><p class="font-16">We know you are busy running your restaurant but we also understand that you might be anxious to dive into your numbers and get more insight. Let us help! For a small ONE-TIME fee our team can have your account setup typically within 1-3 business days after receiving all the information that we need.</p><br/><h2>How it works?</h2><p class="font-16">The Skrible team will setup 80% of your recipes and match 80% of your recipes to their corresponding menu items. We do this intentionally because we like to give our users an opportunity to learn how the system functions without taking up too much of their time. In short, our setup process will leave you with four final tasks which include:</p><ol class="font-16"><li>Entering in the last 20% of your recipes (estimated time - 30 minutes)</li><li>Adding Skrible to your POS email distribution list (estimated time - 10 minutes)</li><li>completing the analytics form (estimated time - 30 minutes)</li><li>Doing a full inventory audit and entering the info into the system (estimated time 2-4 man-hours)</li></ol><br/><h2>What do we need to get started?</h2><ol class="font-16"><li><b><u>List of vendors</u></b> that you currently purchase from which should include their name, address, phone, sales rep name, sales rep email, your account number</li><li><b><u>List of inventory items</u></b> purchased from each vendor and currently on your shelf. You can usually get this info from your vendor pretty quickly then just forward it to us.</li><li><b><u>List of your recipes</u></b> which should include unit of measure and exact name as it appears above. This info must be very clear and specific. For example: if you purchase a red Fuji apple and a red Honeycrisp apple please do not list on your recipe \'red apple\'. In this situation you will have to be very specific and note the details such as \'red Fuji apple\'.</li><li><b><u>Menu items and modifiers</u></b> please provide a copy of your menu which should note the recipe items and menu item cost. For example: a hamburger meal might include a hamburger with optional fries or salad and a drink for $7.99.</li><li><b><u>POS printout with item sales price</u></b> please print your item sales from your POS covering the past 90 days and note any items which are inactive. We also need to see your retail prices and discount prices for each item, each menu item and each modifier.</li></ol><p class="font-16">Please forward all of the above data via email to <code>sales@getskrible.com</code> with your restaurant name and address in the email subject. After we\'ve received all of the above info, your setup will begin and you will be notified once your menu and recipe setup is complete.</p><p class="font-16">To proceed please select one of the below assistance type and you will be taken to the payment screen. Once your payment is processed you will receive a confirmation email and a follow up email with more setup details.</p></article>',that.subscription_type_id=restaurant.data.info.subscription_type_id,that.restaurant_id=localStorageService.get("restaurant_id"),that.currYear=(new Date).getFullYear().toString().slice(-2),$rootScope.card_number="",$rootScope.exp_month="",$rootScope.exp_year="",$rootScope.cvc="",$rootScope.first_name="",$rootScope.last_name="",$rootScope.billing_address="",$rootScope.StripePaymentId="",!that.restaurant_id)return void $state.go("home");restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),that.go_back=function(){that.page=1,that.s_type=null},that.chooseType=function(s_type){switch(that.page=2,that.s_type=s_type,that.s_type){case 1:that.s_amount="699.00";break;case 2:that.s_amount="899.00";break;case 3:that.s_amount="1499.00"}},that.submit=function(form){if(!form.$valid)return void alert("not valid");$scope.handleStripe=function(status,response){response.error?swal({title:"Invalid Card Details!",showConfirmButton:!0,type:"warning"}):that.api.payment_call({response:response,type:that.s_type,mode:"live",pay_for:"setup"}).then(function(res){"done"==res.data.data.payment?SweetAlert.swal({title:"Payment Successful!",type:"success",text:"Please check your email for receipt. You may now begin connecting your POS.",confirmButtonColor:"#337ab7",confirmButtonText:"OK"},function(res1){$state.go("administrator.posSync")}):"error"==res.data.data.payment?swal({title:"Check Card Details!",showConfirmButton:!0,type:"warning"}):swal({title:"Oops! Something went wrong, please try again.",showConfirmButton:!0,type:"warning"})})}},that.$onInit=function(){that.page=1,that.s_type=null}}controller.$inject=["api","$state","auth","localStorageService","$rootScope","$scope","SweetAlert","alertService","restaurant","core"],angular.module("inspinia").component("support",{templateUrl:"js/components/customerSupport/customerSupport.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("admin.support",{url:"/support",template:"<support></support>",data:{pageTitle:"Support"}})})}(),function(){"use strict";function modalController($uibModalInstance,subscription_type_id,localStorageService,get_refbooks,api){var that=this;that.form={},that.api=api,that.get_refbooks=get_refbooks,that.restaurant_id=localStorageService.get("restaurant_id"),that.model={},that.vendor_types=5==subscription_type_id?[{id:2,name:"Alcohol"}]:6==subscription_type_id?[{id:1,name:"Food"}]:[{id:1,name:"Food"},{id:2,name:"Alcohol"}],function(){that.model={restaurant_id:null,vendor_name:null,primary_vendor:null,vendor_type_id:null,address:null,city:null,state:null,zip:null,sales_rep:null,primary_email:null,secondary_email_1:null,secondary_email_2:null,account_no:null}}(),that.getGlobalVendors=function(){that.api.get_global_vendors({vendor_type_id:that.model.vendor_type_id}).then(function(res){try{that.global_Vendors=res.data.data.vendors}catch(e){console.log(e)}})},that.onZipChanged=function(z){that.api.locations_lookup({search_for:z.toString()}).then(function(response){if(response.data.data.locations.length){that.model.city=response.data.data.locations[0].clear_name;for(var i=0;that.get_refbooks.country_states.length>i;i++)if(response.data.data.locations[0].state_geoname_id===that.get_refbooks.country_states[i].geoname_id){that.model.state=that.get_refbooks.country_states[i].state;break}}},function(error){console.log("error")})},that.submit=function(form){if(form.$valid){var m={restaurant_id:that.restaurant_id.restaurant_id,vendor_details:[]};m.vendor_details.push({vendor_name:that.model.vendor_name,primary_vendor:that.model.primary_vendor,vendor_type_id:that.model.vendor_type_id,address:that.model.address,city:that.model.city,state:that.model.state,zip_code:that.model.zip,sales_rep:that.model.sales_rep,primary_email:that.model.primary_email,secondary_email_1:that.model.secondary_email_1,secondary_email_2:that.model.secondary_email_2,account_no:that.model.account_no}),that.api.add_new_vendor(that.restaurant_id.restaurant_id,m).then(function(res){try{1e3===res.data.data.code&&(swal({title:"New Vendor added successfully!",timer:1500,showConfirmButton:!1,type:"success"}),$uibModalInstance.close())}catch(e){console.log(e)}})}},that.cancel=function(){$uibModalInstance.dismiss("cancel")}}function newFoodItem_modalController($uibModalInstance,alertService,api,core,restaurant_id,vendor_id,SweetAlert,$q){var that=this;that.form={},that.uniqueItem=[],that.categories=[],that.sub_categories=[],core.getRefbooks().then(function(res){that.deliveryMeasure=res.measurement_units_of_delivery,that.categories=res.vendor_cat,that.sub_categories=res.vendor_sub_cat}),that.api=api,that.model={},that.sku_lookup=function(search_for){return that.api.sku_lookup({search_for:search_for,vendor_id:vendor_id}).then(function(res){return res.data.data.sku.slice(0,10)})},that.submit=function(form){var deferred=$q.defer();return form.$valid?that.uniqueItem.length?void(null!=that.uniqueItem[0].vendor_sku&&that.uniqueItem[0].vendor_sku.length&&that.api.validateSKU({sku:that.uniqueItem[0].vendor_sku,vendor_id:vendor_id}).then(function(res){if(res.data.data.sku_status.length&&"used"==res.data.data.sku_status[0].sku_status)return void alertService.showError("SKU already used!");for(var id=vendor_id,m={inventory_type_id:1,sku_items:[]},i=0;that.uniqueItem.length>i;i++)m.sku_items.push({substitute_for:that.uniqueItem[i].substitute_for?that.uniqueItem[i].substitute_for:null,vendor_sku:that.uniqueItem[i].vendor_sku,pack:that.uniqueItem[i].pack,size:that.uniqueItem[i].size,total_unit_size:that.uniqueItem[i].pack*that.uniqueItem[i].size,uom_id_of_delivery_unit:that.uniqueItem[i].uom_id_of_delivery_unit,brand:"No Brand",brand_id:1,item_name:that.uniqueItem[i].item_name,vendor_cat_id:that.uniqueItem[i].vendor_cat_id,vendor_sub_cat_id:that.uniqueItem[i].vendor_sub_cat_id,yield:1,price:that.uniqueItem[i].case_cost,minimum_order_type:that.uniqueItem[i].minimum_order_type,is_active:that.uniqueItem[i].is_active,id:that.uniqueItem[i].id});return that.api.add_update_own_inventory(id,m).then(function(res){1e3===res.data.data.code&&(alertService.showAlertSave(),deferred.resolve(),$uibModalInstance.dismiss("cancel"))}),deferred.promise})):(alertService.showError("Please, add at least one item"),deferred.reject(),deferred.promise):(alertService.showError("Please validate all inputs"),deferred.reject(),deferred.promise)},that.apply_values=function($item){that.src=$item.src,that.uniqueItem[0].vendor_sku=$item.vendor_sku,that.uniqueItem[0].item_name=$item.item_name,that.uniqueItem[0].vendor_cat_id=$item.vendor_cat_id,that.uniqueItem[0].vendor_sub_cat_id=$item.vendor_sub_cat_id,that.uniqueItem[0].uom_id_of_delivery_unit=$item.uom_id_of_delivery_unit,that.uniqueItem[0].pack=$item.pack,that.uniqueItem[0].size=$item.size,that.uniqueItem[0].case_cost=$item.case_cost,that.uniqueItem[0].minimum_order_type=$item.minimum_order_type,that.uniqueItem[0].substitute_for=$item.substitute_for,that.filterItems()},that.addUniqueItem=function(){that.uniqueItem.push({vendor_sku:null,pack:null,uom_id_of_delivery_unit:null,item_name:null,vendor_cat_id:that.categories.length?that.categories[0].id:null,vendor_sub_cat_id:that.sub_categories.length?that.sub_categories[0].id:null,is_active:1,size:null,case_cost:null,minimum_order_type:"Case",id:null,substitute_for:null})},that.filterItems=function(){that.inventoryListSelected=[];for(var i=0;i<that.inventoryItems.length;i++)null!=that.inventoryItems[i].substitute_for||that.inventoryItems[i].vendor_cat_id!=that.uniqueItem[0].vendor_cat_id||(10!=that.uniqueItem[0].uom_id_of_delivery_unit&&11!=that.uniqueItem[0].uom_id_of_delivery_unit&&12!=that.uniqueItem[0].uom_id_of_delivery_unit&&13!=that.uniqueItem[0].uom_id_of_delivery_unit&&16!=that.uniqueItem[0].uom_id_of_delivery_unit&&17!=that.uniqueItem[0].uom_id_of_delivery_unit&&18!=that.uniqueItem[0].uom_id_of_delivery_unit||10!=that.inventoryItems[i].uom_id_of_delivery_unit&&11!=that.inventoryItems[i].uom_id_of_delivery_unit&&12!=that.inventoryItems[i].uom_id_of_delivery_unit&&13!=that.inventoryItems[i].uom_id_of_delivery_unit&&16!=that.inventoryItems[i].uom_id_of_delivery_unit&&17!=that.inventoryItems[i].uom_id_of_delivery_unit&&18!=that.inventoryItems[i].uom_id_of_delivery_unit)&&(5!=that.uniqueItem[0].uom_id_of_delivery_unit&&14!=that.uniqueItem[0].uom_id_of_delivery_unit&&15!=that.uniqueItem[0].uom_id_of_delivery_unit&&19!=that.uniqueItem[0].uom_id_of_delivery_unit||5!=that.inventoryItems[i].uom_id_of_delivery_unit&&14!=that.inventoryItems[i].uom_id_of_delivery_unit&&15!=that.inventoryItems[i].uom_id_of_delivery_unit&&19!=that.inventoryItems[i].uom_id_of_delivery_unit)&&(1!=that.uniqueItem[0].uom_id_of_delivery_unit&&2!=that.uniqueItem[0].uom_id_of_delivery_unit&&3!=that.uniqueItem[0].uom_id_of_delivery_unit&&4!=that.uniqueItem[0].uom_id_of_delivery_unit&&5!=that.uniqueItem[0].uom_id_of_delivery_unit&&8!=that.uniqueItem[0].uom_id_of_delivery_unit||1!=that.inventoryItems[i].uom_id_of_delivery_unit&&2!=that.inventoryItems[i].uom_id_of_delivery_unit&&3!=that.inventoryItems[i].uom_id_of_delivery_unit&&4!=that.inventoryItems[i].uom_id_of_delivery_unit&&5!=that.inventoryItems[i].uom_id_of_delivery_unit&&8!=that.inventoryItems[i].uom_id_of_delivery_unit)||that.inventoryListSelected.push(that.inventoryItems[i]);if(that.inventoryListSelected.length){var first=JSON.stringify(that.inventoryListSelected[0]);that.inventoryListSelected.unshift(JSON.parse(first)),that.inventoryListSelected[0].id=null,that.inventoryListSelected[0].vendor_name="--No selection--",that.inventoryListSelected[0].item_name="--No selection--"}else that.inventoryListSelected.push({}),that.inventoryListSelected[0].id=null,that.inventoryListSelected[0].vendor_name="--No selection--",that.inventoryListSelected[0].item_name="--No selection--"},that.getInventoriesByVendor=function(){that.api.get_active_inventory_by_vendor({inventory_type_id:1,caller:"sub_list"},restaurant_id).then(function(res){that.inventoryItems=res.data.data.sku,that.filterItems()})},that.addUniqueItem(),that.getInventoriesByVendor(),that.clear=function(){that.src="",that.uniqueItem=[],that.uniqueItem.push({vendor_sku:null,pack:null,uom_id_of_delivery_unit:null,item_name:null,vendor_cat_id:null,vendor_sub_cat_id:null,is_active:1,size:null,case_cost:null,minimum_order_type:"Case",id:null,substitute_for:null})},that.cancel=function(){$uibModalInstance.dismiss("cancel")}}
function newAlcoholItem_modalController($uibModalInstance,alertService,api,core,restaurant_id,vendor_id,SweetAlert,$q){var that=this;that.form={},that.uniqueItem=[],that.categories=[],that.sub_categories=[],core.getRefbooks().then(function(res){that.refbooks=res,that.categories=res.vendor_cat,that.sub_categories=res.vendor_sub_cat}),that.api=api,that.model={},that.src="",that.sku_lookup=function(search_for){return that.api.sku_lookup({search_for:search_for,vendor_id:vendor_id}).then(function(res){return res.data.data.sku.slice(0,10)})},that.item_name_lookup=function(search_for){return that.api.item_name_lookup({search_for:search_for,vendor_id:vendor_id}).then(function(res){return res.data.data.name})},that.submit=function(form){var deferred=$q.defer();return form.$valid?that.uniqueItem.length?void(null!=that.uniqueItem[0].vendor_sku&&that.uniqueItem[0].vendor_sku.length&&that.api.validateSKU({sku:that.uniqueItem[0].vendor_sku,vendor_id:vendor_id}).then(function(res){if(res.data.data.sku_status.length&&"used"==res.data.data.sku_status[0].sku_status)return void alertService.showError("SKU already used!");for(var id=vendor_id,m={inventory_type_id:2,sku_items:[]},i=0;that.uniqueItem.length>i;i++)m.sku_items.push({substitute_for:that.uniqueItem[i].substitute_for?that.uniqueItem[i].substitute_for:null,item_name:that.uniqueItem[i].item_name,tare_type_id:that.uniqueItem[i].tare_type_id,size:that.uniqueItem[i].content_weight||that.uniqueItem[i].size||1,content_weight:that.uniqueItem[i].content_weight||that.uniqueItem[i].size||1,full_weight:that.uniqueItem[i].full_weight,tare_weight:that.uniqueItem[i].tare_weight,total_unit_size:that.uniqueItem[i].case_qty*that.uniqueItem[i].pack*(that.uniqueItem[i].content_weight||that.uniqueItem[i].size||1),manufacturer:that.uniqueItem[i].manufacturer,vendor_sku:that.uniqueItem[i].vendor_sku,case_qty:that.uniqueItem[i].case_qty,pack:that.uniqueItem[i].pack,price:"Case"==that.uniqueItem[i].minimum_order_type?that.uniqueItem[i].case_cost:that.uniqueItem[i].pack_cost,vendor_cat_id:that.uniqueItem[i].vendor_cat_id,uom_id_of_delivery_unit:5,vendor_sub_cat_id:that.uniqueItem[i].vendor_sub_cat_id,is_active:that.uniqueItem[i].is_active,minimum_order_type:that.uniqueItem[i].minimum_order_type,id:that.uniqueItem[i].id});return that.api.add_update_own_inventory(id,m).then(function(res){1e3===res.data.data.code&&(alertService.showAlertSave(),deferred.resolve(),$uibModalInstance.dismiss("cancel"))}),deferred.promise})):(alertService.showError("Please, add at least one item"),deferred.reject(),deferred.promise):(alertService.showError("Please validate all inputs"),deferred.reject(),deferred.promise)},that.apply_values=function($item){that.src=$item.src,that.uniqueItem[0].vendor_sku=$item.vendor_sku,that.uniqueItem[0].item_name=$item.item_name,that.uniqueItem[0].vendor_cat_id=$item.vendor_cat_id,that.changeMOT(0),that.uniqueItem[0].vendor_sub_cat_id=$item.vendor_sub_cat_id,that.uniqueItem[0].tare_type_id=$item.tare_type_id,that.uniqueItem[0].full_weight=$item.full_weight,that.uniqueItem[0].pack=$item.pack,that.uniqueItem[0].case_cost=$item.case_cost,that.uniqueItem[0].pack_cost=$item.pack_cost,that.setWeights(0,$item.vendor_cat_id,$item.vendor_sub_cat_id,$item.tare_type_id),that.calculate(0),that.uniqueItem[0].substitute_for=$item.substitute_for},that.getSizes=function(cat_id,sub_cat_id){if(!cat_id&&!sub_cat_id)return[];for(var _a=[],i=0;that.refbooks.default_weights.length>i;i++)if(that.refbooks.default_weights[i].vendor_cat_id===cat_id&&that.refbooks.default_weights[i].vendor_sub_cat_id===sub_cat_id)for(var j=0;that.refbooks.tare_types.length>j;j++)that.refbooks.tare_types[j].tare_type_id===that.refbooks.default_weights[i].tare_type_id&&-1===_a.indexOf(that.refbooks.tare_types[j])&&_a.push(that.refbooks.tare_types[j]);return _a},that.calculate=function($index){var t=that.uniqueItem[$index].pack||1,u=that.uniqueItem[$index].pack_cost||1,c=that.uniqueItem[$index].case_qty||1;that.uniqueItem[$index].case_cost=parseFloat((t*u*1*c).toFixed(2))},that.setWeights=function($index,cat_id,sub_cat_id,tare_type_id){for(var i=0;that.refbooks.default_weights.length>i;i++)if(that.refbooks.default_weights[i].vendor_sub_cat_id===sub_cat_id&&that.refbooks.default_weights[i].vendor_cat_id===cat_id&&that.refbooks.default_weights[i].tare_type_id===tare_type_id){var f=71===that.uniqueItem[$index].vendor_cat_id?that.refbooks.default_weights[i].full_weight:that.uniqueItem[$index].full_weight,c=that.refbooks.default_weights[i].content_weight;that.uniqueItem[$index].tare_weight=f-c||0,that.uniqueItem[$index].content_weight=c,76===that.uniqueItem[$index].vendor_cat_id&&(that.uniqueItem[$index].tare_weight=0,that.uniqueItem[$index].content_weight=f*c)}if(cat_id&&sub_cat_id&&(74==cat_id||75==cat_id||99==cat_id))for(var i=0;that.refbooks.default_weights.length>i;i++)if(that.refbooks.default_weights[i].vendor_cat_id===cat_id&&that.refbooks.default_weights[i].vendor_sub_cat_id===sub_cat_id&&that.refbooks.default_weights[i].tare_type_id===tare_type_id){that.uniqueItem[$index].full_weight=that.refbooks.default_weights[i].full_weight,that.uniqueItem[$index].tare_weight=that.refbooks.default_weights[i].tare_weight,that.uniqueItem[$index].content_weight=that.refbooks.default_weights[i].content_weight;break}},that.addUniqueItem=function(){that.uniqueItem.push({item_name:null,size:null,full_weight:null,content_weight:null,tare_weight:null,manufacturer:null,vendor_sku:null,case_qty:1,total_unit_size:null,price:null,pack_cost:null,vendor_cat_id:that.categories.length?that.categories[0].id:null,uom_id_of_delivery_unit:5,vendor_sub_cat_id:that.sub_categories.length?that.sub_categories[0].id:null,is_active:1,minimum_order_type:"Pack",id:null,substitute_for:null})},that.filterItems=function(){that.inventoryListSelected=[];for(var i=0;i<that.inventoryItems.length;i++)that.inventoryItems[i].vendor_cat_id==that.uniqueItem[0].vendor_cat_id&&that.inventoryListSelected.push(that.inventoryItems[i]);if(that.inventoryListSelected.length){var first=JSON.stringify(that.inventoryListSelected[0]);that.inventoryListSelected.unshift(JSON.parse(first)),that.inventoryListSelected[0].id=null,that.inventoryListSelected[0].vendor_name="--No selection--",that.inventoryListSelected[0].item_name="--No selection--"}else that.inventoryListSelected.push({}),that.inventoryListSelected[0].id=null,that.inventoryListSelected[0].vendor_name="--No selection--",that.inventoryListSelected[0].item_name="--No selection--"},that.getInventoriesByVendor=function(){that.api.get_active_inventory_by_vendor({inventory_type_id:2,caller:"sub_list"},restaurant_id).then(function(res){that.inventoryItems=res.data.data.sku,that.filterItems()})},that.changeMOT=function($index){that.uniqueItem[$index].full_weight=null,74==that.uniqueItem[$index].vendor_cat_id?that.uniqueItem[$index].minimum_order_type="Case":that.uniqueItem[$index].minimum_order_type="Pack",that.filterItems()},that.addUniqueItem(),that.getInventoriesByVendor(),that.clear=function(){that.uniqueItem=[],that.uniqueItem.push({vendor_sku:null,pack:null,uom_id_of_delivery_unit:null,item_name:null,vendor_cat_id:null,vendor_sub_cat_id:null,is_active:1,size:null,case_cost:null,minimum_order_type:"Case",id:null,substitute_for:null}),that.src=""},that.cancel=function(){$uibModalInstance.dismiss("cancel")}}function viewInvoices_modalController($uibModalInstance,api){var that=this;that.invoices=[],that.start_date=new Date,that.end_date=new Date,that.search=function(){api.get_added_invoices({start_date:that.start_date,end_date:that.end_date}).then(function(res){try{that.invoices=res.data.data.invoices}catch(e){console.log(e)}})},that.search(),that.cancel=function(){$uibModalInstance.dismiss("cancel")}}function controller($state,auth,api,core,restaurant,$uibModal,localStorageService,$rootScope,alertService,SweetAlert,$window){if(!auth.authentication.isLogged)return void $state.go("login");var that=this;if(that.api=api,that.$state=$state,that.core=core,that.inventories=[],that.refbooks={},that.form={},that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),that.subscription_type_id=restaurant.data.info.subscription_type_id,that.prev_selected_vendor=null,that.selected_vendor=null,that.invoice_number=null,that.invoice_total=null,that.resetOrderModel=function(){that.orderModel={totalItems:0,totalCost:0,inventory_type_id:null,items:[]}},that.resetOrderModel(),that.showInfo=function(){$uibModal.open({animation:!0,templateUrl:"quick_tutorial.html",controller:qt,controllerAs:"qt",windowClass:"animated fadeIn modal-lgg",size:"lg",resolve:{isFood:function(){return that.isFood},isEdit:function(){return that.isEdit}}})},that.addNewOrder=function(form){if(form.$valid){if(that.orderModel.items.length<1)return void alertService.showError("Invoice has no order items!");if(that.invoice_total!=that.orderModel.totalCost)return void alertService.showError("Invoice total doesnt match!");$uibModal.open({animation:!0,templateUrl:"save_invoice.html",controller:save_invoice,controllerAs:"save_invoice",windowClass:"animated fadeIn modal-lgg"}).result.then(function(choice){for(var dayfd=that.invoice_date.getDate(),monthfd=that.invoice_date.getMonth()+1,fd=that.invoice_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,m={inventory_type_id:parseInt(that.selected_vendor.vendor_type_id),items:[],data_entry:{data_entry:!0,is_final_invoice:choice,invoice_number:that.invoice_number,invoice_total:that.invoice_total,delivery_date:fd,delivery_time:"00:00:00"}},i=0;that.orderModel.items.length>i;i++)m.items.push({id:that.orderModel.items[i].id,vendor_id:that.selected_vendor.id,vendor_sku_id:that.orderModel.items[i].vendor_sku_id,suggested_amount:0,suggested_order_type:"Case",amount:that.orderModel.items[i].amount,order_type:that.isFood||"Each"!=that.orderModel.items[i].order_type?that.orderModel.items[i].order_type:"Pack",total_unit_size:that.orderModel.items[i].total_unit_size,item_cost:that.orderModel.items[i].item_cost,total_cost:that.orderModel.items[i].total_cost,is_approved:1});that.api.create_order(m).then(function(res){1e3===res.data.data.code&&(that.isFood,alertService.showAlertSave(),that.prev_selected_vendor=null,that.selected_vendor=null,that.invoice_number=null,that.invoice_total=null,that.resetOrderModel())})})}},that.pushNewItem=function(){that.orderModel.items.push({vendor_sku:null,item_name:null,amount:null,order_type:"Case",case_size:0,item_cost:0,discount:0,total_cost:0})},that.delete=function($index){that.orderModel.items.splice($index,1),angular.forEach(that.orderModel.items,function(v,k){that.calculate(k,v.vendor_sku_id)})},that.calculate=function($index,vendor_sku_id,is_cost_edit){if(!that.orderModel.items[$index].locked)return void alertService.showError("Please search the Item SKU again!");if(vendor_sku_id){that.isFood||(that.orderModel.items[$index].amount=Math.round(that.orderModel.items[$index].amount)),-1==is_cost_edit&&(that.orderModel.items[$index].update_sku=1);var totalItemsCost=0,totalDiscount=0,totalCost=0;angular.forEach(that.orderModel.items,function(v,k){var uod=v.uom_id_of_delivery_unit,mot=v.minimum_order_type;if(2==that.selected_vendor.vendor_type_id)that.orderModel.items[$index].otypes="Case"==mot?[{name:"Case",value:"Case"}]:[{name:"Case",value:"Case"},{name:"Each",value:"Pack"}];else if("Case"==mot)that.orderModel.items[$index].otypes=[{name:"Case",value:"Case"}];else if("Pack"==mot)that.orderModel.items[$index].otypes=[{name:"Case",value:"Case"},{name:"Pack",value:"Pack"}];else for(var j=0;j<that.refbooks.measurement_units_of_delivery.length;j++)if(uod===that.refbooks.measurement_units_of_delivery[j].id){var f_ordertype=that.refbooks.measurement_units_of_delivery[j].name;v.otypes=[{name:"Case",value:"Case"},{name:"Pack",value:"Pack"},{name:f_ordertype,value:"Each"}];break}var temp_cost=v.item_cost;0==is_cost_edit&&1!=v.update_sku&&(v.item_cost=v.amount?"Case"==v.order_type?v.case_cost||0:"Pack"==v.order_type?v.case_cost/v.pack||0:v.case_cost/(v.pack*v.size)||0:0),-1==is_cost_edit&&(v.item_cost=temp_cost),v.item_cost=Math.round(1e4*v.item_cost)/1e4,v.total_cost=v.item_cost*v.amount-v.discount||0,v.total_cost=Math.round(100*v.total_cost)/100,totalItemsCost+=v.item_cost,totalDiscount+=v.discount,totalCost+=v.total_cost,that.orderModel.totalItems=totalItemsCost,that.orderModel.totalDiscount=totalDiscount,that.orderModel.totalCost=totalCost,that.orderModel.totalCost=Math.round(100*that.orderModel.totalCost)/100})}},that.apply_values=function($index,$item){that.pushNewItem(),that.orderModel.items[$index].locked=!0,that.orderModel.items[$index].vendor_sku_id=$item.vendor_sku_id,that.orderModel.items[$index].vendor_sku=$item.vendor_sku,that.orderModel.items[$index].item_name=$item.item_name,that.orderModel.items[$index].vendor_cat_id=$item.vendor_cat_id,that.orderModel.items[$index].vendor_sub_cat_id=$item.vendor_sub_cat_id,that.orderModel.items[$index].uom_id_of_delivery_unit=$item.uom_id_of_delivery_unit,that.orderModel.items[$index].pack=$item.pack,that.orderModel.items[$index].size=$item.size,that.orderModel.items[$index].total_unit_size=$item.pack*$item.size,that.orderModel.items[$index].case_size=$item.pack*$item.size+" "+$item.uod,that.orderModel.items[$index].case_cost=$item.case_cost,that.orderModel.items[$index].minimum_order_type=$item.minimum_order_type,that.calculate($index,$item.vendor_sku_id,0)},that.sku_lookup=function($index,search_for){return 1==that.selected_vendor.vendor_type_id?that.api.sku_lookup({search_for:search_for,vendor_id:that.selected_vendor.id}).then(function(res){for(var local_results=[],i=0;i<res.data.data.sku.length;i++)"l"==res.data.data.sku[i].src&&local_results.push(res.data.data.sku[i]);if(0!==local_results.length)return local_results.slice(0,10);$uibModal.open({templateUrl:"add_new_food_inventory_item.html",controller:newFoodItem_modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",size:"lg",resolve:{vendor_id:function(){return that.selected_vendor.id},restaurant_id:function(){return that.restaurant_id.restaurant_id}}}).result.then(function(){that.orderModel.items[$index].vendor_sku=null},function(){that.orderModel.items[$index].vendor_sku=null})}):2==that.selected_vendor.vendor_type_id?that.api.sku_lookup({search_for:search_for,vendor_id:that.selected_vendor.id}).then(function(res){for(var local_results=[],i=0;i<res.data.data.sku.length;i++)"l"==res.data.data.sku[i].src&&local_results.push(res.data.data.sku[i]);if(0!==local_results.length)return local_results.slice(0,10);$uibModal.open({templateUrl:"add_new_alcohol_inventory_item.html",controller:newAlcoholItem_modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",size:"lg",resolve:{vendor_id:function(){return that.selected_vendor.id},restaurant_id:function(){return that.restaurant_id.restaurant_id}}}).result.then(function(){that.orderModel.items[$index].vendor_sku=null},function(){that.orderModel.items[$index].vendor_sku=null})}):void 0},that.checkDetails=function(){that.invoice_date>new Date&&(alertService.showError("Delivery date cannot be greater than now!"),that.invoice_date=new Date)},that.check_Invoice=function(){return that.selected_vendor?that.invoice_number?void api.check_if_invoice_exists(that.restaurant_id.restaurant_id+"&"+that.invoice_number+"&"+that.selected_vendor.id).then(function(res){try{if("true"==res.data.data.does_exist.does_exist[0].invoice_exists)return alertService.showError("Invoice number already exists in the records!"),void(that.invoice_number=null)}catch(e){that.invoice_number=null,console.log("error")}}):(alertService.showError("Invoice number cannot be empty!"),void(that.invoice_number=null)):(alertService.showError("Please select a vendor!"),void(that.invoice_number=null))},that.viewInvoices=function(){$uibModal.open({templateUrl:"view_invoice.html",controller:viewInvoices_modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr"})},that.chooseVendorConfirm=function(){-1==that.selected_vendor.id?$uibModal.open({templateUrl:"add_new_vendor.html",controller:modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",resolve:{subscription_type_id:function(){return that.subscription_type_id},get_refbooks:function(){return that.get_refbooks?that.get_refbooks:that.core.getRefbooks().then(function(res){return that.get_refbooks=res})}}}).result.then(function(){that.selected_vendor=null,that.prev_selected_vendor=that.selected_vendor,that.getChosenVendors()},function(){that.selected_vendor=null,that.prev_selected_vendor=that.selected_vendor,that.getChosenVendors()}):(that.prev_selected_vendor=that.selected_vendor,that.isFood=1==that.selected_vendor.vendor_type_id?1:0),that.invoice_number=null,that.invoice_total=null,that.resetOrderModel(),that.pushNewItem()},that.chooseVendor=function(){that.orderModel.items.length>0&&that.orderModel.items[0].locked?SweetAlert.swal({title:"Change vendor?",text:"You will lose your current work if you confirm.",type:"warning",showCancelButton:!0,confirmButtonColor:"#337ab7",confirmButtonText:"Confirm"},function(res){res?that.chooseVendorConfirm():that.selected_vendor=that.prev_selected_vendor}):that.chooseVendorConfirm()},that.getChosenVendors=function(){7==that.subscription_type_id?api.get_chosen_vendors(that.restaurant_id.restaurant_id,{vendor_type_id:1}).then(function(res){try{that.vendors=[],that.vendors.push({id:-1,vendor_name:"(+) Add a new Vendor"}),that.vendors=that.vendors.concat(res.data.data.vendors),api.get_chosen_vendors(that.restaurant_id.restaurant_id,{vendor_type_id:2}).then(function(res){try{that.vendors=that.vendors.concat(res.data.data.vendors)}catch(e){console.log(e)}})}catch(e){console.log(e)}}):5!=that.subscription_type_id&&6!=that.subscription_type_id||api.get_chosen_vendors(that.restaurant_id.restaurant_id,{vendor_type_id:5==that.subscription_type_id?2:1}).then(function(res){try{that.vendors=[],that.vendors.push({id:-1,vendor_name:"(+) Add a new Vendor"}),that.vendors=that.vendors.concat(res.data.data.vendors)}catch(e){console.log(e)}})},that.$onInit=function(){that.getChosenVendors(),that.core.getRefbooks().then(function(res){that.refbooks=res})}}var qt=function($uibModalInstance,isFood,isEdit){var that=this;isFood?isEdit?(that.q_title="Confirm Food Delivery Instructions",that.q_texts='<article style="display: block;"><p><b>Confirm Food Delivery Edit Screen</b>  you may modify your orders here to match your invoice or make corrects. Here you may change the Order Quantity, Order Type, Case Size and Item Cost. You may also remove an item completely or add a new item<br/><br/><b>Adding a New Item</b>  Select the + symbol to create a new line item. Note: The vendor has to be the same. Once the new item is added you must approve the item the select Confirm and Save<br/><br/><b>Delete</b>  To remove an item you much first unapproved the item then select Delete and finally Confirm and Save<br/><br/><b>Modify Case Size</b>  Check the box next to the case size that you would like to change. We do not recommend changing the case size but instead, change your order size.<br/><br/><b>Modify Item Cost</b>  Check the box next to the item cost then enter in the correct cost. Select Confirm and Save</p></article>'):(that.q_title="New Food Order Instructions",that.q_texts='<article style="display: block;"><p><b>New Food Order</b>  Here is where you will generate your orders which can be automatically delivered to your sales rep email<br/><br/><b>Vendor</b>  Select the vendor from the drop down list. You may select multiple vendors and the final order will be sorted and delivered by vendors<br/><br/><b>Item Description</b>  Each vendor has their own unique items<br/><br/><b>Units on Hand</b>  The theoretical amount of inventory that you should have on-hand as of the start of the current business day. The categories are Case, Packs, Units and Order Type<br/><br/><b>Actual</b>  This is where you will enter the desired order amount and Order Type<br/><br/><b>Approve</b>  You must approve each item or it will not be processed<br/><br/><b>Confirm and Send</b>  This will send your order to the email addresses you included in the vendors setup file which should include your sales rep email address.<br/><br/><b>Confirm and Save</b>  This will save and process the order but will not send it</p></article>'):isEdit?(that.q_title="Confirm Alcohol Delivery Instructions",that.q_texts='<article style="display: block;"><p><b>Confirm Alcohol Delivery Edit Screen</b>  you may modify your orders here to match your invoice or make corrects. Here you may change the Order Quantity, Order Type, Case Size and Item Cost. You may also remove an item completely or add a new item<br/><br/><b>Adding a New Item</b>  Select the + symbol to create a new line item. Note: The vendor has to be the same. Once the new item is added you must approve the item the select Confirm and Save<br/><br/><b>Delete</b>  To remove an item you much first unapproved the item then select Delete and finally Confirm and Save<br/><br/><b>Modify Item Cost</b>  Check the box next to the item cost then enter in the correct cost. Select Confirm and Save</p></article>'):(that.q_title="New Alcohol Order Instructions",that.q_texts='<article style="display: block;"><p><b>New Alcohol Order</b>  Here is where you will generate your orders which can be automatically delivered to your sales rep email<br/><br/><b>Vendor</b>  Select the vendor from the drop down list. You may select multiple vendors and the final order will be sorted and delivered by vendors<br/><br/><b>Item Description</b>  Each vendor has their own unique items<br/><br/><b>Units on Hand</b>  The theoretical amount of inventory that you should have on-hand as of the start of the current business day.<br/><br/><b>Actual</b>  This is where you will enter the desired order amount and Order Type<br/><br/><b>Approve</b>  You must approve each item or it will not be processed<br/><br/><b>Confirm and Send</b>  This will send your order to the email addresses you included in the vendors setup file which should include your sales rep email address.<br/><br/><b>Confirm and Save</b>  This will save and process the order but will not send it<br/><br/>TIP: Do not include deposits as part of your cost. For example  many keg vendors will charge a refundable keg deposit which is not apart of your true cost. If you add it to your cost it will sku your pricing, cost and budget.</p></article>'),that.skip=function(){$uibModalInstance.dismiss("cancel")}},save_invoice=function($uibModalInstance){var that=this;that.skip=function(){$uibModalInstance.dismiss("cancel")},that.save=function(is_last){var choice=is_last;$uibModalInstance.close(choice)}};controller.$inject=["$state","auth","api","core","restaurant","$uibModal","localStorageService","$rootScope","alertService","SweetAlert","$window"],angular.module("inspinia").component("dataentry",{templateUrl:"js/components/dataEntry/dataEntry.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("admin.dataEntry",{url:"/dataEntry",template:"<dataentry></dataentry>",data:{pageTitle:"Data Entry"}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("alcohol.editAlcoholOrder",{url:"/edit-alcohol-order/:id",template:"<new-order-component></new-order-component>",data:{pageTitle:"Edit Alcohol Order"}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("food.editFoodOrder",{url:"/edit-food-order/:id",template:"<new-order-component></new-order-component>",data:{pageTitle:"Edit Food Order"}})})}(),function(){"use strict";function controller(api,$state,auth,localStorageService,$rootScope,SweetAlert,restaurant,core){var that=this;that.form={},that.state=$state,that.core=core,that.api=api,that.auth=auth,that.$onInit=function(){}}controller.$inject=["api","$state","auth","localStorageService","$rootScope","SweetAlert","restaurant","core"],angular.module("inspinia").component("employeelist",{templateUrl:"js/components/employeelist/employeelist.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("admin.employeelist",{url:"/employeelist",template:"<employeelist></employeelist>",data:{pageTitle:"Employee List"}})})}(),function(){"use strict";function controller(api,$state,auth,localStorageService,$rootScope,SweetAlert,restaurant,core){var that=this;that.form={},that.state=$state,that.core=core,that.api=api,that.auth=auth,that.$onInit=function(){}}controller.$inject=["api","$state","auth","localStorageService","$rootScope","SweetAlert","restaurant","core"],angular.module("inspinia").component("employeeprofile",{templateUrl:"js/components/employeeprofile/employeeprofile.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("admin.employeeprofile",{url:"/employeeprofile",template:"<employeeprofile></employeeprofile>",data:{pageTitle:"Employee Profile"}})})}(),function(){"use strict";function controller(api,$state,auth,localStorageService,$rootScope,SweetAlert,restaurant,core){var that=this;that.form={},that.state=$state,that.core=core,that.api=api,that.auth=auth,that.$onInit=function(){}}controller.$inject=["api","$state","auth","localStorageService","$rootScope","SweetAlert","restaurant","core"],angular.module("inspinia").component("employeerole",{templateUrl:"js/components/employeerole/employeerole.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("admin.employeerole",{url:"/employeerole",template:"<employeerole></employeerole>",data:{pageTitle:"Employee Role"}})})}(),function(){"use strict";function controller(api,$state,auth,localStorageService,$rootScope,SweetAlert,restaurant,core){var that=this;that.form={},that.state=$state,that.core=core,that.api=api,that.auth=auth,that.$onInit=function(){}}controller.$inject=["api","$state","auth","localStorageService","$rootScope","SweetAlert","restaurant","core"],angular.module("inspinia").component("employeeschedule",{templateUrl:"js/components/employeeschedule/employeeschedule.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("admin.employeeschedule",{url:"/employeeschedule",template:"<employeeschedule></employeeschedule>",data:{pageTitle:"Employee Schedule"}})})}(),function(){"use strict";function controller(api,$state,auth,localStorageService,$rootScope,restaurant,core){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;that.form={},that.$state=$state,that.core=core,that.api=api,that.auth=auth;var uxt=+new Date;that.locn_details={},that.yes_no=[{name:"Yes"},{name:"No"}],that.event_types=[],that.event_types.push({type:"(+) Add new category"}),that.event_list=[],that.repeat_type=[{name:"Daily"},{name:"Weekly"},{name:"Monthly"},{name:"Yearly"},{name:"One time only event"}],that.repeat_options=[{Sunday:!1,Monday:!1,Tuesday:!1,Wednesday:!1,Thursday:!1,Friday:!1,Saturday:!1}],that.repeat_every_options=[];for(var i=1;i<=7;i+=1)that.repeat_every_options.push(i);that.ends=[{name:"Never"},{name:"On"}],that.end_n_options=[];var pref="This event affects ";if(that.locn_type=[{name:pref+"just my restaurant"},{name:pref+"restaurants in my area"},{name:pref+"restaurants throughout my city"},{name:pref+"restaurants throughout my county"},{name:pref+"restaurants throughout my state"},{name:pref+"restaurants throughout across the country"}],that.restaurant_id=localStorageService.get("restaurant_id"),that.model={},that.model.events_feedback_stack=[],that.model.curr_stack_id="",that.model.curr_date="",that.model.curr_deviation="",that.resetModel=function(){that.model.true_event=that.yes_no[1].name,that.model.share=that.yes_no[1].name,that.model.selected_event_type="",that.model.is_new_category=!1,that.model.new_category="",that.model.is_new_event=!1,that.model.new_event="",that.model.selected_event_name="",that.model.selected_repeat_type=that.repeat_type[0].name,that.model.repeat_every="",that.model.selected_locn_type=that.locn_type[0].name,that.model.converted_locn_type="Self",that.model.converted_locn=that.restaurant_id.restaurant_id,that.model.ends_n_count=1,that.model.ends_on="",that.model.selected_ends="",that.model.selected_weekly_repeat_option=that.repeat_options,that.model.selected_monthly_repeat_option=[{name:"Date of the month",selected:!0},{name:"Day of the month",selected:!1}],that.model.selected_yearly_repeat_option=[{name:"Date of the year",selected:!0},{name:"Day of the year",selected:!1}],that.model.final_repeat_options_string="",that.model.final_ends_string=""},that.resetModel(),!that.restaurant_id)return void $state.go("home");restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),that.getFeedbackStack=function(resId){console.log("Getting stack"),that.api.get_feedback_stack(resId).then(function(res){var stack=res.data.data.feedback_stack.feedback_stack,new_stack=[];for(i=0;i<stack.length;i++)new_stack.push({id:stack[i].id,date:that.timeConverter(stack[i].date),deviation:stack[i].deviation});that.model.events_feedback_stack=new_stack}),that.resetModel()},that.timeConverter=function(UNIX_timestamp){var a=new Date(UNIX_timestamp);return a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()},that.getEventCategories=function(){that.api.get_event_categories(that.restaurant_id.restaurant_id).then(function(res){that.event_types=[],that.event_types.push({type:"(+) Add new category"}),that.event_types=that.event_types.concat(res.data.data.events.event_categories)})},that.switchFeedback=function(item){that.model.curr_stack_id=item.id,that.model.curr_date=item.date,that.model.curr_deviation=item.deviation,that.resetModel()},that.updateEvents=function(){"(+) Add new category"==that.model.selected_event_type?(that.model.is_new_category=!0,that.model.is_new_event=!0,that.model.selected_repeat_type=that.repeat_type[0].name,that.updateEnds()):(that.model.is_new_category=!1,"(+) Add new event"==that.model.selected_event_name?(that.model.is_new_event=!0,that.model.selected_repeat_type=that.repeat_type[0].name,that.updateEnds()):(that.model.is_new_event=!1,that.model.selected_repeat_type="",that.model.repeat_every="",that.model.final_repeat_options_string="",that.model.final_ends_string=""),that.api.get_events(that.restaurant_id.restaurant_id+"&"+that.model.selected_event_type).then(function(res){that.event_list=[],that.event_list.push({name:"(+) Add new event"}),that.event_list=that.event_list.concat(res.data.data.events.events)}))},that.updateForm=function(){"(+) Add new event"==that.model.selected_event_name?(that.model.is_new_event=!0,that.model.selected_repeat_type=that.repeat_type[0].name):(that.model.is_new_event=!1,that.model.selected_repeat_type="",that.model.repeat_every="",that.model.final_repeat_options_string="",that.model.final_ends_string="")},that.updateEnds=function(){if(that.model.selected_repeat_type==that.repeat_type[0].name){that.ends=[],that.ends=[{name:"Never"},{name:"On"}],that.repeat_every_options=[];for(var i=1;i<=7;i+=1)that.repeat_every_options.push(i)}else if(that.model.selected_repeat_type==that.repeat_type[4].name)that.ends=[],that.ends=[{name:"On"}],that.repeat_every_options=[],that.model.repeat_every="";else{if(that.ends=[],that.ends=[{name:"Never"},{name:"After n occurrences"
},{name:"On"}],that.repeat_every_options=[],that.end_n_options=[],that.model.selected_repeat_type==that.repeat_type[1].name)for(var i=1;i<=52;i+=1)that.repeat_every_options.push(i);else if(that.model.selected_repeat_type==that.repeat_type[2].name)for(var i=1;i<=12;i+=1)that.repeat_every_options.push(i);else if(that.model.selected_repeat_type==that.repeat_type[3].name)for(var i=1;i<=10;i+=1)that.repeat_every_options.push(i);that.end_n_options=that.repeat_every_options}},that.processRadio=function(obj,sm){var indexOfCheckedRadioInTheKindObject=sm.indexOf(obj);angular.forEach(sm,function(value,key){indexOfCheckedRadioInTheKindObject!=key&&(value.selected=!1)})},that.convertLocn_Type=function(){that.model.selected_locn_type==that.locn_type[0].name?(that.model.converted_locn_type="Self",that.model.converted_locn=that.restaurant_id.restaurant_id):that.model.selected_locn_type==that.locn_type[1].name?(that.model.converted_locn_type="Zip Code",that.model.converted_locn=that.locn_details.zip):that.model.selected_locn_type==that.locn_type[2].name?(that.model.converted_locn_type="City",that.model.converted_locn=that.locn_details.city+"_"+that.locn_details.state):that.model.selected_locn_type==that.locn_type[3].name?(that.model.converted_locn_type="County",that.model.converted_locn=that.locn_details.county+"_"+that.locn_details.state):that.model.selected_locn_type==that.locn_type[4].name?(that.model.converted_locn_type="State",that.model.converted_locn=that.locn_details.state):that.model.selected_locn_type==that.locn_type[5].name&&(that.model.converted_locn_type="Country",that.model.converted_locn=that.locn_details.country)},that.next=function(form){if(form.$valid){var m={restaurant_id:that.restaurant_id.restaurant_id,event_details:[]};if(that.model.is_new_event){if("Daily"==that.model.selected_repeat_type||"Weekly"==that.model.selected_repeat_type){var days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],sm=that.model.selected_weekly_repeat_option[0],dwo=[];for(var i in sm)sm[i]&&dwo.push(i);0==dwo.length&&dwo.push(days[(new Date).getDay()]),that.model.final_repeat_options_string=dwo.join()}else if("Monthly"==that.model.selected_repeat_type){var sm=that.model.selected_monthly_repeat_option;angular.forEach(sm,function(value,key){value.selected&&(that.model.final_repeat_options_string=sm[key].name)})}else if("Yearly"==that.model.selected_repeat_type){var sm=that.model.selected_yearly_repeat_option;angular.forEach(sm,function(value,key){value.selected&&(that.model.final_repeat_options_string=sm[key].name)})}"Never"==that.model.selected_ends?that.model.final_ends_string="Never":"After n occurrences"==that.model.selected_ends?that.model.final_ends_string="After "+that.model.ends_n_count:"On"==that.model.selected_ends&&(that.model.final_ends_string="On "+that.model.ends_on)}m.event_details.push({name:that.model.is_new_event?that.model.new_event:that.model.selected_event_name,type:that.model.is_new_category?that.model.new_category:that.model.selected_event_type,date:that.timeConverter(uxt),location_type:"Self",location:that.restaurant_id.restaurant_id,suggested_locn_type:that.model.converted_locn_type,suggested_locn:that.model.converted_locn,repeat_type:that.model.selected_repeat_type,repeat_every:that.model.repeat_every,repeat_options:that.model.final_repeat_options_string,ends:that.model.final_ends_string,stack_id:that.model.curr_stack_id}),that.api.set_events(m).then(function(res){try{if(1e3===res.data.data.code){swal({title:"Thank you!",timer:1500,showConfirmButton:!1,type:"success"});var s={restaurant_id:that.restaurant_id.restaurant_id,stack_id:that.model.curr_stack_id};that.api.set_feedback(s).then(function(res){try{1e3===res.data.data.code&&(that.model.curr_stack_id="",console.log("done?"),that.getFeedbackStack())}catch(e){console.log(e)}})}}catch(e){console.log(e)}})}},that.proceed_without_form=function(){try{swal({title:"Are you sure?",text:"This feedback will really help Artecsan understand your restaurant better.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){res&&that.$state.go("inventory.inventoryCategories")})}catch(e){console.log(e)}},that.$onInit=function(){var resId=that.restaurant_id.restaurant_id;that.getFeedbackStack(resId),that.api.get_restaurant_location_details(resId).then(function(res){var res_locn=res.data.data.locn_details.locn_details[0];that.locn_details.country=res_locn.country,that.locn_details.state=res_locn.state,that.locn_details.county=res_locn.county,that.locn_details.city=res_locn.city,that.locn_details.zip=res_locn.zip})}}controller.$inject=["api","$state","auth","localStorageService","$rootScope","restaurant","core"],angular.module("inspinia").component("eventsFeedbackComponent",{templateUrl:"js/components/eventsFeedback/eventsFeedback.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("admin.eventsFeedback",{url:"/eventsFeedback",template:"<events-feedback-component></events-feedback-component>",data:{pageTitle:"Events Feedback"}})})}(),function(){"use strict";function controller(api,$state,core,auth,localStorageService,$rootScope,restaurant,alertService){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.form={},that.$state=$state,that.core=core,that.api=api,that.auth=auth,that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions});const month_no={January:0,February:1,March:2,April:3,May:4,June:5,July:6,August:7,September:8,October:9,November:10,December:11},DD_OPTIONS_SIZE=3,PAYROLL_TAX=9,BREAKEVEN_INDEX=.62;that.month_names=Object.keys(month_no),that.current_month=(new Date).getMonth(),that.current_year=(new Date).getFullYear(),that.dd_options=[];for(var i=0;i<DD_OPTIONS_SIZE;i++){var d=new Date;that.dd_options.push(d.getFullYear()-i)}that.selected_dd_option=that.dd_options[0],that.alco_tax=6.25,that.cc_fee=2.5,that.expenses_arr=[],that.other_expenses_total_arr=new Array(that.month_names.length).fill(0),that.est_net_profit_arr=new Array(that.month_names.length).fill(0),that.extract_np_values=function(title,key,dummy_arr,arr){var ret_obj={title:title,month_values:dummy_arr};return arr.length&&(ret_obj.month_values=dummy_arr.map(function(y,index){var find_item=arr.filter(function(x){return x.month==index+1});return find_item.length?"alco_sales"==key?Math.round(find_item[0][key.toString()]*that.alco_tax/100):"sales"==key&&"Creditcard Fee"==title?Math.round(find_item[0][key.toString()]*that.cc_fee/100):find_item[0][key.toString()]:y})),ret_obj},that.getData=function(){var dummy_month_arr=new Array(that.month_names.length).fill(0);that.alco_sales_values=new Array(that.month_names.length).fill(0),that.api.getExpenses({year:that.selected_dd_option,net_profit:!0,np_mode:"monthly"}).then(function(res){res&&1e3==res.data.data.code&&void 0!==res.data.data.expenses&&(that.expenses_arr=res.data.data.expenses.expenses_data,that.bef_data=res.data.data.expenses.bef,that.net_profit=res.data.data.expenses.net_profit,that.overview_arr=[],void 0!==that.bef_data&&(void 0!==that.bef_data.alcohol_tax&&null!=that.bef_data.alcohol_tax&&(that.alco_tax=that.bef_data.alcohol_tax),void 0!==that.bef_data.cc_fee&&null!=that.bef_data.cc_fee&&(that.cc_fee=that.bef_data.cc_fee),void 0!==that.bef_data.annual_salaries&&null!=that.bef_data.annual_salaries&&(that.annual_salaries=that.bef_data.annual_salaries)),void 0!==that.net_profit&&(that.overview_arr.push(that.extract_np_values("Sales","sales",dummy_month_arr,that.net_profit.sales)),that.overview_arr.push({title:"Labor",month_values:dummy_month_arr.map(function(x){return x+(null!=that.annual_salaries?Math.round(that.annual_salaries/12):0)})}),that.overview_arr.push(that.extract_np_values("Inventory","inv",dummy_month_arr,that.net_profit.inv)),that.overview_arr.push(that.extract_np_values("Alcohol Tax","alco_sales",dummy_month_arr,that.net_profit.alco_sales)),that.overview_arr.push(that.extract_np_values("Creditcard Fee","sales",dummy_month_arr,that.net_profit.sales)),that.overview_arr.push({title:"Payroll Tax",month_values:that.overview_arr[1].month_values.map(function(x){return Math.round(x*PAYROLL_TAX/100)})}),that.net_profit.alco_sales.length&&(that.alco_sales_values=dummy_month_arr.map(function(y,index){var find_item=that.net_profit.alco_sales.filter(function(x){return x.month==index+1});return find_item.length?JSON.parse(JSON.stringify(find_item[0].alco_sales)):y}))),that.expenses_arr.length||that.addBudgetEntry(),that.calculate_budget_amt_totals(that.expenses_arr),that.calculate_other_expenses_totals())}),that.expenses_cols=that.month_names.map(function(x){return x.substring(0,3)+"-"+that.selected_dd_option%2e3})},that.disableExpenseInput=function(month_key){return!(that.selected_dd_option<that.current_year||month_no[month_key]<=that.current_month)},that.addBudgetEntry=function(){that.expenses_arr.push({expense_id:null,expense_type_unit_id:null,expense_name:null,year:that.selected_dd_option,amount:null}),that.calculateEstNetProfit()},that.removeBudgetEntry=function(index){that.expenses_arr.splice(index,1),that.calculate_budget_amt_totals(that.expenses_arr),that.calculate_other_expenses_totals()},that.calculateEstNetProfit=function(){that.est_net_profit_arr=new Array(that.month_names.length).fill(0);for(var j=0;j<that.est_net_profit_arr.length;j++)that.est_net_profit_arr[j]=that.overview_arr[0].month_values[j]-that.overview_arr[1].month_values[j]-that.overview_arr[2].month_values[j]-that.overview_arr[3].month_values[j]-that.overview_arr[4].month_values[j]-that.overview_arr[5].month_values[j]-that.other_expenses_total_arr[j]},that.calcualte_percent_value=function(key){for(var i=0;i<that.overview_arr.length;i++){var ci=that.overview_arr[i];if(ci.title==key&&"Alcohol Tax"==key){for(var i=0;i<ci.month_values.length-1;i++)ci.month_values[i]=Math.round(that.alco_sales_values[i]*that.alco_tax/100);break}if(ci.title==key&&"Creditcard Fee"==key){for(var i=0;i<ci.month_values.length-1;i++)ci.month_values[i]=Math.round(that.overview_arr[0].month_values[i]*that.cc_fee/100);break}if(ci.title==key&&"Labor"==key){for(var i=0;i<ci.month_values.length-1;i++)ci.month_values[i]=Math.round(that.annual_salaries/12),that.overview_arr[5].month_values[i]=Math.round(ci.month_values[i]*PAYROLL_TAX/100);break}}that.calculateEstNetProfit()},that.calculate_budget_amt_totals=function(arr){for(var total=0,i=0;i<arr.length;i++)total+=arr[i].amount;that.budget_amt_total=total,that.update_breakeven()},that.update_breakeven=function(){that.breakeven_value=Math.round((that.budget_amt_total+(that.selected_dd_option<that.current_year?that.overview_arr[5].month_values[that.month_names.length-1]:that.overview_arr[5].month_values[that.current_month]))/(1-BREAKEVEN_INDEX))},that.calculate_other_expenses_totals=function(month_key){void 0===month_key?that.other_expenses_total_arr=new Array(that.month_names.length).fill(0):that.other_expenses_total_arr[month_no[month_key]]=0;for(var i=0;i<that.expenses_arr.length;i++){var ci=that.expenses_arr[i];that.month_names.forEach(function(m){void 0===month_key?that.other_expenses_total_arr[month_no[m]]+=ci[m]||0:month_key==m&&(that.other_expenses_total_arr[month_no[m]]+=ci[m]||0)})}that.calculateEstNetProfit()},that.saveExpenses=function(form){form.$valid&&that.api.update_expenses({year:that.selected_dd_option,expenses:that.expenses_arr,bef:{alcohol_tax:that.alco_tax,cc_fee:that.cc_fee,annual_salaries:that.annual_salaries}}).then(function(res){res&&1e3==res.data.data.code?(that.getData(),alertService.showAlertSave()):alertService.showError("Something went wrong!")})},that.$onInit=function(){that.core.getRefbooks().then(function(res){that.get_refbooks=res,that.is_su=1==auth.authentication.user.id,that.is_su||$state.go("admin.homeMenu");var exp_subcats_dict={};that.expense_subcategories=that.get_refbooks.accounting_subcategories.filter(function(x){return 7==x.parent_category}).map(function(x){exp_subcats_dict[x.id]=x.subcategory}),that.expenses_types=that.get_refbooks.accounting_units.filter(function(x){return 7==x.parent_category}).map(function(x){return Object.assign(x,{subcat_name:exp_subcats_dict[x.subcategory]})}),that.getData()})}}controller.$inject=["api","$state","core","auth","localStorageService","$rootScope","restaurant","alertService"],angular.module("inspinia").component("expenseBudgetComponent",{templateUrl:"js/components/expenseBudget/expenseBudget.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("admin.expenseBudget",{url:"/expenseBudget",template:"<expense-budget-component></expense-budget-component>",data:{pageTitle:"Expense Budget"}})})}(),function(){"use strict";function controller(api,$state,auth,localStorageService,$rootScope,SweetAlert,restaurant,core){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.$state=$state,that.core=core,that.api=api,that.auth=auth,that.faq_data=[{q:"How do I add another user?",a:"From the navigation bar on the left select Administrator > Create/Delete/Modify User > Add New"},{q:"How do I add another restaurant to my account?",a:"From the navigation bar on the left select Select Restaurant > Add New Restaurant"},{q:"How do I change my password?",a:"In the upper left corner you should see your name. Select your name and a list should appear that says Account Settings and Logout. Select Account Setting to change your name and password."},{q:"Can I merge restaurant reports if I have multiple restaurants?",a:"Merging reports is part of our paid Enterprise version which is due to be released later this year"},{q:"How do I change my subscription level?",a:"Currently you will need to contact the Skrible team at <code>sales@getskrible.com</code> with your request"},{q:"Do you guys have a contact phone number? ",a:"Skrible is in the process of growing and adding new employees which includes a team dedicated to customer service & support. For now the quickest way to reach us is by email at <code>sales@getskrible.com</code>. A representative should be in contact with you within 1-24 hours."},{q:"How do I setup my orders to be automatically sent to my vendors?",a:"In order to deliver your orders to your vendors you must make sure that your sales rep's email address is added to the correct vendors account. To do this you may visit the navigation bar on the left and select Inventory>Food or Alcohol>Add/Edit New Vendor. Once inside you can select Edit next to the desired vendor's name. Note: Edit is only active for vendors who are selected. Once you select Edit you will see three email options which includes Primary, Seconday 1 and Seconday 2. These email slots are the recipients of your orders. For best results we advise that in addition to your vendors, you also add your email address as a secondary confirmation that the order was successfully sent. In addition we also advise that you request a confirmation from your vendor after the order is received."},{q:"How do I automatically send my orders to my vendors?",a:"After your vendors email address has been added to the vendors profile, you simply have to select 'Save and Send' whenever you create a new order. This will automatically email the orders to all email address listed under each vendors profile."},{q:"What is Yield?",a:"Yield is the amount of content or usable value that you get from a food item. For example, a box of noodles has a 100% yield because all the noodles are usable however pound of apples will include a core, stem and seeds which are unusable. This might reduce your usable apple amount down to 3/4th of a pound which is defined as my Yield %. Artecsan has pre-loaded dozens of Yield amounts but also lets the user freely add their own Yield percentages and descriptions."},{q:"I can't find some of my POS items on my reports?",a:"<article style='display: block'><p>Your POS items will not appear on reports if they are inactive, incorrectly categorized, unmapped or never added. You may check for your items in three locations. First visit your menu setup screen by going to Inventory>Food or Alcohol>Modify Menu. We first want to make sure the item is part of a mapped recipe. Scroll down the list until you see the menu item that contains the ingredient that you are searching for. Once you find the recipe, make sure it is mapped to a recipe that you created. If it is not, you may select the dropdown list, find the item and save it as mapped. The item should now show up in your reports.</p><p>If you mapped the item and it still does not show up on your reports you will need to double check the recipe to make sure the item is included in the recipe. To check the recipe simply select the Create Food/Alcohol Item in the top left corner of the same screen. This will take you to the Menu setup screen where you can verify the recipes.</p><p>If you do not see the recipe in your Menu list, you will have to create the recipe then map it. After this step the item should show up in your reports. If you do not see the menu item or your Create a Menu page, the item may have been mis-categorized. To check, please go back to the Create a Menu page where you will see a dropdown list labeled 'Status'. Select Inactive. Any items in this list will not show up in your reports because the status is inactive unless the ingredient is included on an active menu item. To make the item active and appear on report you may change the item status from inactive to active.</p><p>If you have no luck there you may re-visit the mapping screen by selecting Reports>Menu Item Mappings. Once inside you will see a drop down list on the top left labeled 'Category'. In this dropdown list you will see four options labeled Alcohol, Food, Archived and Other. View each list to see if your items have been mis-categorized. For example: if you're working with Food but your item appears in Liquor, that item will not show on your food reports. To fix this, simply move the item to its correct category by selecting the 'Move To' drop down list which is next to the item name. Select where you want the item to go followed by 'Move Selected Item'.</p><p>If you still can't locate the missing item you may want to make sure the item is added to your inventory list by going to Inventory>Food or Alcohol>New Order. Once there you can select the vendor that you purchase the item from, then search for the item in the dropdown list. If you do not see the item in the dropdown list you may select 'Add new' and add the item to your list.</p><p>If you still do not see the item please contact us at <code>sales@getskrible.com</code></p></article>"},{q:"How do I create a new food or alcohol order?",a:"Select Inventory>Food or Alcohol>New Food Order. Once inside simply select the + symbol on the left. This will add rows for you to complete your orders. Each row will contain a vendor, order item, amount ordered and size. Once your list of items ordered is complete simply hit Save or Save and Send. If you select Save and Send your order will be sent directly to the email addresses you attached to each vendors account. If you did not attach an email, then no emails will be delivered but your order will be saved."},{q:"Can I add more than one vendor to a single order?",a:"Yes. Artecsan sorts and combines the order by the vendors name so feel free to list as many items as vendors as you like."},{q:"I received a new order, how do I confirm that I received it in Artecsan?",a:"From the navigation bar on the left you will select Inventory>Food or Alcohol > Confirm Delivery. Once inside you will need to enter the invoice amount, date and invoice number. The invoice amount must match your Order amount. If not, you may select Edit and update the details so that they match the invoice. Once they match, select 'Save' and this will take you back to the Order Summary screen. From there you may reenter the amount, date and invoice number then select both toggle buttons labeled 'Approve' and 'Confirm Delivery'. Once your order is Approved and Confirmed simply select 'Confirm and Save' at the bottom."},{q:"I can't find my orders in any of my reports?",a:"After creating an order, you must also confirmed that the order was received. From the navigation bar on the left, simply select Inventory>Food or Alcohol > Confirm Delivery. Once inside you will need to enter the invoice amount, date and invoice number. The invoice amount must match your Order amount. If not, you may select Edit and update the details so that they match the invoice. Once they match, select 'Save' and this will take you back to the Order Summary screen. From there you may reenter the amount, date and invoice number then select both toggle buttons labeled 'Approve' and 'Confirm Delivery'. Once your order is Approved and Confirmed simply select 'Confirm and Save' at the bottom."},{q:"How do I do an inventory Audit using Artecsan?",a:"<article style='display: block'><p>Artecsan inventory platform does not yet include an app for mobile use therefore the best way to do inventory is to print an inventory sheet, note your count on paper then enter the count into Artecsan. </p><p>Our goal is to have a fully functional app within the near future.</p><p>For alcohol, the count must consist of full bottles counted as full and opened bottles weighed in ounces. For example, if you have 5 bottles of Greygoose on-hand and 3 of the bottles are opened your count would appear as 2 Full and the individual weights of the remaining 3 bottles.</p><p>For food, the count must consist of unopened cases counted as full and opened cases weighed in the unit of delivery. For example, an opened box of steaks delivered in pounds would be placed on a scale and weighed in pounds. </p><p>If you have pre-prep'd food batches, the items should be counted in estimated points. Example: a pre-prep'd batch of beans that typically makes 1 it appears to you have 1/2 gallon on-hand. You would not the estimated content amount of .5 on your report.</p><p>To get started, from the navigation bar on the left simply select Inventory>Alcohol or Food>Begin Alcohol Inventory Count. The next option you see should be Full or Adjustment. With a full audit you must count everything. Anything left unaccounted will default to zero. For an adjustment you only need to count specific items and no other items will be affected. Once inside you may begin entering your data.</p><p>To begin entering your data be sure to enter the date your audit began as the beginning date. Once your data entry is complete you may select 'Save' followed by the 'COS Report' button to view the results and 'Final Save' once your audit is fully completed. Note: After final save your audit cannot be changed.</p></article>"},{q:"How do I merge items?",a:"<article style='display: block'><p>Artecsan allows users to attach one item to another and create a primary and secondary items. The benefit of this is to create clean reports. The merge reporting should be used if you purchase the same item from multiple vendors, if you use the same item but from different manufacturers, if you use the same item but they are two different sizes. The primary should be the item you purchase the most frequently. Note: a secondary items cannot be used a both a secondary and primary.</p><p>This task is best done when creating a new order. To create a primary and secondary item go to the navigation bar on the left and select Inventory>Food or Alcohol>Order. Select the Vendor, then in the next column select the item you wish to make a secondary item or select add new. In the pop screen you will a column labeled 'Primary Item'. From the drop down list select the 'Primary Item' that you want to attach the new item to. Complete the rest of the information, select Save and your done.</p><p>Note: Secondary items will only show in the purchases and on-hand section. You will not be able to add these items to menus or see them on most reports. If you remove the item from the Secondary column, most reports will return to displaying the item.</p></article>"},{q:"Is my On-Hand Report live?",a:"Your on-hand report is based on sales up thru the closing of the most recent business day. If you compare the on-hand report to your actual on-hand prior to any transactions taking place on the current business day, the on-hand report and your actual on-hand inventory should match. Example: if you open at 11am then the on-hand inventory numbers should match your actual on-hand inventory numbers assuming all purchased were received."},{q:"What is the CompGroup Report?",a:"The CompGroup report allows you to view how restaurants within your same competitive grouping is performing compared to your restaurant. For example, if you're a steakhouse, you will see the daily sales of other participating steakhouse without ever knowing the name of the steakhouses or their exact location. You can also see their budget and how it compares to yours as well as dozens of other data points that will be coming soon."},{q:"How do I view my final or previous cost of sales reports?",a:"<article style='display: block'><p>To review previous cost of sales reports you must select the date the audits were performed. You can select any date range even if other audits are in the middle. For example, if you do a monthly audit but you still want to see your annual audit dated as of January 1 2018 thru January 1 2019, simply select the dates, select Search and your Annual audit will calculate.</p><p>The view your previous cost of sales reports simply select Reports>Cost of Sales Summary and select the date range of the reports that you would to view. Finally hit select and the table at the bottom should populate data.</p></article>"},{q:"Things to know about your Cost of Sales Report",a:"<article style='display: block'><p>Artecsan is able to merge items that are used as substitutes and will only show the primary items. For example, if you purchase a liter bottle of Greygoose on a regular basis but the vendor runs out liter size bottles and sends over 750ml size, you may manually designate the 750ml size bottle as a substitute item and Artecsan will calculate the cost as a combined total using a weighted average for unit cost.</p><p>All item weights are converted to points. Example - if you enter 2 full and 3 partial bottle weights during a full inventory audit, you might see 3.1 as a total inventory count. By converting to points it becomes easier to read the numbers.</p><p>Under food you will see a column labeled 'Batch Adjustment'. This column represents inventory items that are pre-mixed or pre-prep'd batches. For example, a full batch of tomato soup might contain a dozen tomatoes. When you enter 1 full batch of tomato soup on your inventory report it will show the 12 tomatoes in the 'batch adjustment' column.</p><p>+/- Unit variance column represents units over or short. This is the column where you want to focus your efforts. This column will tell you exactly how many items are potentially missing.</p></article>"},{q:"Things to know about your Purchases vs Cost Report",a:"Your purchase vs cost report is a great way to easily identify a potential problem. If you're restaurant is purchasing more than it sells, you have a potential problem."}],that.faq_questionare=[],that.faq_answers=[],that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),that.$onInit=function(){}}controller.$inject=["api","$state","auth","localStorageService","$rootScope","SweetAlert","restaurant","core"],angular.module("inspinia").component("faq",{templateUrl:"js/components/faq/faq.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("admin.faq",{url:"/faq",template:"<faq></faq>",data:{pageTitle:"FAQs"}})})}(),function(){"use strict";function foodCalculatorController(api,$state,auth,core,$uibModal,restaurant,alertService,SweetAlert){var that=this;that.auth=auth,that.api=api,that.model={},that.reset_model=function(){that.model={menu_name:null,menu_price:null,menu_cost:null,menu_cost_percent:0,item1:{recipe_name:"Click here for Recipe #1",recipe_cost:null,servings:1,ingredients:[{ingre_name:null,cost:null,delivery_unit:null,recipe_amount:null,measure_type:null,recipe_cost:null}]},item2:{recipe_name:"Click here for Recipe #2",recipe_cost:null,servings:1,ingredients:[{ingre_name:null,cost:null,delivery_unit:null,recipe_amount:null,measure_type:null,recipe_cost:null}]},item3:{recipe_name:"Click here for Recipe #3",recipe_cost:null,servings:1,ingredients:[{ingre_name:null,cost:null,delivery_unit:null,recipe_amount:null,measure_type:null,recipe_cost:null}]},user_email:null},that.selected_item=that.model.item1,that.selected_item_no=1},that.reset_model(),that.unit_types=[{id:1,name:"Lbs"},{id:2,name:"Oz"},{id:3,name:"Units"},{id:4,name:"Gal"},{id:5,name:"Liters"}],that.reset_model_alert=function(){SweetAlert.swal({title:"Are you sure?",text:"This will completely clear all the information and you will have to startover!",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){res&&that.reset_model()})},that.select_item=function(item_no){switch(item_no){case 1:that.selected_item=that.model.item1,that.selected_item_no=1;break;case 2:that.selected_item=that.model.item2,that.selected_item_no=2;break;case 3:that.selected_item=that.model.item3,that.selected_item_no=3;break;default:that.selected_item=that.model.item1,that.selected_item_no=1}},that.get_unit_types=function($index){return null==that.selected_item.ingredients[$index].delivery_unit||void 0===$index?that.unit_types:3==that.selected_item.ingredients[$index].delivery_unit.id?that.unit_types.slice(2,3):1==that.selected_item.ingredients[$index].delivery_unit.id?that.unit_types.slice(0,2):2==that.selected_item.ingredients[$index].delivery_unit.id?that.unit_types.slice(0,2).concat(that.unit_types.slice(3,5)):4==that.selected_item.ingredients[$index].delivery_unit.id||5==that.selected_item.ingredients[$index].delivery_unit.id?that.unit_types.slice(1,2).concat(that.unit_types.slice(3,5)):void 0},that.adjustPrice=function(){(null==that.model.menu_price||that.model.menu_price<0)&&(that.model.menu_price=0)},that.checkRecipeName=function(sel_item){null!=sel_item.recipe_name&&""!=sel_item.recipe_name||(sel_item.recipe_name="Item "+that.selected_item_no)},that.adjustServings=function(sel_item){(null==sel_item.servings||sel_item.servings<0)&&(sel_item.servings=0),sel_item.servings=Math.round(sel_item.servings)},that.addIngreEntry=function(){that.selected_item.ingredients.push({ingre_name:null,cost:null,delivery_unit:null,recipe_amount:null,measure_type:null,recipe_cost:null})},that.delIngreEntry=function($index){that.selected_item.ingredients.splice($index,1),that.calculate(that.selected_item_no)},that.resetFields=function(ingre,$index){ingre.recipe_cost=0,3!=ingre.delivery_unit.id&&3!=ingre.measure_type.id||(ingre.measure_type=null),that.calculate(that.selected_item_no,$index)},that.calc_ingre_recipe_cost=function(curr_i){try{if(null!=curr_i.cost&&null!=curr_i.delivery_unit.id&&null!=curr_i.recipe_amount&&null!=curr_i.measure_type.id){var measure_to_delivery_multiplier=1
;curr_i.delivery_unit.id!=curr_i.measure_type.id&&(1==curr_i.delivery_unit.id&&2==curr_i.measure_type.id?measure_to_delivery_multiplier=1/16:2==curr_i.delivery_unit.id&&1==curr_i.measure_type.id?measure_to_delivery_multiplier=16:2==curr_i.delivery_unit.id&&4==curr_i.measure_type.id?measure_to_delivery_multiplier=128:2==curr_i.delivery_unit.id&&5==curr_i.measure_type.id?measure_to_delivery_multiplier=33.814:4==curr_i.delivery_unit.id&&2==curr_i.measure_type.id?measure_to_delivery_multiplier=1/128:5==curr_i.delivery_unit.id&&2==curr_i.measure_type.id?measure_to_delivery_multiplier=1/33.814:4==curr_i.delivery_unit.id&&5==curr_i.measure_type.id?measure_to_delivery_multiplier=.264172:5==curr_i.delivery_unit.id&&4==curr_i.measure_type.id&&(measure_to_delivery_multiplier=3.78541)),curr_i.recipe_cost=Math.round(curr_i.recipe_amount*measure_to_delivery_multiplier*curr_i.cost*100)/100}else curr_i.recipe_cost=0}catch(err){}},that.calc_recipe_cost=function(curr_r){var recipe_cost=0;for(var i in curr_r.ingredients){var curr_i=curr_r.ingredients[i];null!=curr_i.recipe_cost&&(recipe_cost+=curr_i.recipe_cost)}curr_r.recipe_cost=0==that.selected_item.servings?null:Math.round(recipe_cost/that.selected_item.servings*100)/100},that.calc_menu_cost=function(){that.model.menu_cost=Math.round(100*((null==that.model.item1.recipe_cost?0:that.model.item1.recipe_cost)+(null==that.model.item2.recipe_cost?0:that.model.item2.recipe_cost)+(null==that.model.item3.recipe_cost?0:that.model.item3.recipe_cost)))/100,null!=that.model.menu_price&&0!=that.model.menu_price&&null!=that.model.menu_cost&&(that.model.menu_cost_percent=Math.round(that.model.menu_cost/that.model.menu_price*1e4)/100)},that.calculate=function(selected_item_no,$index){if(null!=$index&&void 0!==$index){if(1==selected_item_no){var curr_i=that.model.item1.ingredients[$index];that.calc_ingre_recipe_cost(curr_i),that.calc_recipe_cost(that.model.item1),that.calc_menu_cost()}else if(2==selected_item_no){var curr_i=that.model.item2.ingredients[$index];that.calc_ingre_recipe_cost(curr_i),that.calc_recipe_cost(that.model.item2),that.calc_menu_cost()}else if(3==selected_item_no){var curr_i=that.model.item3.ingredients[$index];that.calc_ingre_recipe_cost(curr_i),that.calc_recipe_cost(that.model.item3),that.calc_menu_cost()}}else-1==selected_item_no||null!=$index&&void 0!==$index?-1==selected_item_no&&that.calc_menu_cost():1==selected_item_no?(that.calc_recipe_cost(that.model.item1),that.calc_menu_cost()):2==selected_item_no?(that.calc_recipe_cost(that.model.item2),that.calc_menu_cost()):3==selected_item_no&&(that.calc_recipe_cost(that.model.item3),that.calc_menu_cost())},that.removeInvalidIngredients=function(curr_r){var validIngre=[];for(var i in curr_r.ingredients){var curr_i=curr_r.ingredients[i];null!=curr_i.cost&&null!=curr_i.delivery_unit&&null!=curr_i.recipe_amount&&null!=curr_i.measure_type&&null!=curr_i.recipe_cost&&validIngre.push(curr_i)}curr_r.ingredients=validIngre},that.emailDetails=function(){var valid_recipe_exists=!1;if(that.model.item1.ingredients.length&&(valid_recipe_exists=!0),that.model.item2.ingredients.length&&(valid_recipe_exists=!0),that.model.item3.ingredients.length&&(valid_recipe_exists=!0),!valid_recipe_exists)return void alertService.showError("Please add at least one ingredient to any recipe.");var sendResults=function(){var m=JSON.parse(JSON.stringify(that.model));m.item1.ingredients.length&&that.removeInvalidIngredients(m.item1),m.item2.ingredients.length&&that.removeInvalidIngredients(m.item2),m.item3.ingredients.length&&that.removeInvalidIngredients(m.item3),that.api.send_free_calc_email(m).then(function(res,err){swal({title:"Emailed successfully!",text:"Please check your inbox.",showConfirmButton:!0,type:"success"},function(res){})})};that.model.user_email=null,$uibModal.open({templateUrl:"email_results.html",controller:modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",resolve:{user_email:function(){return that.model.user_email}}}).result.then(function(res){that.model.user_email=res.user_email,sendResults()})},that.$onInit=function(){}}var modalController=function($uibModalInstance,alertService,SweetAlert){var that=this;that.emailForm={},that.user_email=null,that.q_title="Please enter your email address",that.save=function(form){if(!form.$valid)return void(form.Email.$valid||SweetAlert.swal({title:"Error!",text:"Enter a valid email address with all lowercase letters.",type:"error",confirmButtonColor:"#ed5565",confirmButtonText:"OK"},function(res){}));$uibModalInstance.close({user_email:that.user_email})},that.cancel=function(){$uibModalInstance.dismiss("cancel")}};foodCalculatorController.$inject=["api","$state","auth","core","$uibModal","restaurant","alertService","SweetAlert"],angular.module("inspinia").component("foodCalculator",{templateUrl:"js/components/foodCalculator/foodCalculator.html",controller:foodCalculatorController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("foodCalculator",{url:"/foodCalculator",template:"<food-calculator></food-calculator>",data:{pageTitle:" Food Calculator"}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("food.orderSummary",{url:"/order-summary",template:"<order-summary-component></order-summary-component>",data:{pageTitle:"Alcohol Order Summary"}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("foodSetup.addPosHere",{url:"/add_pos_here/:pos_id",template:"<add-pos-here-component></add-pos-here-component>",data:{pageTitle:"Add POS Here"}})})}(),function(){"use strict";function deliverySetupController(api,$state,auth,localStorageService,$uibModal,core,alertService,SweetAlert,$rootScope,restaurant){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.form={},that.api=api,that.core=core,that.auth=auth,that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),restaurant.data.info&&(that.isCompleted=restaurant.data.info.is_setup_completed),$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions,that.isCompleted=restaurant.data.info.is_setup_completed}),that.sub_type=restaurant.data.info.subscription_type_id;for(var i in restaurant.data.info.employees)restaurant.data.info.employees[i].id==auth.authentication.user.id&&(that.emp_id=restaurant.data.info.employees[i].type_ids);that.showInfo=function(){$uibModal.open({animation:!0,templateUrl:"quick_tutorial.html",controller:qt,controllerAs:"qt",windowClass:"animated fadeIn modal-lgg",size:"lg"})},that.getAllDeliveries=function(){that.api.delivery_schedules({inventory_type_id:1}).then(function(res){try{that.deliveries=res.data.data.delivery_schedules_list;for(var c in that.categories)if("Non Alcoholic"!=that.categories[c].category){var found_d=!1;for(var d in that.deliveries)if(that.deliveries[d].vendor_category_id==that.categories[c].id){found_d=!0;break}found_d||that.deliveries.push({category:that.categories[c].category,vendor_category_id:that.categories[c].id,is_on_sunday:0,is_on_monday:0,is_on_tuesday:0,is_on_wednesday:0,is_on_thursday:0,is_on_friday:0,is_on_saturday:0})}}catch(e){}})},that.saveAllDeliveries=function(form){if(form.$valid){var m={inventory_type_id:1,deliveries:[]};for(var d in that.deliveries)m.deliveries.push(that.deliveries[d]);that.api.save_delivery(m).then(function(res){try{1e3===res.data.data.code&&(alertService.showAlertSave(),that.getAllDeliveries())}catch(e){alertService.showError("Something went wrong!"),console.log(e)}})}},that.$onInit=function(){Promise.all([api.get_vendors_categories({is_restaurant_used_only:1,inventory_type_id:1})]).then(function(response){that.categories=response[0].data.data.categories,that.getAllDeliveries()})}}var qt=function($uibModalInstance){var that=this;that.q_title="Order Schedule Instructions",that.q_texts='<article style="display: block;"><p><b>Order schedule</b>  For users who upgrade to our Machine Learning you can tell Artecsan what days you like to order and which category of items. On those designated days Artecsan will make a suggestion of what items to order and how much. Just select the vendor name, category and the days you prefer to generate your orders for each category.</p></article>',that.skip=function(){$uibModalInstance.dismiss("cancel")}};deliverySetupController.$inject=["api","$state","auth","localStorageService","$uibModal","core","alertService","SweetAlert","$rootScope","restaurant"],angular.module("inspinia").component("deliverySetupComponent",{templateUrl:"js/components/foodSetup/deliverySetup/deliverySetup.html",controller:deliverySetupController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("foodSetup.delivery",{url:"/delivery-setup",template:"<delivery-setup-component></delivery-setup-component>",data:{pageTitle:" Delivery Setup"}})})}(),function(){"use strict";function foodInventoryController(api,$state,auth,localStorageService,$uibModal,alertService,$rootScope,restaurant,core,$scope,SweetAlert,$q,$timeout){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;that.form={},that.api=api,that.auth=auth,that.get_vendors_categories=[],that.inventories=[],that.is_sug_aud=void 0!==$state.params.is_sug_aud&&""!=$state.params.is_sug_aud?$state.params.is_sug_aud:"false",that.pickers={beginDate:{open:!1,date:new Date},endDate:{open:!1,date:new Date},beginDateBackup:{open:!1,date:new Date}};var INVENTORIES=[];if(that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),that.model={vendor_category_id:null,measurement_units_of_delivery:function(id){for(var i=0;that.refbooks.measurement_units_of_delivery.length>i;i++)if(that.refbooks.measurement_units_of_delivery[i].id===id)return that.refbooks.measurement_units_of_delivery[i].name},inventory_item:null},that.showInfo=function(){$uibModal.open({animation:!0,templateUrl:"quick_tutorial.html",controller:qt,controllerAs:"qt",windowClass:"animated fadeIn modal-lgg",size:"lg"})},$scope.$on("$stateChangeStart",function(event,toState,toParams,fromState,fromParams,options){var toState=toState.name;_.isEqual(INVENTORIES,that.inventories)||(event.preventDefault(),SweetAlert.swal({title:"Save changes?",text:"Changes not been saved yet!",type:"warning",showCancelButton:!0,confirmButtonColor:"#337ab7",confirmButtonText:"Save"},function(res){res?that.saveAll(that.form,!0).then(function(){INVENTORIES=angular.copy(that.inventories),window.onbeforeunload=null,$state.go(toState)}):(INVENTORIES=angular.copy(that.inventories),window.onbeforeunload=null,$state.go(toState))}))}),that.finalSaveAudit=function(caller){if("suggested"==caller)that.api.get_audit_dates({RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:1}).then(function(res1){that.audit_dates=res1.data.data.Report,that.audit_dates_f=res1.data.data.Report.map(function(x){return{aud_title:x.audit_dates.substring(0,10)+" ("+x.type+" by "+x.audited_by_org+")",audit_dates:x.audit_dates.substring(0,10),src:x.src,type:x.type,is_suggested:x.is_suggested}});var adminFS=function(){var m={inventory_type_id:1,counting_started_at:(new Date).getTime(),counting_ended_at:(new Date).getTime(),is_final_save:1,is_adjustment:"suggested"==caller?1:0,send_email:"suggested"==caller,additional_notes:that.additional_notes,inventory_items:[],is_suggested:"true"==that.is_sug_aud?1:0};void 0!==that.prev_audit_date&&null!=that.prev_audit_date&&(m.prev_audit_date=that.prev_audit_date),null==m.additional_notes&&delete m.additional_notes,that.api.update_inventory_audit(m).then(function(res){try{1e3===res.data.data.code&&(alertService.showAlertSave(),$state.go("alcoholSubCategories"))}catch(e){console.log(e)}},function(){})};if("true"==that.is_sug_aud){var conf={title:"Are you sure?",text:"This will permanently update your on-hand count as of today. You will shortly receive a report on your email.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"};swal(conf,function(res){res&&(that.is_send_email=!0,that.audit_type="adjustment",that.additional_notes=null,that.prev_audit_date=that.audit_dates_f[1],adminFS())})}});else if("first_audit"==caller){var adminFS=function(){var m={inventory_type_id:2,counting_started_at:(new Date).getTime(),counting_ended_at:(new Date).getTime(),is_final_save:1,is_adjustment:0,send_email:!1,additional_notes:that.additional_notes,inventory_items:[],is_suggested:0};null==m.additional_notes&&delete m.additional_notes,that.api.update_inventory_audit(m).then(function(res){try{1e3===res.data.data.code&&(alertService.showAlertSave(),$state.go("alcoholSubCategories"))}catch(e){console.log(e)}},function(){})},conf={title:"Are you sure?",text:"This will permanently update your on-hand count as of today. You will shortly receive a report on your email.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"};swal(conf,function(res){res&&(that.additional_notes=null,adminFS())})}},that.calculateTotalUOD=function(item){var totalUnits=item.total_unit_size||0;return item.cases_qty*totalUnits+item.item_qty},that.calculatePartialOnChange=function(item,$index,form){$timeout(function(){return item.item_qty_ph=item.item_qty_ph?item.item_qty_ph.replace(/[^\+^\d((,|\.)\d)?]+/g,""):null},500);var item_qty=item.item_qty_ph?item.item_qty_ph:0;item_qty&&(that.inventories[$index].item_qty_formula=item.item_qty_ph.replace(/[^\d((,|\.)\d)?]+/g,"+").replace(/^\D*|\D*$/g,""),that.itemQtyStr=item_qty.match(/\d+((,|\.)\d+)?/g).reduce(function(previousValue,currentValue,index,array){return 1*previousValue+1*currentValue})),item.itemQtyStrlabel=that.itemQtyStr?that.itemQtyStr:item.item_qty_ph},that.calculatePartialTotal=function(item,$index){var item_qty=item.item_qty_ph?item.item_qty_ph:null;if(!item_qty)return void(that.itemQtyStr=null);that.itemQtyStr=item_qty.match(/\d+((,|\.)\d+)?/g).reduce(function(previousValue,currentValue,index,array){return 1*previousValue+1*currentValue}),that.inventories[$index].item_qty_ph=that.itemQtyStr},that.calculatePartialOnFocus=function(item,$index){that.inventories[$index].item_qty_ph=that.inventories[$index].item_qty_formula?that.inventories[$index].item_qty_formula:that.inventories[$index].item_qty_ph},that.mergeItems=function(){for(var i=0;i<that.inventories.length;i++)null==that.inventories[i].substitute_for&&(that.inventories[i].show=1)},that.getCombinedStringForLocation=function(item,key){var ph_key="full_values"==key?"cases_qty_ph":"item_qty_ph";if(null==item[ph_key]||""==item[key])return"";var x=null==item[key]?"":item[key].split("+").filter(function(xi){return xi.split("_")[1]!=that.selected_location_bu}).join("+");return null!=item[ph_key]&&""!=item[ph_key]&&(x+=(""==x?"":"+")+item[ph_key]+"_"+that.selected_location_bu),x},that._computeTotalByString=function(st){return st?st.split("+").filter(function(item){return""!==(item=item.split("_")[0])}).map(function(entry){return parseFloat(entry)}).reduce(function(pV,cV){return pV+cV},0):0},that.filterLocationData=function(){for(var deferred=$q.defer(),i=0;i<that.inventories.length;i++){if(null!=that.inventories[i].full_values){var st=that.inventories[i].full_values,nums=st.split("+").filter(function(item){return item.split("_")[1]==that.selected_location&&""!==(item=item.split("_")[0])}).map(function(entry){return parseFloat(entry)});nums=nums.reduce(function(pV,cV){return pV+cV},0),that.inventories[i].full_values=that.inventories[i].full_values.split("+").filter(function(item){return item.split("_")[1]!=that.selected_location}).join("+"),that.inventories[i].full_values+="+"+nums+"_"+that.selected_location,that.inventories[i].cases_qty_ph=nums}else that.inventories[i].cases_qty_ph=0;if(null!=that.inventories[i].partial_values){var st=that.inventories[i].partial_values,nums=st.split("+").filter(function(item){return item.split("_")[1]==that.selected_location&&""!==(item=item.split("_")[0])}).map(function(entry){return parseFloat(entry)});nums=nums.reduce(function(pV,cV){return pV+cV},0),that.inventories[i].partial_values=that.inventories[i].partial_values.split("+").filter(function(item){return item.split("_")[1]!=that.selected_location}).join("+"),that.inventories[i].partial_values+="+"+nums+"_"+that.selected_location,that.inventories[i].item_qty_ph=nums}else that.inventories[i].item_qty_ph=0}return deferred.resolve(),deferred.promise},that.changeMode=function(){$state.go("recipeAudit")},that.getInventoriesCaller=function(categoryId,categoryOldId){_.isEqual(INVENTORIES,that.inventories)?that.getInventories(that.model.vendor_category_id):SweetAlert.swal({title:"Save progress?",text:"You may lose any unsaved changes!",type:"warning",showCancelButton:!0,cancelButtonText:"Disard and Continue",confirmButtonColor:"#337ab7",confirmButtonText:"Save"},function(res){res?that.saveAll(that.form,!0).then(function(){that.getInventories(that.model.vendor_category_id)}):that.getInventories(that.model.vendor_category_id)})},that.getInventories=function(categoryId,categoryOldId){that.loading=!0;var m={is_adjustment:0,inventory_type_id:1,vendor_cat_id:"all"==categoryId.id?null:categoryId.id,inventory_item:that.model.inventory_item,audit_start_TS:!0,suggested:that.is_sug_aud};that.api.get_inventory_audit(m).then(function(res){that.inventories=JSON.parse(JSON.stringify(res.data.data.inventory)),that.pickers.beginDate.date=void 0!==res.data.data.audit_start&&null!=res.data.data.audit_start[0].audit_start?new Date(res.data.data.audit_start[0].audit_start):new Date,that.pickers.beginDateBackup.date=JSON.parse(JSON.stringify(that.pickers.beginDate.date)),that.mergeItems(),that.selected_location_bu=JSON.parse(JSON.stringify(that.selected_location)),that.filterLocationData().then(function(res){INVENTORIES=JSON.parse(JSON.stringify(that.inventories)),that.loading=!1})})},that.saveCount=function(form,is_search){var deferred=$q.defer();if(form.inventory.$valid&&that.pickers.beginDate.date&&that.pickers.endDate.date){for(var m={inventory_type_id:1,counting_started_at:new Date(that.pickers.beginDate.date).getTime(),counting_ended_at:(new Date).getTime(),is_final_save:0,is_adjustment:0,inventory_items:[],is_suggested:"true"==that.is_sug_aud?1:0},i=0;that.inventories.length>i;i++)null===that.inventories[i].item_qty_ph&&null===that.inventories[i].cases_qty_ph||(that.inventories[i].full_values=that.getCombinedStringForLocation(that.inventories[i],"full_values"),that.inventories[i].partial_values=that.getCombinedStringForLocation(that.inventories[i],"partial_values"),that.inventories[i].cases_qty=that._computeTotalByString(that.inventories[i].full_values)||0,that.inventories[i].item_qty=that._computeTotalByString(that.inventories[i].partial_values)||0,m.inventory_items.push({id:that.inventories[i].id,vendor_sku_id:that.inventories[i].vendor_sku_id,item_qty:that.inventories[i].item_qty,cases_qty:that.inventories[i].cases_qty,nof_bottles:0,packs_qty:0,total_in_uom_of_delivery:that.calculateTotalUOD(that.inventories[i]),item_qty_formula:null,full_values:that.inventories[i].full_values,partial_values:that.inventories[i].partial_values}));return that.api.update_inventory_audit(m).then(function(res){try{1e3===res.data.data.code&&(is_search||alertService.showAlertSave(),deferred.resolve())}catch(e){console.log(e),deferred.reject()}},function(){deferred.reject()}),deferred.promise}},that.saveAll=function(form,is_search){if(!(that.inventories.length<1)){if(is_search)return that.saveCount(form,is_search);SweetAlert.swal({title:"Save?",text:"This will save this as a draft.",type:"warning",showCancelButton:!0,confirmButtonColor:"#337ab7",confirmButtonText:"OK"},function(res){if(res)return that.saveCount(form,is_search)})}},that.deleteCurrentInventoryAudit=function(){SweetAlert.swal({title:"Are you sure?",text:"This will completely delete the saved Audit for this restaurant and you will have to startover!",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){res&&that.api.delete_inventory_audit(1,that.is_sug_aud).then(function(res1){res&&(SweetAlert.swal("Deleted!","Please proceed to startover a new audit.","success"),$state.go("foodSubCategories"))})})},that.changeAuditDate=function(){that.api.get_audit_dates({RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:1}).then(function(res1){that.audit_dates=res1.data.data.Report;var valid_date=!0;if(that.pickers.beginDate.date>new Date)SweetAlert.swal({title:"Error!",text:"Audit date cannot be greater than now!",type:"error",confirmButtonColor:"#ed5565",confirmButtonText:"OK"},function(res){}),that.pickers.beginDate.date=new Date(that.pickers.beginDateBackup.date),valid_date=!1;else if(that.audit_dates.length>1){var prev_aud=null;prev_aud="history"==that.audit_dates[0].src?that.audit_dates[0].audit_dates:that.audit_dates[1].audit_dates,that.pickers.beginDate.date<=new Date(prev_aud)&&(SweetAlert.swal({title:"Error!",text:"Audit date cannot be less than or equal to the previous audit!",type:"error",confirmButtonColor:"#ed5565",confirmButtonText:"OK"},function(res){}),that.pickers.beginDate.date=new Date(that.pickers.beginDateBackup.date),valid_date=!1)}valid_date&&SweetAlert.swal({title:"Are you sure?",text:"Are you sure you want to change the audit date? This change could affect multiple reports.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){res&&that.api.set_audit_date({inventory_type_id:1,audit_date:new Date(that.pickers.beginDate.date).getTime()}).then(function(res1){SweetAlert.swal("Audit Date Updated!","","success")})})})},that.openCalendar=function(e,picker){that.pickers[picker].open=!0},that.getBatches=function(){var deferred=$q.defer();if("all"==that.model.vendor_category_id.id){var m={is_adjustment:0,inventory_type_id:1,recipe_type_id:null,inventory_item:null};that.api.get_recipe_audit(m).then(function(res){res&&(that.batches=res.data.data.inventory),deferred.resolve()})}else deferred.resolve();return deferred.promise},that.generatePDFCall=function(){that.batches=[],that.getBatches().then(function(res){that.generatePDF()})},that.generatePDF=function(){$scope.print_loading=!0,swal({title:"",text:"Printing...",imageUrl:"https://www.boasnotas.com/img/loading2.gif",showConfirmButton:!1});var r_type="Food",content_data=[{text:restaurant.data.info.restaurant_name,style:"title"},{text:r_type+" Audit Sheet",style:"subheader"}];content_data.push({text:"Audit Date: ____/____/____",style:"audit_date"}),content_data.push({text:" ",style:"audit_date"}),content_data.push({text:"Audited By: ______________",style:"audit_date"}),content_data.push({table:{widths:["*"],body:[[" "],[" "]]},layout:{hLineWidth:function(i,node){return 0===i||i===node.table.body.length?0:2},vLineWidth:function(i,node){return 0}}}),content_data.push({text:"Category: "+that.model.vendor_category_id.category,style:"category"});var table_body_data=[];table_body_data.push([{text:"Vendor",style:"tableHeader",fillColor:"#eeeeee"},{text:"Category",style:"tableHeader",fillColor:"#eeeeee"},{text:"Inventory Item",style:"tableHeader",fillColor:"#eeeeee"},{text:"Cases",style:"tableHeader",fillColor:"#eeeeee"},{text:"Partial",style:"tableHeader",fillColor:"#eeeeee"},{text:"Partial",style:"tableHeader",fillColor:"#eeeeee"},{text:"Partial",style:"tableHeader",fillColor:"#eeeeee"},{text:"Unit of Delivery",style:"tableHeader",fillColor:"#eeeeee"}]);for(var i=0;i<that.inventories.length;i++)1==that.inventories[i].show&&table_body_data.push([{text:that.inventories[i].vendor_name,style:"tableContentNoCenter"},{text:that.inventories[i].category,style:"tableContent"},{text:that.inventories[i].inventory_item+" (Case size: "+that.inventories[i].total_unit_size+" "+that.model.measurement_units_of_delivery(that.inventories[i].uom_id_of_delivery_unit)+")",style:"tableContent"},{text:" ",style:"tableContent"},{text:" ",style:"tableContent"},{text:" ",style:"tableContent"},{text:" ",style:"tableContent"},{text:that.model.measurement_units_of_delivery(that.inventories[i].uom_id_of_delivery_unit),style:"tableContent"}]);if(content_data.push({style:"tableExample",table:{heights:25,widths:[95,45,"*",40,40,40,40,32],headerRows:1,dontBreakRows:!0,body:table_body_data},layout:{hLineWidth:function(i,node){return 1},vLineWidth:function(i,node){return 1},hLineColor:function(i,node){return"gray"},vLineColor:function(i,node){return"gray"}}}),that.batches.length){content_data.push({text:"Category: Batches",style:"category"});var b_table_body_data=[];b_table_body_data.push([{text:"Batch Description",style:"tableHeader",fillColor:"#eeeeee"},{text:"Full",style:"tableHeader",fillColor:"#eeeeee"},{text:"Partial",style:"tableHeader",fillColor:"#eeeeee"},{text:"Partial",style:"tableHeader",fillColor:"#eeeeee"},{text:"Partial",style:"tableHeader",fillColor:"#eeeeee"},{text:"Total Servings (Oz)",style:"tableHeader",fillColor:"#eeeeee"}]);for(var i=0;i<that.batches.length;i++)b_table_body_data.push([{text:that.batches[i].recipe_name,style:"tableContent"},{text:" ",style:"tableContent"},{text:" ",style:"tableContent"},{text:" ",style:"tableContent"},{text:" ",style:"tableContent"},{text:that.batches[i].servings,style:"tableContent"}]);content_data.push({style:"tableExample",table:{heights:25,widths:["*",40,40,40,40,32],headerRows:1,dontBreakRows:!0,body:b_table_body_data},layout:{hLineWidth:function(i,node){return 1},vLineWidth:function(i,node){return 1},hLineColor:function(i,node){return"gray"},vLineColor:function(i,node){return"gray"}}})}content_data.push({text:"----- End of "+r_type+" Audit Sheet -----",style:"end_of_report"});var docDefinition={pageSize:"A4",header:function(currentPage,pageCount){return[{text:currentPage.toString()+" of "+pageCount,style:["header","pg_no"]}]},footer:{text:"Powered by Skrible - www.getskrible.com",style:"footer"},content:content_data,styles:{pg_no:{fontSize:8},header:{margin:[0,10,10,0],alignment:"right"},title:{fontSize:14,bold:!0,margin:[0,0,0,0],alignment:"center"},subheader:{fontSize:12,bold:!0,margin:[0,0,0,0],alignment:"center"},audit_date:{fontSize:11,bold:!0,margin:[0,0,0,0],alignment:"right"},summaryTableHeader:{bold:!1,fontSize:10,color:"black",alignment:"center"},summaryTableContentNoCenter:{bold:!1,fontSize:9,color:"black"},summaryTableContent:{bold:!1,fontSize:9,color:"black",alignment:"center"},category:{fontSize:11,bold:!0,margin:[-10,0,0,0]},tableExample:{margin:[-10,5,-10,15]},tableHeader:{bold:!1,fontSize:9,color:"black",alignment:"center"},tableContentNoCenter:{bold:!1,fontSize:9,color:"black"},tableContent:{bold:!1,fontSize:9,color:"black",alignment:"center"},end_of_report:{fontSize:12,bold:!1,margin:[0,30,0,0],alignment:"center"},footer:{fontSize:8,margin:[0,5,0,0],alignment:"center"}},defaultStyle:{font:"Roboto",bold:"Roboto-Bold"}};pdfMake.fonts={Roboto:{normal:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Regular.ttf",bold:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Medium.ttf",italics:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Italic.ttf",bolditalics:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-MediumItalic.ttf"}},pdfMake.createPdf(docDefinition).download("Audit_Sheet.pdf"),$scope.print_loading=!1,swal.close()},that.changeLocation=function(){-1==that.selected_location?(that.selected_location=that.locations[0].sr_no,$uibModal.open({templateUrl:"js/components/foodSetup/tabletEntry/locationEntry.html",controller:"addEditFoodLocationsController",windowClass:"animated fadeIn",controllerAs:"$ctr",size:"md",resolve:{locations:function(){return that.locations.filter(function(x){return-1!=x.sr_no})},restaurant_id:function(){return that.restaurant_id.restaurant_id}}}).closed.then(function(){that.getLocations(),that.getInventories(that.model.vendor_category_id)})):that.getInventoriesCaller(that.model.vendor_category_id)},that.getLocations=function(){var headers={restaurant_id:that.restaurant_id.restaurant_id,inventory_type_id:1,active_only:1};that.api.get_restaurant_audit_locations(headers).then(function(res){that.locations=res.data.data.Report,that.locations.push({sr_no:-1,location_name:"-- Add/Edit Locations --"}),that.selected_location=that.locations[0].sr_no})},that.init=function(){Promise.all([core.getRefbooks(),api.get_vendors_categories({is_restaurant_used_only:1,inventory_type_id:1}),that.getLocations()]).then(function(response){that.SetUpStatus=restaurant.data.info.is_setup_completed,that.refbooks=response[0],that.get_vendors_categories=response[1].data.data.categories,that.get_vendors_categories.unshift({id:"all",category:"All Items"}),that.model.vendor_category_id=that.get_vendors_categories[0],that.getInventories(that.model.vendor_category_id)})},that.init()}var qt=function($uibModalInstance){var that=this;that.q_title="Food Inventory Audit Pad Instructions",that.q_texts='<article style="display: block;"><p><b>Audit</b> - This is the final step in your setup process. In order to start your reporting we must first know exactly how much inventory you have on-hand. For food inventory counts all items are weighed or counted based on unit of delivery which is noted next to each item. For example  steaks are typically delivered in lbs therefore you weigh any unpackaged steaks in lbs. Vegetables might be delivered in ounces therefore you would weigh any unpackaged vegetables in ounces. Watermelons might be delivered in units therefore you would count the units.<br/><br/>The save button on Full Audit pad allows you to save your work and complete it later.<br/><br/>Final Save is final and cannot be changed<br/><br/>Note: BE SURE THAT THE BEGINNING DATE IS THE ACTUAL DATE YOU COUNTED. IF THE BEGINNING DATE IS ENTERED INCORRECTLY THEN ALL OF YOUR RESULTS WILL BE INCORRECT.</p></article>',that.skip=function(){$uibModalInstance.dismiss("cancel")}};foodInventoryController.$inject=["api","$state","auth","localStorageService","$uibModal","alertService","$rootScope","restaurant","core","$scope","SweetAlert","$q","$timeout"],angular.module("inspinia").component("foodInventoryComponent",{templateUrl:"js/components/foodSetup/foodInventory/foodInventory.html",controller:foodInventoryController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("foodSetup.foodInventory",{url:"/inventory/:is_sug_aud",template:"<food-inventory-component></food-inventory-component>",data:{pageTitle:" Food Inventory Audit Pad"},resolve:{refbooks:function(core){return core.getRefbooks().then(function(res){return res})}}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("foodSetup",{url:"/food",data:{pageTitle:" Food Setup"},abstract:!0,template:"<ui-view></ui-view>",resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]}])}}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("foodSetup.inventoryComplete",{url:"/inventory-complete",templateUrl:"js/components/foodSetup/inventoryComplete/inventoryComplete.html",data:{pageTitle:"Inventory Complete"}})})}(),function(){"use strict";function inventoryMergeController(api,$state,auth,localStorageService,alertService,SweetAlert,$rootScope,restaurant,$uibModal,core,$scope,$q){
if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.form={},that.api=api,that.auth=auth,that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.inventoryList=[],that.vendors=[],that.currentVendor=null,that.searchModel={order_by:"item_name",order_way:"ASC",inRequest:!1,paginationTotal:0,city:null,item_name:null,sub_category:null,vendor_sku:null,filter:"any",category:null},restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),that.showInfo=function(){$uibModal.open({animation:!0,templateUrl:"quick_tutorial.html",controller:qt,controllerAs:"qt",windowClass:"animated fadeIn modal-lgg",size:"lg"})},that.chkIfSubSelected=function($index){for(var e_type=0,parent_name="",child_list=[],i=0;that.inventoryList.length>i;i++)if(that.inventoryList[i].id==that.inventoryList[$index].substitute_for&&null!=that.inventoryList[i].substitute_for){e_type=1,child_list.push(that.inventoryList[i]),that.inventoryList[$index].substitute_for=null;break}if(0==e_type)for(var i=0;that.inventoryItemsForSubCheck.length>i;i++)that.inventoryList[$index].id==that.inventoryItemsForSubCheck[i].substitute_for&&(e_type=2,parent_name=that.inventoryList[$index].item_name,child_list.push(that.inventoryItemsForSubCheck[i]),that.inventoryList[$index].substitute_for=null);if(0==e_type)for(var i=0;i<that.inventoryItems.length;i++)if(that.inventoryList[$index].substitute_for==that.inventoryItems[i].id){10==that.inventoryList[$index].uom_id_of_delivery_unit||11==that.inventoryList[$index].uom_id_of_delivery_unit||12==that.inventoryList[$index].uom_id_of_delivery_unit||13==that.inventoryList[$index].uom_id_of_delivery_unit||16==that.inventoryList[$index].uom_id_of_delivery_unit||17==that.inventoryList[$index].uom_id_of_delivery_unit||18==that.inventoryList[$index].uom_id_of_delivery_unit?10!=that.inventoryItems[i].uom_id_of_delivery_unit&&11!=that.inventoryItems[i].uom_id_of_delivery_unit&&12!=that.inventoryItems[i].uom_id_of_delivery_unit&&13!=that.inventoryItems[i].uom_id_of_delivery_unit&&16!=that.inventoryItems[i].uom_id_of_delivery_unit&&17!=that.inventoryItems[i].uom_id_of_delivery_unit&&18!=that.inventoryItems[i].uom_id_of_delivery_unit&&(e_type=3,that.inventoryList[$index].substitute_for=null):10!=that.inventoryItems[i].uom_id_of_delivery_unit&&11!=that.inventoryItems[i].uom_id_of_delivery_unit&&12!=that.inventoryItems[i].uom_id_of_delivery_unit&&13!=that.inventoryItems[i].uom_id_of_delivery_unit&&16!=that.inventoryItems[i].uom_id_of_delivery_unit&&17!=that.inventoryItems[i].uom_id_of_delivery_unit&&18!=that.inventoryItems[i].uom_id_of_delivery_unit||(e_type=3,that.inventoryList[$index].substitute_for=null);break}1==e_type?swal({title:"Error! "+child_list.map(function(x){return x.item_name}).join("\n")+" is already a substitute item.",type:"error"}):2==e_type?swal({title:"Error! "+parent_name+" is already a primary item of the following.",text:child_list.map(function(x){return x.vendor_name+" - "+x.item_name+" - "+(1==x.is_used?"(Active)":"(Inactive)")}).join("\n"),type:"error"}):3==e_type&&swal({title:"Error! Delivery types of the items are incompatible.",type:"error"})},that.filterItems=function(id,cat_id){if(!cat_id)return[];for(var _a=[],i=0;i<that.inventoryItems.length;i++)that.inventoryItems[i].id!=id&&that.inventoryItems[i].vendor_cat_id==cat_id&&_a.push(that.inventoryItems[i]);if(_a.length){var first=JSON.stringify(_a[0]);_a.unshift(JSON.parse(first)),_a[0].id=null,_a[0].vendor_name="--No selection--",_a[0].item_name="--No selection--"}return _a},that.actInactItem=function(inventory){var id=that.restaurant_id.restaurant_id,m={vendor_id:that.currentVendor.id,sku_id:inventory.id,is_active:"active"==that.activate_mode?0:1,inventory_type_id:1,action:"update"};that.api.add_inventory(id,m).then(function(res){try{1e3===res.data.data.code?swal({title:"Updated!",timer:1500,showConfirmButton:!1,type:"success"}):2079===res.data.data.code.code?swal({title:"Can't perform this action as this item is attached to the following recipes. To make this item inactive you must first visit the recipe screen and either replace the item in the recipe or make the recipe(s) inactive.",text:""+res.data.data.code.res_data.map(function(x){return x.recipe_name+""}).join("\n"),type:"error"}):2081!==res.data.data.code.code&&2082!==res.data.data.code.code||swal({title:"Cannot perform this action as this is a primary item of the below listed items. To make this item inactive you will need to either remove the attached items or make the attached items inactive.",text:""+res.data.data.code.res_data.map(function(x){return x.child_name}).join("\n"),type:"error"}),that.search(!1,!1)}catch(e){console.log(e)}})},that.deleteItem=function(inventory){var id=that.restaurant_id.restaurant_id,m={vendor_id:that.currentVendor.id,sku_id:inventory.id,is_active:0,inventory_type_id:1,action:"delete"};that.api.add_inventory(id,m).then(function(res){try{1e3===res.data.data.code?swal({title:"Updated!",timer:1500,showConfirmButton:!1,type:"success"}):2080===res.data.data.code?swal({title:"This item has historical data and therefore cannot be deleted. You may instead, make this item inactive.",type:"error"}):2079===res.data.data.code.code?swal({title:"Can't perform this action as this item is attached to the following recipes. To make this item inactive you must first visit the recipe screen and either replace the item in the recipe or make the recipe(s) inactive.",text:""+res.data.data.code.res_data.map(function(x){return x.menu_item_name+" ("+x.pricing_level+")"}).join("\n"),type:"error"}):2081!==res.data.data.code.code&&2082!==res.data.data.code.code||swal({title:"Cannot perform this action as this is a primary item of the below listed items. To make this item inactive you will need to either remove the attached items or make the attached items inactive.",text:""+res.data.data.code.res_data.map(function(x){return x.child_name}).join("\n"),type:"error"}),that.search(!1,!1)}catch(e){console.log(e)}})},that.submit=function($index){var deferred=$q.defer(),id=that.currentVendor.id,m={inventory_type_id:1,sku_items:[]};return m.sku_items.push({substitute_for:that.inventoryList[$index].substitute_for?that.inventoryList[$index].substitute_for:null,item_name:that.inventoryList[$index].item_name,tare_type_id:that.inventoryList[$index].tare_type_id,size:that.inventoryList[$index].content_weight||that.inventoryList[$index].size||1,content_weight:that.inventoryList[$index].content_weight||that.inventoryList[$index].size||1,full_weight:that.inventoryList[$index].full_weight,tare_weight:that.inventoryList[$index].tare_weight,total_unit_size:that.inventoryList[$index].case_qty*that.inventoryList[$index].pack*(that.inventoryList[$index].content_weight||that.inventoryList[$index].size||1),manufacturer:that.inventoryList[$index].manufacturer,vendor_sku:that.inventoryList[$index].vendor_sku,case_qty:that.inventoryList[$index].case_qty,pack:that.inventoryList[$index].pack,price:that.inventoryList[$index].case_cost,vendor_cat_id:that.inventoryList[$index].vendor_cat_id,uom_id_of_delivery_unit:that.inventoryList[$index].uom_id_of_delivery_unit,vendor_sub_cat_id:that.inventoryList[$index].vendor_sub_cat_id,is_active:that.inventoryList[$index].is_active,minimum_order_type:that.inventoryList[$index].minimum_order_type,id:that.inventoryList[$index].id}),that.api.add_update_own_inventory(id,m).then(function(res){1e3===res.data.data.code&&alertService.showAlertSave(),Promise.all([that.getItemsForSubCheck()]).then(function(response){deferred.resolve()})}),deferred.promise},that.changeAction=function(){"merge"==that.mode?getMergeModeData(!1):(that.activate_mode="active",getActivateModeData(!1))},that.selectActiveInactive=function(){that.search(!1,!1)},that.selectVendor=function(vendor){that.currentVendor=vendor,that.search(!1,!0)},that.search=function(is_category_change,is_vendor_change,keyword){that.inventoryList=[],that.loading=!0,that.searchModel.inRequest=!0;var m={order_by:that.searchModel.order_by,order_way:that.searchModel.order_way,paginationOffset:that.searchModel.paginationOffset,paginationCount:that.searchModel.paginationCount,city:that.searchModel.city,item_name:that.searchModel.item_name,sub_category:that.searchModel.sub_category,vendor_sku:that.searchModel.vendor_sku,filter:that.searchModel.filter,category:is_category_change?that.searchModel.category:null,inventory_type_id:1};for(var i in m)m[i]||delete m[i];keyword&&(m.paginationOffset=0,that.searchModel.order_by==keyword?(that.searchModel.order_way="ASC"==m.order_way?"DESC":"ASC",m.order_way="ASC"==m.order_way?"DESC":"ASC"):(that.searchModel.order_by=keyword,m.order_by=keyword)),m.paginationOffset>0&&!keyword&&(m.paginationOffset=(m.paginationOffset-1)*m.paginationCount),api.get_inventory_by_vendor(m,that.currentVendor.id).then(function(res){that.loading=!1,that.searchModel.inRequest=!1;try{if(that.searchModel.paginationTotal=res.data.data.total,is_category_change)that.inventoryList=res.data.data.sku;else{that.inventoryListAll=res.data.data.sku;var temp_cats=that.inventoryListAll.map(function(x){return x.category}),c_set=new Set(temp_cats);that.SKU_categories=Array.from(c_set),that.searchModel.category=is_vendor_change?that.SKU_categories[0]:null==that.searchModel.category?that.SKU_categories[0]:that.searchModel.category,that.inventoryList=that.inventoryListAll.filter(function(x){return x.category==that.searchModel.category})}"activate"==that.mode?that.inventoryList=that.inventoryList.filter(function(x){return x.is_used==("active"==that.activate_mode?1:0)}):that.inventoryList=that.inventoryList.filter(function(x){return 1==x.is_used})}catch(e){console.log(e)}},function(){that.searchModel.inRequest=!1})},that.getVendorList=function(){var deferred=$q.defer();return that.api.get_chosen_vendors(that.restaurant_id.restaurant_id,{vendor_type_id:1}).then(function(res){try{if(that.vendors=res.data.data.vendors,!that.vendors.length)return void $state.go("foodSetup.vendor");that.currentVendor=that.vendors[0]}catch(e){console.log(e)}deferred.resolve()}),deferred.promise},that.getItemsForSubCheck=function(){var deferred=$q.defer();return that.api.get_active_inventory_by_vendor({inventory_type_id:1,caller:"sub_list"},that.restaurant_id.restaurant_id).then(function(res){that.inventoryItemsForSubCheck=res.data.data.sku,that.inventoryItems=JSON.parse(JSON.stringify(that.inventoryItemsForSubCheck)),that.inventoryItems=that.inventoryItems.filter(function(x){return null==x.substitute_for}),deferred.resolve()}),deferred.promise};var getMergeModeData=function(is_category_change){Promise.all([that.getItemsForSubCheck(),that.getVendorList()]).then(function(response){that.search(is_category_change,!0)})},getActivateModeData=function(is_category_change){Promise.all([that.getVendorList()]).then(function(response){that.search(is_category_change,!0)})};that.$onInit=function(){that.mode="merge",getMergeModeData(!1)}}var qt=function($uibModalInstance){var that=this;that.q_title="Merge/Edit/Delete Items Help",that.q_texts='<article style="display: block;"><p><b>Merge/Edit/Delete Items</b>  Please check out our instruction video <a href="https://youtu.be/C9oPlIVl4nI" target="_blank">here</a>.</li></ul></p></article>',that.skip=function(){$uibModalInstance.dismiss("cancel")}};inventoryMergeController.$inject=["api","$state","auth","localStorageService","alertService","SweetAlert","$rootScope","restaurant","$uibModal","core","$scope","$q"],angular.module("inspinia").component("foodInventoryMergeComponent",{templateUrl:"js/components/foodSetup/inventoryMerge/inventoryMerge.html",controller:inventoryMergeController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("foodSetup.inventoryMerge",{url:"/inventory-merge",template:"<food-inventory-merge-component></food-inventory-merge-component>",data:{pageTitle:" Inventory Merge"}})})}(),function(){"use strict";function addUniqueItemsController($uibModalInstance,alertService,api,core,searchParams,SweetAlert,$q){var that=this;that.form={},that.uniqueItem=[],that.searchParams=searchParams;var INVENTORIES=[],checkChanges=function(){return _.isEqual(INVENTORIES,JSON.parse(angular.toJson(that.uniqueItem)))};that.vendorsName=that.searchParams.vendors_name;for(var i=0;that.vendorsName.length>i;i++)1==that.vendorsName[i].is_selected&&(that.vendorsName=that.vendorsName[i].vendor_name);that.searchModel={order_by:"item_name",order_way:"ASC",paginationOffset:0,paginationCount:25,inRequest:!1,paginationTotal:0,city:null,item_name:null,sub_category:null,vendor_sku:null,filter:"own",category:null},that.categories=[],that.sub_categories=[],core.getRefbooks().then(function(res){that.deliveryMeasure=res.measurement_units_of_delivery,that.categories=res.vendor_cat,that.sub_categories=res.vendor_sub_cat}),that.api=api,that.model={},that.sku_lookup=function(search_for){return that.api.sku_lookup({search_for:search_for,vendor_id:that.searchParams.vendor_id}).then(function(res){return res.data.data.sku.slice(0,10)})},that.chkIfSubSelected=function($index){for(var e_type=0,parent_name="",child_list=[],i=0;that.uniqueItem.length>i;i++)if(that.uniqueItem[i].id==that.uniqueItem[$index].substitute_for&&null!=that.uniqueItem[i].substitute_for){e_type=1,child_list.push(that.uniqueItem[i]),that.uniqueItem[$index].substitute_for=null;break}if(0==e_type&&null!=that.uniqueItem[$index].id)for(var i=0;that.inventoryItemsForSubCheck.length>i;i++)that.uniqueItem[$index].id==that.inventoryItemsForSubCheck[i].substitute_for&&(e_type=2,parent_name=that.uniqueItem[$index].item_name,child_list.push(that.inventoryItemsForSubCheck[i]),that.uniqueItem[$index].substitute_for=null);if(0==e_type)for(var i=0;i<that.inventoryItems.length;i++)if(that.uniqueItem[$index].substitute_for==that.inventoryItems[i].id){10==that.uniqueItem[$index].uom_id_of_delivery_unit||11==that.uniqueItem[$index].uom_id_of_delivery_unit||12==that.uniqueItem[$index].uom_id_of_delivery_unit||13==that.uniqueItem[$index].uom_id_of_delivery_unit||16==that.uniqueItem[$index].uom_id_of_delivery_unit||17==that.uniqueItem[$index].uom_id_of_delivery_unit||18==that.uniqueItem[$index].uom_id_of_delivery_unit?10!=that.inventoryItems[i].uom_id_of_delivery_unit&&11!=that.inventoryItems[i].uom_id_of_delivery_unit&&12!=that.inventoryItems[i].uom_id_of_delivery_unit&&13!=that.inventoryItems[i].uom_id_of_delivery_unit&&16!=that.inventoryItems[i].uom_id_of_delivery_unit&&17!=that.inventoryItems[i].uom_id_of_delivery_unit&&18!=that.inventoryItems[i].uom_id_of_delivery_unit&&(e_type=3,that.uniqueItem[$index].substitute_for=null):10!=that.inventoryItems[i].uom_id_of_delivery_unit&&11!=that.inventoryItems[i].uom_id_of_delivery_unit&&12!=that.inventoryItems[i].uom_id_of_delivery_unit&&13!=that.inventoryItems[i].uom_id_of_delivery_unit&&16!=that.inventoryItems[i].uom_id_of_delivery_unit&&17!=that.inventoryItems[i].uom_id_of_delivery_unit&&18!=that.inventoryItems[i].uom_id_of_delivery_unit||(e_type=3,that.uniqueItem[$index].substitute_for=null);break}1==e_type?swal({title:"Error! "+child_list.map(function(x){return x.item_name}).join("\n")+" is already a substitute item.",type:"error"}):2==e_type?swal({title:"Error! "+parent_name+" is already a primary item of the following.",text:child_list.map(function(x){return x.vendor_name+" - "+x.item_name+" - "+(1==x.is_used?"(Active)":"(Inactive)")}).join("\n"),type:"error"}):3==e_type&&swal({title:"Error! Delivery types of the items are incompatible.",type:"error"})},that.submit=function(form,get_list){var deferred=$q.defer();if(!form.$valid)return alertService.showError("Please validate all inputs"),deferred.reject(),deferred.promise;if(!that.uniqueItem.length)return alertService.showError("Please, add at least one item"),deferred.reject(),deferred.promise;for(var id=that.searchParams.vendor_id,m={inventory_type_id:1,sku_items:[]},i=0;that.uniqueItem.length>i;i++)m.sku_items.push({substitute_for:that.uniqueItem[i].substitute_for?that.uniqueItem[i].substitute_for:null,vendor_sku:that.uniqueItem[i].vendor_sku,pack:that.uniqueItem[i].pack,size:that.uniqueItem[i].size,total_unit_size:that.uniqueItem[i].pack*that.uniqueItem[i].size,uom_id_of_delivery_unit:that.uniqueItem[i].uom_id_of_delivery_unit,brand:"No Brand",brand_id:1,item_name:that.uniqueItem[i].item_name,vendor_cat_id:that.uniqueItem[i].vendor_cat_id,vendor_sub_cat_id:that.uniqueItem[i].vendor_sub_cat_id,yield:1,price:that.uniqueItem[i].case_cost,minimum_order_type:that.uniqueItem[i].minimum_order_type,is_active:that.uniqueItem[i].is_active,id:that.uniqueItem[i].id});return that.api.add_update_own_inventory(id,m).then(function(res){1e3===res.data.data.code&&(alertService.showAlertSave(),deferred.resolve(),get_list&&that.search())}),deferred.promise},that.checkForUniqueSKU=function($index){for(var i=0;that.uniqueItem.length>i;i++)$index!=i&&that.uniqueItem[i].vendor_sku==that.uniqueItem[$index].vendor_sku&&(that.uniqueItem[$index].vendor_sku=null)},that.apply_values=function($index,$item){that.uniqueItem[$index].src=$item.src,that.uniqueItem[$index].vendor_sku=$item.vendor_sku,that.checkForUniqueSKU($index),that.uniqueItem[$index].item_name=$item.item_name,that.uniqueItem[$index].vendor_cat_id=$item.vendor_cat_id,that.uniqueItem[$index].vendor_sub_cat_id=$item.vendor_sub_cat_id,that.uniqueItem[$index].uom_id_of_delivery_unit=$item.uom_id_of_delivery_unit,that.uniqueItem[$index].pack=$item.pack,that.uniqueItem[$index].size=$item.size,that.uniqueItem[$index].case_cost=$item.case_cost,that.uniqueItem[$index].minimum_order_type=$item.minimum_order_type,that.uniqueItem[$index].substitute_for=$item.substitute_for},that.filterItems=function(id,cat_id){if(!cat_id)return[];for(var _a=[],i=0;i<that.inventoryItems.length;i++)that.inventoryItems[i].id!=id&&that.inventoryItems[i].vendor_cat_id==cat_id&&_a.push(that.inventoryItems[i]);if(_a.length){var first=JSON.stringify(_a[0]);_a.unshift(JSON.parse(first)),_a[0].id=null,_a[0].vendor_name="--No selection--",_a[0].item_name="--No selection--"}else _a.push({}),_a[0].id=null,_a[0].vendor_name="--No selection--",_a[0].item_name="--No selection--";return _a},that.addUniqueItem=function(){that.uniqueItem.push({src:"",vendor_sku:null,pack:null,uom_id_of_delivery_unit:null,brand:null,item_name:null,vendor_cat_id:that.categories.length?that.categories[0].id:null,vendor_sub_cat_id:that.sub_categories.length?that.sub_categories[0].id:null,is_active:1,size:null,case_cost:null,minimum_order_type:"Each",id:null,substitute_for:null,sub_dd_options:that.filterItems(null,that.categories.length?that.categories[0].id:null)})},that.removeUniqueItem=function($index,item){if(that.uniqueItem[$index].id){var vendor_id=that.searchParams.vendor_id;that.api.delete_my_sku(vendor_id,that.uniqueItem[$index].id).then(function(res){if(1e3===res.data.data.code){for(var i=0;that.uniqueItem.length>i;i++)if(item.id===that.uniqueItem[i].id){that.uniqueItem.splice(i,1);break}that.search()}})}else that.uniqueItem.splice($index,1)},that.search=function(keyword){that.api.get_active_inventory_by_vendor({inventory_type_id:1,caller:"sub_list"},that.searchParams.restaurant_id).then(function(res){that.inventoryItemsForSubCheck=res.data.data.sku,that.inventoryItems=JSON.parse(JSON.stringify(that.inventoryItemsForSubCheck)),that.inventoryItems=that.inventoryItems.filter(function(x){return null==x.substitute_for}),that.searchModel.inRequest=!0;var m={order_by:that.searchModel.order_by,order_way:that.searchModel.order_way,paginationOffset:that.searchModel.paginationOffset,paginationCount:that.searchModel.paginationCount,filter:that.searchModel.filter,inventory_type_id:1,city:that.searchModel.city,item_name:that.searchModel.item_name,sub_category:that.searchModel.sub_category,vendor_sku:that.searchModel.vendor_sku,category:that.searchModel.category};for(var i in m)null==m[i]&&delete m[i];keyword&&(m.paginationOffset=0,that.searchModel.order_by==keyword?(that.searchModel.order_way="ASC"==m.order_way?"DESC":"ASC",m.order_way="ASC"==m.order_way?"DESC":"ASC"):(that.searchModel.order_by=keyword,m.order_by=keyword)),m.paginationOffset>0&&!keyword&&(m.paginationOffset=(m.paginationOffset-1)*m.paginationCount);var vendorId=that.searchParams.vendor_id;that.api.get_inventory_by_vendor(m,vendorId).then(function(res){try{$(".modal").animate({scrollTop:0},200),that.uniqueItem=res.data.data.sku,that.searchModel.paginationTotal=res.data.data.total,INVENTORIES=angular.copy(that.uniqueItem),that.uniqueItem=that.uniqueItem.map(function(x){return x.sub_dd_options=that.filterItems(x.id,x.vendor_cat_id),x}),that.searchModel.inRequest=!1}catch(e){console.log(e),that.searchModel.inRequest=!1}},function(){that.searchModel.inRequest=!1})})},that.getMyItems=function(keyword){checkChanges()?that.search(keyword):SweetAlert.swal({title:"Save changes?",text:"Changes not been saved yet!",type:"warning",showCancelButton:!0,confirmButtonColor:"#337ab7",confirmButtonText:"Save"},function(res){res?(that.form.$setSubmitted(),that.submit(that.form).then(function(){that.search(keyword)})):that.search(keyword)})},that.getMyItems(),that.cancel=function(){checkChanges()?$uibModalInstance.dismiss("cancel"):SweetAlert.swal({title:"Save changes?",text:"Changes not been saved yet!",type:"warning",showCancelButton:!0,confirmButtonColor:"#337ab7",confirmButtonText:"Save"},function(res){res?(that.form.$setSubmitted(),that.submit(that.form).then(function(){$uibModalInstance.dismiss("cancel")})):$uibModalInstance.dismiss("cancel")})}}addUniqueItemsController.$inject=["$uibModalInstance","alertService","api","core","searchParams","SweetAlert","$q"],angular.module("inspinia").controller("addUniqueItemsController",addUniqueItemsController)}(),function(){"use strict";function inventorySetupController(api,$state,auth,localStorageService,SweetAlert,$rootScope,restaurant,$uibModal){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.form={},that.api=api,that.auth=auth,that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.inventoryList=[],that.vendors=[],that.inventoryListSelected=[],that.currentVendor=null,that.searchModel={order_by:"item_name",order_way:"ASC",paginationOffset:0,paginationCount:25,inRequest:!1,paginationTotal:0,city:null,item_name:null,sub_category:null,vendor_sku:null,filter:"any",category:null},restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),that.SetUpStatus=0,restaurant.data.info&&(that.SetUpStatus=restaurant.data.info.is_setup_completed),that.showInfo=function(){$uibModal.open({animation:!0,templateUrl:"quick_tutorial.html",controller:qt,controllerAs:"qt",windowClass:"animated fadeIn modal-lgg",size:"lg"})};var getInventoriesByVendor=function(){that.api.get_active_inventory_by_vendor({vendor_id:that.currentVendor.id,inventory_type_id:1},that.restaurant_id.restaurant_id).then(function(res){that.inventoryListSelected=res.data.data.sku})};that.search=function(keyword){that.searchModel.inRequest=!0;var m={order_by:that.searchModel.order_by,order_way:that.searchModel.order_way,paginationOffset:that.searchModel.paginationOffset,paginationCount:that.searchModel.paginationCount,city:that.searchModel.city,item_name:that.searchModel.item_name,sub_category:that.searchModel.sub_category,vendor_sku:that.searchModel.vendor_sku,filter:that.searchModel.filter,category:that.searchModel.category,inventory_type_id:1};for(var i in m)null==m[i]&&delete m[i];keyword&&(m.paginationOffset=0,that.searchModel.order_by==keyword?(that.searchModel.order_way="ASC"==m.order_way?"DESC":"ASC",m.order_way="ASC"==m.order_way?"DESC":"ASC"):(that.searchModel.order_by=keyword,m.order_by=keyword)),m.paginationOffset>0&&!keyword&&(m.paginationOffset=(m.paginationOffset-1)*m.paginationCount),api.get_inventory_by_vendor(m,that.currentVendor.id).then(function(res){try{that.inventoryList=res.data.data.sku,that.searchModel.paginationTotal=res.data.data.total}catch(e){console.log(e)}that.searchModel.inRequest=!1},function(){that.searchModel.inRequest=!1}),getInventoriesByVendor()},that.selectVendor=function(vendor){that.vendors.forEach(function(val,key){vendor.id==val.id?val.is_selected=!0:val.is_selected=!1}),that.currentVendor=vendor,that.search()};var getChosenVendors=function(){api.get_chosen_vendors(that.restaurant_id.restaurant_id,{vendor_type_id:1}).then(function(res){try{if(that.vendors=res.data.data.vendors,!that.vendors.length)return void $state.go("foodSetup.vendor");that.vendors[0].is_selected=!0,that.vendors[0].is_first=!0,that.vendors[that.vendors.length-1].is_last=!0,that.currentVendor=that.vendors[0],that.search()}catch(e){console.log(e)}})};that.addInventory=function(inventory){var id=that.restaurant_id.restaurant_id,m={vendor_id:that.currentVendor.id,sku_id:inventory.id,is_active:inventory.is_used,inventory_type_id:1,action:"update"};that.api.add_inventory(id,m).then(function(){getInventoriesByVendor(),that.search()})},that.deleteInventory=function(inventory){if(1==inventory.is_used_by_receipts)return void SweetAlert.swal({title:"",text:"You can not remove the inventory item, if he has any elements with historical data, or if the item is used in any recipe. Instead, you can disable inventory item, but first remove it from recipes in which it is used.",type:"warning",confirmButtonColor:"#DD6B55"});var id=that.restaurant_id.restaurant_id,m={vendor_id:that.currentVendor.id,sku_id:inventory.id,is_active:0,inventory_type_id:1,action:"delete"};that.api.add_inventory(id,m).then(function(){getInventoriesByVendor(),that.search()})},that.addUniqueItems=function(){$uibModal.open({templateUrl:"js/components/foodSetup/inventorySetup/addUniqueItems/addUniqueItems.html",controller:"addUniqueItemsController",windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",size:"lg2x",resolve:{searchParams:{vendor_id:that.currentVendor.id,restaurant_id:that.restaurant_id.restaurant_id,vendors_name:that.vendors}}}).result.then(function(result){that.search()},function(reason){that.search()})},that.back=function(){if(that.currentVendor.is_first)$state.go("foodSetup.vendor");else{for(var prevVendor,i=0;that.vendors.length>i;i++)that.vendors[i].is_selected&&(prevVendor=that.vendors[i-1]);that.selectVendor(prevVendor)}},that.next=function(){if(that.currentVendor.is_last)$state.go("foodSetup.recipe");else{for(var nextVendor,i=0;that.vendors.length>i;i++)that.vendors[i].is_selected&&(nextVendor=that.vendors[i+1]);that.selectVendor(nextVendor)}},that.$onInit=function(){getChosenVendors()}}var qt=function($uibModalInstance){var that=this;that.q_title="Inventory Setup Instructions",that.q_texts='<article style="display: block;"><p><b>Food Inventory Setup</b>  this is the page which you will use to add all of your inventory items for each vendor. This page will show all the vendors which you selected on the previous page. The vendor that you are working with at the moment will be highlighted in blue. If you selected a vendor that was already in the Artecsan database, that vendor may already have a database of items. If you added a new vendor, it will also mean that you have to add all of the vendor items as well.<br/><br/><b>Step 1:</b> Select the vendor which you want to work with. The vendor will be highlighted in Blue.<br/><br/><b>Step 2:</b> Select Modify/Add which will produce a popup screen which you can enter all of your vendor items into.<br/><br/><b>Step 3:</b> Select the + symbol in the right hand corner. This will open up the necessary fields to add your items.<br/><br/><b>Step 4:</b> Add the necessary details to the add/modify vendor fields. NOTE: We suggest acquiring a purchases list from your vendor which includes all of the needed information. Skrible can also import the data for you if its in excel or csv format and all of the fields are completed<ul><li><b>Sku</b>  this info will come from the vendor. Be sure to use the vendor sku and not the manufacturer sku. The vendor sku is how the vendor knows which items you really want. The difference between manufacturer sku and vendor sku is the manufacturer sku is generated by the maker of the product while the vendor sku is generated by the seller of the produce. Therefore you must use the vendor sku</li><li><b>Item Name</b>  you may enter the item name that works for you however we suggest duplicating the name that was provided by the vendor</li><li><b>Category</b>  categories are preset and as of now cannot be changed</li><li><b>Unit</b>  is the unit of metric in which the items are normally delivered. For example, meat is usually delivered in pounds while eggs are usually delivered in dozens</li><li><b>Pack</b>  Is the number of packs in a case. This info can be easily found on the labeling.</li><li><b>Size</b>  is the total number of single units in a case. For example: If 1 case contained 2 packs and each pack weighed 20 pounds, my size would be 1x2x20=40 size</li><li><b>Case $</b> - this is the total cost of a single case. We understand that prices change frequently but well keep track of the prices on a different module.</li><li><b>Min Order</b>  some items, such as bottle beers require you to order a case while other items may allow you to order in single digit units. You may set the minimum here</li><li><b>Substitute For</b>  If you purchase the same item from multiple vendors or if you have items that are used as replacement, you can assign the parent items her. For example: if I purchase Prime Rib from the local seafood store as well as from the seafood vendor, you can now merge the two items so that only one item merges the transactions and details and only one item shows on the reports.</li></ul>Once the data is in you may select Save and all the item details will be added to your restaurant.</p></article>',that.skip=function(){$uibModalInstance.dismiss("cancel")}};inventorySetupController.$inject=["api","$state","auth","localStorageService","SweetAlert","$rootScope","restaurant","$uibModal"],angular.module("inspinia").component("inventorySetupComponent",{templateUrl:"js/components/foodSetup/inventorySetup/inventorySetup.html",controller:inventorySetupController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("foodSetup.inventory",{url:"/inventory-setup",template:"<inventory-setup-component></inventory-setup-component>",data:{pageTitle:" Inventory Setup"}})})}(),function(){"use strict";function modalController($uibModal,$uibModalInstance,$state,menu,filtered_menus,rest_id,get_refbooks,recipes_list,alertService,SweetAlert,api){var that=this;that.$state=$state,that.form={},that.recipes=recipes_list,that.get_refbooks=get_refbooks,that.menu=menu,that.filtered_menus=filtered_menus,that.rest_id=rest_id,that.mindex=0,that.api=api,that.stdisable=menu,that.savename=null,that.savelevel=null,that.savePL1=null,that.default_note=" Hover the mouse pointer over the form field headings to display their purpose.",that.current_note=that.default_note,that.notes={min:"Please enter the menu item name EXACTLY as it appears in your POS. To add your ingredients please select the plus symbol below the Ingredients header below.",pl:"Your P.O.S. normally has pricing levels for each Menu Item which can be used for discounts and drink special. Your default pricing level is usually pricing level 1 however if your restaurant uses multiple pricing level please select the level to match your POS. If you do not use pricing levels please select a 0.",price:"Please enter the correct retail price that matches the menu item name and price level in your POS.",cp:"Represents your cost percentage for this menu item.",tc:"Represents your total dollar cost for this menu item.",
r:"Please select the plus symbol below and to the right. Here you will add your recipes for the menu item. The recipes will include the name, serving type, recipe amount, total servings and recipe cost.",rname:"The recipes you created in the previous step are populated and can be used here.",rst:"This shows if the selected recipe is a single or batch serving.",ra:"Please select how much portion out of the total servings of the recipe you want to use in this menu item.",rts:"This shows the total servings the recipe can offer.",rcost:"Total recipe cost based on recipe amount and cost.",c:"You may also add comment to each menu item."},that.all_pricing_levels=[{name:0,level:"0"},{name:1,level:"1"},{name:2,level:"2"},{name:3,level:"3"},{name:4,level:"4"},{name:5,level:"5"},{name:6,level:"6"},{name:7,level:"7"},{name:8,level:"8"},{name:9,level:"9"},{name:10,level:"10"}],that.selected_pricing_level=that.all_pricing_levels[0].name,that.model={menu_item_name:that.menu?that.menu.menu_item_name:null,pricing_level:that.menu?that.menu.pricing_level:1,description:that.menu?that.menu.description:null,price:that.menu?that.menu.price:null,cost_margin:that.menu?that.menu.cost_margin:null,cost:that.menu?that.menu.cost:null,menu_items:[]},that.reset_mindex=function(){if(menu)for(var i=0;i<that.filtered_menus.length;i++)if(that.menu.id==that.filtered_menus[i].id){that.mindex=i;break}},that.reset_mindex(),that.reset_model=function(){that.model.menu_item_name=null,that.model.pricing_level=1,that.model.price=null,that.model.cost_margin=0,that.model.cost=0,that.model.description=null,that.model.menu_items=[],that.selected_pricing_level=1,that.savePL1=null},that.savePL1=that.model.menu_item_name,that.selected_pricing_level=that.model.pricing_level,that.setMenuItems=function(){if(that.menu&&that.menu.menu_items)for(var j=0;that.recipes.length>j;j++)for(var i=0;that.menu.menu_items.length>i;i++)if(that.menu.menu_items[i].recipe_id===that.recipes[j].id){var rec=that.recipes[j];rec.recipes_amount=that.menu.menu_items[i].recipes_amount,rec.total_cost=that.recipes[j].cost*(rec.recipes_amount/rec.servings),rec.total_cost=Math.round(1e3*rec.total_cost)/1e3,that.model.menu_items.push({bu_r:rec,recipe:rec,cost:that.menu.menu_items[i].cost,id:that.menu.menu_items[i].id,time:(new Date).getTime()+i})}},that.setMenuItems(),that.update_note=function(key){that.current_note=" "+that.notes[key]},that.reset_note=function(){that.current_note=that.default_note},that.prev_menu_item=function(){0!=that.mindex&&(that.mindex--,that.api.get_menu_by_id(that.filtered_menus[that.mindex].id).then(function(res){that.reset_model(),that.menu=res.data.data.menus_list[0],that.model={menu_item_name:that.menu?that.menu.menu_item_name:null,pricing_level:that.menu?that.menu.pricing_level:1,category:that.menu?that.menu.category:null,price:that.menu?that.menu.price:null,cost_margin:that.menu?that.menu.cost_margin:0,cost:that.menu?that.menu.cost:0,description:that.menu?that.menu.description:null,menu_items:[]},that.setMenuItems(),that.savePL1=that.model.menu_item_name,that.selected_pricing_level=that.model.pricing_level}))},that.next_menu_item=function(){that.mindex!=that.filtered_menus.length-1&&(that.mindex++,that.api.get_menu_by_id(that.filtered_menus[that.mindex].id).then(function(res){that.reset_model(),that.menu=res.data.data.menus_list[0],that.model={menu_item_name:that.menu?that.menu.menu_item_name:null,pricing_level:that.menu?that.menu.pricing_level:1,category:that.menu?that.menu.category:null,price:that.menu?that.menu.price:null,cost_margin:that.menu?that.menu.cost_margin:0,cost:that.menu?that.menu.cost:0,description:that.menu?that.menu.description:null,menu_items:[]},that.setMenuItems(),that.savePL1=that.model.menu_item_name,that.selected_pricing_level=that.model.pricing_level}))},that.delete_current=function(){that.api.get_menu_by_name_and_pricing_level(that.model.menu_item_name+"&"+that.selected_pricing_level).then(function(res){var len=res.data.data.menus_list.length,del_item=res.data.data.menus_list[0];1==len?swal({title:"Are you sure?",text:"This menu will be deleted",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){res&&that.api.delete_menu(del_item.id).then(that.update_details)}):0==len&&swal({title:"Nothing to delete!",timer:1500,showConfirmButton:!1,type:"warning"})})},that.update_details=function(){that.savename=that.model.menu_item_name,that.savelevel=that.selected_pricing_level,that.api.get_menu_by_name_and_pricing_level(that.model.menu_item_name+"&"+that.selected_pricing_level).then(function(res){var len=res.data.data.menus_list.length,edit_item=res.data.data.menus_list[0];if(1==len){if(that.stdisable=!0,that.model.price=edit_item.price,that.model.cost_margin=edit_item.cost_margin,that.model.cost=edit_item.cost,edit_item.menu_items)for(var j=0;that.recipes.length>j;j++)for(var i=0;edit_item.menu_items.length>i;i++)edit_item.menu_items[i].recipe_id===that.recipes[j].id&&that.model.menu_items.push({recipe:that.recipes[j],cost:edit_item.menu_items[i].cost,id:edit_item.menu_items[i].id,time:(new Date).getTime()+i});that.model.description=edit_item.description}else 0==len&&(that.stdisable=!1,that.reset_model(),that.model.menu_item_name=that.savename,that.model.pricing_level=that.savelevel,that.selected_pricing_level=that.savelevel)})},that.addRecipe=function(){that.model.menu_items.push({recipe:null,cost:null,time:(new Date).getTime()})},that.countCost=function(r){var is_insert_new_inv=!1;void 0!==r&&(-2==r.recipe.id?that.$state.go("foodSetup.recipe"):-1==r.recipe.id&&(is_insert_new_inv=!0,r.recipe=r.bu_r?r.bu_r:null)),void 0!==r&&(r.bu_r=r.recipe);for(var sum=0,i=0;that.model.menu_items.length>i;i++)null!=that.model.menu_items[i].recipe&&(4==that.model.menu_items[i].recipe.recipe_type_id&&(that.model.menu_items[i].recipe.recipes_amount=that.model.menu_items[i].recipe.servings),that.model.menu_items[i].recipe.total_cost=that.model.menu_items[i].recipe.cost*(that.model.menu_items[i].recipe.recipes_amount/that.model.menu_items[i].recipe.servings),that.model.menu_items[i].recipe.total_cost=Math.round(1e3*that.model.menu_items[i].recipe.total_cost)/1e3,sum+=that.model.menu_items[i].recipe.total_cost);that.model.cost=parseFloat(sum.toFixed(2)),that.model.cost_margin=parseFloat((that.model.cost/that.model.price*100).toFixed(2)),is_insert_new_inv&&SweetAlert.swal({title:"Discard Progress?",text:"This will open a new window and you may lose your progress. Go back to save your progress or proceed",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Discard Progress & Continue",cancelButtonText:"Go Back"},function(res){res&&($uibModalInstance.dismiss("cancel"),$uibModal.open({templateUrl:"add_new_food_inventory_item.html",controller:newFoodItem_modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",size:"lg2x",resolve:{vendor_list:function(){return that.vendors?that.vendors:that.api.get_chosen_vendors(that.rest_id,{vendor_type_id:1}).then(function(res){return that.vendors=res.data.data.vendors})},inventory_type_id:function(){return 1},restaurant_id:function(){return that.rest_id}}}))})},that.remove=function($index){that.model.menu_items.splice($index,1),that.model.menu_items.length&&that.countCost($index)},that.submit=function(form){if(!that.model.menu_items.length)return void alertService.showError("Please add at least one recipe");if(form.$valid){for(var m={inventory_type_id:1,menu_item_name:that.model.menu_item_name,pricing_level:that.selected_pricing_level,category:"Food",description:that.model.description,price:that.model.price,cost_margin:that.model.cost_margin,cost:that.model.cost,menu_items:[]},i=0;that.model.menu_items.length>i;i++)m.menu_items.push({recipe_id:that.model.menu_items[i].recipe.id,id:that.model.menu_items[i].id,cost:that.model.menu_items[i].recipe.total_cost,recipes_amount:that.model.menu_items[i].recipe.recipes_amount});that.savePL1!=that.model.menu_item_name&&null!=that.savePL1?that.api.update_menu(that.menu.id,m).then(function(res){try{1e3===res.data.data.code&&swal({title:"Menu Item updated successfully!",timer:1500,showConfirmButton:!1,type:"success"})}catch(e){console.log(e)}}):that.stdisable?that.api.update_menu(that.menu.id,m).then(function(res){try{1e3===res.data.data.code&&swal({title:"Menu Item updated successfully!",timer:1500,showConfirmButton:!1,type:"success"})}catch(e){console.log(e)}}):that.api.save_menu(m).then(function(res){try{1e3===res.data.data.code&&swal({title:"New Menu Item created successfully!",timer:1500,showConfirmButton:!1,type:"success"})}catch(e){console.log(e)}})}},that.cancel=function(){$uibModalInstance.dismiss("cancel")}}function newFoodItem_modalController($uibModalInstance,$state,alertService,restaurant_id,vendor_list,inventory_type_id,api,core,SweetAlert,$q){var that=this;that.$state=$state,that.form={},that.uniqueItem=[],that.categories=[],that.sub_categories=[],core.getRefbooks().then(function(res){that.deliveryMeasure=res.measurement_units_of_delivery,that.categories=res.vendor_cat,that.sub_categories=res.vendor_sub_cat}),that.api=api,that.model={},that.vendor_list=vendor_list,that.selected_vendor=null,that.sku_lookup=function(search_for){return that.api.sku_lookup({search_for:search_for,vendor_id:that.selected_vendor}).then(function(res){return res.data.data.sku.slice(0,10)})},that.submit=function(form){var deferred=$q.defer();return form.$valid?that.uniqueItem.length?void(null!=that.uniqueItem[0].vendor_sku&&that.uniqueItem[0].vendor_sku.length&&that.api.validateSKU({sku:that.uniqueItem[0].vendor_sku,vendor_id:that.selected_vendor}).then(function(res){if(res.data.data.sku_status.length&&"used"==res.data.data.sku_status[0].sku_status)return void alertService.showError("SKU already used!");for(var id=that.selected_vendor,m={inventory_type_id:1,sku_items:[]},i=0;that.uniqueItem.length>i;i++)m.sku_items.push({substitute_for:that.uniqueItem[i].substitute_for?that.uniqueItem[i].substitute_for:null,vendor_sku:that.uniqueItem[i].vendor_sku,pack:that.uniqueItem[i].pack,size:that.uniqueItem[i].size,total_unit_size:that.uniqueItem[i].pack*that.uniqueItem[i].size,uom_id_of_delivery_unit:that.uniqueItem[i].uom_id_of_delivery_unit,brand:"No Brand",brand_id:1,item_name:that.uniqueItem[i].item_name,vendor_cat_id:that.uniqueItem[i].vendor_cat_id,vendor_sub_cat_id:that.uniqueItem[i].vendor_sub_cat_id,yield:1,price:that.uniqueItem[i].case_cost,minimum_order_type:that.uniqueItem[i].minimum_order_type,is_active:that.uniqueItem[i].is_active,id:that.uniqueItem[i].id});return that.api.add_update_own_inventory(id,m).then(function(res){1e3===res.data.data.code&&(that.clear(),alertService.showAlertSave(),deferred.resolve())}),deferred.promise})):(alertService.showError("Please, add at least one item"),deferred.reject(),deferred.promise):(alertService.showError("Please validate all inputs"),deferred.reject(),deferred.promise)},that.apply_values=function($item){that.src=$item.src,that.uniqueItem[0].vendor_sku=$item.vendor_sku,that.uniqueItem[0].item_name=$item.item_name,that.uniqueItem[0].vendor_cat_id=$item.vendor_cat_id,that.uniqueItem[0].vendor_sub_cat_id=$item.vendor_sub_cat_id,that.uniqueItem[0].uom_id_of_delivery_unit=$item.uom_id_of_delivery_unit,that.uniqueItem[0].pack=$item.pack,that.uniqueItem[0].size=$item.size,that.uniqueItem[0].case_cost=$item.case_cost,that.uniqueItem[0].minimum_order_type=$item.minimum_order_type,that.uniqueItem[0].substitute_for=$item.substitute_for,that.filterItems()},that.addUniqueItem=function(){that.uniqueItem.push({vendor_sku:null,pack:null,uom_id_of_delivery_unit:null,item_name:null,vendor_cat_id:that.categories.length?that.categories[0].id:null,vendor_sub_cat_id:that.sub_categories.length?that.sub_categories[0].id:null,is_active:1,size:null,case_cost:null,minimum_order_type:"Case",id:null,substitute_for:null})},that.filterItems=function(){that.inventoryListSelected=[];for(var i=0;i<that.inventoryItems.length;i++)that.inventoryItems[i].vendor_cat_id!=that.uniqueItem[0].vendor_cat_id||(10!=that.uniqueItem[0].uom_id_of_delivery_unit&&11!=that.uniqueItem[0].uom_id_of_delivery_unit&&12!=that.uniqueItem[0].uom_id_of_delivery_unit&&13!=that.uniqueItem[0].uom_id_of_delivery_unit&&16!=that.uniqueItem[0].uom_id_of_delivery_unit&&17!=that.uniqueItem[0].uom_id_of_delivery_unit&&18!=that.uniqueItem[0].uom_id_of_delivery_unit||10!=that.inventoryItems[i].uom_id_of_delivery_unit&&11!=that.inventoryItems[i].uom_id_of_delivery_unit&&12!=that.inventoryItems[i].uom_id_of_delivery_unit&&13!=that.inventoryItems[i].uom_id_of_delivery_unit&&16!=that.inventoryItems[i].uom_id_of_delivery_unit&&17!=that.inventoryItems[i].uom_id_of_delivery_unit&&18!=that.inventoryItems[i].uom_id_of_delivery_unit)&&(5!=that.uniqueItem[0].uom_id_of_delivery_unit&&14!=that.uniqueItem[0].uom_id_of_delivery_unit&&15!=that.uniqueItem[0].uom_id_of_delivery_unit&&19!=that.uniqueItem[0].uom_id_of_delivery_unit||5!=that.inventoryItems[i].uom_id_of_delivery_unit&&14!=that.inventoryItems[i].uom_id_of_delivery_unit&&15!=that.inventoryItems[i].uom_id_of_delivery_unit&&19!=that.inventoryItems[i].uom_id_of_delivery_unit)&&(1!=that.uniqueItem[0].uom_id_of_delivery_unit&&2!=that.uniqueItem[0].uom_id_of_delivery_unit&&3!=that.uniqueItem[0].uom_id_of_delivery_unit&&4!=that.uniqueItem[0].uom_id_of_delivery_unit&&5!=that.uniqueItem[0].uom_id_of_delivery_unit&&8!=that.uniqueItem[0].uom_id_of_delivery_unit||1!=that.inventoryItems[i].uom_id_of_delivery_unit&&2!=that.inventoryItems[i].uom_id_of_delivery_unit&&3!=that.inventoryItems[i].uom_id_of_delivery_unit&&4!=that.inventoryItems[i].uom_id_of_delivery_unit&&5!=that.inventoryItems[i].uom_id_of_delivery_unit&&8!=that.inventoryItems[i].uom_id_of_delivery_unit)||that.inventoryListSelected.push(that.inventoryItems[i]);if(that.inventoryListSelected.length){var first=JSON.stringify(that.inventoryListSelected[0]);that.inventoryListSelected.unshift(JSON.parse(first)),that.inventoryListSelected[0].id=null,that.inventoryListSelected[0].vendor_name="--No selection--",that.inventoryListSelected[0].item_name="--No selection--"}},that.getInventoriesByVendor=function(){that.api.get_active_inventory_by_vendor({inventory_type_id:1,caller:"sub_list"},restaurant_id).then(function(res){that.inventoryItems=res.data.data.sku,that.filterItems()})},that.addUniqueItem(),that.getInventoriesByVendor(),that.clear=function(){that.src="",that.uniqueItem=[],that.uniqueItem.push({vendor_sku:null,pack:null,uom_id_of_delivery_unit:null,item_name:null,vendor_cat_id:null,vendor_sub_cat_id:null,is_active:1,size:null,case_cost:null,minimum_order_type:"Case",id:null,substitute_for:null})},that.cancel=function(){$uibModalInstance.dismiss("cancel")}}function menuSetupController(api,$state,auth,localStorageService,$uibModal,core,alertService,SweetAlert,$rootScope,restaurant){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.form={},that.api=api,that.core=core,that.auth=auth,that.restaurant_id=localStorageService.get("restaurant_id"),that.status="active",that.has_ig="all",!that.restaurant_id)return void $state.go("home");restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.SetUpStatus=0,restaurant.data.info&&(that.SetUpStatus=restaurant.data.info.is_setup_completed),$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),that.showInfo=function(){$uibModal.open({animation:!0,templateUrl:"quick_tutorial.html",controller:qt,controllerAs:"qt",windowClass:"animated fadeIn modal-lgg",size:"lg"})},that.createMissingMenus=function(){that.api.create_missing_menus({inventory_type_id:1}).then(function(res){SweetAlert.swal({title:"Menus Created Successfully!",text:"Please find the new menus (marked in red) and proceed to add the ingredients in them. Also note these menus are being mapped to POS data as of now. Please allow a few minutes for the mapping to update.",type:"success",confirmButtonText:"OK"},function(res){that.getAllMenus()})})},that.updateMenuPrices=function(){SweetAlert.swal({title:"Are you sure?",text:"This will update the prices of all the menus to their latest average sales price.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){res&&that.getAllMenus(!0)})};var generateFile=function(menuList){const menuHeaders=["id","MenuItemName","PricingLevel","Price","CostMargin","TotalCost","Comments"],recipeHeaders=["RecipeName","ServingType","RecipeAmt","TotalOz","RecipeCost"];var csv="";csv+=menuHeaders.join(",")+",",csv+=recipeHeaders.join(",")+"\r\n",menuList&&menuList.length&&menuList.forEach(function(menu){const m_values=menuHeaders.map(function(header){return menu[header]});menu.recipes&&menu.recipes.length?menu.recipes.forEach(function(recipe){const r_values=recipeHeaders.map(function(header){return recipe[header]});csv+=m_values.join(",")+",",csv+=r_values.join(",")+"\r\n"}):(csv+=m_values.join(",")+",",csv+=recipeHeaders.map(function(header){return","}).join("")+"\r\n")});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="Menu_list(food).csv",hiddenElement.click(),that.export_loading=!1};this.downloadCSV=function(){that.export_loading=!0;const menuList=[];var refRecipes=null,menus=this.filtered_menus,all_menus=[],menus_to_export=[];that.api.get_recipes({inventory_type_id:1}).then(function(res){refRecipes=res.data.data.recipes_list}).then(function(){return that.api.get_menus({inventory_type_id:1,mode:"export"}).then(function(res){all_menus=res.data.data.menus_list;for(var rx in menus)for(var ax in all_menus)if(menus[rx].id==all_menus[ax].id){menus_to_export.push(all_menus[ax]);break}})}).then(function(){return new Promise(function(resolve,reject){function next(){var menu=menus_to_export[index];if(!menu)return resolve(menuList);var menuData=new Object({id:menu.id,MenuItemName:menu.menu_item_name.replace(/[,'#]/g,""),PricingLevel:menu.pricing_level,Price:menu.price,TotalCost:menu.cost,CostMargin:menu.cost_margin,Comments:null==menu.description?menu.description:menu.description.replace(/[,'#\r\n|\n|\r]/g," ")+"",recipes:new Array});menu.menu_items.forEach(function(recipe,ingredientIndex){for(var vi in refRecipes){var reci=refRecipes[vi];if(reci.id===recipe.recipe_id){menuData.recipes.push({RecipeName:reci.recipe_name.replace(/[,'#]/g,""),ServingType:reci.serving_type,RecipeAmt:recipe.recipes_amount,TotalOz:reci.servings,RecipeCost:recipe.cost});break}}}),menuList.push(menuData),index++,next()}var index=0;next()})}).then(function(){generateFile(menuList)})},that.edit=function(menu){that.api.get_menu_by_id(menu.id).then(function(res){that.add(res.data.data.menus_list[0])})},that.deactivate=function(menu_id){that.api.act_deact_menu_item({item:[{action:"deactivate"}],id:menu_id}).then(function(res){that.getAllMenus()})},that.activate=function(menu_id){that.api.act_deact_menu_item({item:[{action:"activate"}],id:menu_id}).then(function(res){that.getAllMenus()})},that.changeList=function(){that.getAllMenus()},that.delete=function(menu){menu.id&&SweetAlert.swal({title:"Are you sure?",text:"This menu will be deleted",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){res&&that.api.delete_menu(menu.id).then(that.getAllMenus)})},that.apply_filter=function(){var pl=that.filter_pl;that.filtered_menus=null==pl||void 0==pl?that.menus.filter(function(x){return"yes"==that.has_ig?"Other"!=x.category:"no"!=that.has_ig||"Other"==x.category}):that.menus.filter(function(x){return x.pricing_level==pl&&("yes"==that.has_ig?"Other"!=x.category:"no"!=that.has_ig||"Other"==x.category)}),that.export_loading=!1},that.getAllMenus=function(upd_price){that.api.get_menus({inventory_type_id:1,update_price:upd_price||!1,menu_item_name:null!=that.search_menu?that.search_menu:""}).then(function(res){try{that.menus=res.data.data.menus_list,that.curr_menus=[];for(var i=0;i<that.menus.length;i++)"active"==that.status&&1==that.menus[i].is_active?that.curr_menus.push(that.menus[i]):"inactive"==that.status&&0==that.menus[i].is_active&&that.curr_menus.push(that.menus[i]);that.menus=that.curr_menus,that.apply_filter()}catch(e){}})},that.getAllMenus(),that.add=function(menu){$uibModal.open({templateUrl:"add_new_menu_item.html",controller:modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",size:"lg",resolve:{menu:function(){return menu},filtered_menus:function(){if(menu)return that.filtered_menus},get_refbooks:function(){return that.get_refbooks?that.get_refbooks:that.core.getRefbooks().then(function(res){return that.get_refbooks=res})},recipes_list:function(){return that.recipes?JSON.parse(JSON.stringify(that.recipes)):that.api.get_recipes({inventory_type_id:1}).then(function(res){return res.data.data.recipes_list.unshift({id:-2,recipe_name:" (+) Add New Recipe"}),res.data.data.recipes_list.unshift({id:-1,recipe_name:" (+) Add a new Inventory Item"}),that.recipes=res.data.data.recipes_list,JSON.parse(JSON.stringify(res.data.data.recipes_list))})},rest_id:function(){return that.restaurant_id.restaurant_id}}}).result.then(function(){alertService.showAlertSave(),that.getAllMenus()},function(){that.getAllMenus()})},that.$onInit=function(){that.core.getRefbooks().then(function(res){that.get_refbooks=res,that.is_setup_completed=restaurant.data.info.is_setup_completed})}}var qt=function($uibModalInstance){var that=this;that.q_title="Menu Setup Instructions",that.q_texts='<article style="display: block;"><p><b>Food Menu Recipe Setup</b>  this screen should match your real Menu. The items from the recipe setup page will be added to the correct menu item<br/><br/><b>Step 1</b>  Enter the Menu Item names just as it appears in your POS or on your actual menu<br/><br/><b>Step 2</b>  The pricing level should be clear in your POS. For example: pricing level 1 could be regular prices while pricing level 2 can be happy hour prices.<br/><br/><b>Step 3</b>  Enter the items selling price<br/><br/><b>Step 4</b>  Select the recipe name from the dropdown list which populates from the list of all previous items you created<br/><br/><b>Step 5</b>  In the Serving Type section you will see three options appear. Depending on what appears in the Serving Type section will depend on the number you enter in the Recipe Amount section. The difference between a single serving and a batch or sauce is that batches and Prepared Sauces are served as ounces and single servings are served as full units.<ul><li>Single Serving  This is a single recipe meant to serve a single person.</li><li>Large Batch/Multi Servings - This is a large recipe thats meant to serve multiple people. Weve broken the recipe down into ounces. In this section you will tell us how many ounces you are serving from this batch.</li><li>Prepared Sauces  Sauces are typically used as ingredients in Large Batch or Single Serving recipes however they can also be served as their own items. This is where you will tell us how many ounces of your special sauce is to be served on the designated menu item.</li></ul></p></article>',that.skip=function(){$uibModalInstance.dismiss("cancel")}};menuSetupController.$inject=["api","$state","auth","localStorageService","$uibModal","core","alertService","SweetAlert","$rootScope","restaurant"],angular.module("inspinia").component("menuSetupComponent",{templateUrl:"js/components/foodSetup/menuSetup/menuSetup.html",controller:menuSetupController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("foodSetup.menu",{url:"/menu-setup",template:"<menu-setup-component></menu-setup-component>",data:{pageTitle:" Menu Setup"}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("foodSetup.posSync",{url:"/pos_sync/:pos_id",template:"<pos-sync-component></pos-sync-component>",data:{pageTitle:" POS Setup"}})})}(),function(){"use strict";function modalController($uibModal,$uibModalInstance,recipe,all_recipes,rest_id,get_refbooks,ingredients,prepped_recipes,alertService,SweetAlert,api,$q,$filter){function get_recipe_items(recipe){var deferred=$q.defer();if(!recipe)return deferred.resolve([]),deferred.promise;var resArr=[],m={uom_conf:[]};if(recipe.recipe_items){1!=recipe.recipe_type_id&&2!=recipe.recipe_type_id||!that.prepped_recipes?3!=recipe.recipe_type_id&&4!=recipe.recipe_type_id||(that.ingredients=ingredients):that.ingredients=ingredients.concat(that.prepped_recipes);for(var i=0;recipe.recipe_items.length>i;i++){resArr.push({model:null,measurement_like:recipe.recipe_items[i].measurement_like_type_id,uom_id:recipe.recipe_items[i].uom_id,prepped_recipe_id:recipe.recipe_items[i].prepped_recipe_id,measurement_type:recipe.recipe_items[i].measurement_type_id,ingredient_id:recipe.recipe_items[i].vendor_sku_id,itype:angular.isUndefined(recipe.recipe_items[i].vendor_sku_id)||null===recipe.recipe_items[i].vendor_sku_id?"PP":"Regular",oz_per_unit:11==recipe.recipe_items[i].uom_id?recipe.recipe_items[i].total_ounces/recipe.recipe_items[i].amount:1,amount:recipe.recipe_items[i].amount,cost:recipe.recipe_items[i].cost,total_ounces:recipe.recipe_items[i].total_ounces,time:(new Date).getTime()+i,mtypes:[]});for(var j=0;that.ingredients.length>j;j++)if(angular.isUndefined(resArr[i].ingredient_id)||null===resArr[i].ingredient_id){if(that.ingredients[j].ppid===resArr[i].prepped_recipe_id){resArr[i].model=that.ingredients[j],resArr[i].bu_model=that.ingredients[j];break}}else if(that.ingredients[j].id===resArr[i].ingredient_id){if(resArr[i].model=that.ingredients[j],resArr[i].bu_model=that.ingredients[j],"Ready Made"!=resArr[i].model.category)if(10==resArr[i].model.uom_id_of_delivery_unit||11==resArr[i].model.uom_id_of_delivery_unit||12==resArr[i].model.uom_id_of_delivery_unit||13==resArr[i].model.uom_id_of_delivery_unit||16==resArr[i].model.uom_id_of_delivery_unit||17==resArr[i].model.uom_id_of_delivery_unit||18==resArr[i].model.uom_id_of_delivery_unit)for(var x=0;x<that.get_refbooks.measurement_types.length;x++)"Percentage"!=that.get_refbooks.measurement_types[x].name&&"Volume"!=that.get_refbooks.measurement_types[x].name&&resArr[i].mtypes.push(that.get_refbooks.measurement_types[x]);else for(var x=0;x<that.get_refbooks.measurement_types.length;x++)"Percentage"!=that.get_refbooks.measurement_types[x].name&&resArr[i].mtypes.push(that.get_refbooks.measurement_types[x]);else for(var x=0;x<that.get_refbooks.measurement_types.length;x++)resArr[i].mtypes.push(that.get_refbooks.measurement_types[x]);break}for(var l=0;that.get_refbooks.measurement_likes.length>l;l++)if(that.get_refbooks.measurement_likes[l].id===resArr[i].measurement_like){resArr[i].measurement_like=that.get_refbooks.measurement_likes[l],resArr[i].oz_per_unit=1==resArr[i].measurement_type?Math.round(resArr[i].oz_per_unit,2):resArr[i].oz_per_unit;break}m.uom_conf.push({measurement_type_id:recipe.recipe_items[i].measurement_type_id,vendor_sku_id:recipe.recipe_items[i].vendor_sku_id})}that.api.get_measure_units(m).then(function(res){for(var uomConformity=res.data.data.uomConformity,i=0;recipe.recipe_items.length>i;i++){for(var a=[],j=0;uomConformity.length>j;j++)if(uomConformity[j].vendor_sku_id===recipe.recipe_items[i].vendor_sku_id&&recipe.recipe_items[i].measurement_type_id===uomConformity[j].measurement_type_id){for(var l=0;a.length>l;l++)a[l].name===uomConformity[j].name&&a[l].measurement_type_id===uomConformity[j].measurement_type_id&&a[l].vendor_sku_id===uomConformity[j].vendor_sku_id&&a.splice(l,1);a.push(uomConformity[j])}if(10!=recipe.recipe_items[i].uom_id_of_delivery_unit&&11!=recipe.recipe_items[i].uom_id_of_delivery_unit&&12!=recipe.recipe_items[i].uom_id_of_delivery_unit&&13!=recipe.recipe_items[i].uom_id_of_delivery_unit&&16!=recipe.recipe_items[i].uom_id_of_delivery_unit&&17!=recipe.recipe_items[i].uom_id_of_delivery_unit&&18!=recipe.recipe_items[i].uom_id_of_delivery_unit)for(var mu=0;mu<a.length;mu++)if(11==a[mu].measure_unit_id){a.splice(mu,1);break}that.measurement_units[i]=a}deferred.resolve(resArr)})}else deferred.resolve([]);return deferred.promise}var that=this;that.form={},that.ingredients=ingredients;for(var i in that.ingredients)that.ingredients[i].item_name=that.ingredients[i].item_name+" ("+that.ingredients[i].vendor_name+")";that.ingredients.unshift({id:-1,item_name:"(+) Add a new Inventory Item"}),that.prepped_recipes=prepped_recipes;for(var i in that.prepped_recipes)that.prepped_recipes[i].item_name=that.prepped_recipes[i].item_name+" ("+that.prepped_recipes[i].vendor_name+")";that.recipes=[],that.get_refbooks=get_refbooks,that.mtypes_bu={},that.showMCP=!1,that.showUsedIn=!1;for(var i=0;i<that.get_refbooks.measurement_types.length;i++)if("Percentage"==that.get_refbooks.measurement_types[i].name){that.mtypes_bu=that.get_refbooks.measurement_types[i];break}that.recipe=recipe,that.all_recipes=all_recipes,that.rest_id=rest_id,that.mindex=0,that.showCategory=!1,that.api=api,that.measurement_units=[],that.default_note=" Hover the mouse pointer over the form field headings to display their purpose.",that.current_note=that.default_note,that.notes={rname:"Name your recipe here. Make sure you use the same recipe names for what you use while cooking for faster setups.",yield:"Yield (%) in culinary terms refers to how much of a product you will have available after trim loss of a finished or processed product. This usually refers to items such as fruits & vegetables. For example, after trimming of Romaine Lettuce you may be only left with a 70% yield (available portion for your recipe).",cost:"Cost ($) Is the actual dollar cost of the recipe based on the used ingredients and their cost.",rtype:"Here you have two choices which includes Single Serving and Batch. A single serving is a recipe created which is meant to one person. A Batch is meant to serve two or more people. You will be able to create the batch serving when you create your Menu in the next step.",serv:"Total ounces in this batch.",slife:"Enter the maximum number of days this batch is fit for consumption or use.",i:"Please select the plus symbol below and to the right. Here you will add ingredients for the recipe.",iname:"From the drop down list you can select the ingredients that are included in the named recipe. If you cant locate the correct item you will need to return to the inventory setup page, add the item to your inventory list then return here in order to add the item to your Recipe.",mtype:"Measure Type is how you measure your ingredients in either the form of a liquid or a dry.",mlike:"Using the measure like feature considers the fact that there can be dozens of types of the same product and one dry item doesnt produce the same content as another. For example, there are 25 different types of apples and a cup of salt does not yield the same as a cup of sugar. Use the measure like feature to identify your ingredient as closely as possible so that we can make the most accurate cost calculation.",uom:"Select how you measure your ingredient.",opu:"Enter the weight of one unit of the item in Ounces.",amt:"Enter the amount used based on the selected unit of measure.",icost:"This is the individual cost of the ingredient based on Measure Like, Unit of Measure and Amount.",c:"You may also add comment to each menu item."},that.menus_using_this_recipe_fetched=!1,that.updateIngredients=function(){1!=that.model.recipe_type&&2!=that.model.recipe_type||!that.prepped_recipes?3!=that.model.recipe_type&&4!=that.model.recipe_type||(that.ingredients=ingredients):that.ingredients=ingredients.concat(that.prepped_recipes)},that.getUsedIn=function(){that.recipes_using_subrecipe_list=[],that.api.get_recipes_using_this_sub_recipe(that.recipe.id).then(function(res){if(that.menus_using_this_recipe_fetched=!0,
void 0!==res.data.data.recipes_using_subrecipe_list&&res.data.data.recipes_using_subrecipe_list.length){that.recipes_using_subrecipe_list=res.data.data.recipes_using_subrecipe_list;for(var rs in that.recipes_using_subrecipe_list)that.recipes_using_subrecipe_list[rs].recipe_type=$filter("recipeTypeFilter")(that.get_refbooks.recipe_types,that.recipes_using_subrecipe_list[rs].recipe_type_id)}})},that.revealUsedIn=function(state){that.showUsedIn=state,that.showUsedIn&&!that.recipes_using_subrecipe_list&&that.getUsedIn()},that.getMCP=function(){that.menus_using_this_recipe=[],that.api.get_menus_using_this_recipe(that.recipe.id).then(function(res){that.menus_using_this_recipe_fetched=!0,void 0!==res.data.data.menus_using_recipe_list&&res.data.data.menus_using_recipe_list.length&&(that.menus_using_this_recipe=res.data.data.menus_using_recipe_list,that.updateMCP())})},that.revealMCP=function(state){that.showMCP=state,that.showMCP&&!that.menus_using_this_recipe_fetched&&that.getMCP()},that.updateMCP=function(){for(var i=0;i<that.menus_using_this_recipe.length;i++){var new_recipe_cost=that.menus_using_this_recipe[i].recipes_amount/that.model.servings*that.model.cost,new_menu_cost=that.menus_using_this_recipe[i].cost+(new_recipe_cost-that.menus_using_this_recipe[i].recipes_amount/(that.recipe?that.recipe.servings:1)*(that.recipe?that.recipe.cost:0));that.menus_using_this_recipe[i].calc_cost=Math.round(100*new_menu_cost)/100,that.menus_using_this_recipe[i].calc_cost_percent=Math.round(new_menu_cost/that.menus_using_this_recipe[i].price*100*100)/100}},that.model={recipe_name:recipe?recipe.recipe_name:null,servings:recipe?recipe.servings:1,recipe_type:recipe?recipe.recipe_type_id:1,shelf_life:recipe?recipe.shelf_life:1,yield:recipe?recipe.yield:100,cost:recipe?recipe.cost:0,ingredients:get_recipe_items(recipe).then(function(res){that.model.ingredients=res}),description:recipe?recipe.description:null,prep_time:recipe?recipe.prep_time:0,cook_time:recipe?recipe.cook_time:0,cook_method:recipe?recipe.cook_method:null},1!=that.model.recipe_type&&2!=that.model.recipe_type||!that.prepped_recipes?3!=that.model.recipe_type&&4!=that.model.recipe_type||(that.ingredients=ingredients):that.ingredients=ingredients.concat(that.prepped_recipes),that.reset_mindex=function(){if(recipe)for(var i=0;i<that.all_recipes.length;i++)if(that.recipe.id==that.all_recipes[i].id){that.mindex=i;break}},that.reset_mindex(),that.resetMCP=function(){that.showMCP=!1,that.menus_using_this_recipe_fetched=!1,that.menus_using_this_recipe=[]},that.reset_model=function(){that.model.recipe_name=null,that.model.servings=1,that.model.recipe_type=1,that.model.shelf_life=1,that.model.yield=100,that.model.cost=0,that.model.ingredients=[],that.model.description=null,that.model.prep_time=0,that.model.cook_time=0,that.model.cook_method=null,that.resetMCP()},that.calculateCostYield=function(){that.model.cost=0,that.model.yield=0,1!=that.model.recipe_type&&(that.model.servings=0);for(var totalAmount=0,yieldValue=0,yieldTotal=[],i=0;that.model.ingredients.length>i;i++)that.model.cost+=that.model.ingredients[i].cost,1!=that.model.recipe_type&&(that.model.servings+=that.model.ingredients[i].total_ounces),!that.model.ingredients[i].measurement_like||1!==that.model.ingredients[i].measurement_type&&4!==that.model.ingredients[i].measurement_type||that.model.ingredients[i].measurement_like.yield&&that.model.ingredients[i].amount&&(yieldTotal.push(that.model.ingredients[i].measurement_like.yield*that.model.ingredients[i].amount),totalAmount+=that.model.ingredients[i].amount),2===that.model.ingredients[i].measurement_type&&(yieldTotal.push(1*that.model.ingredients[i].amount),totalAmount+=that.model.ingredients[i].amount);for(i=0;yieldTotal.length>i;i++)yieldValue+=yieldTotal[i];that.model.cost=parseFloat(that.model.cost.toFixed(2)),that.model.servings=parseFloat(that.model.servings.toFixed(2)),that.model.yield=parseFloat((yieldValue/totalAmount*100).toFixed(2)),isNaN(that.model.yield)&&(that.model.yield=100)},that.update_note=function(key){that.current_note=" "+that.notes[key]},that.reset_note=function(){that.current_note=that.default_note},that.prev_recipe=function(){0!=that.mindex&&(that.mindex--,that.api.get_recipe(that.all_recipes[that.mindex].id).then(function(res){that.reset_model(),that.recipe=res.data.data.recipes_list[0],that.model={recipe_name:that.recipe?that.recipe.recipe_name:null,servings:that.recipe?that.recipe.servings:1,recipe_type:that.recipe?that.recipe.recipe_type_id:1,shelf_life:that.recipe?that.recipe.shelf_life:1,yield:that.recipe?that.recipe.yield:100,cost:that.recipe?that.recipe.cost:0,ingredients:get_recipe_items(that.recipe).then(function(res){that.model.ingredients=res}),description:that.recipe?that.recipe.description:null,prep_time:that.recipe?that.recipe.prep_time:0,cook_time:that.recipe?that.recipe.cook_time:0,cook_method:that.recipe?that.recipe.cook_method:null},1!=that.model.recipe_type&&2!=that.model.recipe_type||!that.prepped_recipes?3!=that.model.recipe_type&&4!=that.model.recipe_type||(that.ingredients=ingredients):that.ingredients=ingredients.concat(that.prepped_recipes)}))},that.next_recipe=function(){that.mindex!=that.all_recipes.length-1&&(that.mindex++,that.api.get_recipe(that.all_recipes[that.mindex].id).then(function(res){that.reset_model(),that.recipe=res.data.data.recipes_list[0],that.model={recipe_name:that.recipe?that.recipe.recipe_name:null,servings:that.recipe?that.recipe.servings:1,recipe_type:that.recipe?that.recipe.recipe_type_id:1,shelf_life:that.recipe?that.recipe.shelf_life:1,yield:that.recipe?that.recipe.yield:100,cost:that.recipe?that.recipe.cost:0,ingredients:get_recipe_items(that.recipe).then(function(res){that.model.ingredients=res}),description:that.recipe?that.recipe.description:null,prep_time:that.recipe?that.recipe.prep_time:0,cook_time:that.recipe?that.recipe.cook_time:0,cook_method:that.recipe?that.recipe.cook_method:null},1!=that.model.recipe_type&&2!=that.model.recipe_type||!that.prepped_recipes?3!=that.model.recipe_type&&4!=that.model.recipe_type||(that.ingredients=ingredients):that.ingredients=ingredients.concat(that.prepped_recipes)}))},that.calculate=function($index){var m=that.model.ingredients[$index];if(m){var cost=0;if("Regular"==m.itype){if(3==m.measurement_type){var caseCost=m.model.case_cost,total_unit=m.model.total_unit_size,amount=m.amount||0,pack_cost=m.model.pack_cost/m.model.total_unit_size||m.model.case_cost/m.model.pack/m.model.total_unit_size,unit_cost=11!==m.uom_id?caseCost/total_unit:pack_cost;cost=amount/100*unit_cost}else{if(!m.model||(1===m.measurement_type&&10!=m.model.uom_id_of_delivery_unit&&11!=m.model.uom_id_of_delivery_unit&&12!=m.model.uom_id_of_delivery_unit&&13!=m.model.uom_id_of_delivery_unit&&16!=m.model.uom_id_of_delivery_unit&&17!=m.model.uom_id_of_delivery_unit&&18!=m.model.uom_id_of_delivery_unit||4===m.measurement_type)&&!m.measurement_like||!m.uom_id||!m.measurement_type)return;var measure_like,findMetricLiqDry=function(deliveryIn,measureIn,measurement_type_id){for(var i=0;that.get_refbooks.liquid_dry_conversion.length>i;i++)if(that.get_refbooks.liquid_dry_conversion[i].measurement_type_id===measurement_type_id&&that.get_refbooks.liquid_dry_conversion[i].uom_id_of_delivery_unit==deliveryIn&&that.get_refbooks.liquid_dry_conversion[i].uom_id==measureIn)return that.get_refbooks.liquid_dry_conversion[i].metric_conv_liq_dry||1;return 1},caseCost=m.model.case_cost,total_unit=m.model.total_unit_size,metric_counter_liq_dry=findMetricLiqDry(m.model.uom_id_of_delivery_unit,m.uom_id,m.measurement_type),oz_per_unit=m.oz_per_unit||1,amount=m.amount||0,yeld=m.measurement_like?m.measurement_like.yield:null,pack_cost=m.model.pack_cost,unit_cost=m.model.unit_cost;m.measurement_like&&(measure_like=m.measurement_like.converter_value||1),10==m.model.uom_id_of_delivery_unit||11==m.model.uom_id_of_delivery_unit||12==m.model.uom_id_of_delivery_unit||13==m.model.uom_id_of_delivery_unit||16==m.model.uom_id_of_delivery_unit||17==m.model.uom_id_of_delivery_unit||18==m.model.uom_id_of_delivery_unit?(cost=unit_cost*amount,null!==yeld&&(cost/=yeld)):(cost=unit_cost*metric_counter_liq_dry*amount,1==m.model.uom_id_of_delivery_unit&&4==m.uom_id||2==m.model.uom_id_of_delivery_unit&&5==m.uom_id||3==m.model.uom_id_of_delivery_unit&&8==m.uom_id||4==m.model.uom_id_of_delivery_unit&&7==m.uom_id||5==m.model.uom_id_of_delivery_unit&&3==m.uom_id||5==m.model.uom_id_of_delivery_unit&&13==m.uom_id||6==m.model.uom_id_of_delivery_unit&&9==m.uom_id||6==m.model.uom_id_of_delivery_unit&&16==m.uom_id||7==m.model.uom_id_of_delivery_unit&&10==m.uom_id||7==m.model.uom_id_of_delivery_unit&&17==m.uom_id||8==m.model.uom_id_of_delivery_unit&&6==m.uom_id||9==m.model.uom_id_of_delivery_unit&&2==m.uom_id||14==m.model.uom_id_of_delivery_unit&&19==m.uom_id||20==m.model.uom_id_of_delivery_unit&&1==m.uom_id||20==m.model.uom_id_of_delivery_unit&&12==m.uom_id||4===m.measurement_type&&(cost*=measure_like),null!==yeld&&(cost/=yeld))}var uod_to_oz=findMetricLiqDry(m.model.uom_id_of_delivery_unit,1==m.measurement_type?13:2==m.measurement_type?3:4==m.measurement_type?21:m.uom_id,m.measurement_type);that.model.ingredients[$index].total_ounces=1==m.measurement_type||4==m.measurement_type?oz_per_unit*amount*metric_counter_liq_dry*(1==m.measurement_type?1:measure_like)/uod_to_oz:oz_per_unit*amount*metric_counter_liq_dry/uod_to_oz}else if("PP"==m.itype){var amount=m.amount||0;cost=amount*(m.model.cost/m.model.servings),that.model.ingredients[$index].total_ounces=amount}cost=Math.round(1e3*cost)/1e3,that.model.ingredients[$index].cost=cost,that.calculateCostYield()}},that.ingredientSelected=function(item,$index){var is_insert_new_inv=!1;if(-1==item.id&&(is_insert_new_inv=!0,item=that.model.ingredients[$index].bu_model?that.model.ingredients[$index].bu_model:null),null!=item){if(that.model.ingredients[$index].model=item,that.model.ingredients[$index].cost=0,that.model.ingredients[$index].mtypes=[],"Ready Made"!=item.category)if(10==that.model.ingredients[$index].model.uom_id_of_delivery_unit||11==that.model.ingredients[$index].model.uom_id_of_delivery_unit||12==that.model.ingredients[$index].model.uom_id_of_delivery_unit||13==that.model.ingredients[$index].model.uom_id_of_delivery_unit||16==that.model.ingredients[$index].model.uom_id_of_delivery_unit||17==that.model.ingredients[$index].model.uom_id_of_delivery_unit||18==that.model.ingredients[$index].model.uom_id_of_delivery_unit)for(var i=0;i<that.get_refbooks.measurement_types.length;i++)"Percentage"!=that.get_refbooks.measurement_types[i].name&&"Volume"!=that.get_refbooks.measurement_types[i].name&&that.model.ingredients[$index].mtypes.push(that.get_refbooks.measurement_types[i]);else for(var i=0;i<that.get_refbooks.measurement_types.length;i++)"Percentage"!=that.get_refbooks.measurement_types[i].name&&that.model.ingredients[$index].mtypes.push(that.get_refbooks.measurement_types[i]);else for(var i=0;i<that.get_refbooks.measurement_types.length;i++)that.model.ingredients[$index].mtypes.push(that.get_refbooks.measurement_types[i]);angular.isUndefined(item.ppid)||null===item.ppid?(that.model.ingredients[$index].ingredient_id=item.id,that.model.ingredients[$index].itype="Regular",that.model.ingredients[$index].measurement_type=null,that.model.ingredients[$index].measurement_like=null,that.model.ingredients[$index].uom_id=null,that.model.ingredients[$index].prepped_recipe_id=null):(that.model.ingredients[$index].prepped_recipe_id=item.ppid,that.model.ingredients[$index].itype="PP",that.model.ingredients[$index].measurement_type=null,that.model.ingredients[$index].measurement_like=null,that.model.ingredients[$index].uom_id=null,that.model.ingredients[$index].ingredient_id=null),"PP"==that.model.ingredients[$index].itype&&4==that.model.ingredients[$index].model.recipe_type_id&&(that.model.ingredients[$index].amount=that.model.ingredients[$index].model.servings)}else that.model.ingredients[$index].model=null;that.model.ingredients[$index].bu_model=that.model.ingredients[$index].model,is_insert_new_inv&&SweetAlert.swal({title:"Discard Progress?",text:"This will open a new window and you may lose your progress. Go back to save your progress or proceed",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Discard Progress & Continue",cancelButtonText:"Go Back"},function(res){res&&($uibModalInstance.dismiss("cancel"),$uibModal.open({templateUrl:"add_new_food_inventory_item.html",controller:newFoodItem_modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",size:"lg2x",resolve:{vendor_list:function(){return that.vendors?that.vendors:that.api.get_chosen_vendors(that.rest_id,{vendor_type_id:1}).then(function(res){return that.vendors=res.data.data.vendors})},inventory_type_id:function(){return 1},restaurant_id:function(){return that.rest_id}}}))})},that.addIngredient=function(){that.model.ingredients.push({ingredient_id:null,measurement_type:null,measurement_like:null,oz_per_unit:1,amount:null,cost:0,uom_id:null,time:(new Date).getTime()}),that.measurement_units.push({})},that.removeIngredient=function($index){that.measurement_units.splice($index,1),that.model.ingredients.splice($index,1),that.calculateCostYield()},that.submit=function(form){if(!that.model.ingredients.length)return void alertService.showError("Please add at least one ingredient");if(form.$valid){for(var m={inventory_type_id:1,recipe_name:that.model.recipe_name,recipe_type_id:that.model.recipe_type,servings:1!==that.model.recipe_type?that.model.servings:1,shelf_life:1!==that.model.recipe_type?that.model.shelf_life:1,yield:that.model.yield,cost:that.model.cost,recipe_items:[],description:that.model.description,prep_time:that.model.prep_time,cook_time:that.model.cook_time,cook_method:that.model.cook_method},i=0;that.model.ingredients.length>i;i++)m.recipe_items.push({vendor_sku_id:that.model.ingredients[i].ingredient_id,prepped_recipe_id:angular.isUndefined(that.model.ingredients[i].prepped_recipe_id)?null:that.model.ingredients[i].prepped_recipe_id,measurement_type_id:that.model.ingredients[i].measurement_type,uom_id:that.model.ingredients[i].uom_id,amount:that.model.ingredients[i].amount,cost:that.model.ingredients[i].cost,yield:that.model.ingredients[i].yield,total_ounces:that.model.ingredients[i].total_ounces}),(1===that.model.ingredients[i].measurement_type&&10!=that.model.ingredients[i].model.uom_id_of_delivery_unit&&11!=that.model.ingredients[i].model.uom_id_of_delivery_unit&&12!=that.model.ingredients[i].model.uom_id_of_delivery_unit&&13!=that.model.ingredients[i].model.uom_id_of_delivery_unit&&16!=that.model.ingredients[i].model.uom_id_of_delivery_unit&&17!=that.model.ingredients[i].model.uom_id_of_delivery_unit&&18!=that.model.ingredients[i].model.uom_id_of_delivery_unit||4===that.model.ingredients[i].measurement_type)&&(m.recipe_items[m.recipe_items.length-1].measurement_like_type_id=that.model.ingredients[i].measurement_like.id);that.recipe?that.api.update_recipe(that.recipe.id,m).then(function(res){try{1e3===res.data.data.code&&(swal({title:"Recipe updated successfully!",timer:1500,showConfirmButton:!1,type:"success"}),that.resetMCP())}catch(e){console.log(e)}}):that.api.save_recipe(m).then(function(res){try{1e3===res.data.data.code&&swal({title:"Recipe updated successfully!",timer:1500,showConfirmButton:!1,type:"success"})}catch(e){console.log(e)}})}},that.cancel=function(){$uibModalInstance.dismiss("cancel")},that.get_measure_units=function(item,$index){if(item.measurement_type&&item.ingredient_id){var m={uom_conf:[{measurement_type_id:item.measurement_type,vendor_sku_id:item.ingredient_id}]};that.api.get_measure_units(m).then(function(res){if(that.measurement_units[$index]=res.data.data.uomConformity,10!=item.model.uom_id_of_delivery_unit&&11!=item.model.uom_id_of_delivery_unit&&12!=item.model.uom_id_of_delivery_unit&&13!=item.model.uom_id_of_delivery_unit&&16!=item.model.uom_id_of_delivery_unit&&17!=item.model.uom_id_of_delivery_unit&&18!=item.model.uom_id_of_delivery_unit)for(var mu=0;mu<that.measurement_units[$index].length;mu++)if(11==that.measurement_units[$index][mu].measure_unit_id){that.measurement_units[$index].splice(mu,1);break}})}}}function controller($scope,$state,localStorageService,auth,api,core,$filter,$uibModal,$q){var that=this;if(that.api=api,that.core=core,that.auth=auth,that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.recipes=[],that.searchModel={order_by:"item_name",order_way:"ASC",paginationOffset:0,paginationCount:10,inRequest:!1,paginationTotal:0,recipe_name:null,inventory_type_id:1,mode:"training",recipe_type:null},$scope.tfile=function(index){$("#image-"+index).click()},$scope.cancelUpload=function(index){that.recipes[index].recipe_image_url=$scope.tempImageUrl,$("#fileBtn-"+index).show(),$("#uploadBtn-"+index).hide(),$("#cancelBtn-"+index).hide()},$scope.tempImageUrl="",$scope.uploadFile=function(index){that.api.upload_recipe_image({inventory_type_id:1,recipe_id:that.recipes[index].id,image:that.recipes[index].recipe_image_url}).then(function(res){$("#fileBtn-"+index).show(),$("#uploadBtn-"+index).hide(),$("#cancelBtn-"+index).hide()})},$scope.getFile=function(file,index){var fileReader=new FileReader;fileReader.onload=function(e){$scope.$apply(function(){$scope.tempImageUrl=that.recipes[index].recipe_image_url,that.recipes[index].recipe_image_url=fileReader.result})},fileReader.readAsDataURL(file),$("#fileBtn-"+index).hide(),$("#uploadBtn-"+index).show(),$("#cancelBtn-"+index).show()},$scope.print_loading=!1,$scope.generatePDF=function(){$scope.print_loading=!0,that.getAllRecipes(1,1)},that.generatePDFCall=function(){swal({title:"",text:"Printing...",imageUrl:"img/loading2.gif",showConfirmButton:!1});var element=$("#recipes-wrapper"),buttonsToHide=element.find("button:visible").hide();kendo.drawing.drawDOM($("#recipes-wrapper"),{paperSize:"A4",forcePageBreak:".page-break",landscape:!0,scale:.9}).then(function(group){if($scope.print_loading=!1,"safari"==that.browserType())kendo.drawing.pdf.saveAs(group,"recipe-review.pdf");else{var windowReference=window.open();kendo.drawing.pdf.toBlob(group,function(blob){windowReference.location=window.URL.createObjectURL(blob)})}that.getAllRecipes(0),swal.close()}).done(function(){buttonsToHide.show()})},that.browserType=function(){var userAgent=navigator.userAgent;return userAgent.match(/chrome|chromium|crios/i)?"chrome":userAgent.match(/firefox|fxios/i)?"firefox":userAgent.match(/safari/i)?"safari":userAgent.match(/opr\//i)?"opera":userAgent.match(/edg/i)?"edge":"No browser detection"},that.changeList=function(caller){that.getAllRecipes(1)},that.getAllRecipes=function(keyword,print){that.recipes=[],document.body.scrollTop=0;var m={mode:"training",inventory_type_id:that.searchModel.inventory_type_id,recipe_type:that.searchModel.recipe_type,recipe_name:that.searchModel.recipe_name,paginationOffset:that.searchModel.paginationOffset,paginationCount:that.searchModel.paginationCount};that.searchModel.recipe_type&&(m.recipe_type=that.searchModel.recipe_type);for(var i in m)null!=m[i]&&""!=m[i]||delete m[i];keyword?(that.searchModel.paginationOffset=0,m.paginationOffset=0):m.paginationOffset>0&&(m.paginationOffset=(m.paginationOffset-1)*m.paginationCount),swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),print&&(m={recipe_type:that.searchModel.recipe_type,inventory_type_id:that.searchModel.inventory_type_id,mode:"training"}),that.api.get_recipes(m).then(function(res){try{that.searchModel.paginationTotal=res.data.data.total,that.recipes=res.data.data.recipes_list,swal.close()}catch(e){console.log(e),swal.close()}setTimeout(function(){$(".recipe_image").each(function(){var oneTime=1;this.onload=function(){if(1===oneTime){var bData=$scope.getBase64Image($(this)[0]);this.setAttribute("src",bData),oneTime++}}}),print&&that.generatePDFCall()},1e3)})},$scope.getBase64Image=function(img){var canvas=document.createElement("canvas");return canvas.width=img.naturalWidth,canvas.height=img.naturalHeight,canvas.getContext("2d").drawImage(img,0,0),canvas.toDataURL("image/png")},that.edit=function(recipe){that.api.get_recipe(recipe.id).then(function(res){that.add(res.data.data.recipes_list[0])})},that.add=function(recipe){$uibModal.open({templateUrl:"add_new_recipe_item.html",controller:modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",size:"lg",resolve:{recipe:function(){return recipe},get_refbooks:function(){return that.get_refbooks?that.get_refbooks:that.core.getRefbooks().then(function(res){return that.get_refbooks=res})},all_recipes:function(){if(recipe)return that.all_recipes_bu},ingredients:function(){return that.ingredients?that.ingredients:that.api.get_active_inventory_by_vendor({inventory_type_id:1,caller:"recipe_edit"},that.restaurant_id.restaurant_id).then(function(res){return res.data.data.sku})},prepped_recipes:function(){return that.all_recipes_bu?that.getPPR():that.processPPR()},rest_id:function(){return that.restaurant_id.restaurant_id}}}).result.then(function(){alertService.showAlertSave(),that.getAllRecipes()},function(){that.getAllRecipes()})},that.getPPR=function(){for(var ppr=[],i=0;i<that.all_recipes_bu.length;i++)if(3===that.all_recipes_bu[i].recipe_type_id||4===that.all_recipes_bu[i].recipe_type_id){var ppr_name=$filter("recipeTypeFilter")(that.get_refbooks.recipe_types,that.all_recipes_bu[i].recipe_type_id),ri=that.all_recipes_bu[i];ri.ppid=ri.id,ri.item_name=ri.recipe_name,ri.category=ppr_name,ri.vendor_name=ppr_name,ppr.push(ri)}return ppr},that.processPPR=function(){that.getRecipesBu().then(function(res){return that.getPPR()})},that.getRecipesBu=function(){var deferred=$q.defer(),m={inventory_type_id:1};return that.api.get_recipes(m).then(function(res){try{that.all_recipes_bu=JSON.parse(JSON.stringify(res.data.data.recipes_list))}catch(e){console.log(e)}deferred.resolve()}),deferred.promise},that.$onInit=function(){Promise.all([that.getRecipesBu()]).then(function(response){that.core.getRefbooks().then(function(res){that.get_refbooks=res,that.get_refbooks.dd_recipe_types=JSON.parse(JSON.stringify(that.get_refbooks.recipe_types)),that.get_refbooks.dd_recipe_types_filter=JSON.parse(JSON.stringify(that.get_refbooks.recipe_types));for(var rt in that.get_refbooks.dd_recipe_types){var rtt=that.get_refbooks.dd_recipe_types[rt];1==rtt.id?rtt.name+=" (cannot be added to another recipe)":2==rtt.id?rtt.name+=" (cannot be added to another recipe)":3==rtt.id?rtt.name+=" (can be added to a Batch Recipe or Basic Recipe)":4==rtt.id&&(rtt.name+=" (can be added to a Batch Recipe or Basic Recipe)")}that.get_refbooks.dd_recipe_types_filter.splice(3,1),that.get_refbooks.dd_recipe_types_filter.unshift({id:null,name:"All"}),that.getAllRecipes(1),that.export_loading=!1})})}}var ngFileSelect=function(){return{scope:{someCtrlFn:"&callbackFn"},link:function($scope,el){el.bind("change",function(e){$scope.file=(e.srcElement||e.target).files[0],$scope.someCtrlFn({file:$scope.file})})}}};controller.$inject=["$scope","$state","localStorageService","auth","api","core","$filter","$uibModal","$q"],angular.module("inspinia").component("recipeReviewComponent",{templateUrl:"js/components/foodSetup/recipeReview/recipeReview.html",controller:controller,controllerAs:"$ctr",bindings:{}}).directive("ngFileSelect",ngFileSelect)}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("foodSetup.recipeReview",{url:"/recipe-review",template:"<recipe-review-component></recipe-review-component>",data:{pageTitle:"Recipe Review"}})})}(),function(){"use strict";function modalController($uibModal,$uibModalInstance,recipe,all_recipes,rest_id,get_refbooks,ingredients,prepped_recipes,alertService,SweetAlert,api,$q,$filter){function get_recipe_items(recipe){var deferred=$q.defer();if(!recipe)return deferred.resolve([]),deferred.promise;var resArr=[],m={uom_conf:[]};if(recipe.recipe_items){1!=recipe.recipe_type_id&&2!=recipe.recipe_type_id||!that.prepped_recipes?3!=recipe.recipe_type_id&&4!=recipe.recipe_type_id||(that.ingredients=ingredients):that.ingredients=ingredients.concat(that.prepped_recipes);for(var i=0;recipe.recipe_items.length>i;i++){resArr.push({model:null,measurement_like:recipe.recipe_items[i].measurement_like_type_id,uom_id:recipe.recipe_items[i].uom_id,prepped_recipe_id:recipe.recipe_items[i].prepped_recipe_id,measurement_type:recipe.recipe_items[i].measurement_type_id,ingredient_id:recipe.recipe_items[i].vendor_sku_id,itype:angular.isUndefined(recipe.recipe_items[i].vendor_sku_id)||null===recipe.recipe_items[i].vendor_sku_id?"PP":"Regular",oz_per_unit:11==recipe.recipe_items[i].uom_id?recipe.recipe_items[i].total_ounces/recipe.recipe_items[i].amount:1,amount:recipe.recipe_items[i].amount,cost:recipe.recipe_items[i].cost,total_ounces:recipe.recipe_items[i].total_ounces,time:(new Date).getTime()+i,mtypes:[]});for(var j=0;that.ingredients.length>j;j++)if(angular.isUndefined(resArr[i].ingredient_id)||null===resArr[i].ingredient_id){if(that.ingredients[j].ppid===resArr[i].prepped_recipe_id){resArr[i].model=that.ingredients[j],resArr[i].bu_model=that.ingredients[j];break}}else if(that.ingredients[j].id===resArr[i].ingredient_id){if(resArr[i].model=that.ingredients[j],resArr[i].bu_model=that.ingredients[j],"Ready Made"!=resArr[i].model.category)if(10==resArr[i].model.uom_id_of_delivery_unit||11==resArr[i].model.uom_id_of_delivery_unit||12==resArr[i].model.uom_id_of_delivery_unit||13==resArr[i].model.uom_id_of_delivery_unit||16==resArr[i].model.uom_id_of_delivery_unit||17==resArr[i].model.uom_id_of_delivery_unit||18==resArr[i].model.uom_id_of_delivery_unit)for(var x=0;x<that.get_refbooks.measurement_types.length;x++)"Percentage"!=that.get_refbooks.measurement_types[x].name&&"Volume"!=that.get_refbooks.measurement_types[x].name&&resArr[i].mtypes.push(that.get_refbooks.measurement_types[x]);else for(var x=0;x<that.get_refbooks.measurement_types.length;x++)"Percentage"!=that.get_refbooks.measurement_types[x].name&&resArr[i].mtypes.push(that.get_refbooks.measurement_types[x]);else for(var x=0;x<that.get_refbooks.measurement_types.length;x++)resArr[i].mtypes.push(that.get_refbooks.measurement_types[x]);break}for(var l=0;that.get_refbooks.measurement_likes.length>l;l++)if(that.get_refbooks.measurement_likes[l].id===resArr[i].measurement_like){resArr[i].measurement_like=that.get_refbooks.measurement_likes[l],resArr[i].oz_per_unit=1==resArr[i].measurement_type?Math.round(resArr[i].oz_per_unit,2):resArr[i].oz_per_unit;break}m.uom_conf.push({measurement_type_id:recipe.recipe_items[i].measurement_type_id,vendor_sku_id:recipe.recipe_items[i].vendor_sku_id})}that.api.get_measure_units(m).then(function(res){for(var uomConformity=res.data.data.uomConformity,i=0;recipe.recipe_items.length>i;i++){for(var a=[],j=0;uomConformity.length>j;j++)if(uomConformity[j].vendor_sku_id===recipe.recipe_items[i].vendor_sku_id&&recipe.recipe_items[i].measurement_type_id===uomConformity[j].measurement_type_id){for(var l=0;a.length>l;l++)a[l].name===uomConformity[j].name&&a[l].measurement_type_id===uomConformity[j].measurement_type_id&&a[l].vendor_sku_id===uomConformity[j].vendor_sku_id&&a.splice(l,1);a.push(uomConformity[j])}if(10!=recipe.recipe_items[i].uom_id_of_delivery_unit&&11!=recipe.recipe_items[i].uom_id_of_delivery_unit&&12!=recipe.recipe_items[i].uom_id_of_delivery_unit&&13!=recipe.recipe_items[i].uom_id_of_delivery_unit&&16!=recipe.recipe_items[i].uom_id_of_delivery_unit&&17!=recipe.recipe_items[i].uom_id_of_delivery_unit&&18!=recipe.recipe_items[i].uom_id_of_delivery_unit)for(var mu=0;mu<a.length;mu++)if(11==a[mu].measure_unit_id){a.splice(mu,1);break}that.measurement_units[i]=a}deferred.resolve(resArr)})}else deferred.resolve([]);return deferred.promise}var that=this;that.form={},that.ingredients=ingredients;for(var i in that.ingredients)that.ingredients[i].item_name=that.ingredients[i].item_name+" ("+that.ingredients[i].vendor_name+")";that.ingredients.unshift({id:-1,item_name:"(+) Add a new Inventory Item"}),that.prepped_recipes=prepped_recipes;for(var i in that.prepped_recipes)that.prepped_recipes[i].item_name=that.prepped_recipes[i].item_name+" ("+that.prepped_recipes[i].vendor_name+")";that.recipes=[],that.get_refbooks=get_refbooks,that.mtypes_bu={},that.showMCP=!1,that.showUsedIn=!1;for(var i=0;i<that.get_refbooks.measurement_types.length;i++)if("Percentage"==that.get_refbooks.measurement_types[i].name){that.mtypes_bu=that.get_refbooks.measurement_types[i];break}that.recipe=recipe,that.all_recipes=all_recipes,that.rest_id=rest_id,that.mindex=0,that.showCategory=!1,that.api=api,that.measurement_units=[],that.default_note=" Hover the mouse pointer over the form field headings to display their purpose.",that.current_note=that.default_note,that.notes={rname:"Name your recipe here. Make sure you use the same recipe names for what you use while cooking for faster setups.",yield:"Yield (%) in culinary terms refers to how much of a product you will have available after trim loss of a finished or processed product. This usually refers to items such as fruits & vegetables. For example, after trimming of Romaine Lettuce you may be only left with a 70% yield (available portion for your recipe).",cost:"Cost ($) Is the actual dollar cost of the recipe based on the used ingredients and their cost.",rtype:"Here you have two choices which includes Single Serving and Batch. A single serving is a recipe created which is meant to one person. A Batch is meant to serve two or more people. You will be able to create the batch serving when you create your Menu in the next step.",serv:"Total ounces in this batch.",slife:"Enter the maximum number of days this batch is fit for consumption or use.",i:"Please select the plus symbol below and to the right. Here you will add ingredients for the recipe.",iname:"From the drop down list you can select the ingredients that are included in the named recipe. If you cant locate the correct item you will need to return to the inventory setup page, add the item to your inventory list then return here in order to add the item to your Recipe.",mtype:"Measure Type is how you measure your ingredients in either the form of a liquid or a dry.",mlike:"Using the measure like feature considers the fact that there can be dozens of types of the same product and one dry item doesnt produce the same content as another. For example, there are 25 different types of apples and a cup of salt does not yield the same as a cup of sugar. Use the measure like feature to identify your ingredient as closely as possible so that we can make the most accurate cost calculation.",uom:"Select how you measure your ingredient.",opu:"Enter the weight of one unit of the item in Ounces.",amt:"Enter the amount used based on the selected unit of measure.",icost:"This is the individual cost of the ingredient based on Measure Like, Unit of Measure and Amount.",c:"You may also add comment to each menu item."},that.menus_using_this_recipe_fetched=!1,that.updateIngredients=function(){1!=that.model.recipe_type&&2!=that.model.recipe_type||!that.prepped_recipes?3!=that.model.recipe_type&&4!=that.model.recipe_type||(that.ingredients=ingredients):that.ingredients=ingredients.concat(that.prepped_recipes)},that.getUsedIn=function(){that.recipes_using_subrecipe_list=[],that.api.get_recipes_using_this_sub_recipe(that.recipe.id).then(function(res){if(that.menus_using_this_recipe_fetched=!0,void 0!==res.data.data.recipes_using_subrecipe_list&&res.data.data.recipes_using_subrecipe_list.length){that.recipes_using_subrecipe_list=res.data.data.recipes_using_subrecipe_list;for(var rs in that.recipes_using_subrecipe_list)that.recipes_using_subrecipe_list[rs].recipe_type=$filter("recipeTypeFilter")(that.get_refbooks.recipe_types,that.recipes_using_subrecipe_list[rs].recipe_type_id)}})},that.revealUsedIn=function(state){that.showUsedIn=state,that.showUsedIn&&!that.recipes_using_subrecipe_list&&that.getUsedIn()},
that.getMCP=function(){that.menus_using_this_recipe=[],that.api.get_menus_using_this_recipe(that.recipe.id).then(function(res){that.menus_using_this_recipe_fetched=!0,void 0!==res.data.data.menus_using_recipe_list&&res.data.data.menus_using_recipe_list.length&&(that.menus_using_this_recipe=res.data.data.menus_using_recipe_list,that.updateMCP())})},that.revealMCP=function(state){that.showMCP=state,that.showMCP&&!that.menus_using_this_recipe_fetched&&that.getMCP()},that.updateMCP=function(){for(var i=0;i<that.menus_using_this_recipe.length;i++){var new_recipe_cost=that.menus_using_this_recipe[i].recipes_amount/that.model.servings*that.model.cost,new_menu_cost=that.menus_using_this_recipe[i].cost+(new_recipe_cost-that.menus_using_this_recipe[i].recipes_amount/(that.recipe?that.recipe.servings:1)*(that.recipe?that.recipe.cost:0));that.menus_using_this_recipe[i].calc_cost=Math.round(100*new_menu_cost)/100,that.menus_using_this_recipe[i].calc_cost_percent=Math.round(new_menu_cost/that.menus_using_this_recipe[i].price*100*100)/100}},that.model={recipe_name:recipe?recipe.recipe_name:null,servings:recipe?recipe.servings:1,recipe_type:recipe?recipe.recipe_type_id:1,shelf_life:recipe?recipe.shelf_life:1,price:null,yield:recipe?recipe.yield:100,cost:recipe?recipe.cost:0,cost_percent:null,ingredients:get_recipe_items(recipe).then(function(res){that.model.ingredients=res}),description:recipe?recipe.description:null,prep_time:recipe?recipe.prep_time:0,cook_time:recipe?recipe.cook_time:0,cook_method:recipe?recipe.cook_method:null},that.model.cost_percent=null==that.model.price||0==that.model.price?0:Math.round(that.model.cost/that.model.price*1e4)/100,1!=that.model.recipe_type&&2!=that.model.recipe_type||!that.prepped_recipes?3!=that.model.recipe_type&&4!=that.model.recipe_type||(that.ingredients=ingredients):that.ingredients=ingredients.concat(that.prepped_recipes),that.calcRecipeCostPercent=function(){that.model.cost_percent=null==that.model.price||0==that.model.price?0:Math.round(that.model.cost/that.model.price*1e4)/100},that.reset_mindex=function(){if(recipe)for(var i=0;i<that.all_recipes.length;i++)if(that.recipe.id==that.all_recipes[i].id){that.mindex=i;break}},that.reset_mindex(),that.resetMCP=function(){that.showMCP=!1,that.menus_using_this_recipe_fetched=!1,that.menus_using_this_recipe=[]},that.reset_model=function(){that.model.recipe_name=null,that.model.servings=1,that.model.recipe_type=1,that.model.shelf_life=1,that.model.yield=100,that.model.cost=0,that.model.ingredients=[],that.model.description=null,that.model.prep_time=0,that.model.cook_time=0,that.model.cook_method=null,that.resetMCP()},that.calculateCostYield=function(){that.model.cost=0,that.model.yield=0,1!=that.model.recipe_type&&(that.model.servings=0);for(var totalAmount=0,yieldValue=0,yieldTotal=[],i=0;that.model.ingredients.length>i;i++)that.model.cost+=that.model.ingredients[i].cost,1!=that.model.recipe_type&&(that.model.servings+=that.model.ingredients[i].total_ounces),!that.model.ingredients[i].measurement_like||1!==that.model.ingredients[i].measurement_type&&4!==that.model.ingredients[i].measurement_type||that.model.ingredients[i].measurement_like.yield&&that.model.ingredients[i].amount&&(yieldTotal.push(that.model.ingredients[i].measurement_like.yield*that.model.ingredients[i].amount),totalAmount+=that.model.ingredients[i].amount),2===that.model.ingredients[i].measurement_type&&(yieldTotal.push(1*that.model.ingredients[i].amount),totalAmount+=that.model.ingredients[i].amount);for(i=0;yieldTotal.length>i;i++)yieldValue+=yieldTotal[i];that.model.cost=parseFloat(that.model.cost.toFixed(2)),that.model.servings=parseFloat(that.model.servings.toFixed(2)),that.model.yield=parseFloat((yieldValue/totalAmount*100).toFixed(2)),isNaN(that.model.yield)&&(that.model.yield=100),that.calcRecipeCostPercent()},that.update_note=function(key){that.current_note=" "+that.notes[key]},that.reset_note=function(){that.current_note=that.default_note},that.prev_recipe=function(){0!=that.mindex&&(that.mindex--,that.api.get_recipe(that.all_recipes[that.mindex].id).then(function(res){that.reset_model(),that.recipe=res.data.data.recipes_list[0],that.model={recipe_name:that.recipe?that.recipe.recipe_name:null,servings:that.recipe?that.recipe.servings:1,recipe_type:that.recipe?that.recipe.recipe_type_id:1,shelf_life:that.recipe?that.recipe.shelf_life:1,yield:that.recipe?that.recipe.yield:100,cost:that.recipe?that.recipe.cost:0,ingredients:get_recipe_items(that.recipe).then(function(res){that.model.ingredients=res}),description:that.recipe?that.recipe.description:null,prep_time:that.recipe?that.recipe.prep_time:0,cook_time:that.recipe?that.recipe.cook_time:0,cook_method:that.recipe?that.recipe.cook_method:null},1!=that.model.recipe_type&&2!=that.model.recipe_type||!that.prepped_recipes?3!=that.model.recipe_type&&4!=that.model.recipe_type||(that.ingredients=ingredients):that.ingredients=ingredients.concat(that.prepped_recipes)}))},that.next_recipe=function(){that.mindex!=that.all_recipes.length-1&&(that.mindex++,that.api.get_recipe(that.all_recipes[that.mindex].id).then(function(res){that.reset_model(),that.recipe=res.data.data.recipes_list[0],that.model={recipe_name:that.recipe?that.recipe.recipe_name:null,servings:that.recipe?that.recipe.servings:1,recipe_type:that.recipe?that.recipe.recipe_type_id:1,shelf_life:that.recipe?that.recipe.shelf_life:1,yield:that.recipe?that.recipe.yield:100,cost:that.recipe?that.recipe.cost:0,ingredients:get_recipe_items(that.recipe).then(function(res){that.model.ingredients=res}),description:that.recipe?that.recipe.description:null,prep_time:that.recipe?that.recipe.prep_time:0,cook_time:that.recipe?that.recipe.cook_time:0,cook_method:that.recipe?that.recipe.cook_method:null},1!=that.model.recipe_type&&2!=that.model.recipe_type||!that.prepped_recipes?3!=that.model.recipe_type&&4!=that.model.recipe_type||(that.ingredients=ingredients):that.ingredients=ingredients.concat(that.prepped_recipes)}))},that.calculate=function($index){var m=that.model.ingredients[$index];if(m){var cost=0;if("Regular"==m.itype){if(3==m.measurement_type){var caseCost=m.model.case_cost,total_unit=m.model.total_unit_size,amount=m.amount||0,pack_cost=m.model.pack_cost/m.model.total_unit_size||m.model.case_cost/m.model.pack/m.model.total_unit_size,unit_cost=11!==m.uom_id?caseCost/total_unit:pack_cost;cost=amount/100*unit_cost}else{if(!m.model||(1===m.measurement_type&&10!=m.model.uom_id_of_delivery_unit&&11!=m.model.uom_id_of_delivery_unit&&12!=m.model.uom_id_of_delivery_unit&&13!=m.model.uom_id_of_delivery_unit&&16!=m.model.uom_id_of_delivery_unit&&17!=m.model.uom_id_of_delivery_unit&&18!=m.model.uom_id_of_delivery_unit||4===m.measurement_type)&&!m.measurement_like||!m.uom_id||!m.measurement_type)return;var measure_like,findMetricLiqDry=function(deliveryIn,measureIn,measurement_type_id){for(var i=0;that.get_refbooks.liquid_dry_conversion.length>i;i++)if(that.get_refbooks.liquid_dry_conversion[i].measurement_type_id===measurement_type_id&&that.get_refbooks.liquid_dry_conversion[i].uom_id_of_delivery_unit==deliveryIn&&that.get_refbooks.liquid_dry_conversion[i].uom_id==measureIn)return that.get_refbooks.liquid_dry_conversion[i].metric_conv_liq_dry||1;return 1},caseCost=m.model.case_cost,total_unit=m.model.total_unit_size,metric_counter_liq_dry=findMetricLiqDry(m.model.uom_id_of_delivery_unit,m.uom_id,m.measurement_type),oz_per_unit=m.oz_per_unit||1,amount=m.amount||0,yeld=m.measurement_like?m.measurement_like.yield:null,pack_cost=m.model.pack_cost,unit_cost=m.model.unit_cost;m.measurement_like&&(measure_like=m.measurement_like.converter_value||1),10==m.model.uom_id_of_delivery_unit||11==m.model.uom_id_of_delivery_unit||12==m.model.uom_id_of_delivery_unit||13==m.model.uom_id_of_delivery_unit||16==m.model.uom_id_of_delivery_unit||17==m.model.uom_id_of_delivery_unit||18==m.model.uom_id_of_delivery_unit?(cost=unit_cost*amount,null!==yeld&&(cost/=yeld)):(cost=unit_cost*metric_counter_liq_dry*amount,1==m.model.uom_id_of_delivery_unit&&4==m.uom_id||2==m.model.uom_id_of_delivery_unit&&5==m.uom_id||3==m.model.uom_id_of_delivery_unit&&8==m.uom_id||4==m.model.uom_id_of_delivery_unit&&7==m.uom_id||5==m.model.uom_id_of_delivery_unit&&3==m.uom_id||5==m.model.uom_id_of_delivery_unit&&13==m.uom_id||6==m.model.uom_id_of_delivery_unit&&9==m.uom_id||6==m.model.uom_id_of_delivery_unit&&16==m.uom_id||7==m.model.uom_id_of_delivery_unit&&10==m.uom_id||7==m.model.uom_id_of_delivery_unit&&17==m.uom_id||8==m.model.uom_id_of_delivery_unit&&6==m.uom_id||9==m.model.uom_id_of_delivery_unit&&2==m.uom_id||14==m.model.uom_id_of_delivery_unit&&19==m.uom_id||20==m.model.uom_id_of_delivery_unit&&1==m.uom_id||20==m.model.uom_id_of_delivery_unit&&12==m.uom_id||4===m.measurement_type&&(cost*=measure_like),null!==yeld&&(cost/=yeld))}var uod_to_oz=findMetricLiqDry(m.model.uom_id_of_delivery_unit,1==m.measurement_type?13:2==m.measurement_type?3:4==m.measurement_type?21:m.uom_id,m.measurement_type);that.model.ingredients[$index].total_ounces=1==m.measurement_type||4==m.measurement_type?oz_per_unit*amount*metric_counter_liq_dry*(1==m.measurement_type?1:measure_like)/uod_to_oz:oz_per_unit*amount*metric_counter_liq_dry/uod_to_oz}else if("PP"==m.itype){var amount=m.amount||0;cost=amount*(m.model.cost/m.model.servings),that.model.ingredients[$index].total_ounces=amount}cost=Math.round(1e3*cost)/1e3,that.model.ingredients[$index].cost=cost,that.calculateCostYield()}},that.ingredientSelected=function(item,$index){var is_insert_new_inv=!1;if(-1==item.id&&(is_insert_new_inv=!0,item=that.model.ingredients[$index].bu_model?that.model.ingredients[$index].bu_model:null),null!=item){if(that.model.ingredients[$index].model=item,that.model.ingredients[$index].cost=0,that.model.ingredients[$index].mtypes=[],"Ready Made"!=item.category)if(10==that.model.ingredients[$index].model.uom_id_of_delivery_unit||11==that.model.ingredients[$index].model.uom_id_of_delivery_unit||12==that.model.ingredients[$index].model.uom_id_of_delivery_unit||13==that.model.ingredients[$index].model.uom_id_of_delivery_unit||16==that.model.ingredients[$index].model.uom_id_of_delivery_unit||17==that.model.ingredients[$index].model.uom_id_of_delivery_unit||18==that.model.ingredients[$index].model.uom_id_of_delivery_unit)for(var i=0;i<that.get_refbooks.measurement_types.length;i++)"Percentage"!=that.get_refbooks.measurement_types[i].name&&"Volume"!=that.get_refbooks.measurement_types[i].name&&that.model.ingredients[$index].mtypes.push(that.get_refbooks.measurement_types[i]);else for(var i=0;i<that.get_refbooks.measurement_types.length;i++)"Percentage"!=that.get_refbooks.measurement_types[i].name&&that.model.ingredients[$index].mtypes.push(that.get_refbooks.measurement_types[i]);else for(var i=0;i<that.get_refbooks.measurement_types.length;i++)that.model.ingredients[$index].mtypes.push(that.get_refbooks.measurement_types[i]);angular.isUndefined(item.ppid)||null===item.ppid?(that.model.ingredients[$index].ingredient_id=item.id,that.model.ingredients[$index].itype="Regular",that.model.ingredients[$index].measurement_type=null,that.model.ingredients[$index].measurement_like=null,that.model.ingredients[$index].uom_id=null,that.model.ingredients[$index].prepped_recipe_id=null):(that.model.ingredients[$index].prepped_recipe_id=item.ppid,that.model.ingredients[$index].itype="PP",that.model.ingredients[$index].measurement_type=null,that.model.ingredients[$index].measurement_like=null,that.model.ingredients[$index].uom_id=null,that.model.ingredients[$index].ingredient_id=null),"PP"==that.model.ingredients[$index].itype&&4==that.model.ingredients[$index].model.recipe_type_id&&(that.model.ingredients[$index].amount=that.model.ingredients[$index].model.servings)}else that.model.ingredients[$index].model=null;that.model.ingredients[$index].bu_model=that.model.ingredients[$index].model,is_insert_new_inv&&SweetAlert.swal({title:"Discard Progress?",text:"This will open a new window and you may lose your progress. Go back to save your progress or proceed",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Discard Progress & Continue",cancelButtonText:"Go Back"},function(res){res&&($uibModalInstance.dismiss("cancel"),$uibModal.open({templateUrl:"add_new_food_inventory_item.html",controller:newFoodItem_modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",size:"lg2x",resolve:{vendor_list:function(){return that.vendors?that.vendors:that.api.get_chosen_vendors(that.rest_id,{vendor_type_id:1}).then(function(res){return that.vendors=res.data.data.vendors})},inventory_type_id:function(){return 1},restaurant_id:function(){return that.rest_id}}}))})},that.addIngredient=function(){that.model.ingredients.push({ingredient_id:null,measurement_type:null,measurement_like:null,oz_per_unit:1,amount:null,cost:0,uom_id:null,time:(new Date).getTime()}),that.measurement_units.push({})},that.removeIngredient=function($index){that.measurement_units.splice($index,1),that.model.ingredients.splice($index,1),that.calculateCostYield()},that.submit=function(form){if(!that.model.ingredients.length)return void alertService.showError("Please add at least one ingredient");that.checkRecipeName().then(function(res,err){if(form.$valid&&null!=that.model.recipe_name){for(var m={inventory_type_id:1,recipe_name:that.model.recipe_name,recipe_type_id:that.model.recipe_type,servings:1!==that.model.recipe_type?that.model.servings:1,shelf_life:1!==that.model.recipe_type?that.model.shelf_life:1,yield:that.model.yield,cost:that.model.cost,recipe_items:[],description:that.model.description,prep_time:that.model.prep_time,cook_time:that.model.cook_time,cook_method:that.model.cook_method},i=0;that.model.ingredients.length>i;i++)m.recipe_items.push({vendor_sku_id:that.model.ingredients[i].ingredient_id,prepped_recipe_id:angular.isUndefined(that.model.ingredients[i].prepped_recipe_id)?null:that.model.ingredients[i].prepped_recipe_id,measurement_type_id:that.model.ingredients[i].measurement_type,uom_id:that.model.ingredients[i].uom_id,amount:that.model.ingredients[i].amount,cost:that.model.ingredients[i].cost,yield:that.model.ingredients[i].yield,total_ounces:that.model.ingredients[i].total_ounces}),(1===that.model.ingredients[i].measurement_type&&10!=that.model.ingredients[i].model.uom_id_of_delivery_unit&&11!=that.model.ingredients[i].model.uom_id_of_delivery_unit&&12!=that.model.ingredients[i].model.uom_id_of_delivery_unit&&13!=that.model.ingredients[i].model.uom_id_of_delivery_unit&&16!=that.model.ingredients[i].model.uom_id_of_delivery_unit&&17!=that.model.ingredients[i].model.uom_id_of_delivery_unit&&18!=that.model.ingredients[i].model.uom_id_of_delivery_unit||4===that.model.ingredients[i].measurement_type)&&(m.recipe_items[m.recipe_items.length-1].measurement_like_type_id=that.model.ingredients[i].measurement_like.id);that.recipe?that.api.update_recipe(that.recipe.id,m).then(function(res){try{1e3===res.data.data.code&&(swal({title:"Recipe updated successfully!",timer:1500,showConfirmButton:!1,type:"success"}),that.resetMCP())}catch(e){console.log(e)}}):that.api.save_recipe(m).then(function(res){try{1e3===res.data.data.code&&swal({title:"Recipe created successfully!",timer:1500,showConfirmButton:!1,type:"success"})}catch(e){console.log(e)}})}})},that.cancel=function(){$uibModalInstance.dismiss("cancel")},that.get_measure_units=function(item,$index){if(item.measurement_type&&item.ingredient_id){var m={uom_conf:[{measurement_type_id:item.measurement_type,vendor_sku_id:item.ingredient_id}]};that.api.get_measure_units(m).then(function(res){if(that.measurement_units[$index]=res.data.data.uomConformity,10!=item.model.uom_id_of_delivery_unit&&11!=item.model.uom_id_of_delivery_unit&&12!=item.model.uom_id_of_delivery_unit&&13!=item.model.uom_id_of_delivery_unit&&16!=item.model.uom_id_of_delivery_unit&&17!=item.model.uom_id_of_delivery_unit&&18!=item.model.uom_id_of_delivery_unit)for(var mu=0;mu<that.measurement_units[$index].length;mu++)if(11==that.measurement_units[$index][mu].measure_unit_id){that.measurement_units[$index].splice(mu,1);break}})}},that.checkRecipeName=function(){var deferred=$q.defer();return null!=that.model.recipe_name&&""!=that.model.recipe_name||deferred.resolve(),that.api.get_recipes({inventory_type_id:1,recipe_name:"",recipe_type:null}).then(function(res){try{that.recipes=res.data.data.recipes_list.map(function(x){return{r_id:x.id,recipe_name:x.recipe_name}});for(var ri=0;ri<that.recipes.length;ri++){var rid_condn=void 0===that.recipe||that.recipes[ri].r_id!=that.recipe.id;if(that.recipes[ri].recipe_name==that.model.recipe_name&&rid_condn){alertService.showError("Recipe name already exists!"),that.model.recipe_name=null;break}}deferred.resolve()}catch(e){console.log("err returin gall",e),deferred.reject(!0)}}),deferred.promise}}function newFoodItem_modalController($uibModalInstance,$state,alertService,restaurant_id,vendor_list,inventory_type_id,api,core,SweetAlert,$q){var that=this;that.$state=$state,that.form={},that.uniqueItem=[],that.categories=[],that.sub_categories=[],core.getRefbooks().then(function(res){that.deliveryMeasure=res.measurement_units_of_delivery,that.categories=res.vendor_cat,that.sub_categories=res.vendor_sub_cat}),that.api=api,that.model={},that.vendor_list=vendor_list,that.selected_vendor=null,that.sku_lookup=function(search_for){return that.api.sku_lookup({search_for:search_for,vendor_id:that.selected_vendor}).then(function(res){return res.data.data.sku.slice(0,10)})},that.submit=function(form){var deferred=$q.defer();return form.$valid?that.uniqueItem.length?void(null!=that.uniqueItem[0].vendor_sku&&that.uniqueItem[0].vendor_sku.length&&that.api.validateSKU({sku:that.uniqueItem[0].vendor_sku,vendor_id:that.selected_vendor}).then(function(res){if(res.data.data.sku_status.length&&"used"==res.data.data.sku_status[0].sku_status)return void alertService.showError("SKU already used!");for(var id=that.selected_vendor,m={inventory_type_id:1,sku_items:[]},i=0;that.uniqueItem.length>i;i++)m.sku_items.push({substitute_for:that.uniqueItem[i].substitute_for?that.uniqueItem[i].substitute_for:null,vendor_sku:that.uniqueItem[i].vendor_sku,pack:that.uniqueItem[i].pack,size:that.uniqueItem[i].size,total_unit_size:that.uniqueItem[i].pack*that.uniqueItem[i].size,uom_id_of_delivery_unit:that.uniqueItem[i].uom_id_of_delivery_unit,brand:"No Brand",brand_id:1,item_name:that.uniqueItem[i].item_name,vendor_cat_id:that.uniqueItem[i].vendor_cat_id,vendor_sub_cat_id:that.uniqueItem[i].vendor_sub_cat_id,yield:1,price:that.uniqueItem[i].case_cost,minimum_order_type:that.uniqueItem[i].minimum_order_type,is_active:that.uniqueItem[i].is_active,id:that.uniqueItem[i].id});return that.api.add_update_own_inventory(id,m).then(function(res){1e3===res.data.data.code&&(that.clear(),alertService.showAlertSave(),deferred.resolve())}),deferred.promise})):(alertService.showError("Please, add at least one item"),deferred.reject(),deferred.promise):(alertService.showError("Please validate all inputs"),deferred.reject(),deferred.promise)},that.apply_values=function($item){that.src=$item.src,that.uniqueItem[0].vendor_sku=$item.vendor_sku,that.uniqueItem[0].item_name=$item.item_name,that.uniqueItem[0].vendor_cat_id=$item.vendor_cat_id,that.uniqueItem[0].vendor_sub_cat_id=$item.vendor_sub_cat_id,that.uniqueItem[0].uom_id_of_delivery_unit=$item.uom_id_of_delivery_unit,that.uniqueItem[0].pack=$item.pack,that.uniqueItem[0].size=$item.size,that.uniqueItem[0].case_cost=$item.case_cost,that.uniqueItem[0].minimum_order_type=$item.minimum_order_type,that.uniqueItem[0].substitute_for=$item.substitute_for,that.filterItems()},that.addUniqueItem=function(){that.uniqueItem.push({vendor_sku:null,pack:null,uom_id_of_delivery_unit:null,item_name:null,vendor_cat_id:that.categories.length?that.categories[0].id:null,vendor_sub_cat_id:that.sub_categories.length?that.sub_categories[0].id:null,is_active:1,size:null,case_cost:null,minimum_order_type:"Case",id:null,substitute_for:null})},that.filterItems=function(){that.inventoryListSelected=[];for(var i=0;i<that.inventoryItems.length;i++)that.inventoryItems[i].vendor_cat_id!=that.uniqueItem[0].vendor_cat_id||(10!=that.uniqueItem[0].uom_id_of_delivery_unit&&11!=that.uniqueItem[0].uom_id_of_delivery_unit&&12!=that.uniqueItem[0].uom_id_of_delivery_unit&&13!=that.uniqueItem[0].uom_id_of_delivery_unit&&16!=that.uniqueItem[0].uom_id_of_delivery_unit&&17!=that.uniqueItem[0].uom_id_of_delivery_unit&&18!=that.uniqueItem[0].uom_id_of_delivery_unit||10!=that.inventoryItems[i].uom_id_of_delivery_unit&&11!=that.inventoryItems[i].uom_id_of_delivery_unit&&12!=that.inventoryItems[i].uom_id_of_delivery_unit&&13!=that.inventoryItems[i].uom_id_of_delivery_unit&&16!=that.inventoryItems[i].uom_id_of_delivery_unit&&17!=that.inventoryItems[i].uom_id_of_delivery_unit&&18!=that.inventoryItems[i].uom_id_of_delivery_unit)&&(5!=that.uniqueItem[0].uom_id_of_delivery_unit&&14!=that.uniqueItem[0].uom_id_of_delivery_unit&&15!=that.uniqueItem[0].uom_id_of_delivery_unit&&19!=that.uniqueItem[0].uom_id_of_delivery_unit||5!=that.inventoryItems[i].uom_id_of_delivery_unit&&14!=that.inventoryItems[i].uom_id_of_delivery_unit&&15!=that.inventoryItems[i].uom_id_of_delivery_unit&&19!=that.inventoryItems[i].uom_id_of_delivery_unit)&&(1!=that.uniqueItem[0].uom_id_of_delivery_unit&&2!=that.uniqueItem[0].uom_id_of_delivery_unit&&3!=that.uniqueItem[0].uom_id_of_delivery_unit&&4!=that.uniqueItem[0].uom_id_of_delivery_unit&&5!=that.uniqueItem[0].uom_id_of_delivery_unit&&8!=that.uniqueItem[0].uom_id_of_delivery_unit||1!=that.inventoryItems[i].uom_id_of_delivery_unit&&2!=that.inventoryItems[i].uom_id_of_delivery_unit&&3!=that.inventoryItems[i].uom_id_of_delivery_unit&&4!=that.inventoryItems[i].uom_id_of_delivery_unit&&5!=that.inventoryItems[i].uom_id_of_delivery_unit&&8!=that.inventoryItems[i].uom_id_of_delivery_unit)||that.inventoryListSelected.push(that.inventoryItems[i]);if(that.inventoryListSelected.length){var first=JSON.stringify(that.inventoryListSelected[0]);that.inventoryListSelected.unshift(JSON.parse(first)),that.inventoryListSelected[0].id=null,that.inventoryListSelected[0].vendor_name="--No selection--",that.inventoryListSelected[0].item_name="--No selection--"}},that.getInventoriesByVendor=function(){that.api.get_active_inventory_by_vendor({inventory_type_id:1,caller:"sub_list"},restaurant_id).then(function(res){that.inventoryItems=res.data.data.sku,that.filterItems()})},that.addUniqueItem(),that.getInventoriesByVendor(),that.clear=function(){that.src="",that.uniqueItem=[],that.uniqueItem.push({vendor_sku:null,pack:null,uom_id_of_delivery_unit:null,item_name:null,vendor_cat_id:null,vendor_sub_cat_id:null,is_active:1,size:null,case_cost:null,minimum_order_type:"Case",id:null,substitute_for:null})},that.cancel=function(){$uibModalInstance.dismiss("cancel")}}function recipeSetupController(api,$state,auth,localStorageService,$uibModal,core,alertService,SweetAlert,$rootScope,restaurant,$filter){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.form={},that.api=api,that.core=core,that.auth=auth,that.restaurant_id=localStorageService.get("restaurant_id"),that.status="active",that.type_filter=null,!that.restaurant_id)return void $state.go("home");restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),that.showInfo=function(){$uibModal.open({animation:!0,templateUrl:"quick_tutorial.html",controller:qt,controllerAs:"qt",windowClass:"animated fadeIn modal-lgg",size:"lg"})};var generateFile=function(recipeList){const reciHeaders=["RecipeName","Yield","Cost","RecipeType","TotalOz","ShelfLife","Comments","PrepTime","CookTime","CookMethod"],ingreHeaders=["IngredientItemName","MeasurementType","MeasureLike","UnitOfMeasure","UnitWtInOz","Amount","Cost"];var csv="";csv+=reciHeaders.join(",")+",",csv+=ingreHeaders.join(",")+"\r\n",recipeList&&recipeList.length&&recipeList.forEach(function(reci){const r_values=reciHeaders.map(function(header){return reci[header]});reci.ingredients&&reci.ingredients.length?reci.ingredients.forEach(function(ingre){const i_values=ingreHeaders.map(function(header){return ingre[header]});csv+=r_values.join(",")+",",csv+=i_values.join(",")+"\r\n"}):(csv+=r_values.join(",")+",",csv+=ingreHeaders.map(function(header){return","}).join("")+"\r\n")});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="Recipe_list(food).csv",hiddenElement.click(),that.export_loading=!1};this.downloadCSV=function(){that.export_loading=!0;const reciList=[];var refBooks=null,vendor=null,recipes=this.recipes,pp_recipes=that.getPPR(),all_recipes=[],filtered_recipes=[];that.core.getRefbooks().then(function(res){refBooks=res}).then(function(){return that.api.get_recipes({inventory_type_id:1,mode:"export"}).then(function(res){all_recipes=res.data.data.recipes_list;for(var rx in recipes)for(var ax in all_recipes)if(recipes[rx].id==all_recipes[ax].id){filtered_recipes.push(all_recipes[ax]);break}})}).then(function(){return that.api.get_active_inventory_by_vendor({inventory_type_id:1},that.restaurant_id.restaurant_id).then(function(response){vendor=response})}).then(function(){return new Promise(function(resolve,reject){function getMeasurementType(mt_id){for(var ri in refBooks.measurement_types)if(refBooks.measurement_types[ri].id==mt_id)return refBooks.measurement_types[ri].name;return""}function getMeasureLike(ml_id){for(var ri in refBooks.measurement_likes)if(refBooks.measurement_likes[ri].id==ml_id)return refBooks.measurement_likes[ri].name;return""}function getUnitOfMeasure(uom_id){for(var ri in refBooks.measurement_units)if(refBooks.measurement_units[ri].id==uom_id)return refBooks.measurement_units[ri].name;return""}function next(){var r=filtered_recipes[index];if(!r)return resolve(reciList);var reciData=new Object({RecipeName:r.recipe_name.replace(/[,'#]/g,""),Yield:r.yield,Cost:r.cost,RecipeType:r.serving_type,TotalOz:r.servings,ShelfLife:r.shelf_life,Comments:null==r.description?r.description:r.description.replace(/[,'#\r\n|\n|\r]/g," ")+"",PrepTime:r.prep_time,CookTime:r.cook_time,CookMethod:r.cook_method,ingredients:new Array});r.recipe_items.forEach(function(recipe,ingredientIndex){if(null==recipe.prepped_recipe_id)for(var vi in vendor.data.data.sku){var sku=vendor.data.data.sku[vi];if(sku.id===recipe.vendor_sku_id){reciData.ingredients.push({IngredientItemName:sku.item_name.replace(/[,'#]/g,"")+" ("+sku.vendor_name.replace(/[,'#]/g,"")+")",MeasurementType:getMeasurementType(recipe.measurement_type_id),MeasureLike:getMeasureLike(recipe.measurement_like_type_id).replace(/[,'#]/g,""),UnitOfMeasure:getUnitOfMeasure(recipe.uom_id),UnitWtInOz:11==recipe.uom_id?recipe.total_ounces/recipe.amount:null,Amount:recipe.amount,Cost:recipe.cost});break}}else for(var vi in pp_recipes){var ppr=pp_recipes[vi];if(ppr.ppid===recipe.prepped_recipe_id){reciData.ingredients.push({IngredientItemName:ppr.item_name.replace(/[,'#]/g,"")+" ("+ppr.category+")",Amount:recipe.amount,Cost:recipe.cost});break}}}),reciList.push(reciData),index++,next()}var index=0;next()})}).then(function(){generateFile(reciList)})},that.edit=function(recipe){that.api.get_recipe(recipe.id).then(function(res){that.add(res.data.data.recipes_list[0])})},that.deactivate=function(recipe_id){that.api.act_deact_recipe({item:[{action:"deactivate"}],id:recipe_id}).then(function(res){that.getAllRecipes()})},that.activate=function(recipe_id){that.api.act_deact_recipe({item:[{action:"activate"}],id:recipe_id}).then(function(res){that.getAllRecipes()})},that.changeList=function(caller){that.getAllRecipes()},that.filterRecipes=function(){that.recipes=that.recipes.filter(function(x){return x.is_active==("inactive"==that.status?0:1)})},that.delete=function(recipe){SweetAlert.swal({title:"Are you sure?",text:"This recipe will be deleted",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){res&&that.api.delete_recipe(recipe.id).then(that.getAllRecipes)})},that.getAllRecipes=function(caller){return new Promise(function(resolve,reject){var search_recipe_name="ppr"==caller?"":null!=that.search_recipe?that.search_recipe:"",search_ingredient_name="ppr"==caller?"":null!=that.search_ingredient?that.search_ingredient:"",search_recipe_type_id="ppr"==caller?null:that.type_filter;that.api.get_recipes({inventory_type_id:1,recipe_name:search_recipe_name,recipe_item_name:search_ingredient_name,recipe_type:search_recipe_type_id}).then(function(res){try{return that.recipes=res.data.data.recipes_list,""==search_recipe_name&&null==search_recipe_type_id&&""==search_ingredient_name&&(that.all_recipes_bu=JSON.parse(JSON.stringify(res.data.data.recipes_list))),that.filterRecipes(),resolve()}catch(e){return console.log("err returin gall"),resolve()}})})},that.getPPR=function(){return new Promise(function(resolve,reject){for(var ppr=[],i=0;i<that.all_recipes_bu.length;i++)if(3===that.all_recipes_bu[i].recipe_type_id||4===that.all_recipes_bu[i].recipe_type_id){var ppr_name=$filter("recipeTypeFilter")(that.get_refbooks.recipe_types,that.all_recipes_bu[i].recipe_type_id),ri=that.all_recipes_bu[i];ri.ppid=ri.id,ri.item_name=ri.recipe_name,ri.category=ppr_name,ri.vendor_name=ppr_name,ppr.push(ri)}return resolve(ppr)})},that.processPPR=function(){return that.getAllRecipes("ppr"),that.getPPR()},that.add=function(recipe){$uibModal.open({templateUrl:"add_new_recipe_item.html",controller:modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",size:"lg",resolve:{recipe:function(){return recipe},get_refbooks:function(){return that.get_refbooks?that.get_refbooks:that.core.getRefbooks().then(function(res){return that.get_refbooks=res})},all_recipes:function(){if(recipe)return that.recipes},ingredients:function(){return that.ingredients?JSON.parse(JSON.stringify(that.ingredients)):that.api.get_active_inventory_by_vendor({inventory_type_id:1,caller:"recipe_edit"},that.restaurant_id.restaurant_id).then(function(res){return that.ingredients=res.data.data.sku,JSON.parse(JSON.stringify(res.data.data.sku))})},prepped_recipes:function(){return that.all_recipes_bu?that.getPPR():that.processPPR()},rest_id:function(){return that.restaurant_id.restaurant_id}}}).result.then(function(){alertService.showAlertSave(),that.getAllRecipes()},function(){that.getAllRecipes()})},that.$onInit=function(){that.core.getRefbooks().then(function(res){that.get_refbooks=res,that.get_refbooks.dd_recipe_types=JSON.parse(JSON.stringify(that.get_refbooks.recipe_types)),that.get_refbooks.dd_recipe_types_filter=JSON.parse(JSON.stringify(that.get_refbooks.recipe_types)),that.get_refbooks.dd_recipe_types_filter.unshift({id:null,name:"All"});for(var rt in that.get_refbooks.dd_recipe_types){var rtt=that.get_refbooks.dd_recipe_types[rt];1==rtt.id?rtt.name+=" (cannot be added to another recipe)":2==rtt.id?rtt.name+=" (cannot be added to another recipe)":3==rtt.id?rtt.name+=" (can be added to a Batch Recipe or Basic Recipe)":4==rtt.id&&(rtt.name+=" (can be added to a Batch Recipe or Basic Recipe)")}that.getAllRecipes(),that.export_loading=!1})}}var qt=function($uibModalInstance){var that=this;that.q_title="Recipe Setup Instructions",
that.q_texts='<article style="display: block;"><p><b>Food Recipe Setup</b>  Here you can see all your recipes summarized on a single screen and add or edit new recipes.<br/><br/>Please check out our instruction videos on <a href="https://youtu.be/8zGBVsuQHGw" target="_blank">Overview</a>, <a href="https://youtu.be/H63YzN_XIU8" target="_blank">Recipe Types</a>, and <a href="https://youtu.be/d2eDY3-4wMU" target="_blank">Recipe Setup</a>.<br/><br/>To add a recipe simply select Add Recipe and the create recipe screen will appear.<br/><br/><b>Step 1</b>  Enter the name of your Recipe<br/><br/><b>Step 2</b>  Choose the serving type<ul><li><b>Single Serving</b>  a recipe item that is meant to serve one person</li><li><b>Large Batch/Multi Serving</b>  this is a recipe item that is meant to serve more than one person. Quite often restaurants will prepare large batches of items, store those items and serve portions to each customer.</li><li><b>Prepared Sauces</b>  a recipe item that is typically created as a sauce or similar item that is meant to be added to a Large Batch or Single Serving.</li></ul><b>Step 3</b>  Select the + button and begin adding ingredients<br/><br/><b>Step 4</b>  Select the ingredient name from the dropdown list. This is the list of item you selected in the Inventory setup section<br/><br/><b>Step 5</b>  Select the Measure Type which is how you measured the selected ingredient either Volume, Weight or Liquid<br/><br/><b>Step 6</b>  Measure Like  will appear if you select the Volume as measure type. Here you will select the item that is most like the ingredient you are using<br/><br/><b>Step 7</b>  Unit of Measure  tells us how you measured your serving<br/><br/><b>Step 8</b>  Amount  is the amount of the ingredient based on the unit of measure.</p></article>',that.skip=function(){$uibModalInstance.dismiss("cancel")}};recipeSetupController.$inject=["api","$state","auth","localStorageService","$uibModal","core","alertService","SweetAlert","$rootScope","restaurant","$filter"],angular.module("inspinia").component("recipeSetupComponent",{templateUrl:"js/components/foodSetup/recipeSetup/recipeSetup.html",controller:recipeSetupController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("foodSetup.recipe",{url:"/recipe-setup",template:"<recipe-setup-component></recipe-setup-component>",data:{pageTitle:" Recipe Setup"}})})}(),function(){"use strict";function setParController(api,$state,auth,core,localStorageService,alertService,SweetAlert,restaurant,$rootScope,$scope,$q){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.api=api,that.core=core,that.auth=auth,that.processed_par_items=[],$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.setDirty=function(){that.dataChanged=!0},that.goToOrder=function(){$state.go("food.newFoodOrder")},that.processPar=function(){that.processed_par_items=[];for(var pd in that.par_data){var pdi=that.par_data[pd];null==pdi.substitute_for&&(pdi.bu_minimum_order_type=pdi.minimum_order_type.substr(),pdi.show_minimum_order_type="Each"!=pdi.minimum_order_type.substr()?pdi.minimum_order_type.substr():pdi.uod,"Case"==pdi.minimum_order_type?pdi.suggested_par_units=Math.ceil(pdi.suggested_par_units/(pdi.pack*pdi.size)):"Pack"==pdi.minimum_order_type&&(pdi.suggested_par_units=Math.ceil(pdi.suggested_par_units/pdi.size)),pdi.actual_order_unit!=pdi.minimum_order_type&&null!=pdi.actual_par_units&&("Case"==pdi.minimum_order_type?"Pack"==pdi.actual_order_unit?pdi.actual_par_units=Math.ceil(pdi.actual_par_units/pdi.pack):pdi.actual_par_units=Math.ceil(pdi.actual_par_units/(pdi.pack*pdi.size)):"Pack"==pdi.minimum_order_type?"Case"==pdi.actual_order_unit?pdi.actual_par_units=Math.ceil(pdi.actual_par_units*pdi.pack):pdi.actual_par_units=Math.ceil(pdi.actual_par_units/pdi.size):"Case"==pdi.actual_order_unit?pdi.actual_par_units=Math.ceil(pdi.actual_par_units*pdi.pack*pdi.size):pdi.actual_par_units=Math.ceil(pdi.actual_par_units*pdi.size)),pdi.units_on_hand="Loading...",that.processed_par_items.push(pdi))}},that.checkCount=function(item){1==item.alert_if_low?that.count_limit<1?(swal({title:"Limit reached! Please uncheck some items first.",timer:3e3,showConfirmButton:!1,type:"warning"}),item.alert_if_low=0):that.count_limit--:that.count_limit++},that.getData=function(){that.loading=!0,Promise.all([that.getParData()]).then(function(response){that.getOH(),that.getSuggestedOrder()})},that.getOH=function(){that.api.food_OH({RestaurantId:that.restaurant_id.restaurant_id,Category:that.category,caller:"oh_report"}).then(function(res){if(res){that.oh_table_data=res.data.data.Report;for(var pt in that.processed_par_items){var found_item=!1;for(var ot in that.oh_table_data){if(that.oh_table_data[ot].vendor_sku_id==that.processed_par_items[pt].vendor_sku_id){that.processed_par_items[pt].units_on_hand=that.oh_table_data[ot].total_uod_on_hand,found_item=!0;break}found_item||(that.processed_par_items[pt].units_on_hand="N/A")}}}that.loading=!1})},that.getSuggestedOrder=function(){that.api.get_suggested_orders({RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:1}).then(function(res){if(res){that.suggested_table_data=res.data.data.Report;for(var pt in that.processed_par_items)for(var ot in that.suggested_table_data)if(that.suggested_table_data[ot].vendor_sku_id==that.processed_par_items[pt].vendor_sku_id){that.processed_par_items[pt].suggested_amount=that.suggested_table_data[ot].suggested_amount,that.processed_par_items[pt].suggested_order_type=that.suggested_table_data[ot].suggested_order_type;break}}})},that.getParData=function(){var deferred=$q.defer();return that.count_limit=100,that.dataChanged?SweetAlert.swal({title:"Are you sure?",text:"Unsaved changes will be lost if you change the category.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"OK"},function(sres){sres&&(that.dataChanged=!1,that.api.get_par({category:that.category,inventory_type_id:1,get_notif_status:!0}).then(function(res){res&&(that.par_data=res.data.data.pars,that.count_limit=isNaN(res.data.data.notif_count)?0:that.count_limit-res.data.data.notif_count,that.processPar()),deferred.resolve()}))}):that.api.get_par({category:that.category,inventory_type_id:1,get_notif_status:!0}).then(function(res){res&&(that.par_data=res.data.data.pars,that.count_limit=isNaN(res.data.data.notif_count)?0:that.count_limit-res.data.data.notif_count,that.processPar()),deferred.resolve()}),deferred.promise},that.saveActualPar=function(){that.api.update_par({inventory_type_id:1,pars_data:that.par_data.map(function(x){return{vendor_sku_id:x.vendor_sku_id,actual_par_units:x.actual_par_units,order_unit:x.bu_minimum_order_type,alert_if_low:x.alert_if_low,notify_units:x.notify_units}})}).then(function(res){res&&1e3==res.data.data.code?(that.dataChanged=!1,alertService.showAlertSave()):alertService.showError("Something went wrong!")})},that.$onInit=function(){that.api.get_active_SKU_categories({inventory_type_id:1}).then(function(res){that.SKU_categories=res.data.data.categories,that.SKU_categories.length&&(that.category=that.SKU_categories[0].category,that.dataChanged=!1,that.getData())})}}setParController.$inject=["api","$state","auth","core","localStorageService","alertService","SweetAlert","restaurant","$rootScope","$scope","$q"],angular.module("inspinia").component("setFoodParComponent",{templateUrl:"js/components/foodSetup/setPar/setPar.html",controller:setParController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("foodSetup.setPar",{url:"/set-par",template:"<set-food-par-component></set-food-par-component>",data:{pageTitle:"Set Par"}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("foodSetup.confirmation",{url:"/confirmation",template:"<setup-confirmation-component></setup-confirmation-component>",data:{pageTitle:"Setup Confirmation"}})})}(),function(){"use strict";function addEditFoodLocationsController($uibModalInstance,api,alertService,locations,restaurant_id){var that=this;that.form={},that.api=api,that.addLocation=function(){if(!(that.active_locations_length<that.locations_limit))return void alertService.showError("Active locations limit reached!");that.active_locations_length++,that.locations.push({location_name:null,status:1,added:!0})},that.changeLocationsStatus=function($index,action){if("hide"==action)that.active_locations_length--,that.locations[$index].status=0;else{if(!(that.active_locations_length<that.locations_limit))return void alertService.showError("Active locations limit reached!");that.active_locations_length++,that.locations[$index].status=1}},that.remove=function($index){1==that.locations[$index].status&&that.active_locations_length--,that.locations.splice($index,1)},that.save=function(form){if(!form.$valid)return void alertService.showError("Please validate all inputs");if(!(that.active_locations_length<=that.locations_limit))return void alertService.showError("Active locations limit reached!");var headers={restaurant_id:restaurant_id,inventory_type_id:1,loc_list:that.locations};that.api.add_edit_locations(headers).then(function(res){try{1e3===res.data.data.code&&(alertService.showSuccessText("Saved!"),that.getLocations())}catch(e){console.log(e)}})},that.cancel=function(){$uibModalInstance.dismiss("cancel")},that.getLocations=function(){var headers={restaurant_id:restaurant_id,inventory_type_id:1};that.api.get_restaurant_audit_locations(headers).then(function(res){that.locations=res.data.data.Report,that.active_locations_length=that.locations.filter(function(x){return 1==x.status}).length,"active"==that.show_status?that.locations=that.locations.filter(function(x){return 1==x.status}):that.locations=that.locations.filter(function(x){return 0==x.status})})},that.locations_limit=7,that.show_status="active",that.getLocations()}addEditFoodLocationsController.$inject=["$uibModalInstance","api","alertService","locations","restaurant_id"],angular.module("inspinia").controller("addEditFoodLocationsController",addEditFoodLocationsController)}(),function(){"use strict";function addFoodItemsController($uibModalInstance,alertService,$filter,searchParams,locations,selected_location){var that=this;searchParams&&(that.item=searchParams.item,that.mode=searchParams.mode,that.locations=locations,that.selected_location=selected_location);var parseStringToNum=function(st){return"inv"==that.mode?st.split("+").filter(function(item){return""!==item.split("_")[0]}).map(function(item,i){return{id:i,value:parseFloat(item.split("_")[0]),locn_id:parseInt(item.split("_")[1])}}):st.split("+").filter(function(item){return""!==item}).map(function(item,i){return{id:i,value:parseFloat(item)}})},parseNumToString=function(array){return"inv"==that.mode?array.map(function(item){return item.value+"_"+item.locn_id}).join("+"):array.map(function(item){return item.value}).join("+")};if("inv"==that.mode)that.entries={full:null!=that.item.full_values?parseStringToNum(that.item.full_values):[],pack:null!=that.item.pack_values?parseStringToNum(that.item.pack_values):[],partial:null!=that.item.partial_values?parseStringToNum(that.item.partial_values):[]};else{that.entries={full:[],partial:[]},that.entries=[];for(var i=0;i<that.item.items.length;i++)for(var full=null!=that.item.items[i].full_values?parseStringToNum(that.item.items[i].full_values):[],partial=null!=that.item.items[i].partial_values?parseStringToNum(that.item.items[i].partial_values):[],j=0;j<full.length;j++)that.entries.push({recipe_created_on:new Date(that.item.items[i].recipe_created_on.substring(0,10).replace(/-/g,"/")),full:full[j].value,partial:partial[j].value,visible:!0})}that.addField=function(){if("inv"==that.mode){var fid=that.entries.full.length?that.entries.full.length+1:0;that.entries.full.push({id:fid,value:0,locn_id:selected_location});var pkid=that.entries.pack.length?that.entries.pack.length+1:0;if(that.entries.pack.push({id:pkid,value:0,locn_id:selected_location}),"Bottle Beer"!=that.item.category){var pid=that.entries.partial.length?that.entries.partial.length+1:0;that.entries.partial.push({id:pid,value:0,locn_id:selected_location})}}else that.entries.push({recipe_created_on:new Date,full:0,partial:0,visible:!0})},that.removeField=function(index,type){"inv"==that.mode?"full"==type?that.entries.full.splice(index,1):"pack"==type?that.entries.pack.splice(index,1):"partial"==type&&that.entries.partial.splice(index,1):(that.entries[index].full=0,that.entries[index].partial=0,that.entries[index].visible=!1)},that._computeTotalByString=function(st){return st?st.split("+").filter(function(item){return""!==(item=item.split("_")[0])}).map(function(entry){return parseFloat(entry)}).reduce(function(pV,cV){return pV+cV}):0},that._recalculateTotal=function(indx){that.item.items[indx].n_partial_entries=0,null!=that.item.items[indx].partial_values&&(that.item.items[indx].n_partial_entries=that.item.items[indx].partial_values.split("+").filter(function(item){return""!==(item=item.split("_")[0])&&"0"!=item}).length),that.item.items[indx].full_total=that._computeTotalByString(that.item.items[indx].full_values),that.item.items[indx].pack_total=that._computeTotalByString(that.item.items[indx].pack_values),that.item.items[indx].partial_total=that._computeTotalByString(that.item.items[indx].partial_values)},that.save=function(){if("inv"==that.mode)that.item.full_values=null!=that.entries.full?parseNumToString(that.entries.full):null,that.item.pack_values=null!=that.entries.pack?parseNumToString(that.entries.pack):null,that.item.partial_values=null!=that.entries.partial?parseNumToString(that.entries.partial):null,$uibModalInstance.close(that.item);else{for(var i=0;i<that.item.items.length;i++)that.item.items[i].full_qty=0,that.item.items[i].full_values=null,that.item.items[i].partial_qty=0,that.item.items[i].partial_values=null;for(var j=0;j<that.entries.length;j++){for(var no_date=!0,i=0;i<that.item.items.length;i++)$filter("date")(that.item.items[i].recipe_created_on,"yyyy-MM-dd")==$filter("date")(that.entries[j].recipe_created_on,"yyyy-MM-dd")&&(no_date=!1,that.item.items[i].full_values=null!=that.entries[j].full?null!=that.item.items[i].full_values?that.item.items[i].full_values+"+"+that.entries[j].full.toString():that.entries[j].full.toString():null!=that.item.items[i].full_values?that.item.items[i].full_values+"+0":"0",that.item.items[i].partial_values=null!=that.entries[j].partial?null!=that.item.items[i].partial_values?that.item.items[i].partial_values+"+"+that.entries[j].partial.toString():that.entries[j].partial.toString():null!=that.item.items[i].partial_values?that.item.items[i].partial_values+"+0":"0");if(no_date){that.item.items.push(JSON.parse(JSON.stringify(that.item.items[0])));var nd=that.item.items.length-1;that.item.items[nd].recipe_created_on=$filter("date")(that.entries[j].recipe_created_on,"yyyy-MM-dd"),that.item.items[nd].full_values=null!=that.entries[j].full?that.entries[j].full.toString():"0",that.item.items[nd].partial_values=null!=that.entries[j].partial?that.entries[j].partial.toString():"0"}}for(var i=0;i<that.item.items.length;i++)that._recalculateTotal(i);$uibModalInstance.close(that.item)}},that.cancel=function(){$uibModalInstance.dismiss("cancel")}}addFoodItemsController.$inject=["$uibModalInstance","alertService","$filter","searchParams","locations","selected_location"],angular.module("inspinia").controller("addFoodItemsController",addFoodItemsController)}(),function(){"use strict";function tabletEntryController(api,$state,auth,$filter,localStorageService,restaurant,core,alertService,SweetAlert,$uibModal){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.api=api,that.auth=auth,that.is_sug_aud=void 0!==$state.params.is_sug_aud&&""!=$state.params.is_sug_aud?$state.params.is_sug_aud:"false",restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.pickers={beginDate:{open:!1,date:new Date},endDate:{open:!1,date:new Date},beginDateBackup:{open:!1,date:new Date}};var date=new Date,d=date,month=d.getMonth()+1,day=d.getDate();that.maxBatchCreationDate=d.getFullYear()+"-"+((""+month).length<2?"0":"")+month+"-"+((""+day).length<2?"0":"")+day;var INVENTORY_MASTER_LIST=[];that.currentFoodIndex=0,that.model={categories:[],subcategories:[],quick_search_keys:[],prev_item:null,current_item:null,next_item:null,search_query:null,inventory:[],full_total:null,pack_total:null,partial_total:null,n_partial_entries:null,batch_input_modes:["Oz","Lbs","Batches"],selected_batch_input_mode:null},that.changeLocation=function(){-1==that.selected_location&&(that.selected_location=that.locations[0].sr_no,$uibModal.open({templateUrl:"js/components/foodSetup/tabletEntry/locationEntry.html",controller:"addEditFoodLocationsController",windowClass:"animated fadeIn",controllerAs:"$ctr",size:"md",resolve:{locations:function(){return that.locations.filter(function(x){return-1!=x.sr_no})},restaurant_id:function(){return that.restaurant_id.restaurant_id}}}).closed.then(function(){that.getLocations()}))},that.addUniqueItems=function(){if("inv"==that.mode){var headers={is_adjustment:0,inventory_type_id:1,vendor_cat_id:"all"==that.selected_category.id?null:that.selected_category.id,vendor_sku_id:that.model.current_item.vendor_sku_id};that.api.get_inventory_audit(headers).then(function(res){res.data.data.inventory.length&&(that.model.current_item.full_values=res.data.data.inventory[0].full_values,that.model.current_item.pack_values=res.data.data.inventory[0].pack_values,that.model.current_item.partial_values=res.data.data.inventory[0].partial_values),$uibModal.open({templateUrl:"js/components/foodSetup/tabletEntry/modalEntry.html",controller:"addFoodItemsController",windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",size:"lg",resolve:{searchParams:function(){return{item:that.model.current_item,mode:that.mode}},locations:function(){return that.locations.filter(function(x){return-1!=x.sr_no})},selected_location:function(){return that.selected_location}}}).result.then(function(){that._recalculateTotal();var item={id:that.model.current_item.id,vendor_sku_id:that.model.current_item.vendor_sku_id,item_qty:that.model.current_item.partial_total,cases_qty:that.model.current_item.full_total,nof_bottles:0,packs_qty:that.model.current_item.pack_total,total_in_uom_of_delivery:that.calculate_uom_of_delivery(that.model.current_item),item_qty_formula:null,full_values:that.model.current_item.full_values,pack_values:that.model.current_item.pack_values,partial_values:that.model.current_item.partial_values};that._submitInventory(item,!0)})})}else{var headers={is_adjustment:0,inventory_type_id:1,recipe_type_id:that.selected_category.r_type_id,recipe_id:that.model.current_item.recipe_id};that.api.get_recipe_audit(headers).then(function(res){if(res.data.data.inventory.length){for(var dict={},i=0;i<res.data.data.inventory.length;i++)dict.hasOwnProperty(res.data.data.inventory[i].recipe_id)?dict[res.data.data.inventory[i].recipe_id].push(res.data.data.inventory[i]):dict[res.data.data.inventory[i].recipe_id]=[res.data.data.inventory[i]];for(var b in dict)that.model.current_item.items=dict[b]}$uibModal.open({templateUrl:"js/components/foodSetup/tabletEntry/modalEntry.html",controller:"addFoodItemsController",windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",size:"md",resolve:{searchParams:function(){return{item:that.model.current_item,mode:that.mode}},locations:function(){return that.locations.filter(function(x){return-1!=x.sr_no})},selected_location:function(){return that.selected_location}}}).result.then(function(){that._recalculateTotal();for(var items=[],i=0;i<that.model.current_item.items.length;i++)items.push({id:that.model.current_item.items[i].id,recipe_type_id:that.model.current_item.items[i].recipe_type_id,total_servings:that.model.current_item.items[i].total_servings,full_qty:that.model.current_item.items[i].full_total,partial_qty:that.model.current_item.items[i].partial_total,is_ref:0,recipe_created_on:that.model.current_item.items[i].recipe_created_on,full_values:that.model.current_item.items[i].full_values,partial_values:that.model.current_item.items[i].partial_values});that._submitBatches(items)})})}},that.prepBatchObjAndSave=function(){var no_date=!0,indx=0;"Oz"==that.model.selected_batch_input_mode?that.model.current_item.packs_qty_inp=(that.model.current_item.packs_qty_inp/that.model.current_item.total_servings).toFixed(2):"Lbs"==that.model.selected_batch_input_mode&&(that.model.current_item.packs_qty_inp=(16*that.model.current_item.packs_qty_inp/that.model.current_item.total_servings).toFixed(2));for(var i=0;i<that.model.current_item.items.length;i++)if($filter("date")(that.model.current_item.items[i].recipe_created_on,"yyyy-MM-dd")==$filter("date")(that.model.current_item.created_on_inp,"yyyy-MM-dd")){no_date=!1,indx=i,that.model.current_item.items[i].full_values=null!=that.model.current_item.packs_qty_inp?null!=that.model.current_item.items[i].full_values?that.model.current_item.items[i].full_values+"+"+that.model.current_item.packs_qty_inp.toString():that.model.current_item.packs_qty_inp.toString():null!=that.model.current_item.items[i].full_values?that.model.current_item.items[i].full_values+"+0":"0",that.model.current_item.items[i].partial_values=null!=that.model.current_item.item_qty_inp?null!=that.model.current_item.items[i].partial_values?that.model.current_item.items[i].partial_values+"+"+that.model.current_item.item_qty_inp.toString():that.model.current_item.item_qty_inp.toString():null!=that.model.current_item.items[i].partial_values?that.model.current_item.items[i].partial_values+"+0":"0";break}if(no_date){that.model.current_item.items.push(JSON.parse(JSON.stringify(that.model.current_item.items[0])));var nd=that.model.current_item.items.length-1;that.model.current_item.items[nd].recipe_created_on=$filter("date")(that.model.current_item.created_on_inp,"yyyy-MM-dd"),that.model.current_item.items[nd].full_values=null!=that.model.current_item.packs_qty_inp?that.model.current_item.packs_qty_inp.toString():"0",that.model.current_item.items[nd].partial_values=null!=that.model.current_item.item_qty_inp?that.model.current_item.item_qty_inp.toString():"0",indx=nd}that._recalculateTotal(indx,that.model.current_item.created_on_inp);var items=[{id:that.model.current_item.items[indx].id,recipe_type_id:that.model.current_item.items[indx].recipe_type_id,total_servings:that.model.current_item.items[indx].total_servings,full_qty:that.model.current_item.items[indx].full_total,partial_qty:that.model.current_item.items[indx].partial_total,is_ref:0,recipe_created_on:that.model.current_item.created_on_inp?$filter("date")(that.model.current_item.created_on_inp,"yyyy-MM-dd"):null,full_values:that.model.current_item.items[indx].full_values,partial_values:that.model.current_item.items[indx].partial_values}];that._submitBatches(items)},that.handleSubmitBatches=function(){if(that.model.current_item.created_on_inp>new Date)return void alertService.showError("Invalid date!");if(that.model.current_item.packs_qty_inp||that.model.current_item.item_qty_inp){var headers={is_adjustment:0,inventory_type_id:1,recipe_type_id:that.selected_category.r_type_id,recipe_id:that.model.current_item.recipe_id};that.api.get_recipe_audit(headers).then(function(res){if(res.data.data.inventory.length){for(var dict={},i=0;i<res.data.data.inventory.length;i++)dict.hasOwnProperty(res.data.data.inventory[i].recipe_id)?dict[res.data.data.inventory[i].recipe_id].push(res.data.data.inventory[i]):dict[res.data.data.inventory[i].recipe_id]=[res.data.data.inventory[i]];for(var b in dict)that.model.current_item.items=dict[b]}var temp_date=new Date(that.model.current_item.created_on_inp),expiry=new Date(temp_date.setDate(temp_date.getDate()+that.model.current_item.shelf_life));that.pickers.beginDate.date>=expiry?SweetAlert.swal({title:"Batch Expired?",text:"This batch seems to have expired! Verify the batch creation date before you Save.",type:"warning",showCancelButton:!0,confirmButtonColor:"#337ab7",confirmButtonText:"Save"},function(res){res&&that.prepBatchObjAndSave()}):that.prepBatchObjAndSave()})}},that.handleSubmitSubcategory=function(){if(null==that.model.current_item.vendor_sub_cat_id)return void alertService.showError("Please select a subcategory.");SweetAlert.swal({title:"Are you sure?",text:"Are you sure you want to change the subcategory of the item. This change could affect multiple reports.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){if(res){var m={vendor_sub_cat_id:that.model.current_item.vendor_sub_cat_id};that.api.update_sku(that.model.current_item.vendor_sku_id,m).then(function(res){200===res.status&&(that.disableCheckBoxes(),SweetAlert.swal("Saved!","Your changes has been saved!","success"))})}})},that.handleSubmitEntries=function(){if(that.model.current_item.cases_qty_inp||that.model.current_item.packs_qty_inp||that.model.current_item.item_qty_inp){var headers={is_adjustment:0,inventory_type_id:1,vendor_cat_id:"all"==that.selected_category.id?null:that.selected_category.id,vendor_sku_id:that.model.current_item.vendor_sku_id};that.api.get_inventory_audit(headers).then(function(res){res.data.data.inventory.length&&(that.model.current_item.full_values=res.data.data.inventory[0].full_values,that.model.current_item.pack_values=res.data.data.inventory[0].pack_values,that.model.current_item.partial_values=res.data.data.inventory[0].partial_values),that.model.current_item.full_values=null!=that.model.current_item.cases_qty_inp?null!=that.model.current_item.full_values?that.model.current_item.full_values+"+"+that.model.current_item.cases_qty_inp.toString()+"_"+that.selected_location:that.model.current_item.cases_qty_inp.toString()+"_"+that.selected_location:null!=that.model.current_item.full_values?that.model.current_item.full_values:null,that.model.current_item.pack_values=null!=that.model.current_item.packs_qty_inp?null!=that.model.current_item.pack_values?that.model.current_item.pack_values+"+"+that.model.current_item.packs_qty_inp.toString()+"_"+that.selected_location:that.model.current_item.packs_qty_inp.toString()+"_"+that.selected_location:null!=that.model.current_item.pack_values?that.model.current_item.pack_values:null,that.model.current_item.partial_values=null!=that.model.current_item.item_qty_inp?null!=that.model.current_item.partial_values?that.model.current_item.partial_values+"+"+that.model.current_item.item_qty_inp.toString()+"_"+that.selected_location:that.model.current_item.item_qty_inp.toString()+"_"+that.selected_location:null!=that.model.current_item.partial_values?that.model.current_item.partial_values:null,that._recalculateTotal();var item={id:that.model.current_item.id,vendor_sku_id:that.model.current_item.vendor_sku_id,item_qty:that.model.current_item.partial_total,cases_qty:that.model.current_item.full_total,nof_bottles:0,packs_qty:that.model.current_item.pack_total,total_in_uom_of_delivery:that.calculate_uom_of_delivery(that.model.current_item),item_qty_formula:null,full_values:that.model.current_item.full_values,pack_values:that.model.current_item.pack_values,partial_values:that.model.current_item.partial_values};that._submitInventory(item,!1)})}},that.createConversionTable=function(){"inv"==that.mode&&(that.conversion_table=[],that.conversion_table.push({from:5,to:14,value:.0625}),that.conversion_table.push({from:5,to:15,value:28.3495}),that.conversion_table.push({from:5,to:19,value:.0283}),that.conversion_table.push({from:14,to:5,value:16}),that.conversion_table.push({from:14,to:15,value:453.592}),that.conversion_table.push({from:14,to:19,value:.4536}),that.conversion_table.push({from:15,to:5,value:.0353}),that.conversion_table.push({from:15,to:14,value:.0022}),that.conversion_table.push({from:15,to:19,value:.001}),that.conversion_table.push({from:19,to:5,value:35.274}),that.conversion_table.push({from:19,to:14,value:2.2046}),that.conversion_table.push({from:19,to:15,value:1e3}),that.conversion_table.push({from:1,to:2,value:3.7854}),that.conversion_table.push({from:1,to:3,value:4}),that.conversion_table.push({from:1,to:4,value:8}),that.conversion_table.push({from:1,to:5,value:128}),that.conversion_table.push({from:1,to:8,value:3785.4}),that.conversion_table.push({from:2,to:1,value:.2642}),that.conversion_table.push({from:2,to:3,value:1.0567}),that.conversion_table.push({from:2,to:4,value:2.1134}),that.conversion_table.push({from:2,to:5,value:33.814}),that.conversion_table.push({from:2,to:8,value:1e3}),that.conversion_table.push({from:3,to:1,value:.25}),that.conversion_table.push({from:3,to:2,value:.9464}),that.conversion_table.push({from:3,to:4,value:2}),that.conversion_table.push({from:3,to:5,value:32}),that.conversion_table.push({from:3,to:8,value:946.353}),that.conversion_table.push({from:4,to:1,value:.125}),that.conversion_table.push({from:4,to:2,value:.4732}),that.conversion_table.push({from:4,to:3,value:.5}),that.conversion_table.push({from:4,to:5,value:16}),that.conversion_table.push({from:4,to:8,value:473.176}),that.conversion_table.push({from:5,to:1,value:.0078}),that.conversion_table.push({from:5,to:2,value:.0296}),that.conversion_table.push({from:5,to:3,value:.0313}),that.conversion_table.push({from:5,to:4,value:.0625}),that.conversion_table.push({from:5,to:8,value:29.5735}),that.conversion_table.push({from:8,to:1,value:3e-4}),that.conversion_table.push({from:8,to:2,value:.001}),that.conversion_table.push({from:8,to:3,value:.0011}),that.conversion_table.push({from:8,to:4,value:.0021}),that.conversion_table.push({from:8,to:5,value:.0338}))},that.convert=function(from,to){if(from==to)return 1;for(var i=0;i<that.conversion_table.length;i++)if(that.conversion_table[i].from==from&&that.conversion_table[i].to==to)return that.conversion_table[i].value},that.preProcessCOS=function(){for(var dict={},signs={},primary_uod={},i=0;i<that.cos_table_data.length;i++)null==that.cos_table_data[i].substitute_for?(primary_uod[that.cos_table_data[i].vendor_sku_id]=that.cos_table_data[i].uod_id,dict.hasOwnProperty(that.cos_table_data[i].vendor_sku_id)?(dict[that.cos_table_data[i].vendor_sku_id].push(that.cos_table_data[i]),0==that.cos_table_data[i].purchases?signs[that.cos_table_data[i].vendor_sku_id][0]++:signs[that.cos_table_data[i].vendor_sku_id][1]++):(dict[that.cos_table_data[i].vendor_sku_id]=[that.cos_table_data[i]],signs[that.cos_table_data[i].vendor_sku_id]=[0,0],0==that.cos_table_data[i].purchases?signs[that.cos_table_data[i].vendor_sku_id][0]++:signs[that.cos_table_data[i].vendor_sku_id][1]++)):dict.hasOwnProperty(that.cos_table_data[i].substitute_for)?(dict[that.cos_table_data[i].substitute_for].push(that.cos_table_data[i]),0==that.cos_table_data[i].purchases?signs[that.cos_table_data[i].substitute_for][0]++:signs[that.cos_table_data[i].substitute_for][1]++):(dict[that.cos_table_data[i].substitute_for]=[that.cos_table_data[i]],signs[that.cos_table_data[i].substitute_for]=[0,0],0==that.cos_table_data[i].purchases?signs[that.cos_table_data[i].substitute_for][0]++:signs[that.cos_table_data[i].substitute_for][1]++);for(var key in dict)if(dict.hasOwnProperty(key))for(var i=0;i<dict[key].length;i++){var conv_val=that.convert(dict[key][i].uod_id,primary_uod[key]);dict[key][i].item_cost=dict[key][i].item_cost/conv_val,dict[key][i].purchases=dict[key][i].purchases*conv_val,dict[key][i].sales=dict[key][i].sales*conv_val,dict[key][i].beg_oz=dict[key][i].beg_oz*conv_val,dict[key][i].awc=dict[key][i].awc*conv_val,
dict[key][i].end_oz=dict[key][i].end_oz*conv_val,dict[key][i].theor_sales=dict[key][i].theor_sales*conv_val,dict[key][i].unit_variance=dict[key][i].unit_variance*conv_val}var total={};for(var key in dict)if(dict.hasOwnProperty(key)){total[key]=0;for(var i=0;i<dict[key].length;i++)total[key]+=Math.abs(dict[key][i].purchases)}for(var key in dict)if(dict.hasOwnProperty(key))if(0==signs[key][0]&&0!=signs[key][1])for(var i=0;i<dict[key].length;i++)dict[key][i].wauc=Math.abs(dict[key][i].purchases)/total[key]*dict[key][i].item_cost;else if(0!=signs[key][0]&&0!=signs[key][1])for(var i=0;i<dict[key].length;i++)dict[key][i].wauc=Math.abs(dict[key][i].purchases)/total[key]*dict[key][i].item_cost;else if(0!=signs[key][0]&&0==signs[key][1])for(var i=0;i<dict[key].length;i++)dict[key][i].wauc=1/signs[key][0]*dict[key][i].item_cost;var p_indx={},yo=[];for(var key in dict)if(dict.hasOwnProperty(key)){for(var uc=0,pur=0,sales=0,beg=0,awc=0,end=0,ther=0,unit=0,i=0;i<dict[key].length;i++)null==dict[key][i].substitute_for&&(p_indx[key]=i),uc+=dict[key][i].wauc,pur+=dict[key][i].purchases,sales+=dict[key][i].sales,beg+=dict[key][i].beg_oz,awc+=dict[key][i].awc,end+=dict[key][i].end_oz,ther+=dict[key][i].theor_sales,unit+=dict[key][i].unit_variance;dict[key][p_indx[key]].wauc=uc,dict[key][p_indx[key]].purchases=pur,dict[key][p_indx[key]].sales=sales,dict[key][p_indx[key]].beg_oz=beg,dict[key][p_indx[key]].awc=awc,dict[key][p_indx[key]].end_oz=end,dict[key][p_indx[key]].theor_sales=ther,dict[key][p_indx[key]].unit_variance=unit,dict[key][p_indx[key]].cost_variance=unit*uc,yo.push(dict[key][p_indx[key]])}that.cos_table_data=yo},that.getCOS=function(item,is_ve){if(that.loadingCOS=!0,void 0===item||is_ve)that.api.get_audit_dates({RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:1}).then(function(res1){that.audit_dates=res1.data.data.Report,that.audit_dates_f=res1.data.data.Report.map(function(x){return x.audit_dates.substring(0,10)}),that.audit_dates_t=JSON.parse(JSON.stringify(that.audit_dates_f)),that.audit_dates_f.splice(0,1),that.start_date=that.audit_dates_f[0],that.end_date=that.audit_dates_t[0];var params=item?{RestaurantId:that.restaurant_id.restaurant_id,Category:"all"==that.selected_category.id?"%":that.selected_category.category,start_date:that.start_date,end_date:that.end_date,inventory_type_id:1,vendor_sku_id:item.vendor_sku_id}:{RestaurantId:that.restaurant_id.restaurant_id,Category:"all"==that.selected_category.id?"%":that.selected_category.category,start_date:that.start_date,end_date:that.end_date,inventory_type_id:1};that.api.sku_table(params).then(function(res){if(that.loadingCOS=!1,res&&(that.cos_table_data=res.data.data.sku_table,void 0!==that.cos_table_data&&null!=that.cos_table_data&&that.cos_table_data.length)){that.global_cos_table_data=JSON.parse(JSON.stringify(that.cos_table_data));for(var i=0;i<that.model.inventory.length;i++)for(var c=0;c<that.cos_table_data.length;c++)if(that.model.inventory[i].vendor_sku_id==that.cos_table_data[c].vendor_sku_id){that.model.inventory[i].unit_variance=that.cos_table_data[c].unit_variance,that.model.inventory[i].OH=that.cos_table_data[c].beg_oz+that.cos_table_data[c].purchases-that.cos_table_data[c].sales;break}}})});else{if(void 0!==that.global_cos_table_data)for(var c=0;c<that.global_cos_table_data.length;c++)if(null==item.substitute_for&&item.vendor_sku_id==that.global_cos_table_data[c].vendor_sku_id){that.global_cos_table_data[c].unit_variance=that.calculate_uom_of_delivery(that.model.current_item)-that.model.current_item.OH,that.global_cos_table_data[c].end_oz=that.calculate_uom_of_delivery(that.model.current_item);for(var i=0;i<that.model.inventory.length;i++)if(that.model.inventory[i].vendor_sku_id==that.global_cos_table_data[c].vendor_sku_id){that.model.inventory[i].unit_variance=that.global_cos_table_data[c].unit_variance;break}break}that.loadingCOS=!1}},that.setCOS=function(){that.cos_table_data=JSON.parse(JSON.stringify(that.global_cos_table_data));for(var i=0;i<that.model.inventory.length;i++)for(var c=0;c<that.cos_table_data.length;c++)if(that.model.inventory[i].vendor_sku_id==that.cos_table_data[c].vendor_sku_id){that.model.inventory[i].unit_variance=that.cos_table_data[c].unit_variance,that.model.inventory[i].OH=that.cos_table_data[c].beg_oz+that.cos_table_data[c].purchases-that.cos_table_data[c].sales;break}},that._recalculateTotal=function(indx,date_inp){if("inv"==that.mode)null!=that.model.current_item.partial_values?that.model.current_item.n_partial_entries=that.model.current_item.partial_values.split("+").filter(function(item){return""!==(item=item.split("_")[0])&&"0"!=item}).length:that.model.current_item.n_partial_entries=0,that.model.current_item.full_total=that._computeTotalByString(that.model.current_item.full_values),that.model.current_item.pack_total=that._computeTotalByString(that.model.current_item.pack_values),that.model.current_item.partial_total=that._computeTotalByString(that.model.current_item.partial_values),that.model.current_item.cases_qty_inp=null,that.model.current_item.packs_qty_inp=null,that.model.current_item.item_qty_inp=null;else{that.model.current_item.n_partial_entries=0,that.model.current_item.full_total=0,that.model.current_item.partial_total=0;for(var i=0;i<that.model.current_item.items.length;i++)null!=that.model.current_item.items[i].partial_values&&(that.model.current_item.n_partial_entries+=that.model.current_item.items[i].partial_values.split("+").filter(function(item){return""!==item&&"0"!=item}).length),that.model.current_item.full_total+=that._computeTotalByString(that.model.current_item.items[i].full_values),that.model.current_item.partial_total+=that._computeTotalByString(that.model.current_item.items[i].partial_values);that.model.current_item.packs_qty_inp=null,that.model.current_item.item_qty_inp=null,new Date,that.model.current_item.created_on_inp=null==date_inp?that.pickers.beginDate.date:new Date(date_inp),null!=indx&&(that.model.current_item.items[indx].n_partial_entries=0,null!=that.model.current_item.items[indx].partial_values&&(that.model.current_item.items[indx].n_partial_entries=that.model.current_item.items[indx].partial_values.split("+").filter(function(item){return""!==item&&"0"!=item}).length),that.model.current_item.items[indx].full_total=that._computeTotalByString(that.model.current_item.items[indx].full_values),that.model.current_item.items[indx].partial_total=that._computeTotalByString(that.model.current_item.items[indx].partial_values))}},that._computeTotalByString=function(st){return st?st.split("+").filter(function(item){return""!==(item=item.split("_")[0])}).map(function(entry){return parseFloat(entry)}).reduce(function(pV,cV){return pV+cV}):0},that.deleteCurrentInventoryAudit=function(){SweetAlert.swal({title:"Are you sure?",text:"This will completely delete the saved Audit for this restaurant and you will have to startover!",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){res&&that.api.delete_inventory_audit(1,that.is_sug_aud).then(function(res1){res&&(SweetAlert.swal("Deleted!","Please proceed to startover a new audit.","success"),$state.go("foodSubCategories"))})})},that._submitBatches=function(items){var m={inventory_type_id:1,counting_started_at:new Date(that.pickers.beginDate.date).getTime(),counting_ended_at:(new Date).getTime(),is_final_save:0,is_adjustment:0,inventory_items:items};that.api.update_recipe_audit(m).then(function(res){SweetAlert.swal("Saved!","Your changes has been saved!","success")})},that._submitInventory=function(item,is_ve){var m={inventory_type_id:1,counting_started_at:new Date(that.pickers.beginDate.date).getTime(),counting_ended_at:(new Date).getTime(),is_final_save:0,is_adjustment:0,inventory_items:[item],tablet_mode:!0,is_suggested:"true"==that.is_sug_aud?1:0};that.api.update_inventory_audit(m).then(function(res){SweetAlert.swal("Saved!","Your changes has been saved!","success"),void 0!==that.res_data_audit_start&&null!=that.res_data_audit_start[0].audit_start||(that.res_data_audit_start=[{audit_start:new Date}]),null==that.model.current_item.substitute_for&&that.showCOSDetails&&that.getCOS(that.model.current_item,is_ve)})},that.calculate_uom_of_delivery=function(item){return item.full_total*item.total_unit_size+item.pack_total*item.size+item.partial_total},that.disableCheckBoxes=function(){that.model.subcat_enabled=!1},that.viewReport=function(){$state.go("reports.foodCostOfSummary")},that.finalSaveAudit=function(caller){if("suggested"==caller)that.api.get_audit_dates({RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:1}).then(function(res1){that.audit_dates=res1.data.data.Report,that.audit_dates_f=res1.data.data.Report.map(function(x){return{aud_title:x.audit_dates.substring(0,10)+" ("+x.type+" by "+x.audited_by_org+")",audit_dates:x.audit_dates.substring(0,10),src:x.src,type:x.type,is_suggested:x.is_suggested}});var adminFS=function(){var m={inventory_type_id:1,counting_started_at:(new Date).getTime(),counting_ended_at:(new Date).getTime(),is_final_save:1,is_adjustment:"suggested"==caller?1:0,send_email:"suggested"==caller,additional_notes:that.additional_notes,inventory_items:[],is_suggested:"true"==that.is_sug_aud?1:0};void 0!==that.prev_audit_date&&null!=that.prev_audit_date&&(m.prev_audit_date=that.prev_audit_date),null==m.additional_notes&&delete m.additional_notes,that.api.update_inventory_audit(m).then(function(res){try{1e3===res.data.data.code&&(alertService.showAlertSave(),$state.go("alcoholSubCategories"))}catch(e){console.log(e)}},function(){})};if("true"==that.is_sug_aud){var conf={title:"Are you sure?",text:"This will permanently update your on-hand count as of today. You will shortly receive a report on your email.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"};swal(conf,function(res){res&&(that.is_send_email=!0,that.audit_type="adjustment",that.additional_notes=null,that.prev_audit_date=that.audit_dates_f[1],adminFS())})}});else if("first_audit"==caller){var adminFS=function(){var m={inventory_type_id:1,counting_started_at:(new Date).getTime(),counting_ended_at:(new Date).getTime(),is_final_save:1,is_adjustment:0,send_email:!1,additional_notes:that.additional_notes,inventory_items:[],is_suggested:0};null==m.additional_notes&&delete m.additional_notes,that.api.update_inventory_audit(m).then(function(res){try{1e3===res.data.data.code&&(alertService.showAlertSave(),$state.go("alcoholSubCategories"))}catch(e){console.log(e)}},function(){})},conf={title:"Are you sure?",text:"This will permanently update your on-hand count as of today. You will shortly receive a report on your email.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"};swal(conf,function(res){res&&(that.additional_notes=null,adminFS())})}},that.back=function(){0==that.SetUpStatus?$state.go("setupFirstAudit"):$state.go("foodSubCategories")},that.navigate=function(direction){"next"===direction&&that.currentFoodIndex<that.model.inventory.length-1?(that.currentFoodIndex++,that.model.current_item=that.model.inventory[that.currentFoodIndex]):"previous"===direction&&that.currentFoodIndex>0&&(that.currentFoodIndex--,that.model.current_item=that.model.inventory[that.currentFoodIndex]),that._recalculateTotal(),that.setPrevNext(that.currentFoodIndex)},that.setPrevNext=function(index){that.model.inventory&&(that.model.prev_item=index>0?that.model.inventory[index-1]:null,that.model.next_item=index<that.model.inventory.length-1?that.model.inventory[index+1]:null)},that.hideShowSubstitutes=function(is_manual,inv_list){that.hide_subs=is_manual?!that.hide_subs:that.hide_subs,inv_list||(that.currentFoodIndex=0);var fl=inv_list||INVENTORY_MASTER_LIST;that.hide_subs?(that.model.inventory=fl.filter(function(item){return null==item.substitute_for}),inv_list||(that.model.current_item=that.model.inventory[0])):(that.model.inventory=fl,inv_list||(that.model.current_item=that.model.inventory[0])),is_manual&&(that.model.quick_search_keys=that._extractKeys(),that._recalculateTotal()),inv_list||that.setPrevNext(that.currentFoodIndex)},that.handleSearch=function(query){that.currentFoodIndex=0,that.hide_subs&&"inv"==that.mode?that.hideShowSubstitutes(!1,INVENTORY_MASTER_LIST):that.model.inventory=INVENTORY_MASTER_LIST,query&&query.length?that.model.inventory=that.model.inventory.filter(function(item){return("inv"==that.mode?item.inventory_item:item.recipe_name).toUpperCase().includes(query.toUpperCase())}):"inv"==that.mode?(that.model.inventory=INVENTORY_MASTER_LIST,that.hide_subs&&that.hideShowSubstitutes(!1,that.model.inventory)):"batches"==that.mode&&(that.model.inventory=INVENTORY_MASTER_LIST),that.model.current_item=that.model.inventory[0],that.model.quick_search_keys=that._extractKeys(),that._recalculateTotal(),that.setPrevNext(that.currentFoodIndex)},that.jumpToLetter=function(key){that.currentFoodIndex=0,null!=that.selected_subcategory&&(that.model.inventory=that._filterBySubCategoryId(that.selected_subcategory)),that.hide_subs&&"inv"==that.mode?that.hideShowSubstitutes(!1,that.model.inventory):"batches"==that.mode&&(that.model.inventory=INVENTORY_MASTER_LIST);for(var i=0;i<that.model.inventory.length&&key!=("inv"==that.mode?that.model.inventory[i].inventory_item[0].toUpperCase():that.model.inventory[i].recipe_name[0].toUpperCase());i++)that.currentFoodIndex++;that.model.current_item=that.model.inventory[that.currentFoodIndex],that._recalculateTotal(),that.setPrevNext(that.currentFoodIndex)},that._extractKeys=function(){var letters=new Set;return that.model.inventory.forEach(function(item){var letter="inv"==that.mode?item.inventory_item[0].toUpperCase():item.recipe_name[0].toUpperCase();letters.add(letter)}),Array.from(letters).sort()},that._filterBySubCategoryId=function(sub_cat){var filtered_items;return sub_cat&&(filtered_items=INVENTORY_MASTER_LIST.filter(function(item){return item.vendor_sub_cat_id===sub_cat.id})),filtered_items},that.handleSubcatClick=function(sub_cat){that.model.inventory=that._filterBySubCategoryId(sub_cat),that.hide_subs&&that.hideShowSubstitutes(!1,that.model.inventory),that.model.quick_search_keys=that._extractKeys(),that.model.current_item=that.model.inventory[0],that.selected_subcategory=sub_cat,that._recalculateTotal(),that.setPrevNext(that.currentFoodIndex)},that._getSubcategories=function(){function compare(a,b){return a.sub_category>b.sub_category?1:b.sub_category>a.sub_category?-1:0}var subcats=new Set;return that.model.inventory.forEach(function(item){for(var i=0;i<that.refbooks.vendor_sub_cat.length;i++)if(item.vendor_cat_id==that.refbooks.vendor_sub_cat[i].vendor_cat_id&&item.vendor_sub_cat_id==that.refbooks.vendor_sub_cat[i].id){subcats.add(that.refbooks.vendor_sub_cat[i]);break}}),Array.from(subcats).sort(compare)},that._getInventories=function(category,is_init){var headers={is_adjustment:0,inventory_type_id:1,vendor_cat_id:"all"==category.id?null:category.id,inventory_item:null,audit_start_TS:!0,suggested:that.is_sug_aud};that.api.get_inventory_audit(headers).then(function(res){function compare(a,b){return a.inventory_item.toLowerCase()>b.inventory_item.toLowerCase()?1:b.inventory_item.toLowerCase()>a.inventory_item.toLowerCase()?-1:0}that.res_data_audit_start=res.data.data.audit_start,that.pickers.beginDate.date=void 0!==res.data.data.audit_start&&null!=res.data.data.audit_start[0].audit_start?new Date(res.data.data.audit_start[0].audit_start):new Date,that.pickers.beginDateBackup.date=JSON.parse(JSON.stringify(that.pickers.beginDate.date)),res.data.data.inventory.sort(compare),INVENTORY_MASTER_LIST=res.data.data.inventory,that.hideShowSubstitutes(!1),that.model.subcategories=that._getSubcategories(),that.selected_subcategory=null,that.model.quick_search_keys=that._extractKeys(),that.currentFoodIndex=0,that.model.current_item=that.model.inventory[that.currentFoodIndex],that._recalculateTotal(),that.setPrevNext(that.currentFoodIndex),is_init?that.showCOSDetails&&that.getCOS():that.showCOSDetails&&that.setCOS()})},that._getBatches=function(category){var headers={is_adjustment:0,inventory_type_id:1,recipe_type_id:category.r_type_id,inventory_item:null,audit_start_TS:!0};that.api.get_recipe_audit(headers).then(function(res){function compare(a,b){return a.recipe_name.toLowerCase()>b.recipe_name.toLowerCase()?1:b.recipe_name.toLowerCase()>a.recipe_name.toLowerCase()?-1:0}that.res_data_audit_start=res.data.data.audit_start,that.pickers.beginDate.date=void 0!==res.data.data.audit_start&&null!=res.data.data.audit_start[0].audit_start?new Date(res.data.data.audit_start[0].audit_start):new Date,INVENTORY_MASTER_LIST=res.data.data.inventory;for(var dict={},i=0;i<INVENTORY_MASTER_LIST.length;i++)dict.hasOwnProperty(INVENTORY_MASTER_LIST[i].recipe_id)?dict[INVENTORY_MASTER_LIST[i].recipe_id].push(INVENTORY_MASTER_LIST[i]):dict[INVENTORY_MASTER_LIST[i].recipe_id]=[INVENTORY_MASTER_LIST[i]];INVENTORY_MASTER_LIST=[];for(var b in dict)INVENTORY_MASTER_LIST.push({recipe_id:dict[b][0].recipe_id,recipe_name:dict[b][0].recipe_name,total_servings:dict[b][0].servings,shelf_life:dict[b][0].shelf_life,items:dict[b]});INVENTORY_MASTER_LIST.sort(compare),that.model.inventory=INVENTORY_MASTER_LIST,that.model.quick_search_keys=that._extractKeys(),that.currentFoodIndex=0,that.model.current_item=that.model.inventory[that.currentFoodIndex],that._recalculateTotal(),that.setPrevNext(that.currentFoodIndex)})},that.handleCategoryClick=function(category,is_init){that.selected_category=category,"inv"==that.mode?that._getInventories(category,is_init):that._getBatches(category)},that.initBatchCats=function(){var r_type_list=[];for(var ri in that.refbooks.recipe_types){var cr=that.refbooks.recipe_types[ri];1!=cr.id&&r_type_list.push({category:cr.name,r_type_id:cr.id})}return{categories:r_type_list}},that.changeMode=function(){"inv"==that.mode?(that.mode="batches",that.model.selected_batch_input_mode=that.model.batch_input_modes[0]):that.mode="inv",that.init()},that.checkEmpType=function(){that.SetUpStatus=restaurant.data.info.is_setup_completed;var emps=restaurant.data.info.employees;if(that.user={userid:null,user_type_id:null},that.user.userid=that.auth.authentication.user.id,1==that.user.userid)that.showCOSDetails=!0;else{that.showCOSDetails=!1;for(var i=0;emps.length>i;i++)if(emps[i].id==that.user.userid){that.user.user_type_id=emps[i].type_ids,1==emps[i].type_ids||2==emps[i].type_ids||3==emps[i].type_ids?that.showCOSDetails=!0:9!=emps[i].type_ids&&10!=emps[i].type_ids||(that.showCOSDetails=!0);break}}},that.showInfo=function(){$uibModal.open({animation:!0,templateUrl:"quick_tutorial.html",controller:qt,controllerAs:"qt",windowClass:"animated fadeIn modal-lgg",size:"lg"})},that.getLocations=function(){var headers={restaurant_id:that.restaurant_id.restaurant_id,inventory_type_id:1,active_only:1};that.api.get_restaurant_audit_locations(headers).then(function(res){that.locations=res.data.data.Report,that.locations.push({sr_no:-1,location_name:"-- Add/Edit Locations --"}),that.selected_location=that.locations[0].sr_no})},that.changeAuditDate=function(){if(void 0===that.res_data_audit_start||null==that.res_data_audit_start[0].audit_start)return SweetAlert.swal({title:"Alert!",text:"You need to count at least one item before changing the Audit date!",type:"error",confirmButtonColor:"#ed5565",confirmButtonText:"OK"},function(res){}),void(that.pickers.beginDate.date=new Date(that.pickers.beginDateBackup.date));var valid_date=!0;if(that.pickers.beginDate.date>new Date)SweetAlert.swal({title:"Error!",text:"Audit date cannot be greater than now!",type:"error",confirmButtonColor:"#ed5565",confirmButtonText:"OK"},function(res){}),that.pickers.beginDate.date=new Date(that.pickers.beginDateBackup.date),valid_date=!1;else if(that.audit_dates.length>1){var prev_aud=null;prev_aud="history"==that.audit_dates[0].src?that.audit_dates[0].audit_dates:that.audit_dates[1].audit_dates,that.pickers.beginDate.date<=new Date(prev_aud)&&(SweetAlert.swal({title:"Error!",text:"Audit date cannot be less than or equal to the previous audit!",type:"error",confirmButtonColor:"#ed5565",confirmButtonText:"OK"},function(res){}),that.pickers.beginDate.date=new Date(that.pickers.beginDateBackup.date),valid_date=!1)}valid_date&&SweetAlert.swal({title:"Are you sure?",text:"Are you sure you want to change the audit date? This change could affect multiple reports.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){res&&that.api.set_audit_date({inventory_type_id:1,audit_date:new Date(that.pickers.beginDate.date).getTime()}).then(function(res1){SweetAlert.swal("Audit Date Updated!","","success"),that.handleCategoryClick(that.selected_category)})})},that.openCalendar=function(e,picker){that.pickers[picker].open=!0},that.init=function(){Promise.all([core.getRefbooks(),"inv"==that.mode?api.get_vendors_categories({is_restaurant_used_only:1,inventory_type_id:1}):that.initBatchCats(),that.createConversionTable(),that.getLocations()]).then(function(response){that.refbooks=response[0],that.hide_subs=!0,that.model.categories="inv"==that.mode?response[1].data.data.categories:response[1].categories,"inv"==that.mode&&that.model.categories.unshift({id:"all",category:"All Items"}),that.handleCategoryClick(that.model.categories[0],!0)})},that.checkEmpType(),that.mode="inv","false"==that.is_sug_aud?SweetAlert.swal({title:"Note",text:"Here you may do a full audit or mini-audit (adjustment). A full audit saves everything, including items you do not count, while a mini-audit or adjustment will only affect the items you count. Once your count is complete, select 'View Report'. From the reports page, you may choose your audit type (full audit or mini-audit) after you select 'Final Save'.",type:"info",showCancelButton:!1,confirmButtonColor:"#ed5565",confirmButtonText:"OK"},function(res){that.init()}):that.init()}var qt=function($uibModalInstance){var that=this;that.q_title="Inventory Audit Help",that.q_texts='<article style="display: block;"><p><b>Inventory Audit</b>  Please check out our instruction video <a href="https://youtu.be/GZ2GagdCvzg" target="_blank">here</a>.</li></ul></p></article>',that.skip=function(){$uibModalInstance.dismiss("cancel")}};tabletEntryController.$inject=["api","$state","auth","$filter","localStorageService","restaurant","core","alertService","SweetAlert","$uibModal"],angular.module("inspinia").component("tabletEntryComponentFood",{templateUrl:"js/components/foodSetup/tabletEntry/tabletEntry.html",controller:tabletEntryController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("foodSetup.tabletEntry",{url:"/tablet-entry/:is_sug_aud",template:"<tablet-entry-component-food></tablet-entry-component-food>"})})}(),function(){"use strict";function modalController($uibModalInstance,vendor,global_Vendors,showPrimaryVendor,localStorageService,get_refbooks,api){var that=this;that.form={},that.api=api,that.get_refbooks=get_refbooks,that.restaurant_id=localStorageService.get("restaurant_id"),that.vendor=vendor,that.global_Vendors=global_Vendors,that.showPrimaryVendor=showPrimaryVendor,that.model={},that.is_add=!that.vendor,function(){that.model={restaurant_id:that.vendor?that.vendor.restaurant_id:null,vendor_name:that.vendor?that.vendor.vendor_name:null,primary_vendor:that.vendor?that.vendor.primary_vendor:null,vendor_type_id:(that.vendor,1),address:that.vendor?that.vendor.address:null,city:that.vendor?that.vendor.city:null,state:that.vendor?that.vendor.state:null,zip:that.vendor?that.vendor.zip_code:null,sales_rep:that.vendor?that.vendor.sales_rep:null,phone_number:that.vendor?that.vendor.phone_number:null,primary_email:that.vendor?that.vendor.primary_email:null,secondary_email_1:that.vendor?that.vendor.secondary_email_1:null,secondary_email_2:that.vendor?that.vendor.secondary_email_2:null,account_no:that.vendor?that.vendor.account_no:null}}(),that.onZipChanged=function(z){that.api.locations_lookup({search_for:z.toString()}).then(function(response){if(response.data.data.locations.length){that.model.city=response.data.data.locations[0].clear_name;for(var i=0;that.get_refbooks.country_states.length>i;i++)if(response.data.data.locations[0].state_geoname_id===that.get_refbooks.country_states[i].geoname_id){that.model.state=that.get_refbooks.country_states[i].state;break}}},function(error){console.log("error")})},that.submit=function(form){if(form.$valid){var m={restaurant_id:that.restaurant_id.restaurant_id,vendor_details:[]};m.vendor_details.push({vendor_name:that.model.vendor_name,primary_vendor:that.model.primary_vendor,vendor_type_id:that.model.vendor_type_id,address:that.model.address,city:that.model.city,state:that.model.state,zip_code:that.model.zip,sales_rep:that.model.sales_rep,phone_number:that.model.phone_number,primary_email:that.model.primary_email,secondary_email_1:that.model.secondary_email_1,secondary_email_2:that.model.secondary_email_2,account_no:that.model.account_no}),that.vendor?that.api.update_vendor_details(that.vendor.id,m).then(function(res){try{1e3===res.data.data.code&&(swal({title:"Vendor updated successfully!",timer:1500,showConfirmButton:!1,type:"success"}),$uibModalInstance.close())}catch(e){console.log(e)}}):that.api.add_new_vendor(that.restaurant_id.restaurant_id,m).then(function(res){try{1e3===res.data.data.code&&(swal({title:"New Vendor added successfully!",timer:1500,showConfirmButton:!1,type:"success"}),$uibModalInstance.close())}catch(e){console.log(e)}})}},that.cancel=function(){$uibModalInstance.dismiss("cancel")}}function vendorSetupController(api,$state,auth,core,localStorageService,$uibModal,SweetAlert,$rootScope,restaurant,$window,$scope){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.form={},that.api=api,that.auth=auth,that.core=core,that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),$scope.SetUpStatus=0,restaurant.data.info&&($scope.SetUpStatus=restaurant.data.info.is_setup_completed),$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),that.vendorList=[],that.vendorsSelected=[],that.searchModel={order_by:null,order_way:"DESC",paginationOffset:0,paginationCount:25,inRequest:!1,search_by:null,paginationTotal:0,city:null,vendor_name:null,zip_code:null},that.checkEmpType=function(){that.user={userid:null,user_type_id:null},that.user.userid=that.auth.authentication.user.id,that.showPrimaryVendor=!1,1==that.user.userid&&(that.showPrimaryVendor=!0)},that.showInfo=function(){$uibModal.open({animation:!0,templateUrl:"quick_tutorial.html",controller:qt,controllerAs:"qt",windowClass:"animated fadeIn modal-lgg",size:"lg"})},that.addNewVendor=function(vendor){$uibModal.open({templateUrl:"add_new_vendor.html",controller:modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",resolve:{vendor:function(){return vendor},global_Vendors:function(){return that.global_Vendors},get_refbooks:function(){return that.get_refbooks?that.get_refbooks:that.core.getRefbooks().then(function(res){return that.get_refbooks=res})},showPrimaryVendor:function(){return that.showPrimaryVendor}}}).result.then(function(){getChosenVendors(),that.search()},function(){getChosenVendors()})},that.editVendor=function(vendor){that.api.get_vendor_by_id(vendor.id).then(function(res){var vd=res.data.data.vendordetails[0];vd.id=vendor.id,vd.restaurant_id=vendor.restaurant_id,that.addNewVendor(vd)})},that.search=function(keyword){that.searchModel.inRequest=!0;var m={vendor_type_id:1,order_by:that.searchModel.order_by,order_way:that.searchModel.order_way,paginationOffset:that.searchModel.paginationOffset,paginationCount:that.searchModel.paginationCount,search_by:that.searchModel.search_by,city:that.searchModel.city,vendor_name:that.searchModel.vendor_name,zip_code:that.searchModel.zip_code};for(var i in m)m[i]||delete m[i];keyword&&(m.paginationOffset=0,that.searchModel.order_by==keyword?(that.searchModel.order_way="ASC"==m.order_way?"DESC":"ASC",m.order_way="ASC"==m.order_way?"DESC":"ASC"):(that.searchModel.order_by=keyword,m.order_by=keyword)),m.paginationOffset>0&&!keyword&&(m.paginationOffset=(m.paginationOffset-1)*m.paginationCount),api.get_vendors(m).then(function(res){try{that.vendorList=res.data.data.vendors,that.searchModel.paginationTotal=res.data.data.total}catch(e){console.log(e)}that.searchModel.inRequest=!1},function(){that.searchModel.inRequest=!1})},that.search();var getChosenVendors=function(){api.get_chosen_vendors(that.restaurant_id.restaurant_id,{vendor_type_id:1}).then(function(res){try{that.vendorsSelected=res.data.data.vendors}catch(e){console.log(e)}})},getGlobalVendors=function(){api.get_global_vendors({vendor_type_id:1}).then(function(res){try{that.global_Vendors=res.data.data.vendors}catch(e){console.log(e)}})};that.addVendor=function(vendor){var id=that.restaurant_id.restaurant_id,m={vendor_id:vendor.id,is_active:vendor.is_used,inventory_type_id:1};that.api.add_vendor(id,m).then(getChosenVendors)},that.deleteVendor=function(vendor){if(1==vendor.is_has_active_sku_uses)return void SweetAlert.swal({title:"",text:"You can not delete the vendor, if he has any elements with historical data, or if elements are used in any recipe. Instead, you can disable the provider, but first remove all the items belonging to the supplier, which are associated with the recipe.",type:"warning",confirmButtonColor:"#DD6B55"});var id=that.restaurant_id.restaurant_id,m={vendor_id:vendor.id,is_active:0,inventory_type_id:1};that.api.add_vendor(id,m).then(function(){getChosenVendors(),that.search()})},that.next=function(){if(that.vendorsSelected.length)return void $state.go("foodSetup.inventory");SweetAlert.swal({title:"At first select vendors",showConfirmButton:!1,type:"error",timer:2e3})},that.$onInit=function(){Promise.all([that.checkEmpType()]).then(function(response){getChosenVendors(),getGlobalVendors()})}}var qt=function($uibModalInstance){var that=this;that.q_title="Vendor Setup Instructions",that.q_texts='<article style="display: block;"><p><b>Add a New Vendor</b>  to add a new vendor you should first start a search for vendors by Name, City or Zip Code. If your search return a result you should first select the Edit button to view the vendor details to assure that you have an exact match. If youre vendor matches, while in the edit section, be sure to add your sale rep name and account number.<br/><br/><b>Cant locate your vendor?</b> Simply select the Add a New Vendor button on the right.<br/>From there you can manually enter all of your vendor details which includes name, address, phone number, account number and sale rep name.<br/><br/><b>Email Inventory Orders</b>  to email an inventory order you will need to include your sales rep email address. To add your sales rep email address simply locate your vendor and select Edit. Once inside the edit module you will see three email addresses. These email addresses are who your online orders will be delivered to. You may enter up to three email addresses.</p></article>',that.skip=function(){$uibModalInstance.dismiss("cancel")}};vendorSetupController.$inject=["api","$state","auth","core","localStorageService","$uibModal","SweetAlert","$rootScope","restaurant","$window","$scope"],angular.module("inspinia").component("vendorSetupComponent",{templateUrl:"js/components/foodSetup/vendorSetup/vendorSetup.html",controller:vendorSetupController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("foodSetup.vendor",{url:"/vendor-setup",template:"<vendor-setup-component></vendor-setup-component>",data:{pageTitle:" Vendor Setup"}})})}(),function(){"use strict";function headerController(api,core,auth,$q,$state,restaurant,$rootScope){var that=this
;that.isAuth=auth.authentication.isLogged,that.restaurantService=restaurant,that.state=$state,that.m={order_by:"name",order_way:"ASC",paginationOffset:0,search_by:null},that.get_restaurants_list=function(){var deferred=$q.defer();if(that.isAuth){var m={order_by:that.m.order_by,order_way:that.m.order_way,paginationOffset:that.m.paginationOffset};api.get_restaurants(m).then(function(res){try{that.rest_list=res.data.data.restaurants_list,that.rest_list.unshift({id:-1,restaurant_name:"--Compare Restaurants--"})}catch(e){console.log(e)}deferred.resolve()},function(e){console.log(e),deferred.resolve()})}else deferred.resolve();return deferred.promise},that.selectRestaurant=function(go_to_restaurant){try{if(go_to_restaurant==restaurant.data.info.id)return;if(-1==go_to_restaurant)return restaurant.data.info.id=-1,void $state.go("compareRestaurants");go_to_restaurant=that.rest_list.filter(function(x){return x.id==go_to_restaurant})[0],that.restaurantService.set_restaurant(go_to_restaurant.id).then(function(res){if($rootScope.restaurant_id=go_to_restaurant.id,$rootScope.subscription_type_id=go_to_restaurant.subscription_type_id,$state.go("admin.homeMenu",{},{reload:!0}),4!=restaurant.subscription_type_id){for(var i in res.employees)if(res.employees[i].id==auth.authentication.user.id){if(8===res.employees[i].type_ids)return void $state.go("admin.dataEntry");if(5===res.employees[i].type_ids)return void $state.go("foodSubCategories");if(6===res.employees[i].type_ids)return void $state.go("alcoholSubCategories");if(9===res.employees[i].type_ids||10===res.employees[i].type_ids){if(5==restaurant.subscription_type_id)return void $state.go("alcoholSubCategories");if(6==restaurant.subscription_type_id)return void $state.go("foodSubCategories");if(7==restaurant.subscription_type_id)return void $state.go("admin.inventoryCategories")}}$state.go("admin.homeMenu",{},{reload:!0})}else $state.go("reports.compgroupReport")})}catch(e){$state.go("home",{},{reload:!0})}},that.$onInit=function(){core.getSettings().then(that.get_restaurants_list()).then(function(res){that.settings=res});try{restaurant.data.info?("home"!=$state.current.name&&("compareRestaurants"==$state.current.name?that.restaurantName="Compare Restaurants":that.restaurantName=restaurant.data.info.restaurant_name),that.current_rest=restaurant.data.info.id):"compareRestaurants"!=$state.current.name&&"compareRestaurantsMapping"!=$state.current.name||(that.current_rest=-1,that.restaurantName="Compare Restaurants")}catch(e){console.log(e)}},$rootScope.$on("restaurantSelected",function(){that.restaurantName=restaurant.data.info.restaurant_name}),that.logout=function(){auth.logOut(),$state.go("login")}}headerController.$inject=["api","core","auth","$q","$state","restaurant","$rootScope"],angular.module("inspinia").component("headerComponent",{templateUrl:"js/components/header/header.html",controller:headerController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";function homeController(appConfig,$state,auth,api,alertService,core,restaurant,localStorageService,$scope,$rootScope,$interval){if(!auth.authentication.isLogged)return void $state.go("login");var that=this;that.restaurantService=restaurant,that.restaurantsList=[],that.employees_list=[],that.api=api,that.inventoryTypeId=null,that.sub_types=["Active","Inactive"],core.data.new_restaurant=null,that.m={order_by:"name",order_way:"ASC",paginationOffset:0,paginationCount:10,inRequest:!1,search_by:null,sub_type:"Active",paginationTotal:0},$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),that.is_su=1==auth.authentication.user.id,that.$onInit=function(){that.permissions=restaurant.data.permissions},that.selectRestaurant=function(restaurant){that.restaurantService.set_restaurant(restaurant.id).then(function(res){if(that.api.report_items_match(restaurant.id).then(function(res){$rootScope.report_items_match_to_show=res.data.data.items_to_match,$rootScope.restaurant_id=restaurant.id,$rootScope.subscription_type_id=restaurant.subscription_type_id}),4!=restaurant.subscription_type_id){for(var i in res.employees)if(res.employees[i].id==auth.authentication.user.id){if(8===res.employees[i].type_ids)return void $state.go("admin.dataEntry");if(11===res.employees[i].type_ids||12===res.employees[i].type_ids)return void alertService.showError("You do not have access here. Please login using the mobile app.");if(5===res.employees[i].type_ids)return void $state.go("foodSubCategories");if(6===res.employees[i].type_ids)return void $state.go("alcoholSubCategories");if(9===res.employees[i].type_ids||10===res.employees[i].type_ids){if(5==restaurant.subscription_type_id)return void $state.go("alcoholSubCategories");if(6==restaurant.subscription_type_id)return void $state.go("foodSubCategories");if(7==restaurant.subscription_type_id)return void $state.go("admin.inventoryCategories")}}$state.go("admin.homeMenu")}else $state.go("reports.compgroupReport")})},that.search=function(keyword){that.inRequest=!0;var m={order_by:that.m.order_by,order_way:that.m.order_way,paginationOffset:that.m.paginationOffset,paginationCount:that.m.paginationCount,search_by:that.m.search_by};that.is_su&&(m.sub_type="Active"==that.m.sub_type?"Paid":"Free");for(var i in m)m[i]||delete m[i];keyword&&(m.paginationOffset=0,that.m.order_by==keyword?(that.m.order_way="ASC"==m.order_way?"DESC":"ASC",m.order_way="ASC"==m.order_way?"DESC":"ASC"):(that.m.order_by=keyword,m.order_by=keyword)),m.paginationOffset>0&&!keyword&&(m.paginationOffset=(m.paginationOffset-1)*m.paginationCount),api.get_restaurants(m).then(function(res){try{that.restaurantsList=res.data.data.restaurants_list,that.m.paginationTotal=res.data.data.total}catch(e){console.log(e)}that.m.inRequest=!1},function(e){console.log(e),that.m.inRequest=!1})},that.search(),that.editRestaurant=function(e_restaurant){that.restaurantService.set_restaurant(e_restaurant.id).then(function(){that.restaurantService.set_to_edit(e_restaurant.id).then(function(){api.get_restaurant(e_restaurant.id).then(function(res){if(that.typeIdSubscription=res.data.data.restaurants_list[0].subscription_type_id,4!=that.typeIdSubscription){that.employees_list=res.data.data.restaurants_list[0].employees;for(var i=0;that.employees_list.length>i;i++)that.employees_list[i].id==auth.authentication.user.id&&(that.employees_list[i].type_ids>1?1==that.typeIdSubscription||5==that.typeIdSubscription?6==that.employees_list[i].type_ids||9==that.employees_list[i].type_ids||10==that.employees_list[i].type_ids?$state.go("setupFirstAudit"):$state.go("alcoholSetup.vendor"):2==that.typeIdSubscription||6==that.typeIdSubscription?5==that.employees_list[i].type_ids||9==that.employees_list[i].type_ids||10==that.employees_list[i].type_ids?$state.go("setupFirstAudit"):$state.go("foodSetup.vendor"):3!=that.typeIdSubscription&&7!=that.typeIdSubscription||(5==that.employees_list[i].type_ids||6==that.employees_list[i].type_ids||9==that.employees_list[i].type_ids||10==that.employees_list[i].type_ids?$state.go("setupFirstAudit"):4==that.employees_list[i].type_ids?$state.go("alcoholSetup.vendor"):(that.employees_list[i].type_ids,$state.go("foodSetup.vendor"))):$state.go("invite",{id:e_restaurant.id}));1===auth.authentication.user.id&&(1==that.typeIdSubscription||5==that.typeIdSubscription?$state.go("alcoholSetup.vendor"):2!=that.typeIdSubscription&&3!=that.typeIdSubscription&&6!=that.typeIdSubscription&&7!=that.typeIdSubscription||$state.go("foodSetup.vendor"))}else that.api.get_analytics_answers({rest_id:e_restaurant.id,pg_no:1}).then(function(res){0==res.data.data.analytics_answers.analytics_answers.length?$state.go("administrator.posSync"):$state.go("admin.analytics")})})})})}}homeController.$inject=["appConfig","$state","auth","api","alertService","core","restaurant","localStorageService","$scope","$rootScope","$interval"],angular.module("inspinia").component("homeComponent",{templateUrl:"js/components/home/home.html",controller:homeController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("home",{url:"/home",template:"<home-component></home-component>",data:{pageTitle:"Home"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]}])}}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("inventory.foodCategories",{url:"/food_categories",templateUrl:"js/components/inventory/foodCategories/foodCategories.html",data:{pageTitle:"Food Categories"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]}])}}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("inventory",{url:"/inventory",data:{pageTitle:"Inventory Categories"},abstract:!0,template:"<ui-view></ui-view>"})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("inventory.inventoryCategories",{url:"/inventory_categories",templateUrl:"js/components/inventory/inventoryCategories/inventoryCategories.html",data:{pageTitle:"Inventory Categories"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]}])}}})})}(),function(){"use strict";function loginController(appConfig,$scope,$state,auth,api,alertService,SweetAlert,core,$uibModal){if(auth.authentication.isLogged)return void $state.go("home");var that=this;that.loginForm={},that.popupForm={},that.m={email:null,password:null,captchaKey:appConfig.googleCaptcha,errorMessage:null,inRequest:!1,forgotPass:!1,popup_passwd:null},that.createNewAccountPopup=function(self){$state.go("subscription")},that.login=function(form){if(!form.$valid)return void(that.loginForm.Email.$valid||SweetAlert.swal({title:"Error!",text:"Enter a valid email address with all lowercase letters.",type:"error",confirmButtonColor:"#ed5565",confirmButtonText:"OK"},function(res){}));that.m.inRequest=!0;var m={username:that.m.email,password:that.m.password};auth.login(m).then(function(res){that.m.inRequest=!1,$state.go("home")},function(error){that.m.errorMessage=!0,that.m.inRequest=!1})},that.forgotPassword=function(form){form.$valid&&(that.m.inRequest=!0,api.reset_password({email:that.m.email}).then(function(res){try{1e3===res.data.data.code&&alertService.showSuccessText("Successful","Confirmation link was sent to your email")}catch(e){console.log(e)}that.m.inRequest=!1},function(error){that.m.inRequest=!1}))},that.$onInit=function(){try{core.getSettings().then(function(res){that.settings=res})}catch(e){console.log(e)}}}loginController.$inject=["appConfig","$scope","$state","auth","api","alertService","SweetAlert","core","$uibModal"],angular.module("inspinia").component("loginComponent",{templateUrl:"js/components/login/login.html",controller:loginController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("login",{url:"/login",template:"<login-component></login-component>",data:{pageTitle:"Login",specialClass:"login-page"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{name:"vcRecaptcha",files:["js/plugins/angular-recaptcha.min.js"]}])}}})})}(),function(){"use strict";function navigationController($state,auth,restaurant,$rootScope,api,$uibModal,alertService,common,$scope){var that=this;that.api=api,that.auth=auth,that.user=auth.authentication.user,that.report_items_match_to_show=$rootScope.report_items_match_to_show,that.subscription_type_id=$rootScope.subscription_type_id,that.state=$state,that.SetUpStatus=0,that.isAuth=auth.authentication.isLogged,$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions,restaurant.data.info&&(that.SetUpStatus=restaurant.data.info.is_setup_completed)}),that.$onInit=function(){that.permissions=restaurant.data.permissions,restaurant.data.info&&(that.SetUpStatus=restaurant.data.info.is_setup_completed)},that.myProfile=function(){$uibModal.open({animation:!0,templateUrl:"views/modal/accountSettings.html",controller:myProfileController,controllerAs:"$ctr"}).result.then(function(){that.user=auth.authentication.user,alertService.showAlertSave()})},that.logOut=function(){auth.logOut(),$state.go("login")},that.linkInventory=function(){$state.go("setupFirstAudit")},that.linkInventoryMain=function(){return 3==$rootScope.subscription_type_id||7==$rootScope.subscription_type_id?void $state.go("admin.inventoryCategories"):2==$rootScope.subscription_type_id||6==$rootScope.subscription_type_id?void $state.go("foodSubCategories"):void(1!=$rootScope.subscription_type_id&&5!=$rootScope.subscription_type_id||$state.go("alcoholSubCategories"))}}navigationController.$inject=["$state","auth","restaurant","$rootScope","api","$uibModal","alertService","common","$scope"],angular.module("inspinia").component("navigationComponent",{templateUrl:"js/components/navigation/navigation.html",controller:navigationController,controllerAs:"$ctr",bindings:{}});var myProfileController=function($uibModalInstance,auth,api){var that=this;that.api=api,that.auth=auth;var id=auth.authentication.user.id;that.m={first_name:auth.authentication.user.first_name,last_name:auth.authentication.user.last_name,phone_number:auth.authentication.user.phone_number,email:auth.authentication.user.email,password:null,password_confirm:null},that.close=function(){$uibModalInstance.dismiss("cancel")},that.save=function(form){if(form.$valid){var m={first_name:that.m.first_name,last_name:that.m.last_name,phone_number:that.m.phone_number,email:that.m.email};that.m.password&&(m.password=that.m.password),that.api.update_user_info(id,m).then(function(res){try{1e3===res.data.data.code&&that.api.get_user_info(id).then(function(res){that.auth.updateMyInfo(res.data.data.user),$uibModalInstance.close()})}catch(e){}})}}}}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("alcohol.newAlcoholOrder",{url:"/new-alcohol-order",template:"<new-order-component></new-order-component>",data:{pageTitle:"New Alcohol Order"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]}])}}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("food.newFoodOrder",{url:"/new-food-order",template:"<new-order-component></new-order-component>",data:{pageTitle:"New Food Order"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]}])}}})})}(),function(){"use strict";function modalController($uibModalInstance,global_Vendors,inventory_type_id,localStorageService,get_refbooks,api){var that=this;that.form={},that.api=api,that.get_refbooks=get_refbooks,that.restaurant_id=localStorageService.get("restaurant_id"),that.global_Vendors=global_Vendors,that.inventory_type_id=inventory_type_id,that.model={},function(){that.model={restaurant_id:null,vendor_name:null,primary_vendor:null,vendor_type_id:that.inventory_type_id,address:null,city:null,state:null,zip:null,sales_rep:null,primary_email:null,secondary_email_1:null,secondary_email_2:null,account_no:null}}(),that.onZipChanged=function(z){that.api.locations_lookup({search_for:z.toString()}).then(function(response){if(response.data.data.locations.length){that.model.city=response.data.data.locations[0].clear_name;for(var i=0;that.get_refbooks.country_states.length>i;i++)if(response.data.data.locations[0].state_geoname_id===that.get_refbooks.country_states[i].geoname_id){that.model.state=that.get_refbooks.country_states[i].state;break}}},function(error){console.log("error")})},that.submit=function(form){if(form.$valid){var m={restaurant_id:that.restaurant_id.restaurant_id,vendor_details:[]};m.vendor_details.push({vendor_name:that.model.vendor_name,primary_vendor:that.model.primary_vendor,vendor_type_id:that.model.vendor_type_id,address:that.model.address,city:that.model.city,state:that.model.state,zip_code:that.model.zip,sales_rep:that.model.sales_rep,primary_email:that.model.primary_email,secondary_email_1:that.model.secondary_email_1,secondary_email_2:that.model.secondary_email_2,account_no:that.model.account_no}),that.api.add_new_vendor(that.restaurant_id.restaurant_id,m).then(function(res){try{1e3===res.data.data.code&&(swal({title:"New Vendor added successfully!",timer:1500,showConfirmButton:!1,type:"success"}),$uibModalInstance.close())}catch(e){console.log(e)}})}},that.cancel=function(){$uibModalInstance.dismiss("cancel")}}function newFoodItem_modalController($uibModalInstance,$state,alertService,restaurant_id,vendor_id,inventory_type_id,api,core,SweetAlert,$q){var that=this;that.$state=$state,that.form={},that.uniqueItem=[],that.categories=[],that.sub_categories=[],core.getRefbooks().then(function(res){that.deliveryMeasure=res.measurement_units_of_delivery,that.categories=res.vendor_cat,that.sub_categories=res.vendor_sub_cat}),that.api=api,that.model={},that.sku_lookup=function(search_for){return that.api.sku_lookup({search_for:search_for,vendor_id:vendor_id}).then(function(res){return res.data.data.sku.slice(0,10)})},that.submit=function(form){var deferred=$q.defer();return form.$valid?that.uniqueItem.length?void(null!=that.uniqueItem[0].vendor_sku&&that.uniqueItem[0].vendor_sku.length&&that.api.validateSKU({sku:that.uniqueItem[0].vendor_sku,vendor_id:vendor_id}).then(function(res){if(res.data.data.sku_status.length&&"used"==res.data.data.sku_status[0].sku_status)return void alertService.showError("SKU already used!");for(var id=vendor_id,m={inventory_type_id:1,sku_items:[]},i=0;that.uniqueItem.length>i;i++)m.sku_items.push({substitute_for:that.uniqueItem[i].substitute_for?that.uniqueItem[i].substitute_for:null,vendor_sku:that.uniqueItem[i].vendor_sku,pack:that.uniqueItem[i].pack,size:that.uniqueItem[i].size,total_unit_size:that.uniqueItem[i].pack*that.uniqueItem[i].size,uom_id_of_delivery_unit:that.uniqueItem[i].uom_id_of_delivery_unit,brand:"No Brand",brand_id:1,item_name:that.uniqueItem[i].item_name,vendor_cat_id:that.uniqueItem[i].vendor_cat_id,vendor_sub_cat_id:that.uniqueItem[i].vendor_sub_cat_id,yield:1,price:that.uniqueItem[i].case_cost,minimum_order_type:that.uniqueItem[i].minimum_order_type,is_active:that.uniqueItem[i].is_active,id:that.uniqueItem[i].id});return that.api.add_update_own_inventory(id,m).then(function(res){1e3===res.data.data.code&&(alertService.showAlertSave(),deferred.resolve(),$uibModalInstance.dismiss("cancel"))}),deferred.promise})):(alertService.showError("Please, add at least one item"),deferred.reject(),deferred.promise):(alertService.showError("Please validate all inputs"),deferred.reject(),deferred.promise)},that.apply_values=function($item){that.src=$item.src,that.uniqueItem[0].vendor_sku=$item.vendor_sku,that.uniqueItem[0].item_name=$item.item_name,that.uniqueItem[0].vendor_cat_id=$item.vendor_cat_id,that.uniqueItem[0].vendor_sub_cat_id=$item.vendor_sub_cat_id,that.uniqueItem[0].uom_id_of_delivery_unit=$item.uom_id_of_delivery_unit,that.uniqueItem[0].pack=$item.pack,that.uniqueItem[0].size=$item.size,that.uniqueItem[0].case_cost=$item.case_cost,that.uniqueItem[0].minimum_order_type=$item.minimum_order_type,that.uniqueItem[0].substitute_for=$item.substitute_for,that.filterItems()},that.addUniqueItem=function(){that.uniqueItem.push({vendor_sku:null,pack:null,uom_id_of_delivery_unit:null,item_name:null,vendor_cat_id:that.categories.length?that.categories[0].id:null,vendor_sub_cat_id:that.sub_categories.length?that.sub_categories[0].id:null,is_active:1,size:null,case_cost:null,minimum_order_type:"Case",id:null,substitute_for:null})},that.filterItems=function(){that.inventoryListSelected=[];for(var i=0;i<that.inventoryItems.length;i++)null!=that.inventoryItems[i].substitute_for||that.inventoryItems[i].vendor_cat_id!=that.uniqueItem[0].vendor_cat_id||(10!=that.uniqueItem[0].uom_id_of_delivery_unit&&11!=that.uniqueItem[0].uom_id_of_delivery_unit&&12!=that.uniqueItem[0].uom_id_of_delivery_unit&&13!=that.uniqueItem[0].uom_id_of_delivery_unit&&16!=that.uniqueItem[0].uom_id_of_delivery_unit&&17!=that.uniqueItem[0].uom_id_of_delivery_unit&&18!=that.uniqueItem[0].uom_id_of_delivery_unit||10!=that.inventoryItems[i].uom_id_of_delivery_unit&&11!=that.inventoryItems[i].uom_id_of_delivery_unit&&12!=that.inventoryItems[i].uom_id_of_delivery_unit&&13!=that.inventoryItems[i].uom_id_of_delivery_unit&&16!=that.inventoryItems[i].uom_id_of_delivery_unit&&17!=that.inventoryItems[i].uom_id_of_delivery_unit&&18!=that.inventoryItems[i].uom_id_of_delivery_unit)&&(5!=that.uniqueItem[0].uom_id_of_delivery_unit&&14!=that.uniqueItem[0].uom_id_of_delivery_unit&&15!=that.uniqueItem[0].uom_id_of_delivery_unit&&19!=that.uniqueItem[0].uom_id_of_delivery_unit||5!=that.inventoryItems[i].uom_id_of_delivery_unit&&14!=that.inventoryItems[i].uom_id_of_delivery_unit&&15!=that.inventoryItems[i].uom_id_of_delivery_unit&&19!=that.inventoryItems[i].uom_id_of_delivery_unit)&&(1!=that.uniqueItem[0].uom_id_of_delivery_unit&&2!=that.uniqueItem[0].uom_id_of_delivery_unit&&3!=that.uniqueItem[0].uom_id_of_delivery_unit&&4!=that.uniqueItem[0].uom_id_of_delivery_unit&&5!=that.uniqueItem[0].uom_id_of_delivery_unit&&8!=that.uniqueItem[0].uom_id_of_delivery_unit||1!=that.inventoryItems[i].uom_id_of_delivery_unit&&2!=that.inventoryItems[i].uom_id_of_delivery_unit&&3!=that.inventoryItems[i].uom_id_of_delivery_unit&&4!=that.inventoryItems[i].uom_id_of_delivery_unit&&5!=that.inventoryItems[i].uom_id_of_delivery_unit&&8!=that.inventoryItems[i].uom_id_of_delivery_unit)||that.inventoryListSelected.push(that.inventoryItems[i]);if(that.inventoryListSelected.length){var first=JSON.stringify(that.inventoryListSelected[0]);that.inventoryListSelected.unshift(JSON.parse(first)),that.inventoryListSelected[0].id=null,that.inventoryListSelected[0].vendor_name="--No selection--",that.inventoryListSelected[0].item_name="--No selection--"}else that.inventoryListSelected.push({}),that.inventoryListSelected[0].id=null,that.inventoryListSelected[0].vendor_name="--No selection--",that.inventoryListSelected[0].item_name="--No selection--"},that.getInventoriesByVendor=function(){that.api.get_active_inventory_by_vendor({inventory_type_id:1,caller:"sub_list"},restaurant_id).then(function(res){that.inventoryItems=res.data.data.sku,that.filterItems()})},that.addUniqueItem(),that.getInventoriesByVendor(),that.clear=function(){that.src="",that.uniqueItem=[],that.uniqueItem.push({vendor_sku:null,pack:null,uom_id_of_delivery_unit:null,item_name:null,vendor_cat_id:null,vendor_sub_cat_id:null,is_active:1,size:null,case_cost:null,minimum_order_type:"Case",id:null,substitute_for:null})},that.cancel=function(){$uibModalInstance.dismiss("cancel")}}function newAlcoholItem_modalController($uibModalInstance,alertService,api,core,restaurant_id,vendor_id,inventory_type_id,SweetAlert,$q){var that=this;that.form={},that.uniqueItem=[],that.categories=[],that.sub_categories=[],core.getRefbooks().then(function(res){that.refbooks=res,that.categories=res.vendor_cat,that.sub_categories=res.vendor_sub_cat}),that.api=api,that.model={},that.src="",that.sku_lookup=function(search_for){return that.api.sku_lookup({search_for:search_for,vendor_id:vendor_id}).then(function(res){return res.data.data.sku.slice(0,10)})},that.item_name_lookup=function(search_for){return that.api.item_name_lookup({search_for:search_for,vendor_id:vendor_id}).then(function(res){return res.data.data.name})},that.submit=function(form){var deferred=$q.defer();return form.$valid?that.uniqueItem.length?void(null!=that.uniqueItem[0].vendor_sku&&that.uniqueItem[0].vendor_sku.length&&that.api.validateSKU({sku:that.uniqueItem[0].vendor_sku,vendor_id:vendor_id}).then(function(res){if(res.data.data.sku_status.length&&"used"==res.data.data.sku_status[0].sku_status)return void alertService.showError("SKU already used!");for(var id=vendor_id,m={inventory_type_id:2,sku_items:[]},i=0;that.uniqueItem.length>i;i++)m.sku_items.push({substitute_for:that.uniqueItem[i].substitute_for?that.uniqueItem[i].substitute_for:null,item_name:that.uniqueItem[i].item_name,tare_type_id:that.uniqueItem[i].tare_type_id,size:that.uniqueItem[i].content_weight||that.uniqueItem[i].size||1,content_weight:that.uniqueItem[i].content_weight||that.uniqueItem[i].size||1,full_weight:that.uniqueItem[i].full_weight,tare_weight:that.uniqueItem[i].tare_weight,total_unit_size:that.uniqueItem[i].case_qty*that.uniqueItem[i].pack*(that.uniqueItem[i].content_weight||that.uniqueItem[i].size||1),manufacturer:that.uniqueItem[i].manufacturer,vendor_sku:that.uniqueItem[i].vendor_sku,case_qty:that.uniqueItem[i].case_qty,pack:that.uniqueItem[i].pack,price:"Case"==that.uniqueItem[i].minimum_order_type?that.uniqueItem[i].case_cost:that.uniqueItem[i].pack_cost,vendor_cat_id:that.uniqueItem[i].vendor_cat_id,uom_id_of_delivery_unit:5,vendor_sub_cat_id:that.uniqueItem[i].vendor_sub_cat_id,is_active:that.uniqueItem[i].is_active,minimum_order_type:that.uniqueItem[i].minimum_order_type,id:that.uniqueItem[i].id});return that.api.add_update_own_inventory(id,m).then(function(res){1e3===res.data.data.code&&(alertService.showAlertSave(),deferred.resolve(),$uibModalInstance.dismiss("cancel"))}),deferred.promise})):(alertService.showError("Please, add at least one item"),deferred.reject(),deferred.promise):(alertService.showError("Please validate all inputs"),deferred.reject(),deferred.promise)},that.apply_values=function($item){that.src=$item.src,that.uniqueItem[0].vendor_sku=$item.vendor_sku,that.uniqueItem[0].item_name=$item.item_name,that.uniqueItem[0].vendor_cat_id=$item.vendor_cat_id,that.changeMOT(0),that.uniqueItem[0].vendor_sub_cat_id=$item.vendor_sub_cat_id,that.uniqueItem[0].tare_type_id=$item.tare_type_id,that.uniqueItem[0].full_weight=$item.full_weight,that.uniqueItem[0].pack=$item.pack,that.uniqueItem[0].case_cost=$item.case_cost,that.uniqueItem[0].pack_cost=$item.pack_cost,that.setWeights(0,$item.vendor_cat_id,$item.vendor_sub_cat_id,$item.tare_type_id),that.calculate(0),that.uniqueItem[0].substitute_for=$item.substitute_for},that.getSizes=function(cat_id,sub_cat_id){if(!cat_id&&!sub_cat_id)return[];for(var _a=[],i=0;that.refbooks.default_weights.length>i;i++)if(that.refbooks.default_weights[i].vendor_cat_id===cat_id&&that.refbooks.default_weights[i].vendor_sub_cat_id===sub_cat_id)for(var j=0;that.refbooks.tare_types.length>j;j++)that.refbooks.tare_types[j].tare_type_id===that.refbooks.default_weights[i].tare_type_id&&-1===_a.indexOf(that.refbooks.tare_types[j])&&_a.push(that.refbooks.tare_types[j]);return _a},that.calculate=function($index){var t=that.uniqueItem[$index].pack||1,u=that.uniqueItem[$index].pack_cost||1,c=that.uniqueItem[$index].case_qty||1;that.uniqueItem[$index].case_cost=parseFloat((t*u*1*c).toFixed(2))},that.setWeights=function($index,cat_id,sub_cat_id,tare_type_id){for(var i=0;that.refbooks.default_weights.length>i;i++)if(that.refbooks.default_weights[i].vendor_sub_cat_id===sub_cat_id&&that.refbooks.default_weights[i].vendor_cat_id===cat_id&&that.refbooks.default_weights[i].tare_type_id===tare_type_id){var f=71===that.uniqueItem[$index].vendor_cat_id?that.refbooks.default_weights[i].full_weight:that.uniqueItem[$index].full_weight,c=that.refbooks.default_weights[i].content_weight;that.uniqueItem[$index].tare_weight=f-c||0,that.uniqueItem[$index].content_weight=c,76===that.uniqueItem[$index].vendor_cat_id&&(that.uniqueItem[$index].tare_weight=0,that.uniqueItem[$index].content_weight=f*c)}if(cat_id&&sub_cat_id&&(74==cat_id||75==cat_id||99==cat_id))for(var i=0;that.refbooks.default_weights.length>i;i++)if(that.refbooks.default_weights[i].vendor_cat_id===cat_id&&that.refbooks.default_weights[i].vendor_sub_cat_id===sub_cat_id&&that.refbooks.default_weights[i].tare_type_id===tare_type_id){that.uniqueItem[$index].full_weight=that.refbooks.default_weights[i].full_weight,that.uniqueItem[$index].tare_weight=that.refbooks.default_weights[i].tare_weight,that.uniqueItem[$index].content_weight=that.refbooks.default_weights[i].content_weight;break}},that.addUniqueItem=function(){that.uniqueItem.push({item_name:null,size:null,full_weight:null,content_weight:null,tare_weight:null,manufacturer:null,vendor_sku:null,case_qty:1,total_unit_size:null,price:null,pack_cost:null,vendor_cat_id:that.categories.length?that.categories[0].id:null,uom_id_of_delivery_unit:5,vendor_sub_cat_id:that.sub_categories.length?that.sub_categories[0].id:null,is_active:1,minimum_order_type:"Pack",id:null,substitute_for:null})},that.filterItems=function(){that.inventoryListSelected=[];for(var i=0;i<that.inventoryItems.length;i++)null==that.inventoryItems[i].substitute_for&&that.inventoryItems[i].vendor_cat_id==that.uniqueItem[0].vendor_cat_id&&that.inventoryListSelected.push(that.inventoryItems[i]);if(that.inventoryListSelected.length){var first=JSON.stringify(that.inventoryListSelected[0]);that.inventoryListSelected.unshift(JSON.parse(first)),that.inventoryListSelected[0].id=null,that.inventoryListSelected[0].vendor_name="--No selection--",that.inventoryListSelected[0].item_name="--No selection--"}else that.inventoryListSelected.push({}),that.inventoryListSelected[0].id=null,that.inventoryListSelected[0].vendor_name="--No selection--",that.inventoryListSelected[0].item_name="--No selection--"},that.getInventoriesByVendor=function(){that.api.get_active_inventory_by_vendor({inventory_type_id:2,caller:"sub_list"},restaurant_id).then(function(res){that.inventoryItems=res.data.data.sku,that.filterItems()})},that.changeMOT=function($index){that.uniqueItem[$index].full_weight=null,74==that.uniqueItem[$index].vendor_cat_id?that.uniqueItem[$index].minimum_order_type="Case":that.uniqueItem[$index].minimum_order_type="Pack",that.filterItems()},that.addUniqueItem(),that.getInventoriesByVendor(),that.clear=function(){that.uniqueItem=[],that.uniqueItem.push({vendor_sku:null,pack:null,uom_id_of_delivery_unit:null,item_name:null,vendor_cat_id:null,vendor_sub_cat_id:null,is_active:1,size:null,case_cost:null,minimum_order_type:"Case",id:null,substitute_for:null}),that.src=""},that.cancel=function(){$uibModalInstance.dismiss("cancel")}}function controller($state,$scope,auth,api,core,restaurant,$uibModal,localStorageService,$rootScope,alertService,$window,$q){if(!auth.authentication.isLogged)return void $state.go("login");if($state.params.id&&!parseInt($state.params.id))return void $state.go("home");var that=this;if(that.api=api,that.$state=$state,that.core=core,that.isFood=$state.includes("food.newFoodOrder")||$state.includes("food.editFoodOrder"),that.isEdit=!!$state.params.id,that.isEdit_vendor_id,that.vendors=[],that.inventories=[],that.refbooks={},that.form={},$scope.EditCheck=that.isEdit,that.inventory_type_id=that.isFood?"1":"2",that.OH=[],that.current_vendor=null,that.order_options=[{id:4,name:"Frequent Items"},{id:1,name:"Last Order"},{id:2,name:"New Order"},{id:3,name:"Suggested Order"}],that.order_option=that.order_options[0],that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),that.getOH=function(){var deferred=$q.defer();return that.isEdit?deferred.resolve():"2"===that.inventory_type_id?that.api.alcohol({
RestaurantId:that.restaurant_id.restaurant_id,Category:"%",caller:"oh_report"}).then(function(res){res&&(that.OH=res.data.data.Report,that.resetOH()),deferred.resolve()}):"1"===that.inventory_type_id&&that.api.food_OH({RestaurantId:that.restaurant_id.restaurant_id,Category:"%",caller:"oh_report"}).then(function(res){res&&(that.OH=res.data.data.Report,that.resetOH()),deferred.resolve()}),deferred.promise},that.resetOrderItems=function(){that.orderModel={totalItems:0,totalCost:0,inventory_type_id:that.inventory_type_id,items:[]}},that.resetOrderItems(),that.showInfo=function(){$uibModal.open({animation:!0,templateUrl:"quick_tutorial.html",controller:qt,controllerAs:"qt",windowClass:"animated fadeIn modal-lgg",size:"lg",resolve:{isFood:function(){return that.isFood},isEdit:function(){return that.isEdit}}})},that.isEdit&&that.api.get_order($state.params.id,{inventory_type_id:that.inventory_type_id}).then(function(res){var order=res.data.data.order;if(_.isEmpty(order))return void window.history.go(-1);if(order)that.orderModel.items=[],angular.forEach(order.items,function(v,k){that.orderModel.items.push({id:v.id,vendor_sku_id:v.vendor_sku_id,vendor_id:v.vendor_id,suggested_amount:v.suggested_amount,suggested_type:v.suggested_order_type,amount:v.amount,order_type:v.order_type,item_cost:v.item_cost,total_cost:v.total_cost,is_approved:0,is_suggested:0,so_id:-1,is_locked:1,category:"Other"})}),that.api.get_active_inventory_by_vendor({vendor_id:order.vendor_id,inventory_type_id:that.inventory_type_id},that.restaurant_id.restaurant_id).then(function(res){that.inventories=res.data.data.sku,angular.forEach(that.orderModel.items,function(v,k){that.calculate(k,v.vendor_sku_id)}),that.isEdit_vendor_id=order.vendor_id,that.current_vendor=that.vendors.filter(function(x){return x.id==that.isEdit_vendor_id})[0]});else{var go=that.isFood?"food.orderSummary":"alcohol.orderSummary";that.$state.go(go)}},function(){var go=that.isFood?"food.orderSummary":"alcohol.orderSummary";that.$state.go(go)}),that.getSuggestedOrder=function(){that.api.get_suggested_orders({RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:that.inventory_type_id}).then(function(res){var Report=res.data.data.Report;if(res.error,Report.length){var totalCost=0,totalItemsCost=0;Report=Report.filter(function(x){return x.vendor_id==that.current_vendor.id}),angular.forEach(Report,function(v,k){that.orderModel.items.push({vendor_sku_id:v.vendor_sku_id,vendor_id:v.vendor_id,suggested_amount:v.suggested_amount,suggested_type:v.suggested_order_type,amount:v.actual_amount,order_type:"Each"==v.actual_order_type?"Pack":v.actual_order_type,item_cost:v.suggested_item_cost,total_cost:v.suggested_total_cost,is_approved:0,is_suggested:1,so_id:v.so_id,is_locked:1,category:"Other"}),totalCost+=v.suggested_item_cost,totalItemsCost+=v.suggested_total_cost,that.orderModel.totalItems=totalCost,that.orderModel.totalCost=totalItemsCost}),angular.forEach(that.orderModel.items,function(v,k){that.calculate(k,v.vendor_sku_id)})}else alertService.showError("This vendor does not have any suggested order.");that.loading=!1})},that.loadOrder=function(){that.loading=!0,that.resetOrderItems(),null!=typeof that.current_vendor&&that.api.get_active_inventory_by_vendor({vendor_id:that.current_vendor.id,inventory_type_id:that.inventory_type_id},that.restaurant_id.restaurant_id).then(function(res){that.inventories=[],that.inventories.push({id:-1,item_name:"(+) Add a new Inventory Item"}),that.inventories=that.inventories.concat(res.data.data.sku),1==that.order_option.id?that.getLastOrder():2==that.order_option.id?(that.pushNewItem(),that.loading=!1):3==that.order_option.id?that.getSuggestedOrder():4==that.order_option.id&&that.getFrequentOrder()})},that.getLastOrder=function(){that.last_order_date=null,that.api.get_last_order({RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:that.inventory_type_id,vendor_id:that.current_vendor.id,mode:"previous"}).then(function(res){var Report=res.data.data.Report;if(res.error,Report.length){var totalCost=0,totalItemsCost=0;angular.forEach(Report,function(v,k){that.last_order_date=v.last_order_date.substr(0,10),that.orderModel.items.push({vendor_sku_id:v.vendor_sku_id,vendor_id:v.vendor_id,suggested_amount:v.suggested_amount,suggested_type:v.suggested_order_type,amount:v.amount,order_type:that.isFood?v.order_type:"Each"==v.order_type?"Pack":v.order_type,item_cost:v.item_cost,total_cost:v.total_cost,is_approved:0,is_suggested:0,is_locked:1,category:"Other"}),totalCost+=v.item_cost,totalItemsCost+=v.total_cost,that.orderModel.totalItems=totalCost,that.orderModel.totalCost=totalItemsCost}),angular.forEach(that.orderModel.items,function(v,k){that.calculate(k,v.vendor_sku_id)})}else alertService.showError("This vendor does not have any recent order.");that.loading=!1})},that.getFrequentOrder=function(){that.api.get_last_order({RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:that.inventory_type_id,vendor_id:that.current_vendor.id,mode:"frequent"}).then(function(res){var Report=res.data.data.Report;if(res.error,Report.length){var totalCost=0,totalItemsCost=0;angular.forEach(Report,function(v,k){that.orderModel.items.push({vendor_sku_id:v.vendor_sku_id,vendor_id:v.vendor_id,suggested_amount:0,suggested_type:"Case",amount:0,order_type:"Case",item_cost:0,total_cost:0,is_approved:0,is_suggested:0,is_locked:1,category:"Other"}),totalCost+=v.item_cost,totalItemsCost+=v.total_cost,that.orderModel.totalItems=totalCost,that.orderModel.totalCost=totalItemsCost}),angular.forEach(that.orderModel.items,function(v,k){that.calculate(k,v.vendor_sku_id)})}else alertService.showError("This vendor does not have any recent order.");that.loading=!1})},that.pushNewItem=function(){that.orderModel.items.push({vendor_id:that.current_vendor.id,vendor_sku_id:null,suggested_amount:0,suggested_type:"Case",amount:0,order_type:"Case",item_cost:0,total_cost:0,is_approved:2==that.order_option.id||that.isEdit?1:0,is_suggested:0,so_id:-1,is_locked:0,category:"Other"})},that.delete=function($index,item,is_approved_flag,is_suggested){1!=is_approved_flag&&(0==is_suggested?that.orderModel.items.splice($index,1):that.api.process_suggested_order_item({so_id:item.so_id,process_value:2,actual_amount:item.amount,actual_order_type:item.order_type}).then(function(res){if(!res)return void console.log("error updating suggested order table");that.orderModel.items.splice($index,1)}),angular.forEach(that.orderModel.items,function(v,k){that.calculate(k,v.vendor_sku_id)}))},that.cleanup_sug_items=function(slist,i){i!=slist.length&&that.api.process_suggested_order_item({so_id:slist[i].so_id,process_value:1,actual_amount:slist[i].amount,actual_order_type:slist[i].order_type}).then(function(res){res.data.data.code,that.cleanup_sug_items(slist,i+1)})},that.getItemOH=function(vendor_sku_id){if(that.inventories.length&&void 0!==that.oh_dict){var result_item=that.inventories.filter(function(x){return x.id==vendor_sku_id});if(result_item.length)return void 0===that.oh_dict[vendor_sku_id]?"N/A":that.isFood?that.oh_dict[vendor_sku_id]+" "+result_item[0].unit_of_delivery:that.oh_dict[vendor_sku_id]}return"N/A"},that.calculate=function($index,vendor_sku_id,is_cost_edit){if(-1==vendor_sku_id){if(null==that.orderModel.items[$index].vendor_id)return alertService.showError("Please select a vendor first!"),void(that.orderModel.items[$index].vendor_sku_id=null);if(that.isFood){var modalInstance=$uibModal.open({templateUrl:"add_new_food_inventory_item.html",controller:newFoodItem_modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",size:"lg2x",resolve:{vendor_id:function(){return that.orderModel.items[$index].vendor_id},inventory_type_id:function(){return that.inventory_type_id},restaurant_id:function(){return that.restaurant_id.restaurant_id}}});modalInstance.result.then(function(){that.orderModel.items[$index].vendor_sku_id=null,that.api.get_active_inventory_by_vendor({vendor_id:that.orderModel.items[$index].vendor_id,inventory_type_id:that.inventory_type_id},that.restaurant_id.restaurant_id).then(function(res){that.orderModel.items[$index].vendor_sku_id=null,that.inventories[$index]=[],that.inventories[$index].push({id:-1,item_name:"(+) Add a new Inventory Item"}),that.inventories[$index]=that.inventories[$index].concat(res.data.data.sku)})},function(){that.orderModel.items[$index].vendor_sku_id=null,that.api.get_active_inventory_by_vendor({vendor_id:that.orderModel.items[$index].vendor_id,inventory_type_id:that.inventory_type_id},that.restaurant_id.restaurant_id).then(function(res){that.orderModel.items[$index].vendor_sku_id=null,that.inventories[$index]=[],that.inventories[$index].push({id:-1,item_name:"(+) Add a new Inventory Item"}),that.inventories[$index]=that.inventories[$index].concat(res.data.data.sku)})})}else{var modalInstance=$uibModal.open({templateUrl:"add_new_alcohol_inventory_item.html",controller:newAlcoholItem_modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",size:"lg2x",resolve:{vendor_id:function(){return that.orderModel.items[$index].vendor_id},inventory_type_id:function(){return that.inventory_type_id},restaurant_id:function(){return that.restaurant_id.restaurant_id}}});modalInstance.result.then(function(){that.orderModel.items[$index].vendor_sku_id=null,that.api.get_active_inventory_by_vendor({vendor_id:that.orderModel.items[$index].vendor_id,inventory_type_id:that.inventory_type_id},that.restaurant_id.restaurant_id).then(function(res){that.orderModel.items[$index].vendor_sku_id=null,that.inventories=[],that.inventories.push({id:-1,item_name:"(+) Add a new Inventory Item"}),that.inventories=that.inventories.concat(res.data.data.sku)})},function(){that.orderModel.items[$index].vendor_sku_id=null,that.api.get_active_inventory_by_vendor({vendor_id:that.orderModel.items[$index].vendor_id,inventory_type_id:that.inventory_type_id},that.restaurant_id.restaurant_id).then(function(res){that.orderModel.items[$index].vendor_sku_id=null,that.inventories=[],that.inventories.push({id:-1,item_name:"(+) Add a new Inventory Item"}),that.inventories=that.inventories.concat(res.data.data.sku)})})}}else{if(!that.inventories)return;if(!_.isArray(that.inventories))return;that.isFood?"Case"==that.orderModel.items[$index].order_type&&(that.orderModel.items[$index].amount=Math.round(that.orderModel.items[$index].amount)):that.orderModel.items[$index].amount=Math.round(that.orderModel.items[$index].amount),-1==is_cost_edit&&(that.orderModel.items[$index].update_sku=1);for(var totalItemsCost=0,totalCost=0,oi=0;oi<that.OH.length;oi++)if(that.OH[oi].vendor_sku_id==that.orderModel.items[$index].vendor_sku_id){"2"==that.inventory_type_id?that.orderModel.items[$index].OH=that.OH[oi].units_on_hand:"1"==that.inventory_type_id&&(that.orderModel.items[$index].OH=that.OH[oi].total_uod_on_hand);break}angular.forEach(that.orderModel.items,function(v,k){vendor_sku_id=v.vendor_sku_id;for(var item,i=0;i<that.inventories.length;i++)if(that.inventories[i].id===vendor_sku_id){item=that.inventories[i];break}if(item){for(var uod,mot,i=0;i<that.inventories.length;i++)if(that.inventories[i].id===that.orderModel.items[$index].vendor_sku_id){-1!=is_cost_edit&&(that.orderModel.items[$index].total_unit_size=that.inventories[i].total_unit_size,that.orderModel.items[$index].unit_of_delivery=that.inventories[i].unit_of_delivery),mot=that.inventories[i].minimum_order_type,uod=that.inventories[i].uom_id_of_delivery_unit;break}if(2==that.inventory_type_id)"Bottle Beer"==item.category?that.orderModel.items[$index].category="Bottle_Beer":that.orderModel.items[$index].category="Other",that.orderModel.items[$index].otypes="Case"==mot?[{name:"Case",value:"Case"}]:[{name:"Case",value:"Case"},{name:"Each",value:"Pack"}];else if("Case"==mot)that.orderModel.items[$index].otypes=[{name:"Case",value:"Case"}];else if("Pack"==mot)that.orderModel.items[$index].otypes=[{name:"Case",value:"Case"},{name:"Pack",value:"Pack"}];else for(var j=0;j<that.refbooks.measurement_units_of_delivery.length;j++)if(uod===that.refbooks.measurement_units_of_delivery[j].id){var f_ordertype=that.refbooks.measurement_units_of_delivery[j].name;that.orderModel.items[$index].otypes=[{name:"Case",value:"Case"},{name:"Pack",value:"Pack"},{name:f_ordertype,value:"Each"}];break}var temp_cost=v.item_cost;(0==is_cost_edit||angular.isUndefined(v.id))&&(v.item_cost=v.amount?"Case"==v.order_type?item.case_cost||0:"Pack"==v.order_type?item.pack_cost||0:that.isFood?item.unit_cost:item.pack_cost||0:0),that.isEdit&&(v.item_cost=v.amount?"Case"==v.order_type?item.case_cost||0:"Pack"==v.order_type?item.pack_cost||0:that.isFood?item.unit_cost:item.pack_cost||0:0),-1==is_cost_edit&&(v.item_cost=temp_cost),v.total_cost=v.item_cost*v.amount||0,totalItemsCost+=v.item_cost,totalCost+=v.total_cost,that.orderModel.totalCost=totalCost,that.orderModel.totalItems=totalItemsCost}})}},that.resetOH=function(){that.oh_dict={};for(var oi=0;oi<that.OH.length;oi++)"2"==that.inventory_type_id?that.oh_dict[that.OH[oi].vendor_sku_id]=that.OH[oi].units_on_hand:"1"==that.inventory_type_id&&(that.oh_dict[that.OH[oi].vendor_sku_id]=that.OH[oi].total_uod_on_hand)},$scope.sendEmail=!1,$scope.setEmail=function(){$scope.sendEmail=!0},$scope.setNoEmail=function(){$scope.sendEmail=!1},that.addNewOrder=function(form){if(form.$valid){for(var m={inventory_type_id:parseInt(that.inventory_type_id),sendEmail:$scope.sendEmail,items:[]},process_sug=[],i=0;that.orderModel.items.length>i;i++)1==that.orderModel.items[i].is_approved&&(m.items.push({id:that.orderModel.items[i].id,vendor_id:that.orderModel.items[i].vendor_id,vendor_sku_id:that.orderModel.items[i].vendor_sku_id,suggested_amount:that.orderModel.items[i].suggested_amount,suggested_order_type:that.orderModel.items[i].suggested_type,amount:that.orderModel.items[i].amount,order_type:that.isFood||"Each"!=that.orderModel.items[i].order_type?that.orderModel.items[i].order_type:"Pack",total_unit_size:that.orderModel.items[i].total_unit_size,item_cost:that.orderModel.items[i].item_cost,total_cost:that.orderModel.items[i].total_cost,is_approved:that.orderModel.items[i].is_approved}),that.isFood||delete m.items[m.items.length-1].total_unit_size,that.isEdit||-1!=that.orderModel.items[i].so_id&&process_sug.push(that.orderModel.items[i]));if(that.isEdit){var conf={title:"Are you sure?",text:"Any unapproved items will be lost if you proceed.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"};swal(conf,function(res){if(res){for(var um={inventory_type_id:parseInt(that.inventory_type_id),items:[]},new_m={inventory_type_id:parseInt(that.inventory_type_id),items:[]},i=0;m.items.length>i;i++)angular.isUndefined(m.items[i].id)?um.items.push(m.items[i]):new_m.items.push(m.items[i]);um.items.length,new_m.items.length,that.api.add_extra_order_items(um,that.$state.params.id).then(function(res1){1e3==res1.data.data.code&&that.api.get_order($state.params.id,{inventory_type_id:that.inventory_type_id}).then(function(res2){if(1e3==res2.data.data.code){for(var i=0;new_m.items.length>i;i++)for(var j=0;res2.data.data.order.items.length>j;j++)if(new_m.items[i].id==res2.data.data.order.items[j].id){res2.data.data.order.items.splice(j,1);break}for(var i=0;um.items.length>i;i++)for(var j=0;res2.data.data.order.items.length>j;j++)if(um.items[i].vendor_sku_id==res2.data.data.order.items[j].vendor_sku_id&&um.items[i].suggested_amount==res2.data.data.order.items[j].suggested_amount&&um.items[i].suggested_order_type==res2.data.data.order.items[j].suggested_order_type&&um.items[i].amount==res2.data.data.order.items[j].amount&&um.items[i].order_type==res2.data.data.order.items[j].order_type&&um.items[i].item_cost==res2.data.data.order.items[j].item_cost&&um.items[i].total_cost==res2.data.data.order.items[j].total_cost&&um.items[i].is_approved==res2.data.data.order.items[j].is_approved&&um.items[i].vendor_id==res2.data.data.order.items[j].vendor_id){um.items[i].id=res2.data.data.order.items[j].id,res2.data.data.order.items.splice(j,1);break}new_m.items=new_m.items.concat(um.items),that.api.update_order(new_m,that.$state.params.id).then(function(res){1e3===res.data.data.code&&$window.history.go(-1)})}})})}})}else if(m.items.length){var missing_emails=new Set;for(var mi in m.items)for(var v in that.vendors)if(m.items[mi].vendor_id==that.vendors[v].id){null!=that.vendors[v].primary_email&&"null"!=that.vendors[v].primary_email&&""!=that.vendors[v].primary_email||null!=that.vendors[v].secondary_email_1&&"null"!=that.vendors[v].secondary_email_1&&""!=that.vendors[v].secondary_email_1||null!=that.vendors[v].secondary_email_2&&"null"!=that.vendors[v].secondary_email_2&&""!=that.vendors[v].secondary_email_2||missing_emails.add(that.vendors[v]);break}if(missing_emails=Array.from(missing_emails),missing_emails.length&&$scope.sendEmail){var conf={title:"Cannot Send Order!",text:"Unfortunately "+missing_emails.map(function(x){return x.vendor_name}).join(", ")+" "+(missing_emails.length>1?"are":"is")+" not set up to receive your orders.\nYou may resolve this issue by selecting 'Update Vendor' which will allow you to add the email addresses of the vendors who are not set up to receive orders. Or you may select 'Cancel' and unselect the vendors who are not setup to receive orders and reprocess your orders for the vendors who are setup to receive orders.\nFor the vendors who are not setup to receive orders you may process them separately by selecting 'Confirm and Save' which will only save but not send.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Update Vendor"};swal(conf,function(res){res&&(2==parseInt(that.inventory_type_id)?that.$state.go("alcoholSetup.vendor"):that.$state.go("foodSetup.vendor"))})}else{var conf={title:"Are you sure?",text:"Any unapproved items that are not suggested orders will be lost if you proceed.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"};swal(conf,function(res){res&&that.api.create_order(m).then(function(res){1e3===res.data.data.code&&(that.cleanup_sug_items(process_sug,0),alertService.showAlertSave(),that.isFood?that.$state.go("foodSubCategories"):$window.location.reload())})})}}else alertService.showError("Please approve at least one item!")}},that.getChosenVendors=function(){api.get_chosen_vendors(that.restaurant_id.restaurant_id,{vendor_type_id:that.inventory_type_id}).then(function(res){try{that.vendors=[],that.vendors.push({id:-1,vendor_name:"(+) Add a new Vendor"}),that.vendors=that.vendors.concat(res.data.data.vendors)}catch(e){console.log(e)}})},that.changeVendor=function(is_init){that.resetOrderItems(),that.current_vendor_bu=JSON.parse(JSON.stringify(that.current_vendor)),-1==that.current_vendor.id?$uibModal.open({templateUrl:"add_new_vendor.html",controller:modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",resolve:{global_Vendors:function(){return that.api.get_global_vendors({vendor_type_id:that.inventory_type_id}).then(function(res){try{return that.global_Vendors=res.data.data.vendors}catch(e){console.log(e)}})},inventory_type_id:function(){return that.inventory_type_id},get_refbooks:function(){return that.get_refbooks?that.get_refbooks:that.core.getRefbooks().then(function(res){return that.get_refbooks=res})}}}).result.then(function(){that.current_vendor=null,that.getChosenVendors()},function(){that.current_vendor=null,that.getChosenVendors()}):(that.isEdit&&that.current_vendor.id!=that.isEdit_vendor_id&&(alertService.showError("Vendor different from that on invoice!"),that.current_vendor=null),that.isEdit||that.api.get_active_inventory_by_vendor({vendor_id:that.current_vendor.id,inventory_type_id:that.inventory_type_id},that.restaurant_id.restaurant_id).then(function(res){that.inventories=[],that.inventories.push({id:-1,item_name:"(+) Add a new Inventory Item"}),that.inventories=that.inventories.concat(res.data.data.sku),that.loadOrder()}))},that.chooseVendor=function(is_init){if(that.orderModel.items.length){var conf={title:"Are you sure?",text:"Any progress will be lost if you proceed.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"};swal(conf,function(res){res?that.changeVendor(is_init):that.current_vendor=JSON.parse(JSON.stringify(that.current_vendor_bu))})}else that.changeVendor(is_init)},that.$onInit=function(){that.getChosenVendors(),that.getOH(),that.core.getRefbooks().then(function(res){that.refbooks=res})}}var qt=function($uibModalInstance,isFood,isEdit){var that=this;isFood?isEdit?(that.q_title="Confirm Food Delivery Instructions",that.q_texts='<article style="display: block;"><p><b>Confirm Food Delivery Edit Screen</b>  you may modify your orders here to match your invoice or make corrects. Here you may change the Order Quantity, Order Type, Case Size and Item Cost. You may also remove an item completely or add a new item<br/><br/><b>Adding a New Item</b>  Select the + symbol to create a new line item. Note: The vendor has to be the same. Once the new item is added you must approve the item the select Confirm and Save<br/><br/><b>Delete</b>  To remove an item you much first unapproved the item then select Delete and finally Confirm and Save<br/><br/><b>Modify Case Size</b>  Check the box next to the case size that you would like to change. We do not recommend changing the case size but instead, change your order size.<br/><br/><b>Modify Item Cost</b>  Check the box next to the item cost then enter in the correct cost. Select Confirm and Save</p></article>'):(that.q_title="New Food Order Instructions",that.q_texts='<article style="display: block;"><p><b>New Food Order</b>  Here is where you will generate your orders which can be automatically delivered to your sales rep email<br/><br/><b>Vendor</b>  Select the vendor from the drop down list. You may select multiple vendors and the final order will be sorted and delivered by vendors<br/><br/><b>Item Description</b>  Each vendor has their own unique items<br/><br/><b>Units on Hand</b>  The theoretical amount of inventory that you should have on-hand as of the start of the current business day. The categories are Case, Packs, Units and Order Type<br/><br/><b>Actual</b>  This is where you will enter the desired order amount and Order Type<br/><br/><b>Approve</b>  You must approve each item or it will not be processed<br/><br/><b>Confirm and Send</b>  This will send your order to the email addresses you included in the vendors setup file which should include your sales rep email address.<br/><br/><b>Confirm and Save</b>  This will save and process the order but will not send it</p></article>'):isEdit?(that.q_title="Confirm Alcohol Delivery Instructions",that.q_texts='<article style="display: block;"><p><b>Confirm Alcohol Delivery Edit Screen</b>  you may modify your orders here to match your invoice or make corrects. Here you may change the Order Quantity, Order Type, Case Size and Item Cost. You may also remove an item completely or add a new item<br/><br/><b>Adding a New Item</b>  Select the + symbol to create a new line item. Note: The vendor has to be the same. Once the new item is added you must approve the item the select Confirm and Save<br/><br/><b>Delete</b>  To remove an item you much first unapproved the item then select Delete and finally Confirm and Save<br/><br/><b>Modify Item Cost</b>  Check the box next to the item cost then enter in the correct cost. Select Confirm and Save</p></article>'):(that.q_title="New Alcohol Order Instructions",that.q_texts='<article style="display: block;"><p><b>New Alcohol Order</b>  Here is where you will generate your orders which can be automatically delivered to your sales rep email<br/><br/><b>Vendor</b>  Select the vendor from the drop down list. You may select multiple vendors and the final order will be sorted and delivered by vendors<br/><br/><b>Item Description</b>  Each vendor has their own unique items<br/><br/><b>Units on Hand</b>  The theoretical amount of inventory that you should have on-hand as of the start of the current business day.<br/><br/><b>Actual</b>  This is where you will enter the desired order amount and Order Type<br/><br/><b>Approve</b>  You must approve each item or it will not be processed<br/><br/><b>Confirm and Send</b>  This will send your order to the email addresses you included in the vendors setup file which should include your sales rep email address.<br/><br/><b>Confirm and Save</b>  This will save and process the order but will not send it<br/><br/>TIP: Do not include deposits as part of your cost. For example  many keg vendors will charge a refundable keg deposit which is not apart of your true cost. If you add it to your cost it will sku your pricing, cost and budget.</p></article>'),that.skip=function(){$uibModalInstance.dismiss("cancel")}};controller.$inject=["$state","$scope","auth","api","core","restaurant","$uibModal","localStorageService","$rootScope","alertService","$window","$q"],angular.module("inspinia").component("newOrderComponent",{templateUrl:"js/components/newOrder/newOrder.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";function controller($state,auth,api,core,restaurant,$uibModal,localStorageService,$rootScope,$filter,alertService){if(!auth.authentication.isLogged)return void $state.go("login");var that=this;if(that.api=api,that.core=core,that.isFood=$state.includes("food.orderSummary"),that.refbooks={},that.form={},that.inventories=[],that.inventory_type_id=that.isFood?"1":"2",that.orderModel={totalInvoice:0,totalOrder:0,inventory_type_id:that.inventory_type_id,items:[]},that.searchModel={inventory_type_id:that.inventory_type_id,orderBy:"vendor_name",orderWay:"DESC",paginationOffset:0,paginationCount:25,paginationTotal:0},that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),that.showInfo=function(){$uibModal.open({animation:!0,templateUrl:"quick_tutorial.html",controller:qt,controllerAs:"qt",windowClass:"animated fadeIn modal-lgg",size:"lg"})},that.search=function(keyword){that.searchModel.inRequest=!0;var m={orderBy:that.searchModel.orderBy,orderWay:that.searchModel.orderWay,paginationOffset:that.searchModel.paginationOffset,paginationCount:that.searchModel.paginationCount,city:that.searchModel.city,item_name:that.searchModel.item_name,sub_category:that.searchModel.sub_category,vendor_sku:that.searchModel.vendor_sku,filter:that.searchModel.filter,category:that.searchModel.category,inventory_type_id:that.inventory_type_id};for(var i in m)m[i]||delete m[i];keyword&&(m.paginationOffset=0,that.searchModel.orderBy==keyword?(that.searchModel.orderWay="ASC"==m.orderWay?"DESC":"ASC",m.orderWay="ASC"==m.orderWay?"DESC":"ASC"):(that.searchModel.orderBy=keyword,m.orderBy=keyword)),m.paginationOffset>0&&!keyword&&(m.paginationOffset=(m.paginationOffset-1)*m.paginationCount),api.get_orders(m).then(function(res){try{that.inventories=res.data.data.orders,that.searchModel.paginationTotal=res.data.data.paginationTotal,that.calculate()}catch(e){console.log(e)}})},that.search(),that.calculate=function(){var totalInvoice=0,totalOrder=0;angular.forEach(that.inventories,function(v,k){totalInvoice+=parseFloat(v.invoice_total)||0,totalOrder+=parseFloat(v.total)||0}),that.orderModel.totalInvoice=totalInvoice,that.orderModel.totalOrder=totalOrder},that.checkDetails=function($index){that.inventories[$index].delivery_date>new Date&&(alertService.showError("Delivery date cannot be greater than now!"),that.inventories[$index].delivery_date=new Date)},that.check_Invoice=function(i){1==i.is_delivery_confirmed&&api.check_if_invoice_exists(that.restaurant_id.restaurant_id+"&"+i.invoice_number+"&"+i.vendor_id).then(function(res){try{if("true"==res.data.data.does_exist.does_exist[0].invoice_exists)return alertService.showError("Invoice number already exists in the records!"),void(i.is_delivery_confirmed=0)}catch(e){console.log("error")}})},that.getDateObj=function(date,isFocus){if(!date&&isFocus)return new Date;if(date||isFocus){var d=new Date(date);return isNaN(d)||!d?new Date:new Date(d)}},that.$onInit=function(){that.core.getRefbooks().then(function(res){that.refbooks=res})},that.save=function(form){if(form.$valid){for(var m={inventory_type_id:that.inventory_type_id,orders:[]},i=0;that.inventories.length>i;i++){if(that.inventories[i].is_approved&&!that.inventories[i].is_delivery_confirmed)return void alertService.showError("Please confirm the delivery of the approved invoices");that.inventories[i].is_approved&&m.orders.push({id:that.inventories[i].id,is_approved:that.inventories[i].is_approved,order_number:that.inventories[i].order_number,order_date:$filter("date")(that.inventories[i].order_date,"yyyy-MM-dd"),total:that.inventories[i].total,is_delivery_confirmed:that.inventories[i].is_delivery_confirmed,invoice_number:that.inventories[i].invoice_number,invoice_total:that.inventories[i].invoice_total,delivery_date:$filter("date")(that.inventories[i].delivery_date,"yyyy-MM-dd"),delivery_time:$filter("date")(that.inventories[i].delivery_date,"HH:mm:ss")})}that.api.update_orders(m).then(function(){alertService.showAlertSave(),that.inventories=[],that.searchModel.paginationTotal=0,that.search()})}}}var qt=function($uibModalInstance){var that=this;that.q_title="Order Summary Instructions",that.q_texts='<article style="display: block;"><p><b>Order Summary</b> - Prior to any orders being stored or updating, you must first confirm receipt of the order.<br/><br/><b>Invoice Number</b>  Please enter the vendors invoice numbers which can be found on the vendors invoice<br/><br/><b>Delivery Date</b>  Please enter the date the item was delivered<br/><br/><b>Total Invoice Amount</b>  Please enter the total amount on the invoice excluding any deposit amounts. This may cause your total amounts to match however if each item cost matches then your total invoice amount will be correct and you can save the entry as is.<br/><br/><b>Edit</b>  If your total invoice doesnt match (excluding deposits), you may adjust the invoice by selecting Edit</p></article>',that.skip=function(){$uibModalInstance.dismiss("cancel")}};controller.$inject=["$state","auth","api","core","restaurant","$uibModal","localStorageService","$rootScope","$filter","alertService"],angular.module("inspinia").component("orderSummaryComponent",{templateUrl:"js/components/orderSummary/orderSummary.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";function controller(api,$state,auth,localStorageService,$rootScope,restaurant,core,$window){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;that.form={},that.$state=$state,that.core=core,that.api=api,that.auth=auth,that.restaurant_id=localStorageService.get("restaurant_id"),that.model={},that.model.res_scores=[],that.model.selected_date="",that.timeConverter=function(UNIX_timestamp){return UNIX_timestamp.substring(0,10)},that.model.alcohol_industry_benchmark=0,that.model.res_scores_xform=[],that.updateScoreTable=function(sd){if(that.model.reres_scores.length>0){var count=0,fetch_flag=!1;that.model.res_scores_xform=[];for(var i=0;i<that.model.reres_scores.length;i++)sd==that.model.reres_scores[i].date&&(fetch_flag=!0),fetch_flag&&count<4&&(that.model.res_scores_xform.push({date:that.model.reres_scores[i].date,ascore:that.model.reres_scores[i].ascore,fscore:that.model.reres_scores[i].fscore,industry_benchmark:that.model.reres_scores[i].industry_benchmark}),count++);that.model.res_scores_xform=that.model.res_scores_xform.reverse(),that.model.alcohol_industry_benchmark=that.model.res_scores_xform[count-1].industry_benchmark}},that.showScoreDetails=function(s_ele,type){$rootScope.performanceDate=s_ele.date,$rootScope.detail_type=type,$window.location.href="#!/admin/performanceScoreDetail"},that.$onInit=function(){
var resId=that.restaurant_id.restaurant_id;that.api.get_scores(resId).then(function(res){if(that.model.res_scores=res.data.data.scores.scores,that.model.res_scores.length>0){for(var ascores=[],fscores=[],i=0;i<that.model.res_scores.length;i++)that.model.res_scores[i].date=that.timeConverter(that.model.res_scores[i].date),"Alcohol Cost"==that.model.res_scores[i].type?ascores.push(that.model.res_scores[i]):"Food Cost"==that.model.res_scores[i].type&&fscores.push(that.model.res_scores[i]);that.model.reres_scores=[];for(var i=0;i<ascores.length;i++){that.model.reres_scores[i]={},that.model.reres_scores[i].date=ascores[i].date,that.model.reres_scores[i].ascore=ascores[i].score;for(var foundfood=!1,j=0;j<fscores.length;j++)if(fscores[j].date==ascores[i].date){foundfood=!0,that.model.reres_scores[i].fscore=fscores[i].score;break}foundfood||(that.model.reres_scores[i].fscore=null)}that.model.selected_date=that.model.reres_scores[0].date,$rootScope.performanceDate=that.model.selected_date,that.updateScoreTable(that.model.selected_date)}}),that.api.calc_scores(resId).then(function(res){if(res){that.model.res_scores.unshift({date:res.data.data.scores.sd,score:res.data.data.scores.ffs,type:"Food Cost"}),that.model.res_scores.unshift({date:res.data.data.scores.sd,score:res.data.data.scores.fs,type:"Alcohol Cost"});for(var ascores=[],fscores=[],i=0;i<that.model.res_scores.length;i++)that.model.res_scores[i].date=that.timeConverter(that.model.res_scores[i].date),"Alcohol Cost"==that.model.res_scores[i].type?ascores.push(that.model.res_scores[i]):"Food Cost"==that.model.res_scores[i].type&&fscores.push(that.model.res_scores[i]);that.model.reres_scores=[];for(var i=0;i<ascores.length;i++){that.model.reres_scores[i]={},that.model.reres_scores[i].date=ascores[i].date,that.model.reres_scores[i].ascore=ascores[i].score;for(var foundfood=!1,j=0;j<fscores.length;j++)if(fscores[j].date==ascores[i].date){foundfood=!0,that.model.reres_scores[i].fscore=fscores[i].score;break}foundfood||(that.model.res_scores[i].fscore=null)}that.model.selected_date=that.model.res_scores[0].date,that.updateScoreTable(that.model.selected_date)}})}}controller.$inject=["api","$state","auth","localStorageService","$rootScope","restaurant","core","$window"],angular.module("inspinia").component("performanceScoreComponent",{templateUrl:"js/components/performanceScore/performanceScore.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("admin.performanceScore",{url:"/performanceScore",template:"<performance-score-component></performance-score-component>",data:{pageTitle:"Performance Score"}})})}(),function(){"use strict";function controller(api,$state,auth,localStorageService,$rootScope,restaurant,core,$scope){if(!auth.authentication.isLogged)return void $state.go("home");$scope.Date=$rootScope.performanceDate;var that=this;that.detail_type=$rootScope.detail_type,that.form={},that.$state=$state,that.core=core,that.api=api,that.auth=auth,that.restaurant_id=localStorageService.get("restaurant_id"),that.score_details=[],that.score_summary={},$scope.performanceScoreDetail=function(){that.api.performance_score_detail({Date:$scope.Date,RestaurantId:that.restaurant_id.restaurant_id,Category:that.score_category}).then(function(ret){if(ret){for(var details=ret.data.data.performanceScoreDetail,i=0;i<details.length;i++)angular.isUndefined(that.active_list[details[i].category])||null===that.active_list[details[i].category]||(that.active_list[details[i].category].push(details[i]),that.summary_list[details[i].category].purchases=angular.isUndefined(that.summary_list[details[i].category].purchases)||null===that.summary_list[details[i].category].purchases?details[i].purchases_units:that.summary_list[details[i].category].purchases+details[i].purchases_units,that.summary_list[details[i].category].sold=angular.isUndefined(that.summary_list[details[i].category].sold)||null===that.summary_list[details[i].category].sold?details[i].sold_units:that.summary_list[details[i].category].sold+details[i].sold_units,that.summary_list[details[i].category].q_var=angular.isUndefined(that.summary_list[details[i].category].q_var)||null===that.summary_list[details[i].category].q_var?details[i].unit_variance:that.summary_list[details[i].category].q_var+details[i].unit_variance,that.summary_list[details[i].category].oh=angular.isUndefined(that.summary_list[details[i].category].oh)||null===that.summary_list[details[i].category].oh?details[i].oh_units:that.summary_list[details[i].category].oh+details[i].oh_units,that.summary_list[details[i].category].slow=angular.isUndefined(that.summary_list[details[i].category].slow)||null===that.summary_list[details[i].category].slow?details[i].oh_units>0&&details[i].usage_percent>0&&details[i].usage_percent<8.25?1:0:that.summary_list[details[i].category].slow+(details[i].oh_units>0&&details[i].usage_percent>0&&details[i].usage_percent<8.25?1:0),that.summary_list[details[i].category].usage=angular.isUndefined(that.summary_list[details[i].category].usage)||null===that.summary_list[details[i].category].usage?details[i].usage_percent>=0?details[i].usage_percent:0:that.summary_list[details[i].category].usage+(details[i].usage_percent>=0?details[i].usage_percent:0),that.summary_list[details[i].category].stale=angular.isUndefined(that.summary_list[details[i].category].stale)||null===that.summary_list[details[i].category].stale?details[i].stale_days>7?1:0:that.summary_list[details[i].category].stale+(details[i].stale_days>7?1:0));for(var category in that.categories)that.summary_list[that.categories[category]].pvs=that.summary_list[that.categories[category]].sold/that.summary_list[that.categories[category]].purchases*100,that.summary_list[that.categories[category]].slow=that.summary_list[that.categories[category]].slow/that.active_list[that.categories[category]].length*100,that.summary_list[that.categories[category]].usage=that.summary_list[that.categories[category]].usage/that.active_list[that.categories[category]].length,that.summary_list[that.categories[category]].stale=that.summary_list[that.categories[category]].stale/that.active_list[that.categories[category]].length*100;that.score_details=that.active_list[that.score_category],that.score_summary=that.summary_list[that.score_category]}})},$scope.food_performanceScoreDetail=function(){that.api.food_performance_score_detail({Date:$scope.Date,RestaurantId:that.restaurant_id.restaurant_id,Category:that.score_category}).then(function(ret){if(ret){for(var details=ret.data.data.performanceScoreDetail,i=0;i<details.length;i++)angular.isUndefined(that.active_list[details[i].category])||null===that.active_list[details[i].category]||(that.active_list[details[i].category].push(details[i]),that.summary_list[details[i].category].purchases=angular.isUndefined(that.summary_list[details[i].category].purchases)||null===that.summary_list[details[i].category].purchases?details[i].purchases_units:that.summary_list[details[i].category].purchases+details[i].purchases_units,that.summary_list[details[i].category].sold=angular.isUndefined(that.summary_list[details[i].category].sold)||null===that.summary_list[details[i].category].sold?details[i].sold_units:that.summary_list[details[i].category].sold+details[i].sold_units,that.summary_list[details[i].category].q_var=angular.isUndefined(that.summary_list[details[i].category].q_var)||null===that.summary_list[details[i].category].q_var?details[i].unit_variance:that.summary_list[details[i].category].q_var+details[i].unit_variance,that.summary_list[details[i].category].oh=angular.isUndefined(that.summary_list[details[i].category].oh)||null===that.summary_list[details[i].category].oh?details[i].oh_units:that.summary_list[details[i].category].oh+details[i].oh_units,that.summary_list[details[i].category].slow=angular.isUndefined(that.summary_list[details[i].category].slow)||null===that.summary_list[details[i].category].slow?details[i].oh_units>0&&details[i].usage_percent>0&&details[i].usage_percent<8.25?1:0:that.summary_list[details[i].category].slow+(details[i].oh_units>0&&details[i].usage_percent>0&&details[i].usage_percent<8.25?1:0),that.summary_list[details[i].category].usage=angular.isUndefined(that.summary_list[details[i].category].usage)||null===that.summary_list[details[i].category].usage?details[i].usage_percent>=0?details[i].usage_percent:0:that.summary_list[details[i].category].usage+(details[i].usage_percent>=0?details[i].usage_percent:0),that.summary_list[details[i].category].stale=angular.isUndefined(that.summary_list[details[i].category].stale)||null===that.summary_list[details[i].category].stale?details[i].stale_days>7?1:0:that.summary_list[details[i].category].stale+(details[i].stale_days>7?1:0));for(var category in that.categories)that.summary_list[that.categories[category]].pvs=that.summary_list[that.categories[category]].sold/that.summary_list[that.categories[category]].purchases*100,that.summary_list[that.categories[category]].slow=that.summary_list[that.categories[category]].slow/that.active_list[that.categories[category]].length*100,that.summary_list[that.categories[category]].usage=that.summary_list[that.categories[category]].usage/that.active_list[that.categories[category]].length,that.summary_list[that.categories[category]].stale=that.summary_list[that.categories[category]].stale/that.active_list[that.categories[category]].length*100;that.score_details=that.active_list[that.score_category],that.score_summary=that.summary_list[that.score_category]}})},that.change_category=function(){that.score_details=that.active_list[that.score_category],that.score_summary=that.summary_list[that.score_category]},that.$onInit=function(){var inventory_type_id=(that.restaurant_id.restaurant_id,"alcohol"==that.detail_type?2:1);Promise.all([api.get_vendors_categories({is_restaurant_used_only:1,inventory_type_id:inventory_type_id})]).then(function(response){that.categories=response[0].data.data.categories.filter(function(x){return"Non Alcoholic"!=x.category}).map(function(x){return x.category}),that.score_category=that.categories[0],that.active_list={},that.summary_list={};for(var i=0;i<that.categories.length;i++)that.active_list[that.categories[i]]=[],that.summary_list[that.categories[i]]={};"alcohol"==that.detail_type?$scope.performanceScoreDetail():"food"==that.detail_type&&$scope.food_performanceScoreDetail()})}}controller.$inject=["api","$state","auth","localStorageService","$rootScope","restaurant","core","$scope"],angular.module("inspinia").component("performanceScoreDetailComponent",{templateUrl:"js/components/performanceScoreDetail/performanceScoreDetail.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("admin.performanceScoreDetail",{url:"/performanceScoreDetail",template:"<performance-score-detail-component></performance-score-detail-component>",data:{pageTitle:"Performance Score Detail"}})})}(),function(){"use strict";function recipeAuditController(api,$state,auth,$filter,localStorageService,alertService,$rootScope,restaurant,core,$scope,SweetAlert,$q){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;that.form={},that.api=api,that.auth=auth,that.recipes=[],that.pickers={beginDate:{open:!1,date:new Date},endDate:{open:!1,date:new Date},beginDateBackup:{open:!1,date:new Date}};var INVENTORIES=[];if(that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),that.model={recipe_category_id:"all",inventory_item:null},that.partial_qty_modes=["Lbs","Oz"],that.current_partial_qty_mode=that.partial_qty_modes[0],that.current_partial_qty_mode_bu=JSON.parse(JSON.stringify(that.partial_qty_modes[0])),$scope.$on("$stateChangeStart",function(event,toState,toParams,fromState,fromParams,options){var toState=toState.name;JSON.stringify(INVENTORIES)!==JSON.stringify(that.recipes)&&(event.preventDefault(),SweetAlert.swal({title:"Save changes?",text:"Changes not been saved yet!",type:"warning",showCancelButton:!0,confirmButtonColor:"#337ab7",confirmButtonText:"Save"},function(res){res?that.saveCount(that.form,!0).then(function(){INVENTORIES=angular.copy(that.recipes),window.onbeforeunload=null,$state.go(toState)}):(INVENTORIES=angular.copy(that.recipes),window.onbeforeunload=null,$state.go(toState))}))}),that.pushNewInstance=function($index,parent){var new_instance=JSON.parse(JSON.stringify(that.recipes[$index]));new_instance.is_ref=0,new_instance.recipe_created_on=null,that.recipes.splice($index+1,0,new_instance)},that.deleteInstance=function($index,item){that.recipes[$index].id?that.api.delete_recipe_audit_item({id:that.recipes[$index].entry_id}).then(function(res){1e3===res.data.data.code?(that.recipes.splice($index,1),swal({title:"Deleted successfully!",timer:1e3,showConfirmButton:!1,type:"success"})):alertService.showError("Couldn't delete!")}):that.recipes.splice($index,1)},that.checkCreationDate=function($index){that.recipes[$index].recipe_created_on>that.pickers.beginDate.date&&(SweetAlert.swal({title:"Invalid Recipe Creation Date",text:"Recipe Creation Date cannot be older than Audit Begin Date",type:"warning",confirmButtonColor:"#337ab7",confirmButtonText:"OK"},function(res){}),that.recipes[$index].recipe_created_on=null)},that.changeMode=function(){$state.go("foodSetup.foodInventory")},that.convertPartialToCurrentMode=function(is_manual){var deferred=$q.defer();const multiplier="Lbs"==that.current_partial_qty_mode?1/16:1;var convert=function(){for(var i=0;i<that.recipes.length;i++)that.recipes[i].partial_qty_ph=Math.round(that.recipes[i].partial_qty/100*that.recipes[i].servings*multiplier*100)/100;that.current_partial_qty_mode_bu=JSON.parse(JSON.stringify(that.current_partial_qty_mode)),deferred.resolve()};return is_manual?SweetAlert.swal({title:"Save progress?",text:"You may lose any unsaved changes!",type:"warning",showCancelButton:!0,cancelButtonText:"Disard and Continue",confirmButtonColor:"#337ab7",confirmButtonText:"Save"},function(res){res?that.saveCount(that.form,!0).then(function(){convert()}):convert()}):convert(),deferred.promise},that.getInventoriesCaller=function(categoryId,categoryOldId){JSON.stringify(INVENTORIES)!==JSON.stringify(that.recipes)?SweetAlert.swal({title:"Save progress?",text:"You may lose any unsaved changes!",type:"warning",showCancelButton:!0,cancelButtonText:"Disard and Continue",confirmButtonColor:"#337ab7",confirmButtonText:"Save"},function(res){res?that.saveAll(that.form,!0).then(function(){that.getInventories(that.model.recipe_category_id)}):that.getInventories(that.model.recipe_category_id)}):that.getInventories(that.model.recipe_category_id)},that.getInventories=function(categoryId,categoryOldId){that.loading=!0;var m={is_adjustment:0,inventory_type_id:1,recipe_type_id:"all"==categoryId?null:categoryId,inventory_item:that.model.inventory_item,audit_start_TS:!0};that.api.get_recipe_audit(m).then(function(res){that.recipes=res.data.data.inventory,that.pickers.beginDate.date=void 0!==res.data.data.audit_start&&null!=res.data.data.audit_start[0].audit_start?new Date(res.data.data.audit_start[0].audit_start):new Date,that.pickers.beginDateBackup.date=JSON.parse(JSON.stringify(that.pickers.beginDate.date));for(var i=0;that.recipes.length>i;i++)that.recipes[i].recipe_created_on=that.recipes[i].recipe_created_on?new Date(that.recipes[i].recipe_created_on):that.pickers.beginDate.date;that.convertPartialToCurrentMode().then(function(res){INVENTORIES=JSON.parse(JSON.stringify(that.recipes)),that.loading=!1})})},that.saveCount=function(form,is_search){var deferred=$q.defer();if(form.inventory.$valid&&that.pickers.beginDate.date&&that.pickers.endDate.date){var m={inventory_type_id:1,counting_started_at:new Date(that.pickers.beginDate.date).getTime(),counting_ended_at:(new Date).getTime(),is_final_save:0,is_adjustment:0,inventory_items:[]};const multiplier="Lbs"==that.current_partial_qty_mode_bu?16:1;for(var i=0;that.recipes.length>i;i++)(null!==that.recipes[i].full_qty&&0!==that.recipes[i].full_qty||null!==that.recipes[i].partial_qty_ph&&0!==that.recipes[i].partial_qty_ph)&&(that.recipes[i].partial_qty=0==that.recipes[i].servings?0:Math.round(that.recipes[i].partial_qty_ph*multiplier/that.recipes[i].servings*100*100)/100,m.inventory_items.push({id:that.recipes[i].id,recipe_type_id:that.recipes[i].recipe_type_id,total_servings:that.recipes[i].total_servings,full_qty:that.recipes[i].full_qty?that.recipes[i].full_qty:0,partial_qty:that.recipes[i].partial_qty?that.recipes[i].partial_qty:0,is_ref:0,recipe_created_on:that.recipes[i].recipe_created_on?$filter("date")(that.recipes[i].recipe_created_on,"yyyy-MM-dd"):null,full_values:(that.recipes[i].full_qty?that.recipes[i].full_qty:0)+"",partial_values:(that.recipes[i].partial_qty?that.recipes[i].partial_qty:0)+""}));return that.api.update_recipe_audit(m).then(function(res){try{1e3===res.data.data.code&&(is_search||(alertService.showAlertSave(),that.getInventories(that.model.recipe_category_id)),deferred.resolve())}catch(e){console.log(e),deferred.reject()}},function(){deferred.reject()}),deferred.promise}},that.saveAll=function(form,is_search){var deferred=$q.defer();that.recipes.length<1&&deferred.resolve();for(var hm={},dup=!1,i=0;that.recipes.length>i;i++){if(void 0!==hm[that.recipes[i].recipe_id+"_"+$filter("date")(that.recipes[i].recipe_created_on,"yyyy-MM-dd")]){dup=!0;break}hm[that.recipes[i].recipe_id+"_"+$filter("date")(that.recipes[i].recipe_created_on,"yyyy-MM-dd")]=1}if(dup)SweetAlert.swal({title:"Duplicate Batch entry",text:"Same Batch Recipes cannot have same creation date. Please add together their count.",type:"warning",confirmButtonColor:"#337ab7",confirmButtonText:"OK"},function(res){res&&deferred.resolve()});else{if(is_search)return that.saveCount(form,is_search);SweetAlert.swal({title:"Save?",text:"This will save this as a draft.",type:"warning",showCancelButton:!0,confirmButtonColor:"#337ab7",confirmButtonText:"OK"},function(res){if(res)return that.saveCount(form,is_search)})}return deferred.promise},that.deleteCurrentInventoryAudit=function(){SweetAlert.swal({title:"Are you sure?",text:"This will completely delete the saved Audit for this restaurant and you will have to startover!",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){res&&that.api.delete_inventory_audit(1).then(function(res1){res&&(SweetAlert.swal("Deleted!","Please proceed to startover a new audit.","success"),$state.go("foodSubCategories"))})})},that.changeAuditDate=function(){that.api.get_audit_dates({RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:1}).then(function(res1){that.audit_dates=res1.data.data.Report;var valid_date=!0;if(that.pickers.beginDate.date>new Date)SweetAlert.swal({title:"Error!",text:"Audit date cannot be greater than now!",type:"error",confirmButtonColor:"#ed5565",confirmButtonText:"OK"},function(res){}),that.pickers.beginDate.date=new Date(that.pickers.beginDateBackup.date),valid_date=!1;else if(that.audit_dates.length>1){var prev_aud=null;prev_aud="history"==that.audit_dates[0].src?that.audit_dates[0].audit_dates:that.audit_dates[1].audit_dates,that.pickers.beginDate.date<=new Date(prev_aud)&&(SweetAlert.swal({title:"Error!",text:"Audit date cannot be less than or equal to the previous audit!",type:"error",confirmButtonColor:"#ed5565",confirmButtonText:"OK"},function(res){}),that.pickers.beginDate.date=new Date(that.pickers.beginDateBackup.date),valid_date=!1)}valid_date&&SweetAlert.swal({title:"Are you sure?",text:"Are you sure you want to change the audit date? This change could affect multiple reports.",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){res&&that.api.set_audit_date({inventory_type_id:1,audit_date:new Date(that.pickers.beginDate.date).getTime()}).then(function(res1){SweetAlert.swal("Audit Date Updated!","","success")})})})},that.openCalendar=function(e,picker){that.pickers[picker].open=!0},that.getBatches=function(){var deferred=$q.defer(),m={is_adjustment:0,inventory_type_id:1,recipe_type_id:null,inventory_item:null};return that.api.get_recipe_audit(m).then(function(res){res&&(that.batches=res.data.data.inventory),deferred.resolve()}),deferred.promise},that.generatePDFCall=function(){that.batches=[],that.getBatches().then(function(res){that.generatePDF()})},that.generatePDF=function(){$scope.print_loading=!0,swal({title:"",text:"Printing...",imageUrl:"https://www.boasnotas.com/img/loading2.gif",showConfirmButton:!1});var r_type="Food",content_data=[{text:restaurant.data.info.restaurant_name,style:"title"},{text:r_type+" Audit Sheet",style:"subheader"}];if(content_data.push({text:"Audit Date: ____/____/____",style:"audit_date"}),content_data.push({text:" ",style:"audit_date"}),content_data.push({text:"Audited By: ______________",style:"audit_date"}),content_data.push({table:{widths:["*"],body:[[" "],[" "]]},layout:{hLineWidth:function(i,node){return 0===i||i===node.table.body.length?0:2},vLineWidth:function(i,node){return 0}}}),that.batches.length){content_data.push({text:"Category: Batches",style:"category"});var b_table_body_data=[];b_table_body_data.push([{text:"Batch Description",style:"tableHeader",fillColor:"#eeeeee"},{text:"Full",style:"tableHeader",fillColor:"#eeeeee"},{text:"Partial",style:"tableHeader",fillColor:"#eeeeee"},{text:"Partial",style:"tableHeader",fillColor:"#eeeeee"},{text:"Partial",style:"tableHeader",fillColor:"#eeeeee"},{text:"Total Servings (Oz)",style:"tableHeader",fillColor:"#eeeeee"}]);for(var i=0;i<that.batches.length;i++)b_table_body_data.push([{text:that.batches[i].recipe_name,style:"tableContent"},{text:" ",style:"tableContent"},{text:" ",style:"tableContent"},{text:" ",style:"tableContent"},{text:" ",style:"tableContent"},{text:that.batches[i].servings,style:"tableContent"}]);content_data.push({style:"tableExample",table:{heights:25,widths:["*",40,40,40,40,32],headerRows:1,dontBreakRows:!0,body:b_table_body_data},layout:{hLineWidth:function(i,node){return 1},vLineWidth:function(i,node){return 1},hLineColor:function(i,node){return"gray"},vLineColor:function(i,node){return"gray"}}})}content_data.push({text:"----- End of "+r_type+" Audit Sheet -----",style:"end_of_report"});var docDefinition={pageSize:"A4",header:function(currentPage,pageCount){return[{text:currentPage.toString()+" of "+pageCount,style:["header","pg_no"]}]},footer:{text:"Powered by Skrible - www.getskrible.com",style:"footer"},content:content_data,styles:{pg_no:{fontSize:8},header:{margin:[0,10,10,0],alignment:"right"},title:{fontSize:14,bold:!0,margin:[0,0,0,0],alignment:"center"},subheader:{fontSize:12,bold:!0,margin:[0,0,0,0],alignment:"center"},audit_date:{fontSize:11,bold:!0,margin:[0,0,0,0],alignment:"right"},summaryTableHeader:{bold:!1,fontSize:10,color:"black",alignment:"center"},summaryTableContentNoCenter:{bold:!1,fontSize:9,color:"black"},summaryTableContent:{bold:!1,fontSize:9,color:"black",alignment:"center"},category:{fontSize:11,bold:!0,margin:[-10,0,0,0]},tableExample:{margin:[-10,5,-10,15]},tableHeader:{bold:!1,fontSize:9,color:"black",alignment:"center"},tableContentNoCenter:{bold:!1,fontSize:9,color:"black"},tableContent:{bold:!1,fontSize:9,color:"black",alignment:"center"},end_of_report:{fontSize:12,bold:!1,margin:[0,30,0,0],alignment:"center"},footer:{fontSize:8,margin:[0,5,0,0],alignment:"center"}},defaultStyle:{font:"Roboto",bold:"Roboto-Bold"}};pdfMake.fonts={Roboto:{normal:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Regular.ttf",bold:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Medium.ttf",italics:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Italic.ttf",bolditalics:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-MediumItalic.ttf"}},pdfMake.createPdf(docDefinition).download("Audit_Sheet.pdf"),$scope.print_loading=!1,swal.close()},that.initBatchCats=function(){var r_type_list=[];for(var ri in that.refbooks.recipe_types){var cr=that.refbooks.recipe_types[ri];1!=cr.id&&4!=cr.id&&r_type_list.push({category:cr.name,r_type_id:cr.id})}return{categories:r_type_list}},that.init=function(){Promise.all([core.getRefbooks()]).then(function(response){that.refbooks=response[0],that.get_recipe_categories=that.initBatchCats().categories,that.get_recipe_categories.unshift({r_type_id:"all",category:"All Recipes"}),that.model.recipe_category_id=that.get_recipe_categories[0].r_type_id,that.getInventories(that.model.recipe_category_id)})},that.init()}recipeAuditController.$inject=["api","$state","auth","$filter","localStorageService","alertService","$rootScope","restaurant","core","$scope","SweetAlert","$q"],angular.module("inspinia").component("recipeAuditComponent",{templateUrl:"js/components/recipeAudit/recipeAudit.html",controller:recipeAuditController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("recipeAudit",{url:"/recipeAudit/:typeInventory",template:"<recipe-audit-component></recipe-audit-component>",data:{pageTitle:"Recipe Audit Pad"},resolve:{refbooks:function(core){return core.getRefbooks().then(function(res){return res})}}})})}(),function(){"use strict";function inviteController(api,$state,auth,core,$uibModal,alertService,restaurant,SweetAlert,$rootScope){if(!auth.authentication.isLogged||!parseInt($state.params.id))return void $state.go("registration");var that=this;that.form={},that.api=api,that.usersList=[],that.typeIdSubscription=null,that.get_refbooks=[],that.api.get_modules({is_tree_mode:1,subscription_type_id:$rootScope.subscription_type_id}).then(function(res){that.modules_tree=res.data.data.modules_tree}),$rootScope.$on("restaurantSelected",function(){that.api.get_modules({is_tree_mode:1,subscription_type_id:$rootScope.subscription_type_id}).then(function(res){that.modules_tree=res.data.data.modules_tree})}),api.get_restaurant($state.params.id).then(function(res){try{var restaurant_to_edit=res.data.data.restaurants_list[0];that.usersList=restaurant_to_edit.employees,that.typeIdSubscription=restaurant_to_edit.subscription_type_id,null!=that.typeIdSubscription&&4!=that.typeIdSubscription||$state.go("home")}catch(e){$state.go("home")}}),that.$onInit=function(){core.getRefbooks().then(function(res){that.get_refbooks=res})},that.userTypesFilter=function(type_id){if(that.get_refbooks.user_types)for(var i=0;that.get_refbooks.user_types.length>i;i++)if(that.get_refbooks.user_types[i].id===type_id)return that.get_refbooks.user_types[i].name},that.delete=function($index){if(that.usersList[$index].id){var m={user_type_id:that.usersList[$index].type_ids,ids:[that.usersList[$index].id]};that.api.delete_invite(m).then(function(res){1e3===res.data.data.code&&that.usersList.splice($index,1)})}else that.usersList.splice($index,1)},$uibModal.open({animation:!0,templateUrl:"quick_tutorial.html",controller:qt,controllerAs:"qt",backdrop:"static",keyboard:!1}),that.addUser=function(){$uibModal.open({animation:!0,templateUrl:"add-user-for-invite.html",controller:addUserInviteController,controllerAs:"vm",resolve:{user:function(){return null},refbooks:that.get_refbooks,modules:angular.copy(that.modules_tree)}}).result.then(function(user){user&&that.usersList.push(user)},function(){})},that.editUser=function(user,$index){$uibModal.open({animation:!0,templateUrl:"add-user-for-invite.html",controller:addUserInviteController,controllerAs:"vm",resolve:{user:function(){return user},refbooks:that.get_refbooks,modules:angular.copy(that.modules_tree)}}).result.then(function(user){user&&(that.usersList[$index]=user)},function(){})},that.changeUserStatus=function(user,$index){user.id&&SweetAlert.swal({title:"Are you sure?",text:"This user will be blocked and wouldn't be able work with this restaurant",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){if(res){var id=$state.params.id,m={employees:[{user_id:user.id,user_type_id:user.type_ids,is_disabled:user.is_disabled}]};that.api.change_restaurant_employee_status(id,m).then(function(res){},function(error){that.usersList[$index].is_disabled=1===user.is_disabled?0:1})}else that.usersList[$index].is_disabled=1===user.is_disabled?0:1})},that.sentInvitations=function(isExit){if(null!=that.typeIdSubscription&&4!=that.typeIdSubscription||$state.go("home"),that.usersList.length)if(isExit)1==that.typeIdSubscription||5==that.typeIdSubscription?4==restaurant.data.info.grant_level?$state.go("alcoholSetup.foodInventory"):restaurant.data.info.grant_level<4&&$state.go("alcoholSetup.vendor"):4==restaurant.data.info.grant_level?$state.go("foodSetup.inventory"):restaurant.data.info.grant_level<4&&$state.go("foodSetup.vendor");else{for(var sentList=[],i=0;that.usersList.length>i;i++){var u={email:that.usersList[i].email,first_name:that.usersList[i].first_name,last_name:that.usersList[i].last_name,type_ids:[that.usersList[i].type_ids],is_disabled:that.usersList[i].is_disabled};that.usersList[i].permissions&&(u.permissions=that.usersList[i].permissions),sentList.push(u)}var model={users:sentList,restaurant_id:$state.params.id};that.api.users_invite(model).then(function(res){1e3===res.data.data.code&&alertService.showSuccessText("Invitations were sent"),1==that.typeIdSubscription||5==that.typeIdSubscription?4==restaurant.data.info.grant_level?$state.go("alcoholSetup.foodInventory"):restaurant.data.info.grant_level<4&&$state.go("alcoholSetup.vendor"):4==restaurant.data.info.grant_level?$state.go("foodSetup.inventory"):restaurant.data.info.grant_level<4&&$state.go("foodSetup.vendor")})}else{if(!isExit)return void alert("Please add users before sending invitations!");1==that.typeIdSubscription||5==that.typeIdSubscription?4==restaurant.data.info.grant_level?$state.go("alcoholSetup.foodInventory"):restaurant.data.info.grant_level<4&&$state.go("alcoholSetup.vendor"):4==restaurant.data.info.grant_level?$state.go("foodSetup.inventory"):restaurant.data.info.grant_level<4&&$state.go("foodSetup.vendor")}},that.back=function(){$state.go("home")}}var addUserInviteController=function(user,refbooks,$uibModalInstance,restaurant,modules){var that=this;that.form={},that.userTypes=refbooks.user_types,that.modules=modules,that.myGrantLevel=restaurant.data.info.grant_level,that.restaurantSubscriptionTypeId=restaurant.data.info.subscription_type_id,user&&user.permissions&&(that.modules=user.permissions),that.m={email:user?user.email:null,first_name:user?user.first_name:null,last_name:user?user.last_name:null,type_ids:user?user.type_ids:null,is_disabled:user?user.is_disabled:1},that.roleFilter=function(user){return 7!=user.id&&8!=user.id&&9!=user.id&&10!=user.id&&(2==that.restaurantSubscriptionTypeId||6==that.restaurantSubscriptionTypeId?2==user.subscription_type_id||3==user.subscription_type_id||6==that.restaurantSubscriptionTypeId||7==that.restaurantSubscriptionTypeId:1==that.restaurantSubscriptionTypeId||5==that.restaurantSubscriptionTypeId?1==user.subscription_type_id||3==user.subscription_type_id||5==that.restaurantSubscriptionTypeId||7==that.restaurantSubscriptionTypeId:3==that.restaurantSubscriptionTypeId||7==that.restaurantSubscriptionTypeId?1==user.subscription_type_id||2==user.subscription_type_id||3==user.subscription_type_id||5==user.subscription_type_id||6==user.subscription_type_id||7==user.subscription_type_id:void 0)},that.grantLevelFilter=function(user){return user.grant_level>=that.myGrantLevel},that.add=function(form){form.$valid&&(7===that.m.type_ids&&(that.m.permissions=that.modules),$uibModalInstance.close(that.m))},that.close=function(){$uibModalInstance.dismiss("cancel")}
},qt=function($uibModalInstance){var that=this;that.pg_no=1,that.q_title=["Quick Tutorial #1 of 11","Quick Tutorial #2 of 11","Quick Tutorial #3 of 11","Quick Tutorial #4 of 11","Quick Tutorial #5 of 11","Quick Tutorial #6 of 11","Quick Tutorial #7 of 11","Quick Tutorial #8 of 11","Quick Tutorial #9 of 11","Quick Tutorial #10 of 11","Quick Tutorial #11 of 11"],that.q_texts=["Thank you for signing up and giving Artecsan a try. The next few steps will provide you with tips and advice on what to expect throughout the setup process. Please note that you will be joining Artecsan through its open beta therefore you can expect to see constant changes, updates and upgrades.","Artecsan free features allows your restaurant to cost out your menu, cost out recipes, track inventory usage, track purchases, item cost and more. With the click of a button, customers who use our system to order their inventory are able to track daily inventory usage, know exactly what they have on-hand, easily view purchase details and more","Artecsan also includes a free inventory auditing platform that requires the use of a scale for improved accuracy. Artecsan helps restaurants to produce a highly accurate cost of goods sold percentage, easily identify which items you're losing money on and create your true budget based on cost and usage.","There is only one requirement for Artecsan to work, it must receive data from your POS which it uses to make all its calculations. Most modern day POS systems are able to distribute itemized sales reports on a nightly basis via email. In the setup process we will provide you basic instruction on how to add Artecsan to your email distribution list in CSV format.","Once connected, you will be able to see your data visually on Artecsan's free dashboard which lets you easily track sales, cost and more. Artecsan even allows you to create and send your inventory orders directly to your vendors so you only have to create your orders once.","With Artecsan's FREE setup process you will have the option to self serve setup using our wizardry process that will take you from step by step or you may opt for our paid setup services. [Optional one-time setup fee of $499 liquor only, $699 food only or $999 both liquor and food].","After completing the tutorial you will be taken to the user page where you will have the option to add additional users. From there you may begin the setup process. For food subscriptions you will begin by adding your food vendors, attaching each vendors inventory items that you use, applying the inventory items to recipes and attaching the recipes as menu items. Finally you will receive instructions on how to attach your POS followed by a questionnaire and then the final step of doing a full inventory audit.... setup complete!","The same setup procedure will followed for alcohol. First add your vendor, then the items purchased from each vendor and use the items to create your recipes and bar menu. Next is a POS connection, a questionaire so we learn about your restaurant and finally a full inventory audit... Setup Complete!","To make your setup as simple as possible we suggest assigning task. Kitchen manager should be given access to food setup and bar manager should be given access to bar setup. Because sales are automatically connected, Artecsan's day to day activity is low mainteanace and only requires that purchases be processed thru Artecsan","Quick Notes: Multiple users can access and use Artecsan at once, there is no limit and we do not charge for more users. Artecsan is webbased so users can gain access from anywhere. A user may also have access to more than one restaurant, therefore if you own a small restaurant group, you may host all your restaurants with us for FREE!","Note: Artecsan is new and we're always working to improve it. Over time you will see upgrades and improvement to all features. However, if you have any issues with the program or notice any problems, please contact us at admin@artecsan.com"],that.next=function(){that.pg_no=that.pg_no+1,that.pg_no>11&&$uibModalInstance.dismiss("cancel")},that.skip=function(){$uibModalInstance.dismiss("cancel")}};inviteController.$inject=["api","$state","auth","core","$uibModal","alertService","restaurant","SweetAlert","$rootScope"],angular.module("inspinia").component("inviteComponent",{templateUrl:"js/components/registration/invite/invite.html",controller:inviteController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("invite",{url:"/invite/:id",template:"<invite-component></invite-component>",data:{pageTitle:"Invite Users"}})})}(),function(){"use strict";function paymentController(api,$scope,$state,auth,core,restaurant,alertService,localStorageService,$rootScope){if(!core.data.new_restaurant)return void $state.go("subscription");var that=this;that.isAdministratorEdit=$state.includes("administrator.restaurantPayment")&&"object"==typeof localStorageService.get("restaurant_id"),that.form={},that.api=api,that.restaurant=core.data.new_restaurant,that.model={},that.currYear=(new Date).getFullYear().toString().slice(-2),$rootScope.card_number="",$rootScope.exp_month="",$rootScope.exp_year="",$rootScope.cvc="",$rootScope.first_name="",$rootScope.last_name="",$rootScope.billing_address="",$rootScope.StripePaymentId="";var restaurant_id=$state.params.id;if(that.isAdministratorEdit&&(restaurant_id=localStorageService.get("restaurant_id").restaurant_id),!core.data.new_restaurant&&!restaurant_id&&!that.isAdministratorEdit)return void $state.go("registration");if(!restaurant_id&&that.isAdministratorEdit)return void $state.go("administrator.menu");if(!auth.authentication.isLogged)return void $state.go("subscription");var initModel=function(){that.model={}};restaurant_id&&auth.authentication.isLogged&&!core.data.new_restaurant?restaurant.set_to_edit(restaurant_id).then(function(){initModel()}):initModel(),that.submit=function(form){if(!form.$valid)return void alert("not valid");if(parseInt(restaurant_id)){var m={subscription_type_id:core.data.new_restaurant.subscription_type_id,pos_id:core.data.new_restaurant.pos_id,restaurant:{restaurant_name:core.data.new_restaurant.restaurant.restaurant_name,entity_type_id:core.data.new_restaurant.restaurant.entity_type_id,address:core.data.new_restaurant.restaurant.address,city_geoname_id:core.data.new_restaurant.restaurant.city_geoname_id,logo_content_item_id:core.data.new_restaurant.restaurant.logo_content_item_id,state_geoname_id:core.data.new_restaurant.restaurant.state_geoname_id,zip:core.data.new_restaurant.restaurant.zip?core.data.new_restaurant.restaurant.zip.toString():null,phone_number:core.data.new_restaurant.restaurant.phone_number},payment:{card_number:core.data.new_restaurant.payment.number,expiration_month:$rootScope.exp_month,expiration_year:$rootScope.exp_year,coupon_code:core.data.new_restaurant.payment.coupon_code?core.data.new_restaurant.payment.coupon_code.toString():core.data.new_restaurant.payment.coupon_code,first_name:core.data.new_restaurant.payment.first_name,last_name:core.data.new_restaurant.payment.last_name,zip:core.data.new_restaurant.payment.zip?core.data.new_restaurant.payment.zip.toString():null,billing_address:core.data.new_restaurant.payment.billing_address,cv_code:core.data.new_restaurant.payment.cvc}};that.api.update_restaurant(m,restaurant_id).then(function(res){try{1e3===res.data.data.code&&(alertService.showAlertSave(),console.log("this restaurant save response",res),that.isAdministratorEdit||setTimeout(function(){$state.go("invite",{id:restaurant_id})},1e3))}catch(e){console.log(e)}})}else $scope.handleStripe=function(status,response){response.error?swal({title:"Invalid Card Details!",showConfirmButton:!0,type:"warning"}):that.api.payment_call({response:response,type:core.data.new_restaurant.subscription_type_id,mode:"live",pay_for:"registration",cust_info:{restaurant_name:core.data.new_restaurant.restaurant.restaurant_name,subscription_type_id:core.data.new_restaurant.subscription_type_id}}).then(function(res){"done"==res.data.data.payment?(core.data.new_restaurant.restaurant.card_ok=!0,$state.go("terms")):"error"==res.data.data.payment?swal({title:"Check Card Details!",showConfirmButton:!0,type:"warning"}):swal({title:"Oops! Something went wrong, please try again.",showConfirmButton:!0,type:"warning"})})}},that.back=function(){that.isAdministratorEdit?$state.go("administrator.restaurantProfile"):(core.data.new_restaurant.payment.card_number=that.model.card_number,core.data.new_restaurant.payment.expiration_month=that.model.expiration_month,core.data.new_restaurant.payment.expiration_year=that.model.expiration_year,core.data.new_restaurant.payment.coupon_code=that.model.coupon_code,core.data.new_restaurant.payment.first_name=that.model.first_name,core.data.new_restaurant.payment.last_name=that.model.last_name,core.data.new_restaurant.payment.zip=that.model.zip,core.data.new_restaurant.payment.billing_address=that.model.billing_address,core.data.new_restaurant.payment.cv_code=that.model.cv_code,$state.go("restaurantProfile"))}}paymentController.$inject=["api","$scope","$state","auth","core","restaurant","alertService","localStorageService","$rootScope"],angular.module("inspinia").component("paymentComponent",{templateUrl:"js/components/registration/payment/payment.html",controller:paymentController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("payment",{url:"/payment/:id",template:"<payment-component></payment-component>",data:{pageTitle:"Payment"}})})}(),function(){"use strict";function registrationController(api,$state,auth,core,appConfig,SweetAlert,restaurant){core.data.new_restaurant||$state.go("subscription");var that=this;that.model={};var initModel=function(){that.model={user_id:auth.authentication.isLogged?auth.authentication.user.id:null,subscription_type_id:core.data.new_restaurant?core.data.new_restaurant.subscription_type_id:null,pos_id:core.data.new_restaurant?core.data.new_restaurant.pos_id:null,user:{first_name:core.data.new_restaurant?core.data.new_restaurant.user.first_name:null,last_name:core.data.new_restaurant?core.data.new_restaurant.user.last_name:null,email:core.data.new_restaurant?core.data.new_restaurant.user.email:null,phone_number:core.data.new_restaurant?core.data.new_restaurant.user.phone_number:null,password:core.data.new_restaurant?core.data.new_restaurant.user.password:null,password_confirm:core.data.new_restaurant?core.data.new_restaurant.user.password_confirm:null},restaurant:{restaurant_name:core.data.new_restaurant?core.data.new_restaurant.restaurant.restaurant_name:null,entity_type_id:core.data.new_restaurant?core.data.new_restaurant.restaurant.entity_type_id:null,address:core.data.new_restaurant?core.data.new_restaurant.restaurant.address:null,city:core.data.new_restaurant?core.data.new_restaurant.restaurant.city:null,state:core.data.new_restaurant?core.data.new_restaurant.restaurant.state:null,zip:core.data.new_restaurant?core.data.new_restaurant.restaurant.zip:null,city_geoname_id:core.data.new_restaurant?core.data.new_restaurant.restaurant.city_geoname_id:null,state_geoname_id:core.data.new_restaurant?core.data.new_restaurant.restaurant.state_geoname_id:null,phone_number:core.data.new_restaurant?core.data.new_restaurant.restaurant.phone_number:null},payment:{card_number:core.data.new_restaurant?core.data.new_restaurant.payment.card_number:null,expiration_month:core.data.new_restaurant?core.data.new_restaurant.payment.expiration_month:null,expiration_year:core.data.new_restaurant?core.data.new_restaurant.payment.expiration_year:null,coupon_code:core.data.new_restaurant?core.data.new_restaurant.payment.coupon_code:null,first_name:core.data.new_restaurant?core.data.new_restaurant.payment.first_name:null,last_name:core.data.new_restaurant?core.data.new_restaurant.payment.last_name:null,zip:core.data.new_restaurant?core.data.new_restaurant.payment.zip:null,billing_address:core.data.new_restaurant?core.data.new_restaurant.payment.billing_address:null,cv_code:core.data.new_restaurant?core.data.new_restaurant.payment.cv_code:null}}};$state.params.id&&auth.authentication.isLogged&&!core.data.new_restaurant?restaurant.set_to_edit($state.params.id).then(function(){initModel()},function(){$state.go("home")}):initModel(),that.base_api_url=appConfig.apiDomain,that.isAuth=auth.authentication.isLogged,that.posList=[],that.selectPos=function(pos){(pos.id||0==pos.id)&&(that.model.pos_id=pos.id,core.data.new_restaurant=that.model,$state.params.id?$state.go("subscription",{id:$state.params.id}):that.isAuth?$state.go("restaurantProfile"):$state.go("restaurantUserProfile"))},that.$onInit=function(){core.data.new_restaurant&&SweetAlert.swal({title:"",text:"Please select the P.O.S. system that your restaurant currently uses.",confirmButtonColor:"#337ab7",confirmButtonText:"OK"},function(res){api.get_pos_list().then(function(res){that.posList=res.data.data.list,that.posList.splice(0,1)})})}}registrationController.$inject=["api","$state","auth","core","appConfig","SweetAlert","restaurant"],angular.module("inspinia").component("registrationComponent",{templateUrl:"js/components/registration/registration.html",controller:registrationController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("registration",{url:"/registration/:id",template:"<registration-component></registration-component>",data:{pageTitle:" Registration"}})})}(),function(){"use strict";function restaurantProfileController(api,$state,$timeout,core,utils,restaurant,auth,SweetAlert,localStorageService){var that=this;that.$state=$state,that.isAdministratorEdit=$state.includes("administrator.restaurantProfile")&&"object"==typeof localStorageService.get("restaurant_id"),that.form={},that.api=api,that.auth=auth,that.$timeout=$timeout,that.restaurant=core.data.new_restaurant,that.get_refbooks=[],that.utils=utils,that.model={};var initModel=function(){that.model={restaurant_name:core.data.new_restaurant?core.data.new_restaurant.restaurant.restaurant_name:null,entity_type_id:core.data.new_restaurant?core.data.new_restaurant.restaurant.entity_type_id:null,address:core.data.new_restaurant?core.data.new_restaurant.restaurant.address:null,city:core.data.new_restaurant?core.data.new_restaurant.restaurant.city:null,state:core.data.new_restaurant?core.data.new_restaurant.restaurant.state:null,zip:core.data.new_restaurant?core.data.new_restaurant.restaurant.zip:null,phone_number:core.data.new_restaurant?core.data.new_restaurant.restaurant.phone_number:null}},restaurant_id=$state.params.id;return that.isAdministratorEdit&&(restaurant_id=localStorageService.get("restaurant_id").restaurant_id),core.data.new_restaurant||restaurant_id||that.isAdministratorEdit?!restaurant_id&&that.isAdministratorEdit?void $state.go("administrator.menu"):auth.authentication.isLogged?(that.subscription_type_id=null,that.isAdministratorEdit||(that.subscription_type_id=core.data.new_restaurant.subscription_type_id),that.submit=function(form){if(form.$valid){if(!core.data.new_restaurant.restaurant.city_geoname_id||!core.data.new_restaurant.restaurant.state_geoname_id)return void SweetAlert.swal({title:"Please select City or State from autocomplete menu"});core.data.new_restaurant.restaurant.restaurant_name=that.model.restaurant_name,core.data.new_restaurant.restaurant.entity_type_id=that.model.entity_type_id,core.data.new_restaurant.restaurant.address=that.model.address,core.data.new_restaurant.restaurant.city=that.model.city,core.data.new_restaurant.restaurant.state=that.model.state,core.data.new_restaurant.restaurant.zip=that.model.zip,core.data.new_restaurant.restaurant.phone_number=that.model.phone_number,that.isAdministratorEdit?$state.go("administrator.restaurantPayment"):1==that.subscription_type_id||2==that.subscription_type_id||3==that.subscription_type_id||4==that.subscription_type_id?$state.go("terms"):$state.go("payment")}},that.back=function(){that.isAdministratorEdit?$state.go("administrator.menu"):(core.data.new_restaurant.restaurant.restaurant_name=that.model.restaurant_name,core.data.new_restaurant.restaurant.entity_type_id=that.model.entity_type_id,core.data.new_restaurant.restaurant.address=that.model.address,core.data.new_restaurant.restaurant.city=that.model.city,core.data.new_restaurant.restaurant.state=that.model.state,core.data.new_restaurant.restaurant.zip=that.model.zip,core.data.new_restaurant.restaurant.phone_number=that.model.phone_number,$state.go("registration"))},that.$onInit=function(){core.getRefbooks().then(function(res){that.get_refbooks=res,restaurant_id&&auth.authentication.isLogged&&!core.data.new_restaurant?restaurant.set_to_edit(restaurant_id).then(function(){initModel(),that.onZipChanged()}):(initModel(),core.data.new_restaurant&&that.onZipChanged())})},that.get_location=function(val,type){if(!(val.length<3))return that.api.locations_lookup({search_for:val}).then(function(response){return response.data.data.locations.filter(function(currentValue,index){return currentValue.type_id===parseInt(type)})})},that.selectCity=function(item){core.data.new_restaurant.restaurant.city_geoname_id=item.geoname_id},that.selectState=function(item){core.data.new_restaurant.restaurant.state_geoname_id=item.geoname_id},that.onZipChanged=function(){that.timer&&that.$timeout.cancel(that.timer),that.timer=that.$timeout(function(){var zip=that.model.zip;zip?that.api.locations_lookup({search_for:zip.toString()}).then(function(response){if(response.data.data.locations.length){that.model.city=response.data.data.locations[0].clear_name,core.data.new_restaurant.restaurant.city_geoname_id=response.data.data.locations[0].geoname_id,core.data.new_restaurant.restaurant.state_geoname_id=response.data.data.locations[0].state_geoname_id;for(var i=0;that.get_refbooks.country_states.length>i;i++)if(response.data.data.locations[0].state_geoname_id===that.get_refbooks.country_states[i].geoname_id){that.model.state=that.get_refbooks.country_states[i].state,that.form.zip.$setValidity("zip",!0);break}}else that.form.zip.$setValidity("zip",!1),that.model.city="",that.model.state="",core.data.new_restaurant.restaurant.city_geoname_id=null,core.data.new_restaurant.restaurant.state_geoname_id=null},function(error){console.log("error")}):(that.form.zip.$setValidity("zip",!1),that.model.city="",that.model.state="",core.data.new_restaurant.restaurant.city_geoname_id=null,core.data.new_restaurant.restaurant.state_geoname_id=null)},300)},void(that.saveProfile=function(form){if(form.$valid&&parseInt(restaurant_id)){var m={pos_id:core.data.new_restaurant.pos_id,restaurant:{restaurant_name:core.data.new_restaurant.restaurant.restaurant_name,entity_type_id:core.data.new_restaurant.restaurant.entity_type_id,address:core.data.new_restaurant.restaurant.address,city_geoname_id:core.data.new_restaurant.restaurant.city_geoname_id,logo_content_item_id:core.data.new_restaurant.restaurant.logo_content_item_id,state_geoname_id:core.data.new_restaurant.restaurant.state_geoname_id,zip:core.data.new_restaurant.restaurant.zip?core.data.new_restaurant.restaurant.zip.toString():null,phone_number:core.data.new_restaurant.restaurant.phone_number}};that.api.update_restaurant(m,restaurant_id).then(function(res){try{1e3===res.data.data.code&&(alertService.showAlertSave(),that.isAdministratorEdit||setTimeout(function(){$state.go("invite",{id:restaurant_id})},1e3))}catch(e){console.log(e)}})}})):void $state.go("subscription"):void $state.go("subscription")}restaurantProfileController.$inject=["api","$state","$timeout","core","utils","restaurant","auth","SweetAlert","localStorageService"],angular.module("inspinia").component("restaurantProfileComponent",{templateUrl:"js/components/registration/restaurantProfile/restaurantProfile.html",controller:restaurantProfileController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("restaurantProfile",{url:"/restaurant-profile/:id",template:"<restaurant-profile-component></restaurant-profile-component>",data:{pageTitle:" Restaurant Profile"}})})}(),function(){"use strict";function restaurantUserProfileController(api,$state,auth,core,localStorageService,alertService){if(auth.authentication.isLogged)return void $state.go("home");if(!core.data.new_restaurant)return void $state.go("subscription");var that=this;that.form={},that.api=api,that.restaurant=core.data.new_restaurant,that.inRequest=!1,that.model={first_name:that.restaurant.user.first_name,last_name:that.restaurant.user.last_name,email:that.restaurant.user.email,phone_number:that.restaurant.user.phone_number,password:that.restaurant.user.password,password_confirm:null},that.submit=function(form){if(!0===form.$valid){that.inRequest=!0;var user_model={email:that.model.email,password:that.model.password,platform:"WEB",first_name:that.model.first_name,last_name:that.model.last_name,phone_number:that.model.phone_number};that.api.users_registration(user_model).then(function(res){try{res.data.data.user&&(localStorageService.set("adminAuthorizationData",{authenticationInfo:auth.setUser(res.data.data.user)}),core.data.new_restaurant.user_id=res.data.data.user.id,core.data.new_restaurant.user.first_name=that.model.first_name,core.data.new_restaurant.user.last_name=that.model.last_name,core.data.new_restaurant.user.email=that.model.email,core.data.new_restaurant.user.phone_number=that.model.phone_number,core.data.new_restaurant.user.password=that.model.password,core.data.new_restaurant.user.password_confirm=that.model.password_confirm,$state.go("restaurantProfile")),that.inRequest=!1}catch(e){that.inRequest=!1,console.log(e)}},function(error){that.inRequest=!1,$state.go("login")})}else if(form.$error&&form.$error.password)return void alertService.showErrorInvitation("","Password should be minimum 8 characters and contain at least 1 uppercase letter and 1 digit")},that.back=function(){core.data.new_restaurant.user.first_name=that.model.first_name,core.data.new_restaurant.user.last_name=that.model.last_name,core.data.new_restaurant.user.email=that.model.email,core.data.new_restaurant.user.phone_number=that.model.phone_number,core.data.new_restaurant.user.password=that.model.password,core.data.new_restaurant.user.password_confirm=that.model.password_confirm,$state.go("registration")}}restaurantUserProfileController.$inject=["api","$state","auth","core","localStorageService","alertService"],angular.module("inspinia").component("restaurantUserProfileComponent",{templateUrl:"js/components/registration/restaurantUserProfile/restaurantUserProfile.html",controller:restaurantUserProfileController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("restaurantUserProfile",{url:"/restaurant-user-profile",template:"<restaurant-user-profile-component></restaurant-user-profile-component>",data:{pageTitle:" Restaurant Administrator Profile"}})})}(),function(){"use strict";function subscriptionController(api,$state,auth,core,$uibModal,restaurant,appConfig){var that=this;that.auth=auth,that.model={};var initModel=function(){that.model={user_id:auth.authentication.isLogged?auth.authentication.user.id:null,subscription_type_id:core.data.new_restaurant?core.data.new_restaurant.subscription_type_id:null,pos_id:core.data.new_restaurant?core.data.new_restaurant.pos_id:null,user:{first_name:core.data.new_restaurant?core.data.new_restaurant.user.first_name:null,last_name:core.data.new_restaurant?core.data.new_restaurant.user.last_name:null,email:core.data.new_restaurant?core.data.new_restaurant.user.email:null,phone_number:core.data.new_restaurant?core.data.new_restaurant.user.phone_number:null,password:core.data.new_restaurant?core.data.new_restaurant.user.password:null,password_confirm:core.data.new_restaurant?core.data.new_restaurant.user.password_confirm:null},restaurant:{restaurant_name:core.data.new_restaurant?core.data.new_restaurant.restaurant.restaurant_name:null,entity_type_id:core.data.new_restaurant?core.data.new_restaurant.restaurant.entity_type_id:null,address:core.data.new_restaurant?core.data.new_restaurant.restaurant.address:null,city:core.data.new_restaurant?core.data.new_restaurant.restaurant.city:null,state:core.data.new_restaurant?core.data.new_restaurant.restaurant.state:null,zip:core.data.new_restaurant?core.data.new_restaurant.restaurant.zip:null,city_geoname_id:core.data.new_restaurant?core.data.new_restaurant.restaurant.city_geoname_id:null,state_geoname_id:core.data.new_restaurant?core.data.new_restaurant.restaurant.state_geoname_id:null,phone_number:core.data.new_restaurant?core.data.new_restaurant.restaurant.phone_number:null},payment:{card_number:core.data.new_restaurant?core.data.new_restaurant.payment.card_number:null,expiration_month:core.data.new_restaurant?core.data.new_restaurant.payment.expiration_month:null,expiration_year:core.data.new_restaurant?core.data.new_restaurant.payment.expiration_year:null,coupon_code:core.data.new_restaurant?core.data.new_restaurant.payment.coupon_code:null,first_name:core.data.new_restaurant?core.data.new_restaurant.payment.first_name:null,last_name:core.data.new_restaurant?core.data.new_restaurant.payment.last_name:null,zip:core.data.new_restaurant?core.data.new_restaurant.payment.zip:null,billing_address:core.data.new_restaurant?core.data.new_restaurant.payment.billing_address:null,cv_code:core.data.new_restaurant?core.data.new_restaurant.payment.cv_code:null}}};$state.params.id&&auth.authentication.isLogged&&!core.data.new_restaurant?restaurant.set_to_edit($state.params.id).then(function(){initModel()},function(){$state.go("home")}):initModel(),that.subscriptions=[],core.data.new_restaurant=that.model,that.restaurant=core.data.new_restaurant;var isEdit=!1;$state.params.id&&auth.authentication.isLogged&&!core.data.new_restaurant&&restaurant.set_to_edit($state.params.id).then(function(){that.restaurant=core.data.new_restaurant,isEdit=!0}),core.getSettings().then(function(res){that.settings=core.data.settings}),that.moreDetails=function(){alert("details")},that.contactUsPopup=function(){$uibModal.open({animation:!0,templateUrl:"contact_us.html",controller:subscriptionContactUs,controllerAs:"vm"}).result.then(function(){that.auth.authentication.isLogged&&$state.go("home")},function(){})},that.$onInit=function(){api.rb_subscriptions().then(function(res){that.subscriptions=res.data.data.subscriptions,that.auth.authentication.isLogged||(that.restaurant.subscription_type_id=that.restaurant.subscription_type_id?that.restaurant.subscription_type_id:that.subscriptions[4].subscription_id);var show_setup_promo=!1;for(var s in that.subscriptions)if(1==that.subscriptions[s].has_promo){show_setup_promo=!0;break}show_setup_promo&&api.get_promo_ref().then(function(res){that.pr_ref=res.data.data.promo_ref,that.base_api_url=appConfig.apiDomain,that.promo_ref_url=that.base_api_url+that.pr_ref.setup_promo,$uibModal.open({animation:!0,templateUrl:"promo_container.html",controller:qt,controllerAs:"qt",windowClass:"animated fadeIn modal-lgg",size:"md",resolve:{promo_URL:function(){return that.promo_ref_url},promo_URL_alt:function(){return"For Setup Promo, email sales@skrible.co"}}})})})},that.back=function(){$state.go("login")},that.select=function(subscription,is_sign_up){that.restaurant.subscription_type_id=subscription?subscription.subscription_id:0,is_sign_up&&0!==that.restaurant.subscription_type_id&&(core.data.new_restaurant.subscription_type_id=that.restaurant.subscription_type_id,auth.authentication.isLogged&&isEdit?$state.go("restaurantProfile",{id:$state.params.id}):$state.go("registration"))}}var subscriptionContactUs=function($uibModalInstance,api,alertService){var that=this;that.form={},that.m={email:null,first_name:null,last_name:null,phone_number:null,message:null},that.contactUs=function(form){if(form.$valid){var m={first_name:that.m.first_name,last_name:that.m.last_name,phone_number:that.m.phone_number,email:that.m.email,message:that.m.message};api.contact_us(m).then(function(res){try{1e3===res.data.data.code&&(alertService.successfullySent("Successfully sent"),that.close())}catch(e){console.log(e)}},function(e){console.log(e)})}},that.close=function(){$uibModalInstance.dismiss("cancel")}},qt=function($uibModalInstance,promo_URL,promo_URL_alt){var that=this;that.promo_URL=promo_URL,that.promo_URL_alt=promo_URL_alt,that.skip=function(){$uibModalInstance.dismiss("cancel")}};subscriptionController.$inject=["api","$state","auth","core","$uibModal","restaurant","appConfig"],angular.module("inspinia").component("subscriptionComponent",{templateUrl:"js/components/registration/subscription/subscription.html",controller:subscriptionController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("subscription",{url:"/subscription/:id",template:"<subscription-component></subscription-component>",data:{pageTitle:" Subscriptions"}})})}(),function(){"use strict";function termsController(api,$state,core,alertService,SweetAlert,restaurant,localStorageService,$rootScope){if(!core.data.new_restaurant)return void $state.go("subscription");var that=this;if(that.form={},that.api=api,that.agree=!1,that.restaurant=core.data.new_restaurant,that.inRequest=!1,that.subscription_type_id=core.data.new_restaurant.subscription_type_id,(5==that.subscription_type_id||6==that.subscription_type_id||7==that.subscription_type_id)&&!core.data.new_restaurant.restaurant.card_ok)return void $state.go("subscription");that.submit=function(form){if(form.$valid){that.inRequest=!0;var m={subscription_type_id:core.data.new_restaurant.subscription_type_id,pos_id:core.data.new_restaurant.pos_id,user_id:core.data.new_restaurant.user_id,restaurant:{restaurant_name:core.data.new_restaurant.restaurant.restaurant_name,entity_type_id:core.data.new_restaurant.restaurant.entity_type_id,address:core.data.new_restaurant.restaurant.address,city_geoname_id:core.data.new_restaurant.restaurant.city_geoname_id,logo_content_item_id:core.data.new_restaurant.restaurant.logo_content_item_id,state_geoname_id:core.data.new_restaurant.restaurant.state_geoname_id,zip:core.data.new_restaurant.restaurant.zip,phone_number:core.data.new_restaurant.restaurant.phone_number},payment:{card_number:$rootScope.card_number,expiration_month:$rootScope.exp_month,expiration_year:$rootScope.exp_year,coupon_code:core.data.new_restaurant.payment.coupon_code,first_name:$rootScope.first_name,last_name:$rootScope.last_name,zip:core.data.new_restaurant.payment.zip,billing_address:$rootScope.billing_address,cv_code:$rootScope.cvc}};that.api.create_restaurant(m).then(function(res){try{1e3===res.data.data.code&&SweetAlert.swal({title:"",type:"success",text:"Congratulations your restaurant was created!.",confirmButtonColor:"#337ab7",confirmButtonText:"OK"},function(res1){restaurant.set_restaurant(res.data.data.id).then(function(){4==that.subscription_type_id?$state.go("administrator.posSync"):$state.go("invite",{id:res.data.data.id})})}),that.inRequest=!1}catch(e){console.log(e),that.inRequest=!1}},function(error){that.inRequest=!1})}},that.back=function(){5==that.subscription_type_id||6==that.subscription_type_id||7==that.subscription_type_id?$state.go("payment"):$state.go("restaurantProfile")},that.$onInit=function(){SweetAlert.swal({title:"",
text:"Please note that Skribles Compset report recently launched in December 2018. For this reason, your restaurant may be the first within its compset to sign up. In order to provide you with data, we must have at least 2 restaurants within the same category. We ask that you continue with your setup and if you are the first restaurant within your compset, we will immediately notify you once a second restaurant in your category has joined. In order to proceed simply scroll down, check the accept button then start your services.",confirmButtonColor:"#337ab7",confirmButtonText:"OK"},function(res){core.getSettings().then(function(res){that.settings=res})})}}termsController.$inject=["api","$state","core","alertService","SweetAlert","restaurant","localStorageService","$rootScope"],angular.module("inspinia").component("termsComponent",{templateUrl:"js/components/registration/terms/terms.html",controller:termsController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("terms",{url:"/terms",template:"<terms-component></terms-component>",data:{pageTitle:" Agreement"}})})}(),function(){"use strict";function alcoholCostOfSummaryController(api,$state,auth,core,alertService,SweetAlert,$q,localStorageService,$uibModal,restaurant,$rootScope,$scope){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.api=api,that.core=core,that.auth=auth,that.subcats=[],that.temp_subcats=[],that.subcategory=null,that.gross_sales=0,that.discounts=0,that.total_sales=0,that.value_last_period=0,that.purchase_value=0,that.value_this_period=0,that.target_cost=0,that.value_used=0,that.cost_percent=0,that.target_cost_percent=0,that.os_percent_variance=0,that.avg_pour_cat=0,that.cos_table_data=[],that.var_total_cost=null,that.end_date_is_suggested=!1,$rootScope.$on("restaurantSelected",function(){that.pos_id=$state.params.pos_id||restaurant.data.info.pos_id,that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.checkEmpType=function(){var emps=restaurant.data.info.employees;if(that.user={userid:null,user_type_id:null},that.user.userid=that.auth.authentication.user.id,1==that.user.userid)that.showFinalSaveButton=!0;else for(var i=0;emps.length>i;i++)if(emps[i].id==that.user.userid){that.user.user_type_id=emps[i].type_ids,2==emps[i].type_ids||4==emps[i].type_ids||6==emps[i].type_ids||9==emps[i].type_ids||10==emps[i].type_ids?that.showFinalSaveButton=!0:that.showFinalSaveButton=!1;break}},that.finalSaveAudit=function(){var deferred=$q.defer(),adminFS=function(){var m={inventory_type_id:2,counting_started_at:(new Date).getTime(),counting_ended_at:(new Date).getTime(),is_final_save:1,is_adjustment:"full"==that.audit_type?0:1,send_email:0!=that.is_send_email,additional_notes:that.additional_notes,inventory_items:[]};void 0!==that.prev_audit_date&&null!=that.prev_audit_date&&(m.prev_audit_date=that.prev_audit_date),null==m.additional_notes&&delete m.additional_notes,that.api.update_inventory_audit(m).then(function(res){try{1e3===res.data.data.code&&(that.$onInit(),alertService.showAlertSave(),deferred.resolve()),that.loading=!1}catch(e){console.log(e),that.loading=!1,deferred.reject()}},function(){deferred.reject()})};that.is_send_email=!1,that.audit_type="full",that.additional_notes=null,$uibModal.open({templateUrl:"admin_final_save.html",controller:modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",resolve:{is_send_email:function(){return that.is_send_email},start_dates:function(){return that.audit_dates_f}}}).result.then(function(res){that.loading=!0,that.is_send_email=res.is_send_email,that.audit_type=res.audit_type,that.prev_audit_date=res.prev_audit_date,that.additional_notes=res.additional_notes,adminFS()})},that.preProcessCOS=function(){for(var dict={},signs={},i=0;i<that.cos_table_data.length;i++)null==that.cos_table_data[i].substitute_for?dict.hasOwnProperty(that.cos_table_data[i].vendor_sku_id)?(dict[that.cos_table_data[i].vendor_sku_id].push(that.cos_table_data[i]),0==that.cos_table_data[i].purchases?signs[that.cos_table_data[i].vendor_sku_id][0]++:signs[that.cos_table_data[i].vendor_sku_id][1]++):(dict[that.cos_table_data[i].vendor_sku_id]=[that.cos_table_data[i]],signs[that.cos_table_data[i].vendor_sku_id]=[0,0],0==that.cos_table_data[i].purchases?signs[that.cos_table_data[i].vendor_sku_id][0]++:signs[that.cos_table_data[i].vendor_sku_id][1]++):dict.hasOwnProperty(that.cos_table_data[i].substitute_for)?(dict[that.cos_table_data[i].substitute_for].push(that.cos_table_data[i]),0==that.cos_table_data[i].purchases?signs[that.cos_table_data[i].substitute_for][0]++:signs[that.cos_table_data[i].substitute_for][1]++):(dict[that.cos_table_data[i].substitute_for]=[that.cos_table_data[i]],signs[that.cos_table_data[i].substitute_for]=[0,0],0==that.cos_table_data[i].purchases?signs[that.cos_table_data[i].substitute_for][0]++:signs[that.cos_table_data[i].substitute_for][1]++);var total={};for(var key in dict)if(dict.hasOwnProperty(key)){total[key]=0;for(var i=0;i<dict[key].length;i++)total[key]+=Math.abs(dict[key][i].purchases)}for(var key in dict)if(dict.hasOwnProperty(key))if(0==signs[key][0]&&0!=signs[key][1])for(var i=0;i<dict[key].length;i++)dict[key][i].wauc=Math.abs(dict[key][i].purchases)/total[key]*dict[key][i].item_cost;else if(0!=signs[key][0]&&0!=signs[key][1])for(var i=0;i<dict[key].length;i++)dict[key][i].wauc=Math.abs(dict[key][i].purchases)/total[key]*dict[key][i].item_cost;else if(0!=signs[key][0]&&0==signs[key][1])for(var i=0;i<dict[key].length;i++)dict[key][i].wauc=1/signs[key][0]*dict[key][i].item_cost;var p_indx={},yo=[];for(var key in dict)if(dict.hasOwnProperty(key)){for(var uc=0,pur=0,sales=0,beg=0,end=0,ther=0,unit=0,i=0;i<dict[key].length;i++)if(null==dict[key][i].substitute_for){p_indx[key]=i;break}if(void 0===p_indx[key])for(var i=0;i<dict[key].length;i++){if("Liquor"==that.category||"Wine"==that.category){var formulaA=dict[key][i].unit_variance>0?.1*(dict[key][i].beg_oz+dict[key][i].purchases):dict[key][i].beg_oz+dict[key][i].purchases>10?-.075*(dict[key][i].beg_oz+dict[key][i].purchases):dict[key][i].beg_oz+dict[key][i].purchases<10?-.1*(dict[key][i].beg_oz+dict[key][i].purchases):dict[key][i].unit_variance;dict[key][i].red_alert=dict[key][i].unit_variance>0&&dict[key][i].unit_variance>formulaA||dict[key][i].unit_variance<0&&dict[key][i].unit_variance<formulaA}else if("Bottle Beer"==that.category){var formulaA=-.025*(dict[key][i].beg_oz+dict[key][i].purchases);dict[key][i].red_alert=dict[key][i].unit_variance>0||dict[key][i].unit_variance<-9||dict[key][i].unit_variance<-2&&dict[key][i].unit_variance<formulaA}else if("Draft Beer"==that.category||"Draft Wine"==that.category){var formulaA=-.01*(dict[key][i].beg_oz+dict[key][i].purchases);dict[key][i].red_alert=dict[key][i].unit_variance>.15||dict[key][i].unit_variance<-.99||dict[key][i].unit_variance<-.15&&dict[key][i].unit_variance<formulaA}dict[key][i].avg_pour=dict[key][i].theor_sales*dict[key][i].content_weight,yo.push(dict[key][i])}else{for(var i=0;i<dict[key].length;i++)uc+=dict[key][i].wauc,pur+=dict[key][i].purchases,sales+=dict[key][i].sales,beg+=dict[key][i].beg_oz,end+=dict[key][i].end_oz,ther+=dict[key][i].theor_sales,unit+=dict[key][i].unit_variance;if(dict[key][p_indx[key]].wauc=uc,dict[key][p_indx[key]].purchases=pur,dict[key][p_indx[key]].sales=sales,dict[key][p_indx[key]].beg_oz=beg,dict[key][p_indx[key]].end_oz=end,dict[key][p_indx[key]].theor_sales=ther,dict[key][p_indx[key]].unit_variance=unit,dict[key][p_indx[key]].cost_variance=unit*uc,"Liquor"==that.category||"Wine"==that.category){var formulaA=dict[key][p_indx[key]].unit_variance>0?.1*(dict[key][p_indx[key]].beg_oz+dict[key][p_indx[key]].purchases):dict[key][p_indx[key]].beg_oz+dict[key][p_indx[key]].purchases>10?-.075*(dict[key][p_indx[key]].beg_oz+dict[key][p_indx[key]].purchases):dict[key][p_indx[key]].beg_oz+dict[key][p_indx[key]].purchases<10?-.1*(dict[key][p_indx[key]].beg_oz+dict[key][p_indx[key]].purchases):dict[key][p_indx[key]].unit_variance;dict[key][p_indx[key]].red_alert=dict[key][p_indx[key]].unit_variance>0&&dict[key][p_indx[key]].unit_variance>formulaA||dict[key][p_indx[key]].unit_variance<0&&dict[key][p_indx[key]].unit_variance<formulaA}else if("Bottle Beer"==that.category){var formulaA=-.025*(dict[key][p_indx[key]].beg_oz+dict[key][p_indx[key]].purchases);dict[key][p_indx[key]].red_alert=dict[key][p_indx[key]].unit_variance>0||dict[key][p_indx[key]].unit_variance<-9||dict[key][p_indx[key]].unit_variance<-2&&dict[key][p_indx[key]].unit_variance<formulaA}else if("Draft Beer"==that.category||"Draft Wine"==that.category){var formulaA=-.01*(dict[key][p_indx[key]].beg_oz+dict[key][p_indx[key]].purchases);dict[key][p_indx[key]].red_alert=dict[key][p_indx[key]].unit_variance>.15||dict[key][p_indx[key]].unit_variance<-.99||dict[key][p_indx[key]].unit_variance<-.15&&dict[key][p_indx[key]].unit_variance<formulaA}dict[key][p_indx[key]].avg_pour=dict[key][p_indx[key]].theor_sales*dict[key][p_indx[key]].content_weight,yo.push(dict[key][p_indx[key]])}}that.cos_table_data=yo},that.loadCOS=function(){return swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),that.audit_dates_t.length<2?void swal.close():(that.disable_final_save="history"==that.end_date.src,that.start_date.audit_dates>that.end_date.audit_dates?void alertService.showError("Invalid date range!"):(that.loading=!0,that.blindMode="history"!=that.end_date.src&&6==that.user.user_type_id,void that.api.alcoholCostSummary({RestaurantId:that.restaurant_id.restaurant_id,start_date:that.start_date.audit_dates,end_date:that.end_date.audit_dates,category:that.category,inventory_type_id:2}).then(function(summary_res){summary_res||console.log("error getting the COS results"),that.api.sku_table({RestaurantId:that.restaurant_id.restaurant_id,Category:that.category,start_date:that.start_date.audit_dates,end_date:that.end_date.audit_dates,inventory_type_id:2,caller:"email"}).then(function(res){if(res){that.loading=!1,that.display_category=that.category,that.var_total_cost=null,that.cos_table_data=res.data.data.sku_table,that.begin_date_available=!1,that.cos_table_data.length&&void 0!==that.cos_table_data[0].begin_date&&(that.begin_date_available=!0),that.preProcessCOS();var Variance=[["x"],["variance"]];that.value_last_period=0,that.purchase_value=0,that.value_this_period=0,that.target_cost=0,that.total_avg_pour=0;for(var i=0;i<that.cos_table_data.length;i++)that.value_last_period+=that.cos_table_data[i].wauc*that.cos_table_data[i].beg_oz,that.purchase_value+=that.cos_table_data[i].wauc*that.cos_table_data[i].purchases,that.value_this_period+=that.cos_table_data[i].wauc*that.cos_table_data[i].end_oz,that.target_cost+=that.cos_table_data[i].wauc*that.cos_table_data[i].sales,that.var_total_cost+=that.cos_table_data[i].cost_variance,0!=that.cos_table_data[i].unit_variance&&(Variance[0].push(that.cos_table_data[i].item_name),Variance[1].push(that.cos_table_data[i].unit_variance)),0==that.cos_table_data[i].theor_sales&&0==that.cos_table_data[i].sales||(that.total_avg_pour+=that.cos_table_data[i].avg_pour);that.var_total_cost=Math.round(that.var_total_cost);var cos_res=summary_res.data.data.cos[0];if(that.gross_sales=Math.round(cos_res.Gross_Sales,2),that.discounts=Math.round(cos_res.Discounts,2),that.total_sales=that.gross_sales+that.discounts,that.total_unit_sold=Math.round(cos_res.Total_Unit_Sales,2),that.value_last_period=Math.round(that.value_last_period,2),that.last_type="Actual",that.purchase_value=Math.round(that.purchase_value,2),that.value_this_period=Math.round(that.value_this_period,2),that.this_type="Actual",that.target_cost=Math.round(that.target_cost,2),that.value_used=that.value_last_period+that.purchase_value-that.value_this_period,that.cost_percent=Math.round(that.value_used/that.total_sales*1e4)/100,that.target_cost_percent=Math.round(that.target_cost/that.total_sales*1e4)/100,that.os_percent_variance=Math.round(100*(that.cost_percent-that.target_cost_percent))/100,that.avg_pour_cat="Bottle Beer"==that.category?"N/A":Math.round(that.total_avg_pour/that.total_unit_sold*100)/100,1==Variance[0].length)var Variance=[];c3.generate({bindto:"#uv-div1",size:{height:450},data:{x:"x",columns:Variance,type:"bar",empty:{label:{text:"No data found."}}},zoom:{enabled:!0,rescale:!0},axis:{rotated:!0,x:{type:"category"},y:{tick:{format:function(d){return parseFloat(Math.round(100*d)/100)}}}},legend:{show:!1}}).zoom([0,10])}swal.close()})})))},that.loadLocationsReport=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),that.loading=!0,that.api.locations_report({RestaurantId:that.restaurant_id.restaurant_id,Category:that.category,start_date:that.start_date.audit_dates,end_date:that.end_date.audit_dates,inventory_type_id:2}).then(function(res){res&&(that.l_start_date=that.start_date.audit_dates,that.l_end_date=that.end_date.audit_dates,that.l_cos_data=res.data.data.locationsReport.cos_data,that.locations=res.data.data.locationsReport.locations),that.loading=!1,swal.close()})},that.loadTrendReport=function(){that.loading=!0,swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),that.api.audit_trend_report({RestaurantId:that.restaurant_id.restaurant_id,Category:that.category,inventory_type_id:2}).then(function(res){res&&(that.trend_data=res.data.data.auditTrendReport.trend_data,that.trend_dates=res.data.data.auditTrendReport.audit_dates.reverse()),that.loading=!1,swal.close()})},that.getsubcats=function(){that.temp_subcats=[];for(var i=0;i<that.subcats.length;i++)that.subcats[i].parent_cat==that.category&&that.temp_subcats.push({name:that.subcats[i].sub_category});that.temp_subcats.length>0&&(that.subcategory=that.temp_subcats[0].name)},that.changeMode=function(mode){that.mode!=mode&&(that.mode=mode,"review"!=that.mode?"trend"==that.mode?that.loadTrendReport():that.loadCOS():that.loadLocationsReport())},that.randTab=[Math.floor(10*Math.random()),Math.floor(10*Math.random()),Math.floor(10*Math.random()),Math.floor(10*Math.random()),Math.floor(10*Math.random()),Math.floor(10*Math.random())],this.exportReport=function(type){"details"==type?this.downloadDetails():"review"==type?this.downloadReview():"trend"==type&&this.downloadTrend()},this.downloadDetails=function(){that.export_loading=!0;const getData=[];that.cos_table_data.forEach(function(data){getData.push({Category:that.category,SKU:data.vendor_sku.replace(/[,'#]/g," "),Item:data.item_name.replace(/[,'#]/g," "),ItemCost:data.wauc,BeginningInv:data.beg_oz,Purchases:data.purchases,EndingInv:data.end_oz,InvUnitsSold:data.theor_sales,POSUnitsSold:data.sales,UnitVariance:data.unit_variance,CostVariance:data.cost_variance})});const headers=["Category","SKU","Item","ItemCost","BeginningInv","Purchases","EndingInv","InvUnitsSold","POSUnitsSold","UnitVariance","CostVariance"];var csv=headers.join(",")+"\r\n";getData.forEach(function(row){const values=headers.map(function(header){return row[header]});csv+=values.join(",")+"\r\n"});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="Cost of Sales Details.csv",hiddenElement.click(),that.export_loading=!1},this.downloadReview=function(){that.export_loading=!0;const getData=[];that.l_cos_data.forEach(function(data){var l_obj={};l_obj.Item=data.item_name,l_obj.Variance=data.unit_variance,that.locations.forEach(function(ldata){l_obj[ldata.location_name+"_"+that.l_start_date]=data[ldata.sr_no].beg,l_obj[ldata.location_name+"_"+that.l_end_date]=data[ldata.sr_no].end}),l_obj["Unassigned_"+that.l_start_date]=data[-1].beg,l_obj["Unassigned_"+that.l_end_date]=data[-1].end,getData.push(l_obj)});const headers=["Item"];that.locations.forEach(function(data){headers.push(data.location_name+"_"+that.l_start_date),headers.push(data.location_name+"_"+that.l_end_date)}),headers.push("Unassigned_"+that.l_start_date),headers.push("Unassigned_"+that.l_end_date),headers.push("Variance");var csv=headers.join(",")+"\r\n";getData.forEach(function(row){const values=headers.map(function(header){return row[header]});csv+=values.join(",")+"\r\n"});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="Cost of Sales Review.csv",hiddenElement.click(),that.export_loading=!1},this.downloadTrend=function(){that.export_loading=!0;const getData=[];that.trend_data.sort(function(a,b){return a.item_name>b.item_name?1:b.item_name>a.item_name?-1:0}),that.trend_data.forEach(function(data){var d_obj={SKU:data.vendor_sku.replace(/[,'#]/g," "),ItemName:data.item_name.replace(/[,'#]/g," ")},indx=0;for(var td in that.trend_dates)d_obj[that.trend_dates[td].audit_dates.substring(0,10)]=data.variances[indx++];getData.push(d_obj)});var headers=["SKU","ItemName"];headers=headers.concat(that.trend_dates.map(function(x){return x.audit_dates.substring(0,10)}));var csv=headers.join(",")+"\r\n";getData.forEach(function(row){const values=headers.map(function(header){return row[header]});csv+=values.join(",")+"\r\n"});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="Cost of Sales Trend.csv",hiddenElement.click(),that.export_loading=!1},this.checkEndDate=function(){1==that.end_date.is_suggested?that.end_date_is_suggested=!0:that.end_date_is_suggested=!1},that.$onInit=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),Promise.all([api.get_vendors_categories({is_restaurant_used_only:1,inventory_type_id:2})]).then(function(response){that.categories=response[0].data.data.categories.filter(function(x){return"Non Alcoholic"!=x.category}),that.category=that.categories[0].category,that.mode="summary",that.checkEmpType(),that.core.getRefbooks().then(function(res){that.subcats=res.vendor_sub_cat,that.getsubcats(),that.api.get_audit_dates({RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:2}).then(function(res1){that.audit_dates_f=res1.data.data.Report.map(function(x){return{aud_title:x.audit_dates.substring(0,10)+" ("+x.type+" by "+x.audited_by_org+")",audit_dates:x.audit_dates.substring(0,10),src:x.src,type:x.type,is_suggested:x.is_suggested}});var draft_present=!1,draft_indx=null;for(var af in that.audit_dates_f)if("draft"==that.audit_dates_f[af].src){draft_present=!0,draft_indx=af;break}if(draft_present&&null!=draft_indx)for(var af in that.audit_dates_f)if(af!=draft_indx&&that.audit_dates_f[af].audit_dates==that.audit_dates_f[draft_indx].audit_dates){that.audit_dates_f.splice(af,1);break}that.audit_dates_t=JSON.parse(JSON.stringify(that.audit_dates_f)),that.audit_dates_f.splice(0,1),that.audit_dates_f.length||(that.audit_dates_f=that.audit_dates_t),that.start_date=that.audit_dates_f[0],that.end_date=that.audit_dates_t[0],that.checkEndDate(),that.loadCOS(),that.export_loading=!1})})})}}var modalController=function($uibModalInstance,alertService,SweetAlert,is_send_email,start_dates){var that=this;that.pg_no=1,that.user_response={},that.audit_type="",that.is_send_email=is_send_email,that.audit_dates_f=start_dates,that.start_date_compare=null,that.additional_notes=null,that.q_title="Select Type",that.q_texts='<article style="display: block;"><p>How do you want to save this audit?</p></article>',that.q_additional_texts="",that.set_page_no=function(dir){that.start_date_compare=null,"back"==dir&&that.pg_no--,1==that.pg_no?(that.q_title="Select Type",that.q_texts='<article style="display: block;"><p>How do you want to save this audit?</p></article>'):2==that.pg_no&&that.set_audit_type(that.audit_type)},that.set_audit_type=function(a_type){that.audit_type=a_type,that.pg_no=2,that.q_title="Final Save "+that.audit_type+"?","full"==that.audit_type?that.q_texts='<article style="display: block;"><p>This will permanently update your on-hand count as of today. <b>Any items that were not counted will be saved as 0.</b> You can choose either to only Save the audit but not send the email report or do both.</p></article>':"adjustment"==that.audit_type?that.q_texts='<article style="display: block;"><p>This will permanently update your on-hand count as of today. <b>Any items that were not counted will not be saved.</b> You can choose either to only Save the audit but not send the email report or do both.</p></article>':"purchase audit"==that.audit_type&&(that.q_texts='<article style="display: block;"><p>This will permanently update your on-hand count as of today. <b>Any items that were not counted will not be saved.</b> A purchase audit report will be emailed to you soon.</p></article>')},that.set_email_value=function(val){if(0==val)that.is_send_email=val,that.save();else if(2==that.pg_no)that.pg_no=3,"full"==that.audit_type&&(that.q_texts='<article style="display: block;"><p>Please select the date of the previous audit to generate the Cost of Sales report.</p></article>'),3==that.pg_no&&(that.q_additional_texts='<article style="display: block;"><br><p>Enter any additional notes you would like to be included in the report.</p></article>');else{if("full"==that.audit_type&&null==that.start_date_compare)return void alertService.showError("Please select a date!");"full"==that.audit_type&&"full"!=that.start_date_compare.type?SweetAlert.swal({title:"Error!",text:"The previous count needs to be a full audit.",type:"warning",confirmButtonColor:"#ed5565",confirmButtonText:"OK"},function(res){that.start_date_compare=null}):(that.is_send_email=val,null==that.start_date_compare&&(that.start_date_compare=that.audit_dates_f[0]),that.save())}},that.save=function(){$uibModalInstance.close({audit_type:that.audit_type,is_send_email:that.is_send_email,prev_audit_date:that.start_date_compare,additional_notes:that.additional_notes})},that.cancel=function(){$uibModalInstance.dismiss("cancel")}};alcoholCostOfSummaryController.$inject=["api","$state","auth","core","alertService","SweetAlert","$q","localStorageService","$uibModal","restaurant","$rootScope","$scope"],angular.module("inspinia").component("alcoholCostOfSummaryComponent",{templateUrl:"js/components/reports/alcoholCostOfSummary/alcoholCostOfSummary.html",controller:alcoholCostOfSummaryController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("reports.alcoholCostOfSummary",{url:"/alcohol-cost-of-summary",template:"<alcohol-cost-of-summary-component></alcohol-cost-of-summary-component>",data:{pageTitle:"Alcohol cost of summary"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]},{serie:!0,files:["css/plugins/c3/c3.min.css","js/plugins/d3/d3.min.js","js/plugins/c3/c3.min.js"]},{serie:!0,name:"gridshore.c3js.chart",files:["js/plugins/c3/c3-angular.min.js"]}])}}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("reports.alcohol.inventoryUsage",{url:"/inventory-usage",template:"<inventory-usage></inventory-usage>",data:{pageTitle:"Inventory Usage"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/moment/moment.min.js"]},{name:"datePicker",files:["css/plugins/datapicker/angular-datapicker.css","js/plugins/datapicker/angular-datepicker.js"]}])}}})})}(),function(){"use strict";function analyticsController(api,$state,auth,localStorageService,restaurant,$rootScope,$scope,$window){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;that.$state=$state,that.api=api,that.auth=auth,that.restaurant_id=localStorageService.get("restaurant_id"),that.score_details=[],that.score_summary={},that.detail_type="alcohol";var from_date=new Date;if(from_date=new Date(from_date.getFullYear(),from_date.getMonth(),1),that.start_date=from_date,that.end_date=new Date,$rootScope.$on("restaurantSelected",function(){that.pos_id=$state.params.pos_id||restaurant.data.info.pos_id,that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),!that.restaurant_id)return void $state.go("home");that.performanceScoreDetail=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),that.loading=!0;var dayfd=that.start_date.getDate(),monthfd=that.start_date.getMonth()+1;that.fd=that.start_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd;var daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1;that.td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd,that.api.performance_score_detail({start_date:that.fd,end_date:that.td,RestaurantId:that.restaurant_id.restaurant_id,Category:that.score_category}).then(function(ret){if(that.loading=!1,swal.close(),ret){for(var details=ret.data.data.performanceScoreDetail,i=0;i<details.length;i++)angular.isUndefined(that.active_list[details[i].category])||null===that.active_list[details[i].category]||(that.active_list[details[i].category].push(details[i]),that.summary_list[details[i].category].purchases=angular.isUndefined(that.summary_list[details[i].category].purchases)||null===that.summary_list[details[i].category].purchases?details[i].purchases_units:that.summary_list[details[i].category].purchases+details[i].purchases_units,that.summary_list[details[i].category].suggested=angular.isUndefined(that.summary_list[details[i].category].suggested)||null===that.summary_list[details[i].category].suggested?details[i].suggested_units:that.summary_list[details[i].category].suggested+details[i].suggested_units,that.summary_list[details[i].category].sold=angular.isUndefined(that.summary_list[details[i].category].sold)||null===that.summary_list[details[i].category].sold?details[i].sold_units:that.summary_list[details[i].category].sold+details[i].sold_units,that.summary_list[details[i].category].oh=angular.isUndefined(that.summary_list[details[i].category].oh)||null===that.summary_list[details[i].category].oh?details[i].oh_units:that.summary_list[details[i].category].oh+details[i].oh_units,that.summary_list[details[i].category].slow=angular.isUndefined(that.summary_list[details[i].category].slow)||null===that.summary_list[details[i].category].slow?details[i].oh_units>0&&details[i].usage_percent>0&&details[i].usage_percent<8.25?1:0:that.summary_list[details[i].category].slow+(details[i].oh_units>0&&details[i].usage_percent>0&&details[i].usage_percent<8.25?1:0),that.summary_list[details[i].category].usage=angular.isUndefined(that.summary_list[details[i].category].usage)||null===that.summary_list[details[i].category].usage?details[i].usage_percent>=0&&details[i].sold_units-details[i].suggested_units+details[i].purchases_units>0?details[i].usage_percent:0:that.summary_list[details[i].category].usage+(details[i].usage_percent>=0&&details[i].sold_units-details[i].suggested_units+details[i].purchases_units>0?details[i].usage_percent:0),that.summary_list[details[i].category].stale=angular.isUndefined(that.summary_list[details[i].category].stale)||null===that.summary_list[details[i].category].stale?details[i].oh_units>0&&details[i].stale_days==ret.data.data.report_period&&details[i].stale_days>=30?1:0:that.summary_list[details[i].category].stale+(details[i].oh_units>0&&details[i].stale_days==ret.data.data.report_period&&details[i].stale_days>=30?1:0));for(var category in that.categories)that.summary_list[that.categories[category]].pvs=that.summary_list[that.categories[category]].sold/that.summary_list[that.categories[category]].purchases*100,that.summary_list[that.categories[category]].slow=that.summary_list[that.categories[category]].slow/that.active_list[that.categories[category]].length*100,that.summary_list[that.categories[category]].usage=that.summary_list[that.categories[category]].usage/that.active_list[that.categories[category]].length,that.summary_list[that.categories[category]].stale=that.summary_list[that.categories[category]].stale/that.active_list[that.categories[category]].length*100;that.score_details=that.active_list[that.score_category],that.score_summary=that.summary_list[that.score_category]}})},that.food_performanceScoreDetail=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),that.loading=!0;var dayfd=that.start_date.getDate(),monthfd=that.start_date.getMonth()+1;that.fd=that.start_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd;var daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1;that.td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd,that.api.food_performance_score_detail({start_date:that.fd,end_date:that.td,RestaurantId:that.restaurant_id.restaurant_id,Category:that.score_category}).then(function(ret){if(that.loading=!1,ret){for(var details=ret.data.data.performanceScoreDetail,i=0;i<details.length;i++)angular.isUndefined(that.active_list[details[i].category])||null===that.active_list[details[i].category]||(that.active_list[details[i].category].push(details[i]),that.summary_list[details[i].category].purchases=angular.isUndefined(that.summary_list[details[i].category].purchases)||null===that.summary_list[details[i].category].purchases?details[i].purchases_units:that.summary_list[details[i].category].purchases+details[i].purchases_units,that.summary_list[details[i].category].suggested=angular.isUndefined(that.summary_list[details[i].category].suggested)||null===that.summary_list[details[i].category].suggested?details[i].suggested_units:that.summary_list[details[i].category].suggested+details[i].suggested_units,that.summary_list[details[i].category].sold=angular.isUndefined(that.summary_list[details[i].category].sold)||null===that.summary_list[details[i].category].sold?details[i].sold_units:that.summary_list[details[i].category].sold+details[i].sold_units,that.summary_list[details[i].category].oh=angular.isUndefined(that.summary_list[details[i].category].oh)||null===that.summary_list[details[i].category].oh?details[i].oh_units:that.summary_list[details[i].category].oh+details[i].oh_units,that.summary_list[details[i].category].slow=angular.isUndefined(that.summary_list[details[i].category].slow)||null===that.summary_list[details[i].category].slow?details[i].oh_units>0&&details[i].usage_percent>0&&details[i].usage_percent<8.25?1:0:that.summary_list[details[i].category].slow+(details[i].oh_units>0&&details[i].usage_percent>0&&details[i].usage_percent<8.25?1:0),that.summary_list[details[i].category].usage=angular.isUndefined(that.summary_list[details[i].category].usage)||null===that.summary_list[details[i].category].usage?details[i].usage_percent>=0?details[i].usage_percent:0:that.summary_list[details[i].category].usage+(details[i].usage_percent>=0?details[i].usage_percent:0),that.summary_list[details[i].category].stale=angular.isUndefined(that.summary_list[details[i].category].stale)||null===that.summary_list[details[i].category].stale?details[i].stale_days==ret.data.data.report_period?1:0:that.summary_list[details[i].category].stale+(details[i].stale_days==ret.data.data.report_period?1:0));for(var category in that.categories)that.summary_list[that.categories[category]].pvs=that.summary_list[that.categories[category]].sold/that.summary_list[that.categories[category]].purchases*100,
that.summary_list[that.categories[category]].slow=that.summary_list[that.categories[category]].slow/that.active_list[that.categories[category]].length*100,that.summary_list[that.categories[category]].usage=that.summary_list[that.categories[category]].usage/that.active_list[that.categories[category]].length,that.summary_list[that.categories[category]].stale=that.summary_list[that.categories[category]].stale/that.active_list[that.categories[category]].length*100;that.score_details=that.active_list[that.score_category],that.score_summary=that.summary_list[that.score_category]}swal.close()})},this.downloadCSV=function(){that.export_loading=!0;const getData=that.score_details;var dayfd=that.start_date.getDate(),monthfd=that.start_date.getMonth()+1,fd=that.start_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1,td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd,headers=["DateFrom","DateTo","Category","Item","Size","PurchasedUnits","SuggestedUnits","POSInventoryUnitsSold","TotalOnHandUnits","Usage%","ZeroSaleDays"],csv=headers.join(",")+"\r\n";getData.forEach(function(row){var pmix_obj={};pmix_obj.DateFrom=fd,pmix_obj.DateTo=td,pmix_obj.Category=row.category,pmix_obj.Item=row.item_name.replace(/[,'#]/g," "),pmix_obj.Size=row.size,pmix_obj.PurchasedUnits=row.purchases_units,pmix_obj.SuggestedUnits=row.suggested_units,pmix_obj.POSInventoryUnitsSold=row.sold_units,pmix_obj.TotalOnHandUnits=row.oh_units,pmix_obj["Usage%"]=row.usage_percent,pmix_obj.ZeroSaleDays=row.stale_days;const values=headers.map(function(header){return pmix_obj[header]});csv+=values.join(",")+"\r\n"});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="Analytics Report.csv",hiddenElement.click(),that.export_loading=!1},that.loadDetails=function(){that.active_list={},that.summary_list={};for(var i=0;i<that.categories.length;i++)that.active_list[that.categories[i]]=[],that.summary_list[that.categories[i]]={};"alcohol"==that.detail_type?that.performanceScoreDetail():"food"==that.detail_type&&that.food_performanceScoreDetail()},that.change_category=function(){that.score_details=that.active_list[that.score_category],that.score_summary=that.summary_list[that.score_category]},that.$onInit=function(){that.restaurant_id.restaurant_id,that.detail_type=$state.params.typeInventory;var inventory_type_id="alcohol"==that.detail_type?2:1;that.export_loading=!1,Promise.all([that.api.get_active_SKU_categories({inventory_type_id:inventory_type_id})]).then(function(response){that.categories=response[0].data.data.categories.filter(function(x){return"Non Alcoholic"!=x.category}).map(function(x){return x.category}),that.score_category=that.categories[0]}).then(function(){that.loadDetails()})}}analyticsController.$inject=["api","$state","auth","localStorageService","restaurant","$rootScope","$scope","$window"],angular.module("inspinia").component("analyticsComponent",{templateUrl:"js/components/reports/analytics/analytics.html",controller:analyticsController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("reports.analytics",{url:"/analytics/:typeInventory",template:"<analytics-component></analytics-component>",data:{pageTitle:"Analytics"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]},{serie:!0,files:["css/plugins/c3/c3.min.css","js/plugins/d3/d3.min.js","js/plugins/c3/c3.min.js"]},{serie:!0,name:"gridshore.c3js.chart",files:["js/plugins/c3/c3-angular.min.js"]}])}}})})}(),function(){"use strict";function batchReportController(api,$state,auth,core,localStorageService,restaurant,$rootScope,$scope){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;that.api=api,this.mydate="";var from_date=new Date;if(that.start_date=new Date(from_date.getFullYear(),0,1),that.end_date=new Date,that.items=[],that.recipe_categories=[{category:"Batch Recipes",r_type_id:2},{category:"Pre-prepped Recipes",r_type_id:3}],that.category=that.recipe_categories[0].category,that.cat_id=that.recipe_categories[0].r_type_id,that.mode="On Hand",$rootScope.$on("restaurantSelected",function(){that.pos_id=$state.params.pos_id||restaurant.data.info.pos_id,that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.loadOH=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1,timer:2e4}),that.mode="On Hand",this.mydate=Date.now(),that.api.batch_OH({Date:this.mydate,RestaurantId:that.restaurant_id.restaurant_id,Category:that.cat_id}).then(function(res){res&&(that.items=[],angular.forEach(res.data.data.Report,function(value,key){var temp_value=value;temp_value.date_of_creation=temp_value.date_of_creation.substring(0,10),that.items.push(temp_value)},that.items)),swal.close()})},that.loadWaste=function(){that.mode="Waste Report";var dayfd=that.start_date.getDate(),monthfd=that.start_date.getMonth()+1,fd=that.start_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1,td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd;that.api.waste_report({From:fd,To:td,RestaurantId:that.restaurant_id.restaurant_id,Category:that.cat_id}).then(function(res){res&&(that.items=[],angular.forEach(res.data.data.Report,function(value,key){var temp_value=value;temp_value.date_of_creation=temp_value.date_of_creation.substring(0,10),temp_value.date_on_hand=temp_value.date_on_hand.substring(0,10),that.items.push(temp_value)},that.items))})},that.changeCat=function(){2===that.cat_id?(that.category=that.recipe_categories[0].category,"On Hand"===that.mode?that.loadOH():"Waste Report"==that.mode&&that.loadWaste()):3===that.cat_id&&(that.category=that.recipe_categories[1].category,"On Hand"===that.mode?that.loadOH():"Waste Report"==that.mode&&that.loadWaste())},that.$onInit=function(){that.loadOH()}}batchReportController.$inject=["api","$state","auth","core","localStorageService","restaurant","$rootScope","$scope"],angular.module("inspinia").component("batchReportComponent",{templateUrl:"js/components/reports/batchReport/batchReport.html",controller:batchReportController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("reports.batchReport",{url:"/batchReport",template:"<batch-report-component></batch-report-component>",data:{pageTitle:"Batch Report"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]},{serie:!0,files:["css/plugins/c3/c3.min.css","js/plugins/d3/d3.min.js","js/plugins/c3/c3.min.js"]},{serie:!0,name:"gridshore.c3js.chart",files:["js/plugins/c3/c3-angular.min.js"]}])}}})})}(),function(){"use strict";function compgroupReportsController(api,$state,$filter,auth,core,SweetAlert,localStorageService,restaurant,$rootScope,$scope){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.api=api,$rootScope.$on("restaurantSelected",function(){that.pos_id=$state.params.pos_id||restaurant.data.info.pos_id,that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.load_lock=!0,that.subscription_type_id=restaurant.data.info.subscription_type_id,that.filters_list=[{name:"Match"},{name:"All"}],that.location_list=[{name:"State"},{name:"Country"}];var from_date=new Date;from_date.setDate(from_date.getDate()-6),that.start_date=from_date,that.end_date=new Date,that.size="All",that.geography="All",that.location="Country",$scope.loadcompsetReport_avg_sales=function(){that.api.compsetReport_avg_sales({start_date:that.fd,end_date:that.td,total_size:that.size,geography:that.geography,location:that.location}).then(function(res){if(res){var result=res.data.data.result,chartData=[];if(0!=result.length){var d=new Set;for(var i in result)d.add(result[i].sales_date.substring(0,10));d.forEach(function(value){var my_sales=0,compset_sales=0;for(var i in result)if(result[i].sales_date.substring(0,10)==value){my_sales=result[i].my_sales,compset_sales=result[i].compset_avg_sales;break}chartData.push({_id:value,"My Restaurant":my_sales,Compgroup:compset_sales})})}c3.generate({bindto:"#sales_avg_line_graph",data:{json:chartData,keys:{x:"_id",value:["My Restaurant","Compgroup"]},empty:{label:{text:"No data found"}}},axis:{x:{type:"category",tick:{rotate:75,multiline:!1},height:130},y:{tick:{format:d3.format("$,")}}}})}})},$scope.loadcompsetReport_daily_sales=function(){that.api.compsetReport_daily_sales({start_date:that.fd,total_size:that.size,geography:that.geography,location:that.location}).then(function(res){var r2_res=res.data.data.result;that.r2_dates=[],that.r2_result=[];for(var i=0;i<7;i++){var from_date=new Date(that.start_date);from_date.setDate(from_date.getDate()+i);var dayfd=from_date.getDate(),monthfd=from_date.getMonth()+1;that.r2_dates.push(from_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd);for(var found=!1,j=0;j<r2_res.length;j++)if(that.r2_dates[i]==r2_res[j].sales_date.substring(0,10)){that.r2_result[i]=r2_res[j],found=!0;break}found||(that.r2_result[i]={})}})},$scope.loadcompsetReport_day_of_week_avg_sales=function(){that.api.compsetReport_day_of_week_avg_sales({start_date:that.fd,end_date:that.td,total_size:that.size,geography:that.geography,location:that.location}).then(function(res){var r3_res=res.data.data.result;that.r3_days=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],that.r3_result=[];for(var i=0;i<7;i++){for(var found=!1,j=0;j<r3_res.length;j++)if(that.r3_days[i]==r3_res[j].day){that.r3_result[i]=r3_res[j],found=!0;break}found||(that.r3_result[i]={})}})},$scope.loadcompsetReport_holiday=function(is_init){var holiday_start;if(is_init){holiday_start=new Date(that.start_date.getFullYear(),0,1);var dayfd=holiday_start.getDate(),monthfd=holiday_start.getMonth()+1;holiday_start=holiday_start.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd}else holiday_start=that.fd;that.api.compsetReport_holiday({start_date:holiday_start,end_date:that.td,total_size:that.size,geography:that.geography,location:that.location}).then(function(res){that.r4_result=res.data.data.result;var categories=[],columns=[["My Restaurant"],["Compgroup Sales Avg"]];for(var i in that.r4_result)categories.push(that.r4_result[i].name),columns[0].push(that.r4_result[i].my_sales),columns[1].push(that.r4_result[i].compset_avg_sales);c3.generate({bindto:"#holiday_report",data:{columns:columns,type:"bar",empty:{label:{text:"No data found."}}},axis:{x:{type:"category",categories:categories,tick:{rotate:45,multiline:!1}},y:{tick:{format:d3.format("$,")}}}})})},$scope.loadcompsetReport_projected_summary=function(){that.api.compsetReport_projected_summary({total_size:that.size,geography:that.geography,location:that.location}).then(function(res){that.r5_result=res.data.data.result,that.r5_result.length<2&&that.r5_result.length>0&&"Last Week"==that.r5_result[0].type&&that.r5_result.push({type:"Current Week"})})},$scope.loadcompsetReport_shared_budget=function(){that.api.compsetReport_shared_budget({start_date:that.fd,end_date:that.td,total_size:that.size,geography:that.geography,location:that.location}).then(function(res){that.r6_result=res.data.data.result,that.r6_result.length>0&&("my_rest"==that.r6_result[0].type?(that.r6_my_budget=that.r6_result[0],that.r6_compset_budget=that.r6_result[1]):"comspet"==that.r6_result[0].type&&(that.r6_my_budget=that.r6_result[1],that.r6_compset_budget=that.r6_result[0]))})},that.loadSalesData=function(is_init){var dayfd=that.start_date.getDate(),monthfd=that.start_date.getMonth()+1;that.fd=that.start_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd;var daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1;that.td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd,$scope.loadcompsetReport_avg_sales(),$scope.loadcompsetReport_daily_sales(),$scope.loadcompsetReport_day_of_week_avg_sales(),$scope.loadcompsetReport_holiday(is_init),$scope.loadcompsetReport_projected_summary(),$scope.loadcompsetReport_shared_budget()},that.$onInit=function(){that.api.checkForSummarizedSales().then(function(res){res.data.data.categories&&Array.isArray(res.data.data.categories)?res.data.data.categories.length>0?(that.load_lock=!1,that.loadSalesData(!0)):4==that.subscription_type_id?SweetAlert.swal({title:"Congratulations your setup is almost complete. It currently takes approximately 1-24 hours to confirm your CSV successfully connected. Once your setup is complete and confirmed you will receive an email notifying you of your updated status.",confirmButtonColor:"#337ab7",confirmButtonText:"OK"},function(res){$state.go("home")}):SweetAlert.swal({title:"Congratulations your setup is almost complete. It currently takes approximately 1-24 hours to confirm your CSV successfully connected. Once your setup is complete and confirmed you will receive an email notifying you of your updated status.",confirmButtonColor:"#337ab7",confirmButtonText:"OK & Continue Setup"},function(res){$state.go("setupFirstAudit")}):$state.go("reports.reportsCategory")})}}compgroupReportsController.$inject=["api","$state","$filter","auth","core","SweetAlert","localStorageService","restaurant","$rootScope","$scope"],angular.module("inspinia").component("compgroupReportComponent",{templateUrl:"js/components/reports/compgroupReport/compgroupReport.html",controller:compgroupReportsController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("reports.compgroupReport",{url:"/compgroup-report",template:"<compgroup-report-component></compgroup-report-component>",data:{pageTitle:"Compgroup Report"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]},{serie:!0,files:["css/plugins/c3/c3.min.css","js/plugins/d3/d3.min.js","js/plugins/c3/c3.min.js"]},{serie:!0,name:"gridshore.c3js.chart",files:["js/plugins/c3/c3-angular.min.js"]}])}}})})}(),function(){"use strict";function costChangeReportsController(api,$state,auth,core,localStorageService,restaurant,$rootScope,$scope){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.api=api,that.core=core,that.auth=auth,$rootScope.$on("restaurantSelected",function(){that.pos_id=$state.params.pos_id||restaurant.data.info.pos_id,that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.start_date=new Date,that.start_date.setMonth(that.start_date.getMonth()-1),that.end_date=new Date,that.details_start_date=new Date,that.multiSelectSettings={selectionLimit:3,scrollableHeight:"200px",scrollable:!0},that.vendor_dict={},that.vendorsList=[],that.selectedVendors=[],that.currentCategories=["Select Vendor(s) First"],that.category=that.currentCategories[0],that.itemsList=[],that.currentItems=[],that.selectedItems=[],that.details_modes_list=[{type:"most_recent",name:"Show Most Recent"},{type:"last_year",name:"Show Last Year"}],that.costChangeGraph=function(){var dayfd=that.start_date.getDate(),monthfd=that.start_date.getMonth()+1,fd=that.start_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1,td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd;that.api.costChangeCostCompare({start_date:fd,end_date:td,RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:2,items:that.selectedItems.map(function(x){return x.id})}).then(function(res){var total_sales=res.data.data.costChangeCostCompare,xs_obj={},cols_arr=[],d=new Set;d.add(fd),d.add(td);var cc_data_obj={};for(var i in total_sales)d.add(total_sales[i].delivery_date.substring(0,10)),cc_data_obj.hasOwnProperty(total_sales[i].delivery_date.substring(0,10))?cc_data_obj[total_sales[i].delivery_date.substring(0,10)][total_sales[i].vendor_sku_id]=total_sales[i].item_cost:(cc_data_obj[total_sales[i].delivery_date.substring(0,10)]={},cc_data_obj[total_sales[i].delivery_date.substring(0,10)][total_sales[i].vendor_sku_id]=total_sales[i].item_cost);d=Array.from(d),d.sort();var item_trans={};for(var si in that.selectedItems)item_trans[that.selectedItems[si].id]={dates:[that.selectedItems[si].id+""],costs:[that.selectedItems[si].label],dates_to_fix:[]},xs_obj[that.selectedItems[si].label]=that.selectedItems[si].id+"",d.forEach(function(value){if(item_trans[that.selectedItems[si].id].dates.push(value),void 0!==cc_data_obj[value])if(void 0!==cc_data_obj[value][that.selectedItems[si].id])item_trans[that.selectedItems[si].id].costs.push(cc_data_obj[value][that.selectedItems[si].id]);else if(value==fd)if(item_trans[that.selectedItems[si].id].costs.length<2)for(var dxx in d){var value_d=d[dxx];if(value_d!=value&&void 0!==cc_data_obj[value_d]&&void 0!==cc_data_obj[value_d][that.selectedItems[si].id]){item_trans[that.selectedItems[si].id].costs.push(cc_data_obj[value_d][that.selectedItems[si].id]);break}}else item_trans[that.selectedItems[si].id].costs.push(item_trans[that.selectedItems[si].id].costs[item_trans[that.selectedItems[si].id].costs.length-1]);else item_trans[that.selectedItems[si].id].costs.push(item_trans[that.selectedItems[si].id].costs[item_trans[that.selectedItems[si].id].costs.length-1]);else if(item_trans[that.selectedItems[si].id].costs.length)item_trans[that.selectedItems[si].id].costs.push(item_trans[that.selectedItems[si].id].costs[item_trans[that.selectedItems[si].id].costs.length-1]);else for(var dxx in d){var value_d=d[dxx];if(value_d!=value&&void 0!==cc_data_obj[value_d][that.selectedItems[si].id]){item_trans[that.selectedItems[si].id].costs.push(cc_data_obj[value_d][that.selectedItems[si].id]);break}}}),cols_arr.push(item_trans[that.selectedItems[si].id].dates),cols_arr.push(item_trans[that.selectedItems[si].id].costs);that.loading=!1,swal.close(),c3.generate({bindto:"#cc_graph",data:{xs:xs_obj,columns:cols_arr,empty:{label:{text:"No data found"}}},axis:{x:{type:"category",tick:{rotate:75,multiline:!1},height:100},y:{tick:{format:d3.format("$,")}}},legend:{position:"bottom"},tooltip:{show:!0}})})},that.loadCostChangeData=function(){that.loading=!0,swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),"summary"==that.mode?that.costChangeGraph():"details"==that.mode&&that.costChangeDetails()},that.costChangeDetails=function(){var params={inventory_type_id:2,category:-1==that.details_category.id?"%":that.details_category.category,sub_category:-1==that.subcategory.id?"%":that.subcategory.sub_category,item:-1==that.item.id?"%":that.item.id,mode:that.details_mode.type};if("most_recent"==that.details_mode.type){var daytd=that.details_start_date.getDate(),monthtd=that.details_start_date.getMonth()+1,td=that.details_start_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd;params.start_date=td}that.api.costChangeDetails(params).then(function(res){if(that.cc_details_items=[],that.cc_details_menus=[],res.data.data.costChangeDetails.sku_items.length){that.cc_details_items=res.data.data.costChangeDetails.sku_items;for(var ci in that.cc_details_items){var ct=that.cc_details_items[ci];null!=ct.prior_purchase_date&&(ct.prior_purchase_date=ct.prior_purchase_date.substring(0,10)),ct.current_purchase_date=ct.current_purchase_date.substring(0,10),null!=ct.prior_purchase_cost?(ct.cost_change=ct.current_purchase_cost-ct.prior_purchase_cost,ct.cost_change_percent=0==ct.cost_change?0:0==ct.prior_purchase_cost?"-":ct.cost_change/ct.prior_purchase_cost*100):(ct.cost_change="-",ct.cost_change_percent="-")}}res.data.data.costChangeDetails.menus.length&&(that.cc_details_menus=res.data.data.costChangeDetails.menus),that.loading=!1,swal.close()})},that.changeMode=function(mode){that.mode!=mode&&(that.mode=mode,"summary"==that.mode?that.costChangeGraph():that.costChangeDetails())},that.selectCategory=function(is_init){if(that.currentItems=that.itemsList.filter(function(x){return x.category==that.category}),that.selectedItems=[],is_init&&that.currentItems.length)if(that.currentItems.length<=3)for(var ci in that.currentItems)that.selectedItems.push(that.currentItems[ci]);else for(var ci=0;ci<3;ci++)that.selectedItems.push(that.currentItems[ci])},that.addVendor=function(v,is_init){if(that.vendor_dict.hasOwnProperty(v.id)){for(var vx in that.vendor_dict[v.id])that.itemsList.push({id:that.vendor_dict[v.id][vx].id,label:that.vendor_dict[v.id][vx].label+" ("+v.label+")",category:that.vendor_dict[v.id][vx].category,vendor_id:v.id});that.currentCategories=Array.from(new Set(that.itemsList.map(function(x){return x.category}))),that.category=that.currentCategories[0],that.selectCategory(),that.itemsList.sort(function(a,b){return a.label>b.label?1:b.label>a.label?-1:0})}else that.api.get_active_inventory_by_vendor({vendor_id:v.id,inventory_type_id:2},that.restaurant_id.restaurant_id).then(function(res){that.vendor_dict[v.id]=[];for(var vx in res.data.data.sku)that.itemsList.push({id:res.data.data.sku[vx].id,label:res.data.data.sku[vx].item_name+" ("+v.label+")",category:res.data.data.sku[vx].category,vendor_id:v.id}),that.vendor_dict[v.id].push(that.itemsList[that.itemsList.length-1]);that.currentCategories=Array.from(new Set(that.itemsList.map(function(x){return x.category}))),that.category=that.currentCategories[0],that.selectCategory(is_init),that.itemsList.sort(function(a,b){return a.label>b.label?1:b.label>a.label?-1:0})})},that.removeVendor=function(v){if(v){var temp_il=that.itemsList.filter(function(x){return x.vendor_id!=v.id});that.itemsList=[],that.itemsList=temp_il,that.currentCategories=Array.from(new Set(that.itemsList.map(function(x){return x.category}))),that.itemsList.sort(function(a,b){return a.label>b.label?1:b.label>a.label?-1:0}),that.selectedVendors.length||(that.currentCategories=["Select Vendor(s) First"],that.category=that.currentCategories[0],that.itemsList=[],that.currentItems=[],that.selectedItems=[])}else that.currentCategories=["Select Vendor(s) First"],that.category=that.currentCategories[0],that.itemsList=[],that.currentItems=[],that.selectedItems=[]},that.vmsEvents={onDeselectAll:function(){that.removeVendor()},onItemSelect:function(item){that.addVendor(item)},onItemDeselect:function(item){that.removeVendor(item)}},that.changeCat=function(){-1!=that.details_category.id?(that.subcategories=that.all_subcategories.filter(function(x){return that.details_category.id==x.vendor_cat_id}),that.subcategories.unshift({id:-1,sub_category:"--All Subcategories--"}),that.subcategory=that.subcategories[0],that.temp_items=that.inventoryListSelected.filter(function(x){return x.vendor_cat_id==that.details_category.id}),that.temp_items.unshift({id:-1,item_name:"--All Items--"}),that.item=that.temp_items[0]):(that.subcategories=JSON.parse(JSON.stringify(that.all_subcategories)),that.subcategory={id:-1,sub_category:"--All Subcategories--"},that.temp_items=JSON.parse(JSON.stringify(that.inventoryListSelected)),that.item={id:-1,item_name:"--All Items--"})},that.changeSubCat=function(){-1!=that.subcategory.id?(that.temp_items=that.inventoryListSelected.filter(function(x){return x.vendor_cat_id==that.details_category.id&&x.vendor_sub_cat_id==that.subcategory.id}),that.temp_items.unshift({id:-1,item_name:"--All Items--"}),that.item=that.temp_items[0]):(that.temp_items=JSON.parse(JSON.stringify(that.inventoryListSelected)),that.item={id:-1,item_name:"--All Items--"})},that.getInventoriesByVendor=function(){that.api.get_active_inventory_by_vendor({inventory_type_id:2},that.restaurant_id.restaurant_id).then(function(res){that.inventoryListSelected=res.data.data.sku,that.temp_items=JSON.parse(JSON.stringify(that.inventoryListSelected))})},that.getChosenVendors=function(){api.get_chosen_vendors(that.restaurant_id.restaurant_id,{vendor_type_id:2}).then(function(res){that.vendors=res.data.data.vendors;for(var vx in res.data.data.vendors)that.vendorsList.push({id:res.data.data.vendors[vx].id,label:res.data.data.vendors[vx].vendor_name});that.vendorsList.length&&(that.selectedVendors.push(that.vendorsList[0]),that.addVendor(that.vendorsList[0],!0))})},this.downloadCSV=function(){that.export_loading=!0;const getData=that.cc_details_items;var headers=[];"details"==that.mode&&(headers=["Vendor","ItemName","DeliveryUnit","LastPurchaseDate","LastPurchaseCost","CurrentPurchaseDate","CurrentPurchaseCost","CostChange","PercentChange"]);var csv=headers.join(",")+"\r\n";getData.forEach(function(row){var cc_obj={};"details"==that.mode&&(cc_obj.Vendor=row.vendor_name.replace(/[,'#]/g," "),cc_obj.ItemName=row.item_name.replace(/[,'#]/g," "),cc_obj.DeliveryUnit=row.uod,cc_obj.LastPurchaseDate=null==row.prior_purchase_date?"-":row.prior_purchase_date,cc_obj.LastPurchaseCost=null==row.prior_purchase_cost?"-":Math.round(100*row.prior_purchase_cost)/100,cc_obj.CurrentPurchaseDate=null==row.current_purchase_date?"-":row.current_purchase_date,cc_obj.CurrentPurchaseCost=null==row.current_purchase_cost?"-":Math.round(100*row.current_purchase_cost)/100,cc_obj.CostChange="-"==row.cost_change?"-":Math.round(100*row.cost_change)/100,cc_obj.PercentChange="-"==row.cost_change_percent?"-":Math.round(100*row.cost_change_percent)/100);const values=headers.map(function(header){return cc_obj[header]});csv+=values.join(",")+"\r\n"});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="CostChange "+("details"==that.mode?"details":"")+" Report.csv",hiddenElement.click(),that.export_loading=!1},that.$onInit=function(){that.mode="details",that.export_loading=!1,Promise.all([api.get_vendors_categories({is_restaurant_used_only:1,inventory_type_id:2}),core.getRefbooks(),that.getChosenVendors(),that.getInventoriesByVendor()]).then(function(response){that.categories=response[0].data.data.categories.filter(function(x){return"Non Alcoholic"!=x.category}),that.categories.unshift({id:-1,category:"--All Categories--",inventory_type_id:2}),that.details_category=that.categories[0];var cat_ids=that.categories.map(function(x){return x.id});that.all_subcategories=response[1].vendor_sub_cat.filter(function(x){return cat_ids.includes(x.vendor_cat_id)}),that.subcategories=JSON.parse(JSON.stringify(that.all_subcategories)),that.subcategory={id:-1,sub_category:"--All Subcategories--"},that.item={id:-1,item_name:"--All Items--"},that.details_mode=that.details_modes_list[0],that.loadCostChangeData()})}}costChangeReportsController.$inject=["api","$state","auth","core","localStorageService","restaurant","$rootScope","$scope"],angular.module("inspinia").component("costChangeReportComponent",{templateUrl:"js/components/reports/costChangeReport/costChangeReport.html",controller:costChangeReportsController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("reports.costChangeReport",{url:"/cost-change-report",template:"<cost-change-report-component></cost-change-report-component>",data:{pageTitle:"Cost Change Report"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]},{serie:!0,files:["css/plugins/c3/c3.min.css","js/plugins/d3/d3.min.js","js/plugins/c3/c3.min.js"]},{serie:!0,name:"gridshore.c3js.chart",files:["js/plugins/c3/c3-angular.min.js"]}])}}})})}(),function(){"use strict";function dailyOnHandController(api,$scope,$state,auth,localStorageService,restaurant,$rootScope){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.api=api,that.auth=auth,this.mydate=new Date,that.items=[],$rootScope.$on("restaurantSelected",function(){that.pos_id=$state.params.pos_id||restaurant.data.info.pos_id,that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.preProcessOH=function(){that.total_OH_value=0;for(var i=0;i<that.oh_table_data.length;i++)that.total_OH_value+=that.oh_table_data[i].OH_value,that.oh_table_data[i].units_on_hand<0?(that.oh_table_data[i].units_on_hand="UR",that.oh_table_data[i].OH_value="UR"):that.oh_table_data[i].OH_value<0&&(that.oh_table_data[i].OH_value=that.oh_table_data[i].units_on_hand*that.oh_table_data[i].pack_cost);that.items=that.oh_table_data},this.downloadCSV=function(){const getData=[];that.export_loading=!0,this.oh_table_data.forEach(function(data){getData.push({Category:data.category,Vendor:data.vendor_name.replace(/[,'#]/g," "),SKU:data.vendor_sku.replace(/[,'#]/g," "),ItemDescription:data.item_name.replace(/[,'#]/g," "),CurrentOnHand:data.units_on_hand,ItemCost:data.pack_cost,OnHandValue:data.OH_value,UsedInRecipe:data.used_in_recipe})});const headers=["Category","Vendor","SKU","ItemDescription","CurrentOnHand","ItemCost","OnHandValue","UsedInRecipe"];var csv=headers.join(",")+"\r\n";getData.forEach(function(row){const values=headers.map(function(header){return row[header]});csv+=values.join(",")+"\r\n"});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="On-Hand Report.csv",hiddenElement.click(),that.export_loading=!1},that.loadOH=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),that.loading=!0,that.api.alcohol({RestaurantId:that.restaurant_id.restaurant_id,Category:"--All--"==that.category?"%":that.category,caller:"oh_report"}).then(function(res){res&&(that.category_label=that.category,that.oh_table_data=res.data.data.Report,that.preProcessOH()),that.loading=!1,swal.close()})},that.$onInit=function(){Promise.all([api.get_vendors_categories({is_restaurant_used_only:1,inventory_type_id:2})]).then(function(response){that.categories=response[0].data.data.categories.filter(function(x){return"Non Alcoholic"!=x.category}),that.categories.unshift({id:-1,category:"--All--",inventory_type_id:2}),that.category=that.categories[0].category,that.loadOH(),that.export_loading=!1})}}dailyOnHandController.$inject=["api","$scope","$state","auth","localStorageService","restaurant","$rootScope"],angular.module("inspinia").component("dailyOnHandComponent",{templateUrl:"js/components/reports/dailyOnHand/dailyOnHand.html",controller:dailyOnHandController,controllerAs:"$ctr",
bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("reports.dailyOnHand",{url:"/daily-on-hand",template:"<daily-on-hand-component></daily-on-hand-component>",data:{pageTitle:"On Hand Status"}})})}(),function(){"use strict";function foodCostChangeReportsController(api,$state,auth,core,localStorageService,restaurant,$rootScope,$scope){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.api=api,that.core=core,that.auth=auth,$rootScope.$on("restaurantSelected",function(){that.pos_id=$state.params.pos_id||restaurant.data.info.pos_id,that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.start_date=new Date,that.start_date.setMonth(that.start_date.getMonth()-1),that.end_date=new Date,that.details_start_date=new Date,that.multiSelectSettings={selectionLimit:3,scrollableHeight:"200px",scrollable:!0},that.vendor_dict={},that.vendorsList=[],that.selectedVendors=[],that.currentCategories=["Select Vendor(s) First"],that.category=that.currentCategories[0],that.itemsList=[],that.currentItems=[],that.selectedItems=[],that.details_modes_list=[{type:"most_recent",name:"Show Most Recent"},{type:"last_year",name:"Show Last Year"}],that.costChangeGraph=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1,timer:2e4});var dayfd=that.start_date.getDate(),monthfd=that.start_date.getMonth()+1,fd=that.start_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1,td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd;that.api.costChangeCostCompare({start_date:fd,end_date:td,RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:1,items:that.selectedItems.map(function(x){return x.id})}).then(function(res){var total_sales=res.data.data.costChangeCostCompare,xs_obj={},cols_arr=[],d=new Set;d.add(fd),d.add(td);var cc_data_obj={};for(var i in total_sales)d.add(total_sales[i].delivery_date.substring(0,10)),cc_data_obj.hasOwnProperty(total_sales[i].delivery_date.substring(0,10))?cc_data_obj[total_sales[i].delivery_date.substring(0,10)][total_sales[i].vendor_sku_id]=total_sales[i].item_cost:(cc_data_obj[total_sales[i].delivery_date.substring(0,10)]={},cc_data_obj[total_sales[i].delivery_date.substring(0,10)][total_sales[i].vendor_sku_id]=total_sales[i].item_cost);d=Array.from(d),d.sort();var item_trans={};for(var si in that.selectedItems)item_trans[that.selectedItems[si].id]={dates:[that.selectedItems[si].id+""],costs:[that.selectedItems[si].label],dates_to_fix:[]},xs_obj[that.selectedItems[si].label]=that.selectedItems[si].id+"",d.forEach(function(value){if(item_trans[that.selectedItems[si].id].dates.push(value),void 0!==cc_data_obj[value])if(void 0!==cc_data_obj[value][that.selectedItems[si].id])item_trans[that.selectedItems[si].id].costs.push(cc_data_obj[value][that.selectedItems[si].id]);else if(value==fd)if(item_trans[that.selectedItems[si].id].costs.length<2)for(var dxx in d){var value_d=d[dxx];if(value_d!=value&&void 0!==cc_data_obj[value_d]&&void 0!==cc_data_obj[value_d][that.selectedItems[si].id]){item_trans[that.selectedItems[si].id].costs.push(cc_data_obj[value_d][that.selectedItems[si].id]);break}}else item_trans[that.selectedItems[si].id].costs.push(item_trans[that.selectedItems[si].id].costs[item_trans[that.selectedItems[si].id].costs.length-1]);else item_trans[that.selectedItems[si].id].costs.push(item_trans[that.selectedItems[si].id].costs[item_trans[that.selectedItems[si].id].costs.length-1]);else if(item_trans[that.selectedItems[si].id].costs.length)item_trans[that.selectedItems[si].id].costs.push(item_trans[that.selectedItems[si].id].costs[item_trans[that.selectedItems[si].id].costs.length-1]);else for(var dxx in d){var value_d=d[dxx];if(value_d!=value&&void 0!==cc_data_obj[value_d][that.selectedItems[si].id]){item_trans[that.selectedItems[si].id].costs.push(cc_data_obj[value_d][that.selectedItems[si].id]);break}}}),cols_arr.push(item_trans[that.selectedItems[si].id].dates),cols_arr.push(item_trans[that.selectedItems[si].id].costs);that.loading=!1,c3.generate({bindto:"#cc_graph",data:{xs:xs_obj,columns:cols_arr,empty:{label:{text:"No data found"}}},axis:{x:{type:"category",tick:{rotate:75,multiline:!1},height:100},y:{tick:{format:d3.format("$,")}}},legend:{position:"bottom"},tooltip:{show:!0}}),swal.close()})},that.loadCostChangeData=function(){that.loading=!0,"summary"==that.mode?that.costChangeGraph():"details"==that.mode&&that.costChangeDetails()},that.costChangeDetails=function(){var params={inventory_type_id:1,category:-1==that.details_category.id?"%":that.details_category.category,sub_category:-1==that.subcategory.id?"%":that.subcategory.sub_category,item:-1==that.item.id?"%":that.item.id,mode:that.details_mode.type};if("most_recent"==that.details_mode.type){var daytd=that.details_start_date.getDate(),monthtd=that.details_start_date.getMonth()+1,td=that.details_start_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd;params.start_date=td}swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1,timer:2e4}),that.api.costChangeDetails(params).then(function(res){if(that.cc_details_items=[],that.cc_details_menus=[],res.data.data.costChangeDetails.sku_items.length){that.cc_details_items=res.data.data.costChangeDetails.sku_items;for(var ci in that.cc_details_items){var ct=that.cc_details_items[ci];null!=ct.prior_purchase_date&&(ct.prior_purchase_date=ct.prior_purchase_date.substring(0,10)),ct.current_purchase_date=ct.current_purchase_date.substring(0,10),null!=ct.prior_purchase_cost?(ct.cost_change=ct.current_purchase_cost-ct.prior_purchase_cost,ct.cost_change_percent=0==ct.cost_change?0:0==ct.prior_purchase_cost?"-":ct.cost_change/ct.prior_purchase_cost*100):(ct.cost_change="-",ct.cost_change_percent="-")}}res.data.data.costChangeDetails.menus.length&&(that.cc_details_menus=res.data.data.costChangeDetails.menus),that.loading=!1,swal.close()})},that.changeMode=function(mode){that.mode!=mode&&(that.mode=mode,"summary"==that.mode?that.costChangeGraph():that.costChangeDetails())},that.selectCategory=function(is_init){if(that.currentItems=that.itemsList.filter(function(x){return x.category==that.category}),that.selectedItems=[],is_init&&that.currentItems.length)if(that.currentItems.length<=3)for(var ci in that.currentItems)that.selectedItems.push(that.currentItems[ci]);else for(var ci=0;ci<3;ci++)that.selectedItems.push(that.currentItems[ci])},that.addVendor=function(v,is_init){if(swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1,timer:2e4}),that.vendor_dict.hasOwnProperty(v.id)){for(var vx in that.vendor_dict[v.id])that.itemsList.push({id:that.vendor_dict[v.id][vx].id,label:that.vendor_dict[v.id][vx].label+" ("+v.label+")",category:that.vendor_dict[v.id][vx].category,vendor_id:v.id});that.currentCategories=Array.from(new Set(that.itemsList.map(function(x){return x.category}))),that.category=that.currentCategories[0],that.selectCategory(),that.itemsList.sort(function(a,b){return a.label>b.label?1:b.label>a.label?-1:0})}else that.api.get_active_inventory_by_vendor({vendor_id:v.id,inventory_type_id:1},that.restaurant_id.restaurant_id).then(function(res){that.vendor_dict[v.id]=[];for(var vx in res.data.data.sku)that.itemsList.push({id:res.data.data.sku[vx].id,label:res.data.data.sku[vx].item_name+" ("+v.label+")",category:res.data.data.sku[vx].category,vendor_id:v.id}),that.vendor_dict[v.id].push(that.itemsList[that.itemsList.length-1]);that.currentCategories=Array.from(new Set(that.itemsList.map(function(x){return x.category}))),that.category=that.currentCategories[0],that.selectCategory(is_init),that.itemsList.sort(function(a,b){return a.label>b.label?1:b.label>a.label?-1:0}),swal.close()})},that.removeVendor=function(v){if(v){var temp_il=that.itemsList.filter(function(x){return x.vendor_id!=v.id});that.itemsList=[],that.itemsList=temp_il,that.currentCategories=Array.from(new Set(that.itemsList.map(function(x){return x.category}))),that.itemsList.sort(function(a,b){return a.label>b.label?1:b.label>a.label?-1:0}),that.selectedVendors.length||(that.currentCategories=["Select Vendor(s) First"],that.category=that.currentCategories[0],that.itemsList=[],that.currentItems=[],that.selectedItems=[])}else that.currentCategories=["Select Vendor(s) First"],that.category=that.currentCategories[0],that.itemsList=[],that.currentItems=[],that.selectedItems=[]},that.vmsEvents={onDeselectAll:function(){that.removeVendor()},onItemSelect:function(item){that.addVendor(item)},onItemDeselect:function(item){that.removeVendor(item)}},that.changeCat=function(){-1!=that.details_category.id?(that.subcategories=that.all_subcategories.filter(function(x){return that.details_category.id==x.vendor_cat_id}),that.subcategories.unshift({id:-1,sub_category:"--All Subcategories--"}),that.subcategory=that.subcategories[0],that.temp_items=that.inventoryListSelected.filter(function(x){return x.vendor_cat_id==that.details_category.id}),that.temp_items.unshift({id:-1,item_name:"--All Items--"}),that.item=that.temp_items[0]):(that.subcategories=JSON.parse(JSON.stringify(that.all_subcategories)),that.subcategory={id:-1,sub_category:"--All Subcategories--"},that.temp_items=JSON.parse(JSON.stringify(that.inventoryListSelected)),that.item={id:-1,item_name:"--All Items--"})},that.changeSubCat=function(){-1!=that.subcategory.id?(that.temp_items=that.inventoryListSelected.filter(function(x){return x.vendor_cat_id==that.details_category.id&&x.vendor_sub_cat_id==that.subcategory.id}),that.temp_items.unshift({id:-1,item_name:"--All Items--"}),that.item=that.temp_items[0]):(that.temp_items=JSON.parse(JSON.stringify(that.inventoryListSelected)),that.item={id:-1,item_name:"--All Items--"})},that.getInventoriesByVendor=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1,timer:2e4}),that.api.get_active_inventory_by_vendor({inventory_type_id:1},that.restaurant_id.restaurant_id).then(function(res){that.inventoryListSelected=res.data.data.sku,that.temp_items=JSON.parse(JSON.stringify(that.inventoryListSelected)),swal.close()})},that.getChosenVendors=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1,timer:2e4}),api.get_chosen_vendors(that.restaurant_id.restaurant_id,{vendor_type_id:1}).then(function(res){that.vendors=res.data.data.vendors;for(var vx in res.data.data.vendors)that.vendorsList.push({id:res.data.data.vendors[vx].id,label:res.data.data.vendors[vx].vendor_name});that.vendorsList.length&&(that.selectedVendors.push(that.vendorsList[0]),that.addVendor(that.vendorsList[0],!0)),swal.close()})},this.downloadCSV=function(){that.export_loading=!0;const getData=that.cc_details_items;var headers=[];"details"==that.mode&&(headers=["Vendor","ItemName","DeliveryUnit","LastPurchaseDate","LastPurchaseCost","CurrentPurchaseDate","CurrentPurchaseCost","CostChange","PercentChange"]);var csv=headers.join(",")+"\r\n";getData.forEach(function(row){var cc_obj={};"details"==that.mode&&(cc_obj.Vendor=row.vendor_name.replace(/[,'#]/g," "),cc_obj.ItemName=row.item_name.replace(/[,'#]/g," "),cc_obj.DeliveryUnit=row.uod,cc_obj.LastPurchaseDate=null==row.prior_purchase_date?"-":row.prior_purchase_date,cc_obj.LastPurchaseCost=null==row.prior_purchase_cost?"-":Math.round(100*row.prior_purchase_cost)/100,cc_obj.CurrentPurchaseDate=null==row.current_purchase_date?"-":row.current_purchase_date,cc_obj.CurrentPurchaseCost=null==row.current_purchase_cost?"-":Math.round(100*row.current_purchase_cost)/100,cc_obj.CostChange="-"==row.cost_change?"-":Math.round(100*row.cost_change)/100,cc_obj.PercentChange="-"==row.cost_change_percent?"-":Math.round(100*row.cost_change_percent)/100);const values=headers.map(function(header){return cc_obj[header]});csv+=values.join(",")+"\r\n"});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="CostChange "+("details"==that.mode?"details":"")+" Report.csv",hiddenElement.click(),that.export_loading=!1},that.$onInit=function(){that.mode="details",that.export_loading=!1,Promise.all([api.get_vendors_categories({is_restaurant_used_only:1,inventory_type_id:1}),core.getRefbooks(),that.getChosenVendors(),that.getInventoriesByVendor()]).then(function(response){that.categories=response[0].data.data.categories.filter(function(x){return"Non Alcoholic"!=x.category}),that.categories.unshift({id:-1,category:"--All Categories--",inventory_type_id:1}),that.details_category=that.categories[0];var cat_ids=that.categories.map(function(x){return x.id});that.all_subcategories=response[1].vendor_sub_cat.filter(function(x){return cat_ids.includes(x.vendor_cat_id)}),that.subcategories=JSON.parse(JSON.stringify(that.all_subcategories)),that.subcategory={id:-1,sub_category:"--All Subcategories--"},that.item={id:-1,item_name:"--All Items--"},that.details_mode=that.details_modes_list[0],that.loadCostChangeData()})}}foodCostChangeReportsController.$inject=["api","$state","auth","core","localStorageService","restaurant","$rootScope","$scope"],angular.module("inspinia").component("foodCostChangeReportComponent",{templateUrl:"js/components/reports/foodCostChangeReport/foodCostChangeReport.html",controller:foodCostChangeReportsController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("reports.foodCostChangeReport",{url:"/food-cost-change-report",template:"<food-cost-change-report-component></food-cost-change-report-component>",data:{pageTitle:"Food Cost Change Report"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]},{serie:!0,files:["css/plugins/c3/c3.min.css","js/plugins/d3/d3.min.js","js/plugins/c3/c3.min.js"]},{serie:!0,name:"gridshore.c3js.chart",files:["js/plugins/c3/c3-angular.min.js"]}])}}})})}(),function(){"use strict";function foodCostOfSummaryController(api,$state,auth,core,alertService,SweetAlert,$q,localStorageService,$uibModal,restaurant,$rootScope,$scope){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.api=api,that.core=core,that.auth=auth,that.subcats=[],that.temp_subcats=[],that.category="",that.subcategory=null,that.gross_sales=0,that.discounts=0,that.total_sales=0,that.value_last_period=0,that.purchase_value=0,that.value_this_period=0,that.target_cost=0,that.value_used=0,that.cost_percent=0,that.target_cost_percent=0,that.os_percent_variance=0,that.cos_table_data=[],that.var_total_cost=null,that.end_date_is_suggested=!1,$rootScope.$on("restaurantSelected",function(){that.pos_id=$state.params.pos_id||restaurant.data.info.pos_id,that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.checkEmpType=function(){var emps=restaurant.data.info.employees;if(that.user={userid:null,user_type_id:null},that.user.userid=that.auth.authentication.user.id,1==that.user.userid)that.showFinalSaveButton=!0;else for(var i=0;emps.length>i;i++)if(emps[i].id==that.user.userid){that.user.user_type_id=emps[i].type_ids,2==emps[i].type_ids||3==emps[i].type_ids||5==emps[i].type_ids||9==emps[i].type_ids||10==emps[i].type_ids?that.showFinalSaveButton=!0:that.showFinalSaveButton=!1;break}},that.finalSaveAudit=function(){var deferred=$q.defer(),adminFS=function(){var m={inventory_type_id:1,counting_started_at:(new Date).getTime(),counting_ended_at:(new Date).getTime(),is_final_save:1,is_adjustment:"full"==that.audit_type?0:1,send_email:0!=that.is_send_email,additional_notes:that.additional_notes,inventory_items:[]};void 0!==that.prev_audit_date&&null!=that.prev_audit_date&&(m.prev_audit_date=that.prev_audit_date),null==m.additional_notes&&delete m.additional_notes,that.api.update_inventory_audit(m).then(function(res){try{1e3===res.data.data.code&&(that.$onInit(),alertService.showAlertSave(),deferred.resolve()),that.loading=!1}catch(e){console.log(e),that.loading=!1,deferred.reject()}},function(){deferred.reject()})};that.is_send_email=!1,that.audit_type="full",that.additional_notes=null,$uibModal.open({templateUrl:"admin_final_save.html",controller:modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr",resolve:{is_send_email:function(){return that.is_send_email},start_dates:function(){return that.audit_dates_f}}}).result.then(function(res){that.loading=!0,that.is_send_email=res.is_send_email,that.audit_type=res.audit_type,that.prev_audit_date=res.prev_audit_date,that.additional_notes=res.additional_notes,adminFS()})},that.createConversionTable=function(){that.conversion_table=[],that.conversion_table.push({from:5,to:14,value:.0625}),that.conversion_table.push({from:5,to:15,value:28.3495}),that.conversion_table.push({from:5,to:19,value:.0283}),that.conversion_table.push({from:14,to:5,value:16}),that.conversion_table.push({from:14,to:15,value:453.592}),that.conversion_table.push({from:14,to:19,value:.4536}),that.conversion_table.push({from:15,to:5,value:.0353}),that.conversion_table.push({from:15,to:14,value:.0022}),that.conversion_table.push({from:15,to:19,value:.001}),that.conversion_table.push({from:19,to:5,value:35.274}),that.conversion_table.push({from:19,to:14,value:2.2046}),that.conversion_table.push({from:19,to:15,value:1e3}),that.conversion_table.push({from:1,to:2,value:3.7854}),that.conversion_table.push({from:1,to:3,value:4}),that.conversion_table.push({from:1,to:4,value:8}),that.conversion_table.push({from:1,to:5,value:128}),that.conversion_table.push({from:1,to:8,value:3785.4}),that.conversion_table.push({from:2,to:1,value:.2642}),that.conversion_table.push({from:2,to:3,value:1.0567}),that.conversion_table.push({from:2,to:4,value:2.1134}),that.conversion_table.push({from:2,to:5,value:33.814}),that.conversion_table.push({from:2,to:8,value:1e3}),that.conversion_table.push({from:3,to:1,value:.25}),that.conversion_table.push({from:3,to:2,value:.9464}),that.conversion_table.push({from:3,to:4,value:2}),that.conversion_table.push({from:3,to:5,value:32}),that.conversion_table.push({from:3,to:8,value:946.353}),that.conversion_table.push({from:4,to:1,value:.125}),that.conversion_table.push({from:4,to:2,value:.4732}),that.conversion_table.push({from:4,to:3,value:.5}),that.conversion_table.push({from:4,to:5,value:16}),that.conversion_table.push({from:4,to:8,value:473.176}),that.conversion_table.push({from:5,to:1,value:.0078}),that.conversion_table.push({from:5,to:2,value:.0296}),that.conversion_table.push({from:5,to:3,value:.0313}),that.conversion_table.push({from:5,to:4,value:.0625}),that.conversion_table.push({from:5,to:8,value:29.5735}),that.conversion_table.push({from:8,to:1,value:3e-4}),that.conversion_table.push({from:8,to:2,value:.001}),that.conversion_table.push({from:8,to:3,value:.0011}),that.conversion_table.push({from:8,to:4,value:.0021}),that.conversion_table.push({from:8,to:5,value:.0338})},that.convert=function(from,to){if(from==to)return 1;if(10==to||11==to||12==to||13==to||16==to||17==to||18==to)return 1;for(var i=0;i<that.conversion_table.length;i++)if(that.conversion_table[i].from==from&&that.conversion_table[i].to==to)return that.conversion_table[i].value},that.preProcessCOS=function(){for(var dict={},signs={},primary_uod={},i=0;i<that.cos_table_data.length;i++)null==that.cos_table_data[i].substitute_for?(primary_uod[that.cos_table_data[i].vendor_sku_id]=that.cos_table_data[i].uod_id,dict.hasOwnProperty(that.cos_table_data[i].vendor_sku_id)?(dict[that.cos_table_data[i].vendor_sku_id].push(that.cos_table_data[i]),0==that.cos_table_data[i].purchases?signs[that.cos_table_data[i].vendor_sku_id][0]++:signs[that.cos_table_data[i].vendor_sku_id][1]++):(dict[that.cos_table_data[i].vendor_sku_id]=[that.cos_table_data[i]],signs[that.cos_table_data[i].vendor_sku_id]=[0,0],0==that.cos_table_data[i].purchases?signs[that.cos_table_data[i].vendor_sku_id][0]++:signs[that.cos_table_data[i].vendor_sku_id][1]++)):dict.hasOwnProperty(that.cos_table_data[i].substitute_for)?(dict[that.cos_table_data[i].substitute_for].push(that.cos_table_data[i]),0==that.cos_table_data[i].purchases?signs[that.cos_table_data[i].substitute_for][0]++:signs[that.cos_table_data[i].substitute_for][1]++):(dict[that.cos_table_data[i].substitute_for]=[that.cos_table_data[i]],signs[that.cos_table_data[i].substitute_for]=[0,0],0==that.cos_table_data[i].purchases?signs[that.cos_table_data[i].substitute_for][0]++:signs[that.cos_table_data[i].substitute_for][1]++);for(var key in dict)if(dict.hasOwnProperty(key))for(var i=0;i<dict[key].length;i++){var conv_val=void 0===primary_uod[key]?1:that.convert(dict[key][i].uod_id,primary_uod[key]);dict[key][i].item_cost=dict[key][i].item_cost/conv_val,dict[key][i].purchases=dict[key][i].purchases*conv_val,dict[key][i].sales=dict[key][i].sales*conv_val,dict[key][i].beg_oz=dict[key][i].beg_oz*conv_val,dict[key][i].awc=dict[key][i].awc*conv_val,dict[key][i].end_oz=dict[key][i].end_oz*conv_val,dict[key][i].theor_sales=dict[key][i].theor_sales*conv_val,dict[key][i].unit_variance=dict[key][i].unit_variance*conv_val}var total={};for(var key in dict)if(dict.hasOwnProperty(key)){total[key]=0;for(var i=0;i<dict[key].length;i++)total[key]+=Math.abs(dict[key][i].purchases)}for(var key in dict)if(dict.hasOwnProperty(key))if(0==signs[key][0]&&0!=signs[key][1])for(var i=0;i<dict[key].length;i++)dict[key][i].wauc=Math.abs(dict[key][i].purchases)/total[key]*dict[key][i].item_cost;else if(0!=signs[key][0]&&0!=signs[key][1])for(var i=0;i<dict[key].length;i++)dict[key][i].wauc=Math.abs(dict[key][i].purchases)/total[key]*dict[key][i].item_cost;else if(0!=signs[key][0]&&0==signs[key][1])for(var i=0;i<dict[key].length;i++)dict[key][i].wauc=1/signs[key][0]*dict[key][i].item_cost;var p_indx={},yo=[],deviation_percent=10;for(var key in dict)if(dict.hasOwnProperty(key)){for(var uc=0,pur=0,sales=0,beg=0,awc=0,end=0,ther=0,unit=0,i=0;i<dict[key].length;i++)if(null==dict[key][i].substitute_for){p_indx[key]=i;break}if(void 0===p_indx[key])for(var i=0;i<dict[key].length;i++){var inv_units_sold=dict[key][i].beg_oz+dict[key][i].purchases-dict[key][i].awc-dict[key][i].end_oz;dict[key][i].unit_variance,dict[key][i].red_alert=dict[key][i].unit_variance>inv_units_sold*(100+deviation_percent)/100||dict[key][i].unit_variance<inv_units_sold*(100-deviation_percent)/100,yo.push(dict[key][i])}else{for(var i=0;i<dict[key].length;i++)uc+=dict[key][i].wauc,pur+=dict[key][i].purchases,sales+=dict[key][i].sales,beg+=dict[key][i].beg_oz,awc+=dict[key][i].awc,end+=dict[key][i].end_oz,ther+=dict[key][i].theor_sales,unit+=dict[key][i].unit_variance;dict[key][p_indx[key]].wauc=uc,dict[key][p_indx[key]].purchases=pur,dict[key][p_indx[key]].sales=sales,dict[key][p_indx[key]].beg_oz=beg,dict[key][p_indx[key]].awc=awc,dict[key][p_indx[key]].end_oz=end,dict[key][p_indx[key]].theor_sales=ther,dict[key][p_indx[key]].unit_variance=unit,dict[key][p_indx[key]].cost_variance=unit*uc;var inv_units_sold=dict[key][p_indx[key]].beg_oz+dict[key][p_indx[key]].purchases-dict[key][p_indx[key]].awc-dict[key][p_indx[key]].end_oz;dict[key][p_indx[key]].unit_variance,dict[key][p_indx[key]].red_alert=dict[key][p_indx[key]].unit_variance>inv_units_sold*(100+deviation_percent)/100||dict[key][p_indx[key]].unit_variance<inv_units_sold*(100-deviation_percent)/100,yo.push(dict[key][p_indx[key]])}}that.cos_table_data=yo},that.loadCOS=function(){return that.disable_final_save="history"==that.end_date.src,that.start_date.audit_dates>that.end_date.audit_dates?void alertService.showError("Invalid date range!"):(swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),that.audit_dates_t.length<2?void swal.close():(that.loading=!0,that.blindMode="history"!=that.end_date.src&&5==that.user.user_type_id,void that.api.alcoholCostSummary({RestaurantId:that.restaurant_id.restaurant_id,start_date:that.start_date.audit_dates,end_date:that.end_date.audit_dates,category:"Food",inventory_type_id:1}).then(function(sum_res){sum_res||console.log("error getting the COS results"),swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),that.api.sku_table({RestaurantId:that.restaurant_id.restaurant_id,Category:"-- All --"==that.category?"%":that.category,start_date:that.start_date.audit_dates,end_date:that.end_date.audit_dates,inventory_type_id:1,sub_category:"-- All --"==that.subcategory?"%":that.subcategory}).then(function(res){if(res){that.loading=!1,that.var_total_cost=null,that.cos_table_data=res.data.data.sku_table,that.begin_date_available=!1,that.cos_table_data.length&&void 0!==that.cos_table_data[0].begin_date&&(that.begin_date_available=!0),that.preProcessCOS();var Variance=[["x"],["variance"]];"-- All --"==that.category&&(that.value_last_period=0,that.purchase_value=0,that.awc=0,that.value_this_period=0,that.target_cost=0);for(var i=0;i<that.cos_table_data.length;i++)"-- All --"==that.category&&(that.value_last_period+=that.cos_table_data[i].wauc*that.cos_table_data[i].beg_oz,that.purchase_value+=that.cos_table_data[i].wauc*that.cos_table_data[i].purchases,that.awc+=that.cos_table_data[i].wauc*that.cos_table_data[i].awc,that.value_this_period+=that.cos_table_data[i].wauc*that.cos_table_data[i].end_oz,that.target_cost+=that.cos_table_data[i].wauc*that.cos_table_data[i].sales),0!=that.cos_table_data[i].unit_variance&&(Variance[0].push(that.cos_table_data[i].item_name),Variance[1].push(that.cos_table_data[i].unit_variance)),that.var_total_cost+=that.cos_table_data[i].cost_variance;if(that.var_total_cost=Math.round(that.var_total_cost),"-- All --"==that.category){var cos_res=sum_res.data.data.cos[0];that.gross_sales=Math.round(cos_res.Gross_Sales,2),that.discounts=Math.round(cos_res.Discounts,2),that.total_sales=that.gross_sales+that.discounts,that.value_last_period=Math.round(that.value_last_period,2),that.last_type="Actual",that.purchase_value=Math.round(that.purchase_value,2),that.awc=Math.round(that.awc,2),that.value_this_period=Math.round(that.value_this_period,2),that.this_type="Actual",that.target_cost=Math.round(that.target_cost,2),that.value_used=that.value_last_period+that.purchase_value-that.awc-that.value_this_period,that.cost_percent=Math.round(that.value_used/that.total_sales*1e4)/100,that.target_cost_percent=Math.round(that.target_cost/that.total_sales*1e4)/100,that.os_percent_variance=Math.round(100*(that.cost_percent-that.target_cost_percent))/100}if(1==Variance[0].length)var Variance=[];c3.generate({bindto:"#uv-div1",size:{height:450},data:{x:"x",columns:Variance,type:"bar",empty:{label:{text:"No data found."}}},zoom:{enabled:!0,rescale:!0},axis:{rotated:!0,x:{type:"category"},y:{tick:{format:function(d){return parseFloat(Math.round(100*d)/100)}}}},legend:{show:!1}}).zoom([0,10])}swal.close()})})))},that.loadLocationsReport=function(){that.loading=!0,swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),that.api.locations_report({RestaurantId:that.restaurant_id.restaurant_id,Category:"-- All --"==that.category?"%":that.category,start_date:that.start_date.audit_dates,end_date:that.end_date.audit_dates,inventory_type_id:1,sub_category:"-- All --"==that.subcategory?"%":that.subcategory}).then(function(res){void 0!==res.data.data.locationsReport.cos_data&&"undefined"!=res.data.data.locationsReport.locations&&(that.l_start_date=that.start_date.audit_dates,that.l_end_date=that.end_date.audit_dates,that.l_cos_data=res.data.data.locationsReport.cos_data,that.locations=res.data.data.locationsReport.locations),that.loading=!1,swal.close()})},that.loadTrendReport=function(){that.loading=!0,swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),that.api.audit_trend_report({RestaurantId:that.restaurant_id.restaurant_id,Category:"-- All --"==that.category?"%":that.category,sub_category:"-- All --"==that.subcategory?"%":that.subcategory,inventory_type_id:1}).then(function(res){res&&(that.trend_data=res.data.data.auditTrendReport.trend_data,that.trend_dates=res.data.data.auditTrendReport.audit_dates.reverse()),that.loading=!1,swal.close()})},that.getsubcats=function(){if(that.temp_subcats=[],"-- All --"!=that.category)for(var i=0;i<that.subcats.length;i++)that.subcats[i].parent_cat==that.category&&that.temp_subcats.push({name:that.subcats[i].sub_category});that.temp_subcats.unshift({name:"-- All --"}),that.temp_subcats.length>0&&(that.subcategory=that.temp_subcats[0].name)},that.changeMode=function(mode){that.mode!=mode&&(that.mode=mode,"review"!=that.mode?"trend"==that.mode?that.loadTrendReport():that.loadCOS():that.loadLocationsReport())},this.exportReport=function(type){"details"==type?this.downloadDetails():"review"==type?this.downloadReview():"trend"==type&&this.downloadTrend()},this.downloadDetails=function(){that.export_loading=!0;const getData=[];this.cos_table_data.forEach(function(data){getData.push({Category:data.category,SKU:data.vendor_sku.replace(/[,'#]/g," "),Item:data.item_name.replace(/[,'#]/g," "),UnitCost:data.wauc,BeginningInv:data.beg_oz,Purchases:data.purchases,PrepdItemsAdj:data.awc,EndingInv:data.end_oz,InvUnitsSold:data.theor_sales,POSUnitsSold:data.sales,UnitVariance:data.unit_variance,CostVariance:data.cost_variance})});const headers=["Category","SKU","Item","UnitCost","BeginningInv","Purchases","PrepdItemsAdj","EndingInv","InvUnitsSold","POSUnitsSold","UnitVariance","CostVariance"];var csv=headers.join(",")+"\r\n";getData.forEach(function(row){const values=headers.map(function(header){return row[header]});csv+=values.join(",")+"\r\n"});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="Cost of Sales Summary.csv",hiddenElement.click(),that.export_loading=!1},this.downloadReview=function(){that.export_loading=!0;const getData=[];that.l_cos_data.forEach(function(data){var l_obj={};l_obj.Item=data.item_name,l_obj.Variance=data.unit_variance,that.locations.forEach(function(ldata){l_obj[ldata.location_name+"_"+that.l_start_date]=data[ldata.sr_no].beg,l_obj[ldata.location_name+"_"+that.l_end_date]=data[ldata.sr_no].end}),l_obj["Unassigned_"+that.l_start_date]=data[-1].beg,l_obj["Unassigned_"+that.l_end_date]=data[-1].end,getData.push(l_obj)});const headers=["Item"];that.locations.forEach(function(data){headers.push(data.location_name+"_"+that.l_start_date),headers.push(data.location_name+"_"+that.l_end_date)}),headers.push("Unassigned_"+that.l_start_date),headers.push("Unassigned_"+that.l_end_date),headers.push("Variance");var csv=headers.join(",")+"\r\n";getData.forEach(function(row){const values=headers.map(function(header){return row[header]});csv+=values.join(",")+"\r\n"});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="Cost of Sales Review.csv",hiddenElement.click(),that.export_loading=!1},this.downloadTrend=function(){that.export_loading=!0;const getData=[];that.trend_data.sort(function(a,b){return a.item_name>b.item_name?1:b.item_name>a.item_name?-1:0}),that.trend_data.forEach(function(data){var d_obj={SKU:data.vendor_sku.replace(/[,'#]/g," "),ItemName:data.item_name.replace(/[,'#]/g," ")},indx=0;for(var td in that.trend_dates)d_obj[that.trend_dates[td].audit_dates.substring(0,10)]=data.variances[indx++];getData.push(d_obj)})
;var headers=["SKU","ItemName"];headers=headers.concat(that.trend_dates.map(function(x){return x.audit_dates.substring(0,10)}));var csv=headers.join(",")+"\r\n";getData.forEach(function(row){const values=headers.map(function(header){return row[header]});csv+=values.join(",")+"\r\n"});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="Cost of Sales Trend.csv",hiddenElement.click(),that.export_loading=!1},this.checkEndDate=function(){1==that.end_date.is_suggested?that.end_date_is_suggested=!0:that.end_date_is_suggested=!1},that.$onInit=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),that.checkEmpType(),that.core.getRefbooks().then(function(res){that.subcats=res.vendor_sub_cat,that.api.get_active_SKU_categories({inventory_type_id:1}).then(function(res){that.SKU_categories=res.data.data.categories,that.SKU_categories.length&&(that.SKU_categories.unshift({category:"-- All --"}),that.category=that.SKU_categories[0].category,that.mode="summary",that.getsubcats(),that.createConversionTable(),that.api.get_audit_dates({RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:1}).then(function(res1){that.audit_dates_f=res1.data.data.Report.map(function(x){return{aud_title:x.audit_dates.substring(0,10)+" ("+x.type+" by "+x.audited_by_org+")",audit_dates:x.audit_dates.substring(0,10),src:x.src,type:x.type,is_suggested:x.is_suggested}});var draft_present=!1,draft_indx=null;for(var af in that.audit_dates_f)if("draft"==that.audit_dates_f[af].src){draft_present=!0,draft_indx=af;break}if(draft_present&&null!=draft_indx)for(var af in that.audit_dates_f)if(af!=draft_indx&&that.audit_dates_f[af].audit_dates==that.audit_dates_f[draft_indx].audit_dates){that.audit_dates_f.splice(af,1);break}that.audit_dates_t=JSON.parse(JSON.stringify(that.audit_dates_f)),that.audit_dates_f.splice(0,1),that.audit_dates_f.length||(that.audit_dates_f=that.audit_dates_t),that.start_date=that.audit_dates_f[0],that.end_date=that.audit_dates_t[0],that.checkEndDate(),that.loadCOS(),that.export_loading=!1}))})})}}var modalController=function($uibModalInstance,alertService,SweetAlert,is_send_email,start_dates){var that=this;that.pg_no=1,that.user_response={},that.audit_type="",that.is_send_email=is_send_email,that.audit_dates_f=start_dates,that.start_date_compare=null,that.additional_notes=null,that.q_title="Select Type",that.q_texts='<article style="display: block;"><p>How do you want to save this audit?</p></article>',that.q_additional_texts="",that.set_page_no=function(dir){that.start_date_compare=null,"back"==dir&&that.pg_no--,1==that.pg_no?(that.q_title="Select Type",that.q_texts='<article style="display: block;"><p>How do you want to save this audit?</p></article>'):2==that.pg_no&&that.set_audit_type(that.audit_type)},that.set_audit_type=function(a_type){that.audit_type=a_type,that.pg_no=2,that.q_title="Final Save "+that.audit_type+"?","full"==that.audit_type?that.q_texts='<article style="display: block;"><p>This will permanently update your on-hand count as of today. <b>Any items that were not counted will be saved as 0.</b> You can choose either to only Save the audit but not send the email report or do both.</p></article>':"adjustment"==that.audit_type?that.q_texts='<article style="display: block;"><p>This will permanently update your on-hand count as of today. <b>Any items that were not counted will not be saved.</b> You can choose either to only Save the audit but not send the email report or do both.</p></article>':"purchase audit"==that.audit_type&&(that.q_texts='<article style="display: block;"><p>This will permanently update your on-hand count as of today. <b>Any items that were not counted will not be saved.</b> A purchase audit report will be emailed to you soon.</p></article>')},that.set_email_value=function(val){if(0==val)that.is_send_email=val,that.save();else if(2==that.pg_no)that.pg_no=3,"full"==that.audit_type&&(that.q_texts='<article style="display: block;"><p>Please select the date of the previous audit to generate the Cost of Sales report.</p></article>'),3==that.pg_no&&(that.q_additional_texts='<article style="display: block;"><br><p>Enter any additional notes you would like to be included in the report.</p></article>');else{if("full"==that.audit_type&&null==that.start_date_compare)return void alertService.showError("Please select a date!");"full"==that.audit_type&&"full"!=that.start_date_compare.type?SweetAlert.swal({title:"Error!",text:"The previous count needs to be a full audit.",type:"warning",confirmButtonColor:"#ed5565",confirmButtonText:"OK"},function(res){that.start_date_compare=null}):(that.is_send_email=val,null==that.start_date_compare&&(that.start_date_compare=that.audit_dates_f[0]),that.save())}},that.save=function(){$uibModalInstance.close({audit_type:that.audit_type,is_send_email:that.is_send_email,prev_audit_date:that.start_date_compare,additional_notes:that.additional_notes})},that.cancel=function(){$uibModalInstance.dismiss("cancel")}};foodCostOfSummaryController.$inject=["api","$state","auth","core","alertService","SweetAlert","$q","localStorageService","$uibModal","restaurant","$rootScope","$scope"],angular.module("inspinia").component("foodCostOfSummaryComponent",{templateUrl:"js/components/reports/foodCostOfSummary/foodCostOfSummary.html",controller:foodCostOfSummaryController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("reports.foodCostOfSummary",{url:"/food-cost-of-summary",template:"<food-cost-of-summary-component></food-cost-of-summary-component>",data:{pageTitle:"food cost of summary"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]},{serie:!0,files:["css/plugins/c3/c3.min.css","js/plugins/d3/d3.min.js","js/plugins/c3/c3.min.js"]},{serie:!0,name:"gridshore.c3js.chart",files:["js/plugins/c3/c3-angular.min.js"]}])}}})})}(),function(){"use strict";function foodDetailController(api,$state,$filter,auth,core,localStorageService,restaurant,$rootScope,$scope){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;that.api=api,that.restaurant_id=localStorageService.get("restaurant_id"),$scope.spa=1,$scope.seoption=[{id:1,name:"Last Week"},{id:2,name:"This Week"},{id:3,name:"Next Week"}],$scope.sns_data={},$scope.loadTable=function(){that.api.sales_and_spendings({RestaurantId:that.restaurant_id.restaurant_id}).then(function(res){var qres=res.data.data.MyJson;$scope.sns_data={Food:{Last_week:{actual_sales:0,actual_purchases:0,predicted_sales:0,suggested:0},This_week:{actual_sales:0,actual_purchases:0,predicted_sales:0,suggested:0},Next_week:{predicted_sales:0,suggested:0}}};for(var i=0;i<qres.length;i++)"Food"==qres[i].type&&($scope.sns_data.Food[qres[i].week_label].actual_sales=Math.round(qres[i].actual_sales),$scope.sns_data.Food[qres[i].week_label].actual_purchases=Math.round(qres[i].actual_purchases),$scope.sns_data.Food[qres[i].week_label].predicted_sales=Math.round(qres[i].predicted_sales),$scope.sns_data.Food[qres[i].week_label].suggested=Math.round(qres[i].suggested))})},$scope.loadTable(),$scope.more_loading=!0,$scope.loadSummaryItemsTable=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),$scope.show_food_more=!0,$scope.summary_items_data=[],that.api.dashboard_summary_items({inventory_type_id:1}).then(function(res){$scope.subscription_type_id=restaurant.data.info.subscription_type_id,swal.close();for(var i=0;i<5;i++)$scope.summary_items_data.push({suggested:res.data.data.dashboardSummaryItems.suggested[i],missing_recipes:res.data.data.dashboardSummaryItems.missing_recipes[i]});$scope.more_loading=!1})},$scope.loadSummaryItemsTable(),$scope.more_navigation=function(go_to){"missing_recipes"==go_to?$state.go("foodSetup.menu"):"high_risk"==go_to?$state.go("reports.foodCostOfSummary"):"suggested"==go_to&&$state.go("food.newFoodOrder")}}foodDetailController.$inject=["api","$state","$filter","auth","core","localStorageService","restaurant","$rootScope","$scope"],angular.module("inspinia").component("foodDetailComponent",{templateUrl:"js/components/reports/foodDetail/foodDetail.html",controller:foodDetailController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("reports.food.foodDetail",{url:"/food-detail",template:"<food-detail-component></food-detail-component>",data:{pageTitle:"Food Detail"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]},{serie:!0,files:["css/plugins/c3/c3.min.css","js/plugins/d3/d3.min.js","js/plugins/c3/c3.min.js"]},{serie:!0,name:"gridshore.c3js.chart",files:["js/plugins/c3/c3-angular.min.js"]}])}}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("reports.food.inventoryUsage",{url:"/inventory-usage",template:"<inventory-usage></inventory-usage>",data:{pageTitle:"Inventory Usage"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/moment/moment.min.js"]},{name:"datePicker",files:["css/plugins/datapicker/angular-datapicker.css","js/plugins/datapicker/angular-datepicker.js"]}])}}})})}(),function(){"use strict";function foodOnHandController(api,$scope,$state,auth,localStorageService,restaurant,$rootScope){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.api=api,that.auth=auth,this.mydate=new Date,that.items=[],that.category="",that.total_OH_value=0,$rootScope.$on("restaurantSelected",function(){that.pos_id=$state.params.pos_id||restaurant.data.info.pos_id,that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.preProcessOH=function(){that.total_OH_value=0;for(var i=0;i<that.oh_table_data.length;i++)that.total_OH_value+=that.oh_table_data[i].OH_value,that.oh_table_data[i].total_uod_on_hand<0?(that.oh_table_data[i].cases_on_hand="UR",that.oh_table_data[i].packs_on_hand="UR",that.oh_table_data[i].units_on_hand="UR",that.oh_table_data[i].total_uod_on_hand="UR",that.oh_table_data[i].OH_value="UR"):(that.oh_table_data[i].OH_value<0&&(that.oh_table_data[i].OH_value=that.oh_table_data[i].total_uod_on_hand*that.oh_table_data[i].unit_cost),that.oh_table_data[i].cases_on_hand=Math.floor(that.oh_table_data[i].total_uod_on_hand/(that.oh_table_data[i].pack*that.oh_table_data[i].size)),that.oh_table_data[i].packs_on_hand=Math.floor((that.oh_table_data[i].total_uod_on_hand-that.oh_table_data[i].cases_on_hand*that.oh_table_data[i].pack*that.oh_table_data[i].size)/that.oh_table_data[i].size),that.oh_table_data[i].units_on_hand=Math.round(100*(that.oh_table_data[i].total_uod_on_hand-that.oh_table_data[i].cases_on_hand*that.oh_table_data[i].pack*that.oh_table_data[i].size-that.oh_table_data[i].packs_on_hand*that.oh_table_data[i].size))/100);that.items=that.oh_table_data},this.downloadCSV=function(){const getData=[];that.export_loading=!0,this.oh_table_data.forEach(function(data){getData.push({Category:data.category,Vendor:data.vendor_name.replace(/[,'#]/g," "),SKU:data.vendor_sku.replace(/[,'#]/g," "),ItemDescription:data.item_name.replace(/[,'#]/g," "),CasesOnHand:data.cases_on_hand,PacksOnHand:data.packs_on_hand,UnitsOnHand:data.units_on_hand,TotalOnHand:data.total_uod_on_hand,DeliveryUnit:data.uod,UnitCost:data.unit_cost,OnHandValue:data.OH_value,UsedInRecipe:data.used_in_recipe})});const headers=["Category","Vendor","SKU","ItemDescription","CasesOnHand","PacksOnHand","UnitsOnHand","TotalOnHand","DeliveryUnit","UnitCost","OnHandValue","UsedInRecipe"];var csv=headers.join(",")+"\r\n";getData.forEach(function(row){const values=headers.map(function(header){return row[header]});csv+=values.join(",")+"\r\n"});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="On-Hand Report.csv",hiddenElement.click(),that.export_loading=!1},that.loadOH=function(){that.loading=!0,swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),that.api.food_OH({RestaurantId:that.restaurant_id.restaurant_id,Category:"--All--"==that.category?"%":that.category,caller:"oh_report"}).then(function(res){res&&(that.category_label=that.category,that.oh_table_data=res.data.data.Report,that.preProcessOH()),that.loading=!1,swal.close()})},that.$onInit=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),that.api.get_active_SKU_categories({inventory_type_id:1}).then(function(res){that.SKU_categories=res.data.data.categories,that.SKU_categories.length&&(that.SKU_categories.unshift({category:"--All--"}),that.category=that.SKU_categories[0].category,that.loadOH(),that.export_loading=!1)})}}foodOnHandController.$inject=["api","$scope","$state","auth","localStorageService","restaurant","$rootScope"],angular.module("inspinia").component("foodOnHandComponent",{templateUrl:"js/components/reports/foodOnHand/foodOnHand.html",controller:foodOnHandController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("reports.foodOnHand",{url:"/food-on-hand",template:"<food-on-hand-component></food-on-hand-component>",data:{pageTitle:"On Hand Status"}})})}(),function(){"use strict";function foodSalesReportController(api,$scope,$state,auth,core,localStorageService,restaurant,$rootScope){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.api=api,that.auth=auth,that.start_date=new Date,that.start_date.setDate(that.start_date.getDate()-1),that.end_date=new Date,that.sales={Food:0,Total:0},$rootScope.$on("restaurantSelected",function(){that.pos_id=$state.params.pos_id||restaurant.data.info.pos_id,that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");var from_date=new Date;from_date.setDate(from_date.getDate()-1),that.start_date=from_date,that.end_date=new Date,that.loadLateralChart=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1,timer:2e4});var dayfd=that.start_date.getDate(),monthfd=that.start_date.getMonth()+1,fd=that.start_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1,td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd;that.api.lateral_chart_api({From:fd,To:td,RestaurantId:that.restaurant_id.restaurant_id,Category:"Food",inventory_type_id:1}).then(function(res){that.loading=!1;var LateralChart=res.data.data.Lateral;that.sales_table_data=[];for(var l=1;l<LateralChart[0].length;l++)that.sales_table_data.push({item_name:LateralChart[0][l],units_sold:LateralChart[1][l]});c3.generate({bindto:"#sales",size:{height:500},data:{x:"x",columns:LateralChart,type:"bar",empty:{label:{text:"No data found."}}},zoom:{enabled:!0},axis:{rotated:!0,x:{type:"category"},y:{tick:{format:function(d){return parseFloat(Math.round(100*d)/100)}}}},legend:{show:!1}}).zoom([0,10]),swal.close()})},that.loadPMIXWeeklyData=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1,timer:2e4}),that.loading=!0,that.api.pmix({RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:1,category:"-- All --"==that.category?"All":"Food, Lunch & Dinner"==that.category?"Food":that.category,mode:"weekly"}).then(function(res){that.loading=!1,that.pmix_data=res.data.data.pMIX,that.pmix_weekly_start=that.pmix_data[0].pmix_weekly_start,that.pmix_weekly_end=that.pmix_data[0].pmix_weekly_end,swal.close()})},that.loadPMIXTrendData=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1,timer:2e4}),that.loading=!0,that.api.pmix({RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:1,category:"-- All --"==that.category?"All":"Food, Lunch & Dinner"==that.category?"Food":that.category,mode:"trend"}).then(function(res){that.loading=!1,that.pmix_data=res.data.data.pMIX,that.pmix_trend_start=that.pmix_data[0].pmix_trend_start,that.pmix_trend_end=that.pmix_data[0].pmix_trend_end,swal.close()})},that.loadDailySalesData=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1,timer:2e4}),that.loading=!0,that.daily_sales_data=[],that.daily_sales_row_header=that.daily_sales_mode.name,that.api.sales_current_to_last_period_report({RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:1,mode:that.daily_sales_mode.mode}).then(function(res){that.loading=!1,that.daily_sales_data=res.data.data.salesCurrentToLastPeriodReport,that.previous_year_label=that.daily_sales_data.previous_year,that.current_year_label=that.daily_sales_data.current_year,delete that.daily_sales_data.previous_year,delete that.daily_sales_data.current_year,that.daily_sales_data_keys=Object.keys(that.daily_sales_data),swal.close()})},that.SalesSummary=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1,timer:2e4});var dayfd=that.start_date.getDate(),monthfd=that.start_date.getMonth()+1,fd=that.start_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1,td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd;that.api.salesSummary({From:fd,To:td,RestaurantId:that.restaurant_id.restaurant_id,Category:"Food"}).then(function(res){if(res){that.sales={Food:0,Total:0};for(var sales_total=0,i=0;i<res.data.data.salesSummary.length;i++)"Food"==res.data.data.salesSummary[i].category&&(that.sales.Food=res.data.data.salesSummary[i].sales,sales_total+=res.data.data.salesSummary[i].sales);that.sales.Total=sales_total}swal.close()})},this.exportReport=function(type){"details"==type?this.downloadDetails():"pmix_weekly"==type||"pmix_trend"==type?this.downloadPMIX():"daily"==type&&this.downloadDailySales()},this.downloadDetails=function(){that.export_loading=!0;const getData=[];this.sales_table_data.forEach(function(data){getData.push({Category:"Food",Item:data.item_name.replace(/[,'#]/g," "),UnitsSold:data.units_sold})});const headers=["Category","Item","UnitsSold"];var csv=headers.join(",")+"\r\n";getData.forEach(function(row){const values=headers.map(function(header){return row[header]});csv+=values.join(",")+"\r\n"});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="Sales Report.csv",hiddenElement.click(),that.export_loading=!1},this.downloadPMIX=function(){that.export_loading=!0;const getData=that.pmix_data;var fd,td;"pmix_weekly"==that.mode?(fd=that.pmix_weekly_start.substring(0,10),td=that.pmix_weekly_end.substring(0,10)):"pmix_trend"==that.mode&&(fd=that.pmix_trend_start.substring(0,10),td=that.pmix_trend_end.substring(0,10));var headers=[];"pmix_weekly"==that.mode?headers=["DateFrom","DateTo","Category","MenuItem","PricingLevel","TotalWeekly$Sales","TotalWeekly$Cost","Gross$Profit","LastWeekUnitsSold","13WeekAvgUnitsSold","Variance","LastWeek%OfSales"]:"pmix_trend"==that.mode&&(headers=["DateFrom","DateTo","Category","MenuItem","PricingLevel","Week1UnitsSold","Week2UnitsSold","Week3UnitsSold","Week4UnitsSold","Week5UnitsSold","Week6UnitsSold","Week7UnitsSold","Week8UnitsSold","Week9UnitsSold","Trend"]);var csv=headers.join(",")+"\r\n";getData.forEach(function(row){var pmix_obj={};"pmix_weekly"==that.mode?(pmix_obj.DateFrom=fd,pmix_obj.DateTo=td,pmix_obj.Category=row.category,pmix_obj.MenuItem=row.name,pmix_obj.PricingLevel=row.price_number,pmix_obj.TotalWeekly$Sales=row.sales,pmix_obj.TotalWeekly$Cost=row.cost,pmix_obj.Gross$Profit=row.sales-row.cost,pmix_obj.LastWeekUnitsSold=row.units_sold,pmix_obj["13WeekAvgUnitsSold"]=row.units_sold_avg_13_weeks,pmix_obj.Variance=row.units_sold-row.units_sold_avg_13_weeks,pmix_obj["LastWeek%OfSales"]=row.percent_of_sales):"pmix_trend"==that.mode&&(pmix_obj.DateFrom=fd,pmix_obj.DateTo=td,pmix_obj.Category=row.category,pmix_obj.MenuItem=row.name,pmix_obj.PricingLevel=row.price_number,pmix_obj.Week1UnitsSold=row.week_1,pmix_obj.Week2UnitsSold=row.week_2,pmix_obj.Week3UnitsSold=row.week_3,pmix_obj.Week4UnitsSold=row.week_4,pmix_obj.Week5UnitsSold=row.week_5,pmix_obj.Week6UnitsSold=row.week_6,pmix_obj.Week7UnitsSold=row.week_7,pmix_obj.Week8UnitsSold=row.week_8,pmix_obj.Week9UnitsSold=row.week_9,pmix_obj.Trend=row.trend);const values=headers.map(function(header){return pmix_obj[header]});csv+=values.join(",")+"\r\n"});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="PMIX "+("pmix_weekly"==that.mode?"Weekly":"Trend")+" Report.csv",hiddenElement.click(),that.export_loading=!1},this.downloadDailySales=function(){that.export_loading=!0;var headers=["Period","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday","Total"],csv=headers.join(",")+"\r\n",values=[];that.daily_sales_data_keys.forEach(function(key){var ds_obj={};ds_obj.Period=that.previous_year_label+" "+key+" "+that.daily_sales_row_header,ds_obj.Monday=that.daily_sales_data[key].previous[0],ds_obj.Tuesday=that.daily_sales_data[key].previous[1],ds_obj.Wednesday=that.daily_sales_data[key].previous[2],ds_obj.Thursday=that.daily_sales_data[key].previous[3],ds_obj.Friday=that.daily_sales_data[key].previous[4],ds_obj.Saturday=that.daily_sales_data[key].previous[5],ds_obj.Sunday=that.daily_sales_data[key].previous[6],ds_obj.Total=that.daily_sales_data[key].previous[7],values=headers.map(function(header){return ds_obj[header]}),csv+=values.join(",")+"\r\n","highest"==that.daily_sales_mode.mode&&(ds_obj.Period="Date of "+that.daily_sales_row_header,ds_obj.Monday=that.daily_sales_data[key].previous_highest_date[0],ds_obj.Tuesday=that.daily_sales_data[key].previous_highest_date[1],ds_obj.Wednesday=that.daily_sales_data[key].previous_highest_date[2],ds_obj.Thursday=that.daily_sales_data[key].previous_highest_date[3],ds_obj.Friday=that.daily_sales_data[key].previous_highest_date[4],ds_obj.Saturday=that.daily_sales_data[key].previous_highest_date[5],ds_obj.Sunday=that.daily_sales_data[key].previous_highest_date[6],ds_obj.Total=that.daily_sales_data[key].previous_highest_date[7],values=headers.map(function(header){return ds_obj[header]}),csv+=values.join(",")+"\r\n"),ds_obj.Period=that.current_year_label+" "+key+" "+that.daily_sales_row_header,ds_obj.Monday=that.daily_sales_data[key].current[0],ds_obj.Tuesday=that.daily_sales_data[key].current[1],ds_obj.Wednesday=that.daily_sales_data[key].current[2],ds_obj.Thursday=that.daily_sales_data[key].current[3],ds_obj.Friday=that.daily_sales_data[key].current[4],ds_obj.Saturday=that.daily_sales_data[key].current[5],ds_obj.Sunday=that.daily_sales_data[key].current[6],ds_obj.Total=that.daily_sales_data[key].current[7],values=headers.map(function(header){return ds_obj[header]}),csv+=values.join(",")+"\r\n","highest"==that.daily_sales_mode.mode&&(ds_obj.Period="Date of "+that.daily_sales_row_header,ds_obj.Monday=that.daily_sales_data[key].current_highest_date[0],ds_obj.Tuesday=that.daily_sales_data[key].current_highest_date[1],ds_obj.Wednesday=that.daily_sales_data[key].current_highest_date[2],ds_obj.Thursday=that.daily_sales_data[key].current_highest_date[3],ds_obj.Friday=that.daily_sales_data[key].current_highest_date[4],ds_obj.Saturday=that.daily_sales_data[key].current_highest_date[5],ds_obj.Sunday=that.daily_sales_data[key].current_highest_date[6],ds_obj.Total=that.daily_sales_data[key].current_highest_date[7],values=headers.map(function(header){return ds_obj[header]}),csv+=values.join(",")+"\r\n"),"total"!=that.daily_sales_mode.mode&&"avg"!=that.daily_sales_mode.mode||(ds_obj.Period="Difference",ds_obj.Monday=that.daily_sales_data[key].current[0]-that.daily_sales_data[key].previous[0],ds_obj.Tuesday=that.daily_sales_data[key].current[1]-that.daily_sales_data[key].previous[1],ds_obj.Wednesday=that.daily_sales_data[key].current[2]-that.daily_sales_data[key].previous[2],ds_obj.Thursday=that.daily_sales_data[key].current[3]-that.daily_sales_data[key].previous[3],ds_obj.Friday=that.daily_sales_data[key].current[4]-that.daily_sales_data[key].previous[4],ds_obj.Saturday=that.daily_sales_data[key].current[5]-that.daily_sales_data[key].previous[5],ds_obj.Sunday=that.daily_sales_data[key].current[6]-that.daily_sales_data[key].previous[6],ds_obj.Total=that.daily_sales_data[key].current[7]-that.daily_sales_data[key].previous[7],values=headers.map(function(header){return ds_obj[header]}),csv+=values.join(",")+"\r\n",ds_obj.Period="Change",ds_obj.Monday=Math.round((that.daily_sales_data[key].current[0]-that.daily_sales_data[key].previous[0])/that.daily_sales_data[key].previous[0]*1e4)/100+"%",ds_obj.Tuesday=Math.round((that.daily_sales_data[key].current[1]-that.daily_sales_data[key].previous[1])/that.daily_sales_data[key].previous[1]*1e4)/100+"%",ds_obj.Wednesday=Math.round((that.daily_sales_data[key].current[2]-that.daily_sales_data[key].previous[2])/that.daily_sales_data[key].previous[2]*1e4)/100+"%",ds_obj.Thursday=Math.round((that.daily_sales_data[key].current[3]-that.daily_sales_data[key].previous[3])/that.daily_sales_data[key].previous[3]*1e4)/100+"%",ds_obj.Friday=Math.round((that.daily_sales_data[key].current[4]-that.daily_sales_data[key].previous[4])/that.daily_sales_data[key].previous[4]*1e4)/100+"%",ds_obj.Saturday=Math.round((that.daily_sales_data[key].current[5]-that.daily_sales_data[key].previous[5])/that.daily_sales_data[key].previous[5]*1e4)/100+"%",ds_obj.Sunday=Math.round((that.daily_sales_data[key].current[6]-that.daily_sales_data[key].previous[6])/that.daily_sales_data[key].previous[6]*1e4)/100+"%",ds_obj.Total=Math.round((that.daily_sales_data[key].current[7]-that.daily_sales_data[key].previous[7])/that.daily_sales_data[key].previous[7]*1e4)/100+"%",values=headers.map(function(header){return ds_obj[header]}),csv+=values.join(",")+"\r\n"),"highest"==that.daily_sales_mode.mode&&(ds_obj.Period=that.previous_year_label+" "+key+"  Zero Sales Days",ds_obj.Monday=that.daily_sales_data[key].previous_zero_days[0],ds_obj.Tuesday=that.daily_sales_data[key].previous_zero_days[1],ds_obj.Wednesday=that.daily_sales_data[key].previous_zero_days[2],ds_obj.Thursday=that.daily_sales_data[key].previous_zero_days[3],ds_obj.Friday=that.daily_sales_data[key].previous_zero_days[4],ds_obj.Saturday=that.daily_sales_data[key].previous_zero_days[5],ds_obj.Sunday=that.daily_sales_data[key].previous_zero_days[6],ds_obj.Total=that.daily_sales_data[key].previous_zero_days[7],values=headers.map(function(header){return ds_obj[header]}),csv+=values.join(",")+"\r\n",ds_obj.Period=that.current_year_label+" "+key+"  Zero Sales Days",ds_obj.Monday=that.daily_sales_data[key].current_zero_days[0],ds_obj.Tuesday=that.daily_sales_data[key].current_zero_days[1],ds_obj.Wednesday=that.daily_sales_data[key].current_zero_days[2],ds_obj.Thursday=that.daily_sales_data[key].current_zero_days[3],ds_obj.Friday=that.daily_sales_data[key].current_zero_days[4],ds_obj.Saturday=that.daily_sales_data[key].current_zero_days[5],ds_obj.Sunday=that.daily_sales_data[key].current_zero_days[6],ds_obj.Total=that.daily_sales_data[key].current_zero_days[7],values=headers.map(function(header){return ds_obj[header]}),csv+=values.join(",")+"\r\n"),ds_obj.Period="",ds_obj.Monday="",ds_obj.Tuesday="",ds_obj.Wednesday="",ds_obj.Thursday="",ds_obj.Friday="",ds_obj.Saturday="",ds_obj.Sunday="",ds_obj.Total="",values=headers.map(function(header){return ds_obj[header]}),csv+=values.join(",")+"\r\n"});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="Daily_Sales "+("total"==that.daily_sales_mode.mode?"Total":"avg"==that.daily_sales_mode.mode?"Average":"Highest Sales")+" Report.csv",hiddenElement.click(),that.export_loading=!1},that.loadSalesData=function(){that.loading=!0,that.SalesSummary(),that.loadLateralChart()},that.loadPMIXData=function(){that.loading=!0,"pmix_weekly"==that.mode?that.loadPMIXWeeklyData():"pmix_trend"==that.mode&&that.loadPMIXTrendData()},that.changeMode=function(mode){that.mode!=mode&&(that.mode=mode,"summary"==that.mode?that.loadSalesData():"details"==that.mode?that.loadLateralChart():"pmix_weekly"==that.mode?that.loadPMIXWeeklyData():"pmix_trend"==that.mode?that.loadPMIXTrendData():"daily"==that.mode&&(that.daily_sales_mode=that.daily_sales_modes_list[0],that.loadDailySalesData()))},that.$onInit=function(){that.categories=[],that.categories.unshift({category:"-- All --"}),that.categories.push({category:"Food, Lunch & Dinner"}),that.categories.push({category:"Other"}),that.category=that.categories[0].category,that.daily_sales_modes_list=[{mode:"total",name:"$ Sales"},{mode:"avg",name:"Running Average $ Sales"},{mode:"highest",name:"Highest $ Sales Day"}],that.mode="summary",that.loadSalesData(),that.export_loading=!1}}foodSalesReportController.$inject=["api","$scope","$state","auth","core","localStorageService","restaurant","$rootScope"],angular.module("inspinia").component("foodSalesReportComponent",{templateUrl:"js/components/reports/foodSalesReport/foodSalesReport.html",controller:foodSalesReportController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("reports.foodSalesReport",{url:"/food-sales-report",template:"<food-sales-report-component></food-sales-report-component>",data:{pageTitle:"Sales Report"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]},{serie:!0,files:["css/plugins/c3/c3.min.css","js/plugins/d3/d3.min.js","js/plugins/c3/c3.min.js"]},{serie:!0,name:"gridshore.c3js.chart",files:["js/plugins/c3/c3-angular.min.js"]}])}}})})}(),function(){"use strict";function foodUsageVsPurchaseController(api,$state,$filter,auth,core,localStorageService,restaurant,$uibModal,$rootScope,$scope){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.api=api,that.core=core,that.auth=auth,that.res_data=[],that.temp_cats=[],that.subcats=[],that.temp_subcats=[],that.temp_items=[],that.category=null,that.subcategory=null,that.item=null,that.start_date=new Date,that.start_date.setMonth(that.start_date.getMonth()-1),that.end_date=new Date,that.invoice_data=[],that.active_skus=[],that.invoice_items=[],$rootScope.$on("restaurantSelected",function(){that.pos_id=$state.params.pos_id||restaurant.data.info.pos_id,that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.sendWeeklyPDF=function(){$uibModal.open({templateUrl:"send_pdf.html",controller:modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr"})},
that.PurchasesVsUsage=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1,timer:2e4}),that.loading=!0;var dayfd=that.start_date.getDate(),monthfd=that.start_date.getMonth()+1,fd=that.start_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1,td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd;that.api.PurchaseVsUsage({From:fd,To:td,RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:1}).then(function(res){res&&(that.res_data=res.data.data.PurchaseVsUsage,that.changeSubCat(),that.update_bar_chart())})},that.changeCat=function(){-1!=that.category.id?(that.subcategories=that.all_subcategories.filter(function(x){return that.category.id==x.vendor_cat_id}),that.subcategories.unshift({id:-1,sub_category:"--All Subcategories--"}),that.subcategory=that.subcategories[0]):(that.subcategories=JSON.parse(JSON.stringify(that.all_subcategories)),that.subcategory={id:-1,sub_category:"--All Subcategories--"}),that.temp_items=["--All Items--"],that.item=that.temp_items[0]},that.changeSubCat=function(){-1!=that.subcategory.id?(that.temp_items=that.res_data.filter(function(x){return x.category==that.category.category&&x.sub_category==that.subcategory.sub_category}).map(function(x){return x.item_name}),that.temp_items.sort(),that.temp_items.unshift("--All Items--"),"--All Items--"!=that.item&&null!=that.item||(that.item=that.temp_items[0])):that.temp_items=that.res_data.map(function(x){return x.item_name})},that.update_bar_chart=function(){var columns=[["Usage"],["Purchases"]],categories=[];that.active_skus=[],-1!=that.category.id&&(that.res_data=that.res_data.filter(function(x){return x.category==that.category.category}),-1!=that.subcategory.id&&(that.res_data=that.res_data.filter(function(x){return x.sub_category==that.subcategory.sub_category}),"--All Items--"!=that.item&&(that.res_data=that.res_data.filter(function(x){return x.item_name==that.item})))),that.res_data.sort(function(a,b){return a.item_name>b.item_name?1:b.item_name>a.item_name?-1:0});for(var i=0;i<that.res_data.length;i++)categories.push(that.res_data[i].item_name),columns[0].push(that.res_data[i].units_sold),columns[1].push(that.res_data[i].units_purchased),that.active_skus.push(that.res_data[i].vendor_sku_id);c3.generate({bindto:"#PurchasesVsUsage",data:{columns:columns,type:"bar"},zoom:{enabled:!0,rescale:!0},axis:{x:{type:"category",categories:categories}},legend:{show:!0}}).zoom([0,10]),that.VendorTable()},that.VendorTable=function(){var dayfd=that.start_date.getDate(),monthfd=that.start_date.getMonth()+1,fd=that.start_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1,td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd;that.api.VendorDetail({From:fd,To:td,RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:1}).then(function(res){if(res){that.invoice_data=res.data.data.VendorDetail,that.invoice_items=[];for(var i=0;i<that.invoice_data.length;i++)for(var j=0;j<that.active_skus.length;j++)that.invoice_data[i].vendor_sku_id!=that.active_skus[j]&&that.invoice_data[i].substitute_for!=that.active_skus[j]||that.invoice_items.push(that.invoice_data[i])}that.loading=!1,swal.close()})},that.changeMode=function(mode){that.mode!=mode&&(that.mode=mode,that.PurchasesVsUsage())},this.downloadCSV=function(){that.export_loading=!0;const getData=[];this.invoice_items.forEach(function(data){var i_date=data.delivery_date.substr(0,10);i_date=i_date.split("-")[0]+"-"+i_date.split("-")[1]+"-"+i_date.split("-")[2],getData.push({Vendor:data.vendor_name.replace(/[,'#]/g," "),SKU:data.vendor_sku.replace(/[,'#]/g," "),ItemDescription:data.item_name.replace(/[,'#]/g," "),Invoice:data.invoice_number.replace(/[,'#]/g," "),DateReceived:i_date,QtyReceived:data.units_purchased,ItemPrice:data.item_cost,TotalCost:data.total_cost})});const headers=["Vendor","SKU","ItemDescription","Invoice","DateReceived","QtyReceived","ItemPrice","TotalCost"];var csv=headers.join(",")+"\r\n";getData.forEach(function(row){const values=headers.map(function(header){return row[header]});csv+=values.join(",")+"\r\n"});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="Usage-vs-Purchases Report.csv",hiddenElement.click(),that.export_loading=!1},that.$onInit=function(){Promise.all([api.get_vendors_categories({is_restaurant_used_only:1,inventory_type_id:1}),core.getRefbooks()]).then(function(response){that.categories=response[0].data.data.categories.filter(function(x){return"Non Alcoholic"!=x.category}),that.categories.unshift({id:-1,category:"--All Categories--",inventory_type_id:1}),that.category=that.categories[0];var cat_ids=that.categories.map(function(x){return x.id});that.all_subcategories=response[1].vendor_sub_cat.filter(function(x){return cat_ids.includes(x.vendor_cat_id)}),that.subcategories=JSON.parse(JSON.stringify(that.all_subcategories)),that.subcategory={id:-1,sub_category:"--All Subcategories--"},that.mode="summary",that.PurchasesVsUsage(),that.export_loading=!1})}}var modalController=function($uibModalInstance,api,alertService){var that=this;that.api=api,that.q_title="Send Report PDF",that.q_texts='<article style="display: block;"><p>Please select a Monday for start date and a Sunday for end date.</p></article>',that.start_date=new Date,that.end_date=new Date,that.select_start_date=function(){if(1!=that.start_date.getDay())return alertService.showError("Please select a Monday!"),void(that.start_date=new Date)},that.select_end_date=function(){if(0!=that.end_date.getDay())return alertService.showError("Please select a Sunday!"),void(that.end_date=new Date)},that.sendPDF=function(){if(that.start_date>=that.end_date)return alertService.showError("Please select a valid range!"),void(that.end_date=new Date);if(1!=that.start_date.getDay())return alertService.showError("Please select a Monday!"),void(that.start_date=new Date);if(0!=that.end_date.getDay())return alertService.showError("Please select a Sunday!"),void(that.end_date=new Date);var dayfd=that.start_date.getDate(),monthfd=that.start_date.getMonth()+1,fd=that.start_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1,td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd;that.api.food_on_hand_email({start_date:fd,end_date:td}).then(function(res){}),alertService.showSuccessText("Sent!","Please check your email"),$uibModalInstance.close()},that.cancel=function(){$uibModalInstance.dismiss("cancel")}};foodUsageVsPurchaseController.$inject=["api","$state","$filter","auth","core","localStorageService","restaurant","$uibModal","$rootScope","$scope"],angular.module("inspinia").component("foodUsageVsPurchaseComponent",{templateUrl:"js/components/reports/foodUsageVsPurchase/foodUsageVsPurchase.html",controller:foodUsageVsPurchaseController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("reports.foodUsageVsPurchase",{url:"/food-usage-vs-purchase",template:"<food-usage-vs-purchase-component></food-usage-vs-purchase-component>",data:{pageTitle:"Usage Vs Purchase"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]},{serie:!0,files:["css/plugins/c3/c3.min.css","js/plugins/d3/d3.min.js","js/plugins/c3/c3.min.js"]},{serie:!0,name:"gridshore.c3js.chart",files:["js/plugins/c3/c3-angular.min.js"]}])}}})})}(),function(){"use strict";function controller(api,$state,auth,localStorageService,restaurant,$rootScope,core,$filter){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.form={},that.api=api,that.auth=auth,that.core=core,that.data=[],that.totals={last_counted:0,purchased_this_period:0,counted_this_period:0,qty_used_this_period:0,pos_sales_this_period:0,over_this_period:0,cost_of_over_this_period:0},that.isFood=$state.includes("reports.food"),that.inventory_type_id=that.isFood?1:2,that.searchModel={date_from:new Date,date_to:new Date},that.searchModel.date_from=that.searchModel.date_from.setDate(that.searchModel.date_from.getDate()-7),$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.calculate=function(){var last_counted=0,purchased_this_period=0,counted_this_period=0,qty_used_this_period=0,pos_sales_this_period=0,over_this_period=0,cost_of_over_this_period=0;angular.forEach(that.data,function(v,k){console.log(v.pos_sales_this_period),last_counted+=parseFloat(v.last_counted)||0,purchased_this_period+=parseFloat(v.purchased_this_period)||0,counted_this_period+=parseFloat(v.counted_this_period)||0,qty_used_this_period+=parseFloat(v.qty_used_this_period)||0,pos_sales_this_period+=parseFloat(v.pos_sales_this_period)||0,over_this_period+=parseFloat(v.over_this_period)||0,cost_of_over_this_period+=parseFloat(v.cost_of_over_this_period)||0}),that.totals.last_counted=last_counted,that.totals.purchased_this_period=purchased_this_period,that.totals.counted_this_period=counted_this_period,that.totals.qty_used_this_period=qty_used_this_period,that.totals.pos_sales_this_period=pos_sales_this_period,that.totals.over_this_period=over_this_period,that.totals.cost_of_over_this_period=cost_of_over_this_period},that.search=function(form){var m={inventory_type_id:that.inventory_type_id,date_from:$filter("date")(new Date(that.searchModel.date_from),"yyyy-MM-dd"),date_to:$filter("date")(new Date(that.searchModel.date_to),"yyyy-MM-dd")};that.api.inventory_usage_report(m).then(function(res){that.data=res.data.data.inventory_usage_report,that.calculate()})},that.$onInit=function(){that.core.getRefbooks().then(function(res){that.refbooks=res,that.search(that.form)})}}controller.$inject=["api","$state","auth","localStorageService","restaurant","$rootScope","core","$filter"],angular.module("inspinia").component("inventoryUsage",{templateUrl:"js/components/reports/inventoryUsage/inventoryUsage.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";function menuItemsMappingController(api,$state,auth,localStorageService,restaurant,$rootScope,SweetAlert){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.base_api_url=appConfig.apiDomain,that.form={},that.api=api,that.auth=auth,that.items=[],that.posSyncList=[],that.menus=[],$rootScope.$on("restaurantSelected",function(){that.pos_id=$state.params.pos_id||restaurant.data.info.pos_id,that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.subscription_type_id=restaurant.data.info.subscription_type_id,that.employees_list=restaurant.data.info.employees;for(var i=0;that.employees_list.length>i;i++)that.employees_list[i].id==auth.authentication.user.id&&(that.emp_id=that.employees_list[i].type_ids);1==auth.authentication.user.id&&(that.emp_id=1),1==that.subscription_type_id||5==that.subscription_type_id?that.moveto_categories=["Alcohol","Alcohol_Mods","Other","Archived"]:2==that.subscription_type_id||6==that.subscription_type_id?that.moveto_categories=["Food","Food_Mods","Other","Archived"]:3!=that.subscription_type_id&&7!=that.subscription_type_id||(4==that.emp_id?that.moveto_categories=["Alcohol","Alcohol_Mods","Other","Archived"]:3==that.emp_id?that.moveto_categories=["Food","Food_Mods","Other","Archived"]:that.moveto_categories=["Alcohol","Alcohol_Mods","Food_Mods","Food","Other","Archived"]),that.current_moveto=[],that.searchModel={is_active:"1",category:that.moveto_categories[0],list_type:"sold_items",paginationCount:25,paginationOffset:0,total:0,isDisabledBtn:!0},that.getMenus=function(){"Alcohol"!=that.searchModel.category&&"Alcohol_Mods"!=that.searchModel.category&&"Food"!=that.searchModel.category&&"Food_Mods"!=that.searchModel.category||that.api.get_menus({update_price:!1,inventory_type_id:"Alcohol"==that.searchModel.category||"Alcohol_Mods"==that.searchModel.category?2:1}).then(function(res){that.menus=JSON.parse(JSON.stringify(res.data.data.menus_list)),that.menus.unshift({id:null,menu_item_name:"--Unmapped--",pricing_level:""})})},that.changeMoveTo=function(){that.current_moveto=[""];for(var i=0;i<that.moveto_categories.length;i++)that.moveto_categories[i]!=that.searchModel.category&&that.current_moveto.push(that.moveto_categories[i])},that.checkMoveRules=function(item){if(""!=item.moveto){var m={matched_items:[{id:item.id,src:that.searchModel.category,dest:item.moveto}]};that.api.change_mapping_category(that.restaurant_id.restaurant_id,m).then(function(res){res&&(0==res.data.report_items.action_id_stack[0].action_id?(SweetAlert.swal({title:"Item moved successfully!",timer:1e3,showConfirmButton:!1,type:"success"}),that.getItems(!1)):1==res.data.report_items.action_id_stack[0].action_id&&SweetAlert.swal({title:"Please unmap the item first!",timer:1e3,showConfirmButton:!1,type:"warning"}))})}},that.getItems=function(is_cat_change){that.changeMoveTo(),that.searchModel.inRequest=!0;var m={is_active:"Archived"==that.searchModel.category?0:that.searchModel.is_active,category:that.searchModel.category,list_type:that.searchModel.list_type,paginationOffset:that.searchModel.paginationOffset,paginationCount:that.searchModel.paginationCount};m.paginationOffset>0&&(m.paginationOffset=(m.paginationOffset-1)*m.paginationCount),that.api.getItemsForMap(that.restaurant_id.restaurant_id,m).then(function(res){that.items=res.data.data.report_items;for(var i=0;i<that.items.length;i++)that.items[i].moveto="";that.searchModel.total=res.data.data.total,is_cat_change&&that.getMenus()})},that.setMenuItemId=function(item,cat){var m={matched_items:[{id:item.id,name:item.name,focus_item_id:item.focus_item_id,menu_item_id:item.menu_item_id,is_active:item.is_active}]};that.api.setItemsForMap(that.restaurant_id.restaurant_id,m).then(function(res){res&&SweetAlert.swal({title:"Mapping saved successfully!",timer:500,showConfirmButton:!1,type:"success"})},that.getItems(!1))},that.unmapItem=function(item,cat){item.menu_item_id=null;var m={matched_items:[{id:item.id,name:item.name,focus_item_id:item.focus_item_id,menu_item_id:item.menu_item_id,is_active:item.is_active}]};that.api.setItemsForMap(that.restaurant_id.restaurant_id,m).then(function(res){res&&SweetAlert.swal({title:"Unmapped successfully!",timer:500,showConfirmButton:!1,type:"success"})})},that.checkAll=function(val){that.searchModel.isDisabledBtn=1!=val;for(var i=0;that.items.length>i;i++)that.items[i].isChecked=val},that.isDisabledBtn=function(item){1==item.isChecked?that.searchModel.isDisabledBtn=!1:that.searchModel.isDisabledBtn=!0},that.getMenuName=function(menu_opn){return null==menu_opn.id?"":menu_opn.menu_item_name+" ("+menu_opn.pricing_level+")"},that.criteriaMatch=function(item_pattern){return function(menu_item){return-1!=menu_item.menu_item_name.toLowerCase().indexOf(item_pattern.toLowerCase().split("_")[0])}},that.moveChecked=function(){SweetAlert.swal({title:"Are you sure?",text:"All selected items will be moved to the selected categories",type:"warning",showCancelButton:!0,confirmButtonColor:"#ed5565",confirmButtonText:"Confirm"},function(res){if(res){var itemsIsArchived={};itemsIsArchived.matched_items=[];for(var i=0;that.items.length>i;i++)""!=that.items[i].moveto&&itemsIsArchived.matched_items.push({id:that.items[i].id,src:that.searchModel.category,dest:that.items[i].moveto});itemsIsArchived.matched_items.length>0&&that.api.change_mapping_category(that.restaurant_id.restaurant_id,itemsIsArchived).then(function(res){if(res&&res.data.report_items.action_id_stack.length==itemsIsArchived.matched_items.length){for(var need_um=!1,i=0;i<res.data.report_items.action_id_stack.length;i++)if(1==res.data.report_items.action_id_stack[i].action_id){need_um=!0;break}need_um?need_um&&SweetAlert.swal({title:"One or more items need to be unmapped first!",timer:1e3,showConfirmButton:!1,type:"warning"}):(SweetAlert.swal({title:"Item(s) moved successfully!",timer:1e3,showConfirmButton:!1,type:"success"}),that.getItems(!1))}})}})},that.$onInit=function(){that.getItems(!0)}}menuItemsMappingController.$inject=["api","$state","auth","localStorageService","restaurant","$rootScope","SweetAlert"],angular.module("inspinia").component("menuItemsMappingComponent",{templateUrl:"js/components/reports/menuItemsMapping/menuItemsMapping.html",controller:menuItemsMappingController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("reports.menuItemsMapping",{url:"/menu-items-mapping/:type",template:"<menu-items-mapping-component></menu-items-mapping-component>",data:{pageTitle:"Menu Items Mapping"}})})}(),function(){"use strict";function pmixController(api,$state,auth,core,localStorageService,restaurant,$rootScope,$scope){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.api=api,that.core=core,that.auth=auth,$rootScope.$on("restaurantSelected",function(){that.pos_id=$state.params.pos_id||restaurant.data.info.pos_id,that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");var from_date=new Date;from_date.setDate(from_date.getDate()-1),that.start_date=from_date,that.end_date=new Date,that.loadPMIXDailyData=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1,timer:2e4});var dayfd=that.start_date.getDate(),monthfd=that.start_date.getMonth()+1,fd=that.start_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1,td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd;that.api.pmix({start_date:fd,end_date:td,RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:that.inventory_type_id,category:"-- All --"==that.category?"All":"Food, Lunch & Dinner"==that.category?"Food":that.category,mode:"daily"}).then(function(res){that.loading=!1,that.pmix_data=res.data.data.pMIX,that.ttl_units_sold=0,that.ttl_sales=0,that.ttl_discounts=0,that.ttl_total_cost=0,that.ttl_gross_profit=0;for(var pi in that.pmix_data){var pt=that.pmix_data[pi];that.ttl_units_sold+=pt.units_sold,that.ttl_sales+=pt.sales,that.ttl_discounts+=pt.discounts,that.ttl_total_cost+=pt.total_cost,that.ttl_gross_profit+=pt.gross_profit}swal.close()})},this.downloadCSV=function(){that.export_loading=!0;const getData=that.pmix_data;var fd,td;if("daily"==that.mode){var dayfd=that.start_date.getDate(),monthfd=that.start_date.getMonth()+1;fd=that.start_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd;var daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1;td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd}var headers=[];"daily"==that.mode&&(headers=["DateFrom","DateTo","Category","MenuItem","PricingLevel","Price","UnitCost","Cost%","UnitsSold","$Sold","Discounts","TotalCost","GrossProfit","%OfUnitsSold","%Of$Sold"]);var csv=headers.join(",")+"\r\n";getData.forEach(function(row){var pmix_obj={};"daily"==that.mode&&(pmix_obj.DateFrom=fd,pmix_obj.DateTo=td,pmix_obj.Category=row.category,pmix_obj.MenuItem=row.name.replace(/,/g,""),pmix_obj.PricingLevel=row.price_number,pmix_obj.Price=row.price,pmix_obj.UnitCost=row.cost,pmix_obj["Cost%"]=row.cost_margin,pmix_obj.UnitsSold=row.units_sold,pmix_obj.$Sold=row.sales,pmix_obj.Discounts=row.discounts,pmix_obj.TotalCost=row.total_cost,pmix_obj.GrossProfit=row.gross_profit,pmix_obj["%OfUnitsSold"]=row.percent_of_units_sold,pmix_obj["%Of$Sold"]=row.percent_of_sales);const values=headers.map(function(header){return pmix_obj[header]});csv+=values.join(",")+"\r\n"});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="PMIX "+("daily"==that.mode?"Daily":"weekly"==that.mode?"Weekly":"Trend")+" Report.csv",hiddenElement.click(),that.export_loading=!1},that.loadData=function(){that.loading=!0,"daily"==that.mode&&that.loadPMIXDailyData()},that.changeMode=function(mode){that.mode!=mode&&(that.mode=mode,that.loadData())},that.$onInit=function(){that.detail_type=$state.params.typeInventory,that.inventory_type_id="alcohol"==that.detail_type?2:1,that.mode="daily",that.export_loading=!1,2==that.inventory_type_id?that.api.get_active_SKU_categories({inventory_type_id:that.inventory_type_id}).then(function(res){that.SKU_categories=res.data.data.categories,that.SKU_categories.unshift({category:"-- All --"}),that.category=that.SKU_categories[0].category,that.SKU_categories.push({category:"Other"}),that.loadPMIXDailyData()}):(that.SKU_categories=[],that.SKU_categories.unshift({category:"-- All --"}),that.category=that.SKU_categories[0].category,that.SKU_categories.push({category:"Food, Lunch & Dinner"}),that.SKU_categories.push({category:"Other"}),that.loadPMIXDailyData())}}pmixController.$inject=["api","$state","auth","core","localStorageService","restaurant","$rootScope","$scope"],angular.module("inspinia").component("pmixComponent",{templateUrl:"js/components/reports/pmix/pmix.html",controller:pmixController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("reports.pmix",{url:"/pmix/:typeInventory",template:"<pmix-component></pmix-component>",data:{pageTitle:"PMIX Report"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]},{serie:!0,files:["css/plugins/c3/c3.min.css","js/plugins/d3/d3.min.js","js/plugins/c3/c3.min.js"]},{serie:!0,name:"gridshore.c3js.chart",files:["js/plugins/c3/c3-angular.min.js"]}])}}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("reports",{url:"/reports",data:{pageTitle:"Reports"},template:"<ui-view></ui-view>",abstract:!0,resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]},{files:["js/plugins/moment/moment.min.js"]},{name:"datePicker",files:["css/plugins/datapicker/angular-datapicker.css","js/plugins/datapicker/angular-datepicker.js"]}])}}})})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("reports.reportsCategory",{url:"/reports-category",templateUrl:"js/components/reports/reportsCategory/reportsCategory.html",data:{pageTitle:"Reports"},controllerAs:"$ctr",controller:function($rootScope,restaurant){var that=this;$rootScope.$on("restaurantSelected",function(){that.permissions=restaurant.data.permissions,that.subscription_type_id=restaurant.data.info.subscription_type_id}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),restaurant.data.info.subscription_type_id&&(that.subscription_type_id=restaurant.data.info.subscription_type_id)}})})}(),function(){"use strict";function salesReportsController(api,$state,auth,core,localStorageService,restaurant,$rootScope,$scope){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.api=api,that.core=core,that.auth=auth,that.subcats=[],that.temp_subcats=[],that.subcategory=null,that.start_date=new Date,that.start_date.setDate(that.start_date.getDate()-1),that.end_date=new Date,that.gross_sales=0,that.discounts=0,that.total_sales=0,that.value_last_period=0,that.purchase_value=0,that.value_this_period=0,that.target_cost=0,that.value_used=0,that.cost_percent=0,that.target_cost_percent=0,that.os_percent_variance=0,that.sales={Liquor:0,Bottle_Beer:0,Draft_Beer:0,Wine:0,Total:0},$rootScope.$on("restaurantSelected",function(){that.pos_id=$state.params.pos_id||restaurant.data.info.pos_id,that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");var from_date=new Date;from_date.setDate(from_date.getDate()-1),that.start_date=from_date,that.end_date=new Date,that.category="Liquor",that.loadLateralChart=function(){var dayfd=that.start_date.getDate(),monthfd=that.start_date.getMonth()+1,fd=that.start_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1,td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd;that.api.lateral_chart_api({From:fd,To:td,RestaurantId:that.restaurant_id.restaurant_id,Category:that.category,inventory_type_id:2}).then(function(res){that.loading=!1,swal.close();var LateralChart=res.data.data.Lateral;that.sales_table_data=[];for(var l=1;l<LateralChart[0].length;l++)that.sales_table_data.push({item_name:LateralChart[0][l],units_sold:LateralChart[1][l]});c3.generate({bindto:"#sales",size:{height:500},data:{x:"x",columns:LateralChart,type:"bar",empty:{label:{text:"No data found."}}},zoom:{enabled:!0},axis:{rotated:!0,x:{type:"category"},y:{tick:{format:function(d){return parseFloat(Math.round(100*d)/100)}}}},legend:{show:!1}}).zoom([0,10])})},that.loadPMIXWeeklyData=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),that.loading=!0,that.api.pmix({RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:2,category:"-- All --"==that.category?"All":"Food, Lunch & Dinner"==that.category?"Food":that.category,mode:"weekly"}).then(function(res){that.loading=!1,swal.close(),that.pmix_data=res.data.data.pMIX,that.pmix_weekly_start=that.pmix_data[0].pmix_weekly_start,that.pmix_weekly_end=that.pmix_data[0].pmix_weekly_end})},that.loadPMIXTrendData=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),that.loading=!0,that.api.pmix({RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:2,category:"-- All --"==that.category?"All":"Food, Lunch & Dinner"==that.category?"Food":that.category,mode:"trend"}).then(function(res){that.loading=!1,swal.close(),that.pmix_data=res.data.data.pMIX,that.pmix_trend_start=that.pmix_data[0].pmix_trend_start,that.pmix_trend_end=that.pmix_data[0].pmix_trend_end})},that.loadDailySalesData=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),that.loading=!0,that.daily_sales_data=[],that.daily_sales_row_header=that.daily_sales_mode.name,that.api.sales_current_to_last_period_report({RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:2,mode:that.daily_sales_mode.mode}).then(function(res){that.loading=!1,swal.close(),that.daily_sales_data=res.data.data.salesCurrentToLastPeriodReport,that.previous_year_label=that.daily_sales_data.previous_year,that.current_year_label=that.daily_sales_data.current_year,delete that.daily_sales_data.previous_year,delete that.daily_sales_data.current_year,that.daily_sales_data_keys=Object.keys(that.daily_sales_data)})},that.SalesSummary=function(){var dayfd=that.start_date.getDate(),monthfd=that.start_date.getMonth()+1,fd=that.start_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1,td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd;that.api.salesSummary({From:fd,To:td,RestaurantId:that.restaurant_id.restaurant_id,Category:that.category}).then(function(res){if(res){that.sales={Liquor:0,Bottle_Beer:0,Draft_Beer:0,"Draft Wine":0,Wine:0,Total:0};for(var sales_total=0,i=0;i<res.data.data.salesSummary.length;i++)"Liquor"==res.data.data.salesSummary[i].category?(that.sales.Liquor=res.data.data.salesSummary[i].sales,sales_total+=res.data.data.salesSummary[i].sales):"Bottle Beer"==res.data.data.salesSummary[i].category?(that.sales.Bottle_Beer=res.data.data.salesSummary[i].sales,sales_total+=res.data.data.salesSummary[i].sales):"Draft Beer"==res.data.data.salesSummary[i].category?(that.sales.Draft_Beer=res.data.data.salesSummary[i].sales,sales_total+=res.data.data.salesSummary[i].sales):"Draft Wine"==res.data.data.salesSummary[i].category?(that.sales.Draft_Wine=res.data.data.salesSummary[i].sales,sales_total+=res.data.data.salesSummary[i].sales):"Wine"==res.data.data.salesSummary[i].category&&(that.sales.Wine=res.data.data.salesSummary[i].sales,sales_total+=res.data.data.salesSummary[i].sales);that.sales.Total=sales_total}})},this.exportReport=function(type){"details"==type?this.downloadDetails():"pmix_weekly"==type||"pmix_trend"==type?this.downloadPMIX():"daily"==type&&this.downloadDailySales()},this.downloadDetails=function(){that.export_loading=!0;const getData=[];this.sales_table_data.forEach(function(data){getData.push({Category:that.category,Item:data.item_name.replace(/[,'#]/g," "),UnitsSold:data.units_sold})});const headers=["Category","Item","UnitsSold"];var csv=headers.join(",")+"\r\n";getData.forEach(function(row){const values=headers.map(function(header){return row[header]});csv+=values.join(",")+"\r\n"});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="Sales Report.csv",hiddenElement.click(),that.export_loading=!1},this.downloadPMIX=function(){that.export_loading=!0;const getData=that.pmix_data;var fd,td;"pmix_weekly"==that.mode?(fd=that.pmix_weekly_start.substring(0,10),td=that.pmix_weekly_end.substring(0,10)):"pmix_trend"==that.mode&&(fd=that.pmix_trend_start.substring(0,10),td=that.pmix_trend_end.substring(0,10));var headers=[];"pmix_weekly"==that.mode?headers=["DateFrom","DateTo","Category","MenuItem","PricingLevel","TotalWeekly$Sales","TotalWeekly$Cost","Gross$Profit","LastWeekUnitsSold","13WeekAvgUnitsSold","Variance","LastWeek%OfSales"]:"pmix_trend"==that.mode&&(headers=["DateFrom","DateTo","Category","MenuItem","PricingLevel","Week1UnitsSold","Week2UnitsSold","Week3UnitsSold","Week4UnitsSold","Week5UnitsSold","Week6UnitsSold","Week7UnitsSold","Week8UnitsSold","Week9UnitsSold","Trend"]);var csv=headers.join(",")+"\r\n";getData.forEach(function(row){var pmix_obj={};"pmix_weekly"==that.mode?(pmix_obj.DateFrom=fd,pmix_obj.DateTo=td,pmix_obj.Category=row.category,pmix_obj.MenuItem=row.name,pmix_obj.PricingLevel=row.price_number,pmix_obj.TotalWeekly$Sales=row.sales,pmix_obj.TotalWeekly$Cost=row.cost,pmix_obj.Gross$Profit=row.sales-row.cost,pmix_obj.LastWeekUnitsSold=row.units_sold,pmix_obj["13WeekAvgUnitsSold"]=row.units_sold_avg_13_weeks,pmix_obj.Variance=row.units_sold-row.units_sold_avg_13_weeks,
pmix_obj["LastWeek%OfSales"]=row.percent_of_sales):"pmix_trend"==that.mode&&(pmix_obj.DateFrom=fd,pmix_obj.DateTo=td,pmix_obj.Category=row.category,pmix_obj.MenuItem=row.name,pmix_obj.PricingLevel=row.price_number,pmix_obj.Week1UnitsSold=row.week_1,pmix_obj.Week2UnitsSold=row.week_2,pmix_obj.Week3UnitsSold=row.week_3,pmix_obj.Week4UnitsSold=row.week_4,pmix_obj.Week5UnitsSold=row.week_5,pmix_obj.Week6UnitsSold=row.week_6,pmix_obj.Week7UnitsSold=row.week_7,pmix_obj.Week8UnitsSold=row.week_8,pmix_obj.Week9UnitsSold=row.week_9,pmix_obj.Trend=row.trend);const values=headers.map(function(header){return pmix_obj[header]});csv+=values.join(",")+"\r\n"});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="PMIX "+("pmix_weekly"==that.mode?"Weekly":"Trend")+" Report.csv",hiddenElement.click(),that.export_loading=!1},this.downloadDailySales=function(){that.export_loading=!0;var headers=["Period","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday","Total"],csv=headers.join(",")+"\r\n",values=[];that.daily_sales_data_keys.forEach(function(key){var ds_obj={};ds_obj.Period=that.previous_year_label+" "+key+" "+that.daily_sales_row_header,ds_obj.Monday=that.daily_sales_data[key].previous[0],ds_obj.Tuesday=that.daily_sales_data[key].previous[1],ds_obj.Wednesday=that.daily_sales_data[key].previous[2],ds_obj.Thursday=that.daily_sales_data[key].previous[3],ds_obj.Friday=that.daily_sales_data[key].previous[4],ds_obj.Saturday=that.daily_sales_data[key].previous[5],ds_obj.Sunday=that.daily_sales_data[key].previous[6],ds_obj.Total=that.daily_sales_data[key].previous[7],values=headers.map(function(header){return ds_obj[header]}),csv+=values.join(",")+"\r\n","highest"==that.daily_sales_mode.mode&&(ds_obj.Period="Date of "+that.daily_sales_row_header,ds_obj.Monday=that.daily_sales_data[key].previous_highest_date[0],ds_obj.Tuesday=that.daily_sales_data[key].previous_highest_date[1],ds_obj.Wednesday=that.daily_sales_data[key].previous_highest_date[2],ds_obj.Thursday=that.daily_sales_data[key].previous_highest_date[3],ds_obj.Friday=that.daily_sales_data[key].previous_highest_date[4],ds_obj.Saturday=that.daily_sales_data[key].previous_highest_date[5],ds_obj.Sunday=that.daily_sales_data[key].previous_highest_date[6],ds_obj.Total=that.daily_sales_data[key].previous_highest_date[7],values=headers.map(function(header){return ds_obj[header]}),csv+=values.join(",")+"\r\n"),ds_obj.Period=that.current_year_label+" "+key+" "+that.daily_sales_row_header,ds_obj.Monday=that.daily_sales_data[key].current[0],ds_obj.Tuesday=that.daily_sales_data[key].current[1],ds_obj.Wednesday=that.daily_sales_data[key].current[2],ds_obj.Thursday=that.daily_sales_data[key].current[3],ds_obj.Friday=that.daily_sales_data[key].current[4],ds_obj.Saturday=that.daily_sales_data[key].current[5],ds_obj.Sunday=that.daily_sales_data[key].current[6],ds_obj.Total=that.daily_sales_data[key].current[7],values=headers.map(function(header){return ds_obj[header]}),csv+=values.join(",")+"\r\n","highest"==that.daily_sales_mode.mode&&(ds_obj.Period="Date of "+that.daily_sales_row_header,ds_obj.Monday=that.daily_sales_data[key].current_highest_date[0],ds_obj.Tuesday=that.daily_sales_data[key].current_highest_date[1],ds_obj.Wednesday=that.daily_sales_data[key].current_highest_date[2],ds_obj.Thursday=that.daily_sales_data[key].current_highest_date[3],ds_obj.Friday=that.daily_sales_data[key].current_highest_date[4],ds_obj.Saturday=that.daily_sales_data[key].current_highest_date[5],ds_obj.Sunday=that.daily_sales_data[key].current_highest_date[6],ds_obj.Total=that.daily_sales_data[key].current_highest_date[7],values=headers.map(function(header){return ds_obj[header]}),csv+=values.join(",")+"\r\n"),"total"!=that.daily_sales_mode.mode&&"avg"!=that.daily_sales_mode.mode||(ds_obj.Period="Difference",ds_obj.Monday=that.daily_sales_data[key].current[0]-that.daily_sales_data[key].previous[0],ds_obj.Tuesday=that.daily_sales_data[key].current[1]-that.daily_sales_data[key].previous[1],ds_obj.Wednesday=that.daily_sales_data[key].current[2]-that.daily_sales_data[key].previous[2],ds_obj.Thursday=that.daily_sales_data[key].current[3]-that.daily_sales_data[key].previous[3],ds_obj.Friday=that.daily_sales_data[key].current[4]-that.daily_sales_data[key].previous[4],ds_obj.Saturday=that.daily_sales_data[key].current[5]-that.daily_sales_data[key].previous[5],ds_obj.Sunday=that.daily_sales_data[key].current[6]-that.daily_sales_data[key].previous[6],ds_obj.Total=that.daily_sales_data[key].current[7]-that.daily_sales_data[key].previous[7],values=headers.map(function(header){return ds_obj[header]}),csv+=values.join(",")+"\r\n",ds_obj.Period="Change",ds_obj.Monday=Math.round((that.daily_sales_data[key].current[0]-that.daily_sales_data[key].previous[0])/that.daily_sales_data[key].previous[0]*1e4)/100+"%",ds_obj.Tuesday=Math.round((that.daily_sales_data[key].current[1]-that.daily_sales_data[key].previous[1])/that.daily_sales_data[key].previous[1]*1e4)/100+"%",ds_obj.Wednesday=Math.round((that.daily_sales_data[key].current[2]-that.daily_sales_data[key].previous[2])/that.daily_sales_data[key].previous[2]*1e4)/100+"%",ds_obj.Thursday=Math.round((that.daily_sales_data[key].current[3]-that.daily_sales_data[key].previous[3])/that.daily_sales_data[key].previous[3]*1e4)/100+"%",ds_obj.Friday=Math.round((that.daily_sales_data[key].current[4]-that.daily_sales_data[key].previous[4])/that.daily_sales_data[key].previous[4]*1e4)/100+"%",ds_obj.Saturday=Math.round((that.daily_sales_data[key].current[5]-that.daily_sales_data[key].previous[5])/that.daily_sales_data[key].previous[5]*1e4)/100+"%",ds_obj.Sunday=Math.round((that.daily_sales_data[key].current[6]-that.daily_sales_data[key].previous[6])/that.daily_sales_data[key].previous[6]*1e4)/100+"%",ds_obj.Total=Math.round((that.daily_sales_data[key].current[7]-that.daily_sales_data[key].previous[7])/that.daily_sales_data[key].previous[7]*1e4)/100+"%",values=headers.map(function(header){return ds_obj[header]}),csv+=values.join(",")+"\r\n"),"highest"==that.daily_sales_mode.mode&&(ds_obj.Period=that.previous_year_label+" "+key+"  Zero Sales Days",ds_obj.Monday=that.daily_sales_data[key].previous_zero_days[0],ds_obj.Tuesday=that.daily_sales_data[key].previous_zero_days[1],ds_obj.Wednesday=that.daily_sales_data[key].previous_zero_days[2],ds_obj.Thursday=that.daily_sales_data[key].previous_zero_days[3],ds_obj.Friday=that.daily_sales_data[key].previous_zero_days[4],ds_obj.Saturday=that.daily_sales_data[key].previous_zero_days[5],ds_obj.Sunday=that.daily_sales_data[key].previous_zero_days[6],ds_obj.Total=that.daily_sales_data[key].previous_zero_days[7],values=headers.map(function(header){return ds_obj[header]}),csv+=values.join(",")+"\r\n",ds_obj.Period=that.current_year_label+" "+key+"  Zero Sales Days",ds_obj.Monday=that.daily_sales_data[key].current_zero_days[0],ds_obj.Tuesday=that.daily_sales_data[key].current_zero_days[1],ds_obj.Wednesday=that.daily_sales_data[key].current_zero_days[2],ds_obj.Thursday=that.daily_sales_data[key].current_zero_days[3],ds_obj.Friday=that.daily_sales_data[key].current_zero_days[4],ds_obj.Saturday=that.daily_sales_data[key].current_zero_days[5],ds_obj.Sunday=that.daily_sales_data[key].current_zero_days[6],ds_obj.Total=that.daily_sales_data[key].current_zero_days[7],values=headers.map(function(header){return ds_obj[header]}),csv+=values.join(",")+"\r\n"),ds_obj.Period="",ds_obj.Monday="",ds_obj.Tuesday="",ds_obj.Wednesday="",ds_obj.Thursday="",ds_obj.Friday="",ds_obj.Saturday="",ds_obj.Sunday="",ds_obj.Total="",values=headers.map(function(header){return ds_obj[header]}),csv+=values.join(",")+"\r\n"});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="Daily_Sales "+("total"==that.daily_sales_mode.mode?"Total":"avg"==that.daily_sales_mode.mode?"Average":"Highest Sales")+" Report.csv",hiddenElement.click(),that.export_loading=!1},that.loadSalesData=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),that.loading=!0,that.SalesSummary(),that.loadLateralChart()},that.loadPMIXData=function(){swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1}),that.loading=!0,"pmix_weekly"==that.mode?that.loadPMIXWeeklyData():"pmix_trend"==that.mode&&that.loadPMIXTrendData()},that.changeMode=function(mode){that.mode!=mode&&(that.mode=mode,"summary"==that.mode?(that.categories=JSON.parse(JSON.stringify(that.bu_categories)),that.category=that.categories[0].category,that.loadSalesData()):"details"==that.mode?(that.categories=JSON.parse(JSON.stringify(that.bu_categories)),that.category=that.categories[0].category,that.loadLateralChart()):"pmix_weekly"==that.mode?(that.categories=JSON.parse(JSON.stringify(that.bu_categories)),that.categories.push({category:"Other"}),that.categories.unshift({category:"-- All --"}),that.category=that.categories[0].category,that.loadPMIXWeeklyData()):"pmix_trend"==that.mode?(that.categories=JSON.parse(JSON.stringify(that.bu_categories)),that.categories.push({category:"Other"}),that.categories.unshift({category:"-- All --"}),that.category=that.categories[0].category,that.loadPMIXTrendData()):"daily"==that.mode&&(that.daily_sales_mode=that.daily_sales_modes_list[0],that.loadDailySalesData()))},that.$onInit=function(){Promise.all([api.get_vendors_categories({is_restaurant_used_only:1,inventory_type_id:2})]).then(function(response){that.categories=response[0].data.data.categories.filter(function(x){return"Non Alcoholic"!=x.category}),that.bu_categories=JSON.parse(JSON.stringify(that.categories)),that.category=that.categories[0].category,that.daily_sales_modes_list=[{mode:"total",name:"$ Sales"},{mode:"avg",name:"Running Average $ Sales"},{mode:"highest",name:"Highest $ Sales Day"}],that.mode="summary",that.loadSalesData(),that.export_loading=!1})}}salesReportsController.$inject=["api","$state","auth","core","localStorageService","restaurant","$rootScope","$scope"],angular.module("inspinia").component("salesReportComponent",{templateUrl:"js/components/reports/salesReport/salesReport.html",controller:salesReportsController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("reports.salesReport",{url:"/sales-report",template:"<sales-report-component></sales-report-component>",data:{pageTitle:"Sales Report"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]},{serie:!0,files:["css/plugins/c3/c3.min.css","js/plugins/d3/d3.min.js","js/plugins/c3/c3.min.js"]},{serie:!0,name:"gridshore.c3js.chart",files:["js/plugins/c3/c3-angular.min.js"]}])}}})})}(),function(){"use strict";function usageVsPurchaseController(api,$state,$filter,auth,core,localStorageService,restaurant,$uibModal,$rootScope,$scope){if(!auth.authentication.isLogged)return void $state.go("home");var that=this;if(that.api=api,that.core=core,that.auth=auth,that.res_data=[],that.temp_cats=[],that.subcats=[],that.temp_subcats=[],that.temp_items=[],that.category=null,that.subcategory=null,that.item=null,that.start_date=new Date,that.start_date.setMonth(that.start_date.getMonth()-1),that.end_date=new Date,that.invoice_data=[],that.active_skus=[],that.invoice_items=[],$rootScope.$on("restaurantSelected",function(){that.pos_id=$state.params.pos_id||restaurant.data.info.pos_id,that.permissions=restaurant.data.permissions}),restaurant.data.permissions&&(that.permissions=restaurant.data.permissions),that.restaurant_id=localStorageService.get("restaurant_id"),!that.restaurant_id)return void $state.go("home");that.sendWeeklyPDF=function(){$uibModal.open({templateUrl:"send_pdf.html",controller:modalController,windowClass:"animated fadeIn modal-lgg",controllerAs:"$ctr"})},that.PurchasesVsUsage=function(){that.loading=!0,swal({title:"",text:"Loading...",imageUrl:"img/loading2.gif",showConfirmButton:!1});var dayfd=that.start_date.getDate(),monthfd=that.start_date.getMonth()+1,fd=that.start_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1,td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd;that.api.PurchaseVsUsage({From:fd,To:td,RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:2}).then(function(res){res&&(that.res_data=res.data.data.PurchaseVsUsage,that.changeSubCat(),that.update_bar_chart())})},that.changeCat=function(){-1!=that.category.id?(that.subcategories=that.all_subcategories.filter(function(x){return that.category.id==x.vendor_cat_id}),that.subcategories.unshift({id:-1,sub_category:"--All Subcategories--"}),that.subcategory=that.subcategories[0]):(that.subcategories=JSON.parse(JSON.stringify(that.all_subcategories)),that.subcategory={id:-1,sub_category:"--All Subcategories--"}),that.temp_items=["--All Items--"],that.item=that.temp_items[0]},that.changeSubCat=function(){-1!=that.subcategory.id?(that.temp_items=that.res_data.filter(function(x){return x.category==that.category.category&&x.sub_category==that.subcategory.sub_category}).map(function(x){return x.item_name}),that.temp_items.sort(),that.temp_items.unshift("--All Items--"),"--All Items--"!=that.item&&null!=that.item||(that.item=that.temp_items[0])):that.temp_items=that.res_data.map(function(x){return x.item_name})},that.update_bar_chart=function(){var columns=[["Usage"],["Purchases"]],categories=[];that.active_skus=[],-1!=that.category.id&&(that.res_data=that.res_data.filter(function(x){return x.category==that.category.category}),-1!=that.subcategory.id&&(that.res_data=that.res_data.filter(function(x){return x.sub_category==that.subcategory.sub_category}),"--All Items--"!=that.item&&(that.res_data=that.res_data.filter(function(x){return x.item_name==that.item})))),that.res_data.sort(function(a,b){return a.item_name>b.item_name?1:b.item_name>a.item_name?-1:0});for(var i=0;i<that.res_data.length;i++)categories.push(that.res_data[i].item_name),columns[0].push(that.res_data[i].units_sold),columns[1].push(that.res_data[i].units_purchased),that.active_skus.push(that.res_data[i].vendor_sku_id);c3.generate({bindto:"#PurchasesVsUsage",data:{columns:columns,type:"bar"},zoom:{enabled:!0,rescale:!0},axis:{x:{type:"category",categories:categories}},legend:{show:!0}}).zoom([0,10]),that.VendorTable()},that.VendorTable=function(){var dayfd=that.start_date.getDate(),monthfd=that.start_date.getMonth()+1,fd=that.start_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1,td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd;that.api.VendorDetail({From:fd,To:td,RestaurantId:that.restaurant_id.restaurant_id,inventory_type_id:2}).then(function(res){if(swal.close(),res){that.invoice_data=res.data.data.VendorDetail,that.invoice_items=[];for(var i=0;i<that.invoice_data.length;i++)for(var j=0;j<that.active_skus.length;j++)that.invoice_data[i].vendor_sku_id!=that.active_skus[j]&&that.invoice_data[i].substitute_for!=that.active_skus[j]||that.invoice_items.push(that.invoice_data[i])}that.loading=!1})},that.changeMode=function(mode){that.mode!=mode&&(that.mode=mode,that.PurchasesVsUsage())},this.downloadCSV=function(){that.export_loading=!0;const getData=[];this.invoice_items.forEach(function(data){var i_date=data.delivery_date.substr(0,10);i_date=i_date.split("-")[0]+"-"+i_date.split("-")[1]+"-"+i_date.split("-")[2],getData.push({Vendor:data.vendor_name.replace(/[,'#]/g," "),SKU:data.vendor_sku.replace(/[,'#]/g," "),ItemDescription:data.item_name.replace(/[,'#]/g," "),Invoice:data.invoice_number.replace(/[,'#]/g," "),DateReceived:i_date,QtyReceived:data.units_purchased,ItemPrice:data.item_cost,TotalCost:data.total_cost})});const headers=["Vendor","SKU","ItemDescription","Invoice","DateReceived","QtyReceived","ItemPrice","TotalCost"];var csv=headers.join(",")+"\r\n";getData.forEach(function(row){const values=headers.map(function(header){return row[header]});csv+=values.join(",")+"\r\n"});var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csv),hiddenElement.target="_blank",hiddenElement.download="Usage-vs-Purchases Report.csv",hiddenElement.click(),that.export_loading=!1},that.$onInit=function(){Promise.all([api.get_vendors_categories({is_restaurant_used_only:1,inventory_type_id:2}),core.getRefbooks()]).then(function(response){that.categories=response[0].data.data.categories.filter(function(x){return"Non Alcoholic"!=x.category}),that.categories.unshift({id:-1,category:"--All Categories--",inventory_type_id:2}),that.category=that.categories[0];var cat_ids=that.categories.map(function(x){return x.id});that.all_subcategories=response[1].vendor_sub_cat.filter(function(x){return cat_ids.includes(x.vendor_cat_id)}),that.subcategories=JSON.parse(JSON.stringify(that.all_subcategories)),that.subcategory={id:-1,sub_category:"--All Subcategories--"},that.mode="summary",that.PurchasesVsUsage(),that.export_loading=!1})}}var modalController=function($uibModalInstance,api,alertService){var that=this;that.api=api,that.q_title="Send Report PDF",that.q_texts='<article style="display: block;"><p>Please select a Monday for start date and a Sunday for end date.</p></article>',that.start_date=new Date,that.end_date=new Date,that.select_start_date=function(){if(1!=that.start_date.getDay())return alertService.showError("Please select a Monday!"),void(that.start_date=new Date)},that.select_end_date=function(){if(0!=that.end_date.getDay())return alertService.showError("Please select a Sunday!"),void(that.end_date=new Date)},that.sendPDF=function(){if(that.start_date>=that.end_date)return alertService.showError("Please select a valid range!"),void(that.end_date=new Date);if(1!=that.start_date.getDay())return alertService.showError("Please select a Monday!"),void(that.start_date=new Date);if(0!=that.end_date.getDay())return alertService.showError("Please select a Sunday!"),void(that.end_date=new Date);var dayfd=that.start_date.getDate(),monthfd=that.start_date.getMonth()+1,fd=that.start_date.getFullYear()+"-"+((""+monthfd).length<2?"0":"")+monthfd+"-"+((""+dayfd).length<2?"0":"")+dayfd,daytd=that.end_date.getDate(),monthtd=that.end_date.getMonth()+1,td=that.end_date.getFullYear()+"-"+((""+monthtd).length<2?"0":"")+monthtd+"-"+((""+daytd).length<2?"0":"")+daytd;that.api.on_hand_email({start_date:fd,end_date:td}).then(function(res){}),alertService.showSuccessText("Sent!","Please check your email"),$uibModalInstance.close()},that.cancel=function(){$uibModalInstance.dismiss("cancel")}};usageVsPurchaseController.$inject=["api","$state","$filter","auth","core","localStorageService","restaurant","$uibModal","$rootScope","$scope"],angular.module("inspinia").component("usageVsPurchaseComponent",{templateUrl:"js/components/reports/usageVsPurchase/usageVsPurchase.html",controller:usageVsPurchaseController,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("reports.usageVsPurchase",{url:"/usage-vs-purchase",template:"<usage-vs-purchase-component></usage-vs-purchase-component>",data:{pageTitle:"Usage Vs Purchase"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load([{files:["js/plugins/footable/footable.all.min.js","css/plugins/footable/footable.core.css"]},{name:"ui.footable",files:["js/plugins/footable/angular-footable.js"]},{serie:!0,files:["css/plugins/c3/c3.min.css","js/plugins/d3/d3.min.js","js/plugins/c3/c3.min.js"]},{serie:!0,name:"gridshore.c3js.chart",files:["js/plugins/c3/c3-angular.min.js"]}])}}})})}(),function(){"use strict";function controller(api,$state,auth,localStorageService,$rootScope,SweetAlert,restaurant,core){var that=this;that.form={},that.state=$state,that.core=core,that.api=api,that.auth=auth,that.$onInit=function(){}}controller.$inject=["api","$state","auth","localStorageService","$rootScope","SweetAlert","restaurant","core"],angular.module("inspinia").component("schedulingsetupandbudget",{templateUrl:"js/components/schedulingSetupandBudget/schedulingsetupandbudget.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";angular.module("inspinia").config(function($stateProvider){$stateProvider.state("admin.schedulingsetupandbudget",{url:"/schedulingsetupandbudget",template:"<schedulingsetupandbudget></schedulingsetupandbudget>",data:{pageTitle:"Scheduling Setup and Budget"}})})}(),function(){"use strict";function controller($state,auth){if(!auth.authentication.isLogged)return void $state.go("home");this.$state=$state}controller.$inject=["$state","auth"],angular.module("inspinia").component("setupConfirmationComponent",{templateUrl:"js/components/setupConfirmation/setupConfirmation.html",controller:controller,controllerAs:"$ctr",bindings:{}})}(),function(){"use strict";var typesFilter=function(){return function(items,prop){var name;return prop&&angular.forEach(items,function(value,key){value.id==prop&&(name=value.name)}),name}};angular.module("inspinia").filter("recipeTypeFilter",typesFilter)}(),function(){"use strict";var tareTypeFilter=function(){return function(items,prop){var name;return prop&&angular.forEach(items,function(value,key){value.tare_type_id==prop&&(name=value.name)}),name}};angular.module("inspinia").filter("tareTypeFilter",tareTypeFilter)}(),function(){"use strict";var typesFilter=function(){return function(items,prop){var name;return prop&&angular.forEach(items,function(value,key){value.id==prop&&(name=value.is_indivisible)}),name}};angular.module("inspinia").filter("vendorSubCatIdTypeFilter",typesFilter)}();