<!-- Wrapper-->
<div id="wrapper">

    <header-component></header-component>

    <navigation-component></navigation-component>

    <!-- Page wraper -->
    <div id="page-wrapper" class="white-bg">
        <!-- <div class="row wrapper border-bottom white-bg page-heading">
            <div class="col-lg-10">
                <h2>Usage Vs Purchase</h2>
                <ol class="breadcrumb">
                    <li ui-sref="reports.reportsCategory">
                        <a>Reports</a>
                    </li>&nbsp;/&nbsp;
                    <li ui-sref="reports.alcohol.alcoholDetail">
                        <a>Alcohol Detail Report</a>
                    </li>&nbsp;/&nbsp;
                    <li class="active-page">
                        <a>Usage Vs Purchase</a>
                    </li>
                </ol>
            </div>
            <div class="col-lg-2">

            </div>
        </div> -->
        <div class="wrapper wrapper-content  animated fadeInRight" style="overflow: hidden;">
			<div class="row">
				<div class="row">
					<div class="col-sm-12">
						<div class="ibox float-e-margins">
							<div class="ibox-content">
								<div class="row">
									<div class="col-xs-12">
										<button class="btn btn-primary" ui-sref="reports.reportsCategory">&lt;&lt; Back</button>
										<button class="btn btn-primary" ui-sref="reports.food.foodDetail">Overview</button>
										<button class="btn btn-primary" ui-sref="reports.foodCostOfSummary">Inventory Count</button>
										<button class="btn btn-primary" ui-sref="reports.foodOnHand">On-Hand</button>
										<button class="btn btn-primary" ui-sref="reports.foodSalesReport">Sales</button>
										<button class="btn btn-primary" ui-sref="reports.batchReport">Batches</button>
										<button class="btn btn-primary" ui-sref="reports.analytics({typeInventory: 'food'})">Usage</button>
										<button class="btn btn-primary" ui-sref="reports.pmix({typeInventory: 'food'})">PMIX</button>
										<button class="btn btn-primary" ui-sref="reports.foodCostChangeReport">Cost Change</button>
										<button class="btn btn-primary active" ui-sref="reports.foodUsageVsPurchase">Purchases</button>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-sm-12">
						<div class="ibox-content text-center">
							<label class="font-noraml"><b>Show:</b></label>
							<button class="btn btn-danger" ng-click="$ctr.changeMode('summary')">Summary</button>
							<button class="btn btn-danger" ng-click="$ctr.changeMode('details')">Details</button>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-sm-12 ir" style="text-align: center">
						<label>Date From</label> <input type="date" ng-model="$ctr.start_date"/>
						<label>Date To</label> <input type="date" ng-model="$ctr.end_date"/>
						<select ng-model="$ctr.category" ng-options="item as item.category for item in $ctr.categories" ng-change="$ctr.changeCat()" required>
						</select>
						<select ng-if="$ctr.category.id != -1" ng-model="$ctr.subcategory" ng-options="item as item.sub_category for item in $ctr.subcategories" ng-change="$ctr.changeSubCat()" required>
						</select>
						<select ng-if="$ctr.subcategory.id != -1" ng-model="$ctr.item" style="width: 104px;" ng-options="item as item for item in $ctr.temp_items" required>
						</select>
						<button ng-if="!$ctr.loading" class="btn btn-primary" ng-click="$ctr.PurchasesVsUsage()">Search</button>
						<button ng-if="$ctr.loading" class="btn btn-primary" disabled>Loading...</button>
						<button ng-click="$ctr.sendWeeklyPDF()">Send PDF</button>
						<button scroll-top class="btn btn-primary margin-right-10 float-right" ng-click="$ctr.downloadCSV()" ng-if="!$ctr.export_loading">Export Report
						</button>
						<button scroll-top class="btn btn-primary margin-right-10 float-right" ng-disabled="$ctr.export_loading" ng-if="$ctr.export_loading">Exporting...
						</button>

					</div>
					<div class="col-lg-12"  ng-if="$ctr.mode == 'summary'">
						<div class="clearfix">
							<h5 class="text-center">Usage -vs- Purchases</h5>
						</div>
						<div class="clearfix">
							<div id="PurchasesVsUsage" class='rChart uvcharts'></div>
						</div>
					</div>
				</div>
				<div class="row" id="top-section" ng-if="$ctr.mode == 'details'">
					<div class="col-sm-12 col-lg-12" style="padding-left: 34px; padding-right: 18px;">
						<table class="table table-bordered table-sm" style="table-layout: fixed;" >
							<thead>
								<tr>
									<td style="width: 230px;">Vendor</td>
									<td style="width: 76px;">Sku</td>
									<td style="width: 310px;">Item Description</td>
									<td style="width: 80px;">Invoice #</td>
									<td style="width: 100px;">Date Received</td>
									<td style="width: 107px;">Qty Received</td>
									<td style="width: 88px;">Item Price</td>
									<td style="width: 88px;">Total Cost</td>
								</tr>
							</thead>
						</table>
					</div>
				</div>
            </div>
            
            <div class="row" id="content-table-section">
                <div class="ibox float-e-margins" style="margin-top: 38px;">
                    <div class="ibox-content ir adjust-pad">
                        <table ng-if="$ctr.mode == 'details'" class="table table-bordered table-sm" style="table-layout: fixed;">
							<tbody ng-repeat="item in $ctr.invoice_items track by $index">
								<tr>
									<td style="width: 230px;">{{item.vendor_name}}</td>
                                    <td style="width: 76px;">{{item.vendor_sku}}</td>
                                    <td style="width: 310px;">{{item.item_name}}</td>
                                    <td style="width: 80px;">{{item.invoice_number}}</td>
                                    <td style="width: 100px;">{{item.delivery_date | date:'yyyy-MM-dd'}}</td>
                                    <td style="width: 107px;">{{item.units_purchased}}</td>
                                    <td style="width: 88px;">{{item.item_cost}}</td>
                                    <td style="width: 88px;">{{item.total_cost}}</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>

        <!-- Footer -->
        <div ng-include="'views/common/footer.html'"></div>

    </div>
    <!-- End page wrapper-->

</div>
<!-- End wrapper-->
<style>
.ir select, .ir input {
    height: 35px;
    padding: 5px;
    margin-bottom: 10px;
}
.ir button {
    border-color: #0078d7;
    background-color: #0078d7;
    display: inline-block;
    padding: 6px 12px;
    margin-bottom: 0;
    font-size: 14px;
    font-weight: 400;
    line-height: 1.42857143;
    text-align: center;
    white-space: nowrap;
    vertical-align: middle;
    -ms-touch-action: manipulation;
    touch-action: manipulation;
    cursor: pointer;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    background-image: none;
    border: 1px solid transparent;
    border-radius: 4px;
    color: #fff;
	position: relative;
	top:-3px;
}

#content-table-section {
    max-height: 55vh;
    overflow-y: scroll;
}

.adjust-pad {
    padding-right: 2px;
    padding-top: 0
}

#top-section {
    position: absolute;
}

.bottomless {
	padding-bottom: 0;
	border-bottom: 0;
}
</style>

<script type="text/ng-template" id="send_pdf.html">
  <div class="inmodal" style="margin-top:80px;">
		<div class="modal-body">
			<h4 class="text-center modal-title">{{$ctr.q_title}}</h4>
			<fieldset>
				<div style="font-size:15px;" ng-bind-html="$ctr.q_texts"></div>
			</fieldset>
			
			<div>
				<div class="form-group">
					<label class="font-noraml">Date From</label>
					<div class="input-group date">
						<input type="date" ng-change="$ctr.select_start_date()" ng-model="$ctr.start_date" required />
					</div>
				</div>
				<div class="form-group">
					<label class="font-noraml">Date To</label>
					<div class="input-group date">
						<input type="date" ng-change="$ctr.select_end_date()" ng-model="$ctr.end_date" required />
					</div>
				</div>
			</div>
		</div>
		
		<div class="modal-footer">
			<button type="button" class="btn btn-white" ng-click="$ctr.sendPDF()">Confirm</button>
		</div>
	</div>
</script>

<script>
    $(document).ready(function () {
        setTimeout(function () {
            var height = document.getElementById('top-section').clientHeight;
            $('#content-table-section').css('margin-top', height + 'px');
        }, 2000);
    });
</script>